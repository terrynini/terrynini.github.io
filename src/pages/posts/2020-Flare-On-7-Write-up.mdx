---
title: "2020::Flare-On 7::Write-up"
description: ""
publishDate: "2020-10-22"
category: "Flare-On"
layout: "../../layouts/ArticleLayout.astro"
---


å–”è€¶ï¼Œé›–ç„¶åæ¬¡æ²’æœ‰å¾ˆè®šï¼Œä½†é‚„æ˜¯ç ´å°äº†ï¼Œåˆçœ‹äº†ä¸€å †å¥‡æŠ€æ·«å·§ğŸ¤”ï¸\
ä»Šå¹´å‰é¢æ‰“çš„å¤ªæ‚ é–’ï¼Œå°è‡´ 11 é¡Œå·®é»è§£ä¸æ‰ï¼Œå“­å•Š...\
é€™æ¬¡è§£é¡Œé‚Šè§£é‚ŠæŠŠ writeup æçš„å·®ä¸å¤šäº†ï¼Œé †æ‰‹ä¾†ç™¼ä¸€ç¯‡


# å¿ƒå¾—

æ ¹æ“š[å®˜æ–¹çš„çµ±è¨ˆæ•¸æ“š](https://www.fireeye.com/blog/threat-research/2020/10/flare-on-7-challenge-solutions.html)ï¼Œä»Šå¹´åº¦å°ç£ç¸½å…±æœ‰ 4 å€‹äººç ´å°ï¼Œä½†é€™å€‹æ•¸æ“šæœ‰é»å¤±çœŸï¼Œå› ç‚ºå°±æˆ‘æ‰€çŸ¥è‡³å°‘é‚„æœ‰å…©å€‹äººç ´å°ä½†æ˜¯æ²’æ›å°ç£åœ‹ç±ï¼Œä½†ä¹Ÿçœ‹å¾—å‡ºä¾†å¤§å®¶è¶Šä¾†è¶Šå¿™ï¼Œ2019 å¹´çš„æ™‚å€™é‚„æœ‰ 8 å€‹äººã€‚

<Image src="./picture3.png" alt="å®Œè³½äººæ•¸" />

å°±çœ‹å¾—åˆ°çš„çµæœä¾†èªªï¼Œæˆ‘æ˜¯ç¬¬ 2 å€‹ç ´å°çš„å°ç£äººï¼Œä¸éè·Ÿç¬¬ä¸€åçš„ Lays å¯¦åœ¨æ˜¯å·®æœ‰é»é ğŸ¤”ï¸ï¼Œé€™æ¬¡å®˜æ–¹é‚„å¾ˆæœ‰è¶£çš„çµ±è¨ˆäº†åœ‹å®¶çš„äººå‡ç ´å°ç‡ï¼Œæˆ‘å€‹äººæ˜¯è¦ºå¾—çœ‹å®Œç¬‘ç¬‘å°±å¥½äº†ï¼Œä½†æ–°åŠ å¡çš„æ•¸å­—é‚„çœŸæ˜¯å¯æ€•ã€‚

<Image src="./picture4.png" alt="äººå‡å®Œè³½ç‡" />

æ˜¯èªªå¯«é€™ç¨® writeup éƒ½æœ‰é»éº»ç…©ï¼Œå¯«åˆ°è¶…ç´šè©³ç´°è®“æ²’æœ‰æ‰“çš„äººéƒ½çœ‹å¾—æ‡‚ç•¶ç„¶æ˜¯å¯è¡Œï¼Œä½†æ˜¯æ™‚é–“æˆæœ¬å¤ªé«˜äº†ï¼Œæ‰€ä»¥æˆ‘å°±åœ¨é€™è£¡ç•™å€‹å¤§æ¦‚ï¼Œå¦‚æœçœŸçš„æœ‰äººç”¨ Flare-On åœ¨ç·´ç¿’ reversing çš„æ™‚å€™çœ‹ä¸æ‡‚çš„è©±ï¼Œå¯ä»¥ç›´æ¥æˆ³æˆ‘æ²’é—œä¿‚ã€‚

ä»Šå¹´çš„ badge æ˜¯é‘°åŒ™ï¼ŒæŒºé…·é…·çš„ï¼š

<Image src="./IMG_6580.png" alt="" />

# 1 - fidler

## Description

>Welcome to the Seventh Flare-On Challenge!
>This is a simple game. Win it by any means necessary and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level.
>This challenge is written in Python and is distributed as a runnable EXE and matching source code for your convenience.
>You can run the source code directly on any Python platform with PyGame if you would prefer.
>*7zip password: flare

## Solution

å¾åœ–ç‰‡ä¸Šçœ‹å¾—å‡ºä¾†æ˜¯ä½¿ç”¨ PyInstaller æ‰“åŒ…éçš„ç¨‹å¼ï¼Œç›´æ¥æ‰¾ç”¨å·¥å…·æŠŠ python bytecode æŠ½å‡ºä¾†ï¼Œ[PyInstaller Extractor](https://github.com/extremecoders-re/pyinstxtractor)ï¼š

<Image src="./fidler00.png" alt="" />

åŒæ™‚é‹è¡Œç¨‹å¼çœ‹ä¸€ä¸‹æœ‰ä»€éº¼ç›®æ¨™ï¼Œçœ‹èµ·ä¾†æ˜¯è¦å…ˆæ‰¾å¯†ç¢¼ï¼š

<Image src="./fidler01.png" alt="" />

å¾å‰›å‰› decompile ä¾†çš„ python code å¯ä»¥çŸ¥é“å¯†ç¢¼æ˜¯ã€Œghostã€ï¼š

```py fidler.py =14
def password_check(input):
    altered_key = 'hiptu'
    key = ''.join([chr(ord(x) - 1) for x in altered_key])
    return input == key
```

çœ‹èµ·ä¾†æ˜¯ pygameï¼ŒéŠæˆ²æ¨¡å¼é¡ä¼¼ Cookie Clicker

<Image src="./fidler02.png" alt="" />

ç›´æ¥ call è§£å¯† flag çš„åœ°æ–¹ï¼š

```py fidler.py =249
if __name__ == '__main__':
    target_amount = 103079215104
    print(decode_flag(int(target_amount / 100000000)))
#idle_with_kitty@flare-on.com
```

# 2 - garbage

## Description

>One of our team members developed a Flare-On challenge but accidentally deleted it. 
>We recovered it using extreme digital forensic techniques but it seems to be corrupted. 
>We would fix it but we are too busy solving today's most important information security threats affecting our global economy. 
>You should be able to get it working again, reverse engineer it, and acquire the flag.
>*7zip password: flare

## Solution

ç›´æ¥åŸ·è¡Œé¡Œç›®çµ¦çš„ garbage.exe ï¼Œ windows ç›´æ¥è·³éŒ¯èª¤åœ¨è‡‰ä¸Šï¼š

<Image src="./garbage00.png" alt="" />

æª¢æŸ¥ PE Header çš„å„ç¨®æ¬„ä½çœ‹èµ·ä¾†æ²’ä»€éº¼å•é¡Œï¼Œä½†æª¢æŸ¥ Section header æœƒç™¼ç¾ï¼Œé€™æ˜¯ä¸€éš»ç”± UPX å£“ç¸®éçš„ç¨‹å¼ï¼ŒåŒæ™‚æœ€å¾Œä¸€å€‹ `.rsrc` çš„ size ä¸å°ï¼Œæ ¹æ“šé¡Œç›®æ•˜è¿°ï¼Œé€™è£¡å¯ä»¥åˆç†æ¨æ–·è©²åœ°æ–¹çš„æ•¸æ“šéºå¤±ï¼Œç›´æ¥ `xxd garbage.exe` å¯ä»¥çœ‹åˆ°å°¾ç«¯çš„ xml è¢«æˆªæ–·äº†æ‰€ä»¥æ²’æœ‰é–‰åˆï¼š

```hexdump
00009e40: 0904 0000 4800 0000 5c90 0100 7d01 0000  ....H...\...}...
00009e50: 0000 0000 0000 0000 6050 0100 3c3f 786d  ........`P..<?xm
00009e60: 6c20 7665 7273 696f 6e3d 2731 2e30 2720  l version='1.0'
00009e70: 656e 636f 6469 6e67 3d27 5554 462d 3827  encoding='UTF-8'
00009e80: 2073 7461 6e64 616c 6f6e 653d 2779 6573   standalone='yes
00009e90: 273f 3e0d 0a3c 6173 7365 6d62 6c79 2078  '?>..<assembly x
00009ea0: 6d6c 6e73 3d27 7572 6e3a 7363 6865 6d61  mlns='urn:schema
00009eb0: 732d 6d69 6372 6f73 6f66 742d 636f 6d3a  s-microsoft-com:
00009ec0: 6173 6d2e 7631 2720 6d61 6e69 6665 7374  asm.v1' manifest
00009ed0: 5665 7273 696f 6e3d 2731 2e30 273e 0d0a  Version='1.0'>..
00009ee0: 2020 3c74 7275 7374 496e 666f 2078 6d6c    <trustInfo xml
00009ef0: 6e73 3d22 7572 6e3a 7363 6865 6d61 732d  ns="urn:schemas-
00009f00: 6d69 6372 6f73 6f66 742d 636f 6d3a 6173  microsoft-com:as
00009f10: 6d2e 7633 223e 0d0a 2020 2020 3c73 6563  m.v3">..    <sec
00009f20: 7572 6974 0a                             urit.
```

ç¸½ä¹‹å°±æ˜¯æŠŠ IAT ä¿®å¥½ï¼Œè®“ UPX æ‰¾å¾—åˆ°éœ€è¦ç”¨çš„ Dll è·Ÿå°æ‡‰çš„ functionï¼Œå› ç‚ºæ˜¯åŸ·è¡Œæª”æ‰€ä»¥ relocation å¯ä»¥ä¸ç®¡ï¼Œä¿®å¥½çš„ binary æˆ‘æ”¾åœ¨[é€™è£](https://github.com/terrynini/CTF-writeup/blob/master/Flareon_2020/2_-_garbage/repair.exe)ï¼Œç›´æ¥åŸ·è¡Œå°±æœƒç”Ÿæˆåç‚º `sink_the_tanker.vbs` çš„è…³æœ¬è² è²¬æŠŠ flag ç›´æ¥å°å‡ºä¾†ï¼š

<Image src="./garbage01.png" alt="" />

# 3 - wednesday

## Description

>Be the wednesday. Unlike challenge 1, you probably won't be able to beat this game the old fashioned way. Read the README.txt file, it is very important.

```text README.txt =
â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•
â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
 â•šâ•â•â•â•šâ•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•   â•šâ•â•

                        --- BE THE WEDNESDAY ---

                                   S
                                   M
                                   T
                                  DUDE
                                   T
                                   F
                                   S

                --- Enable accelerated graphics in VM ---
                  --- Attach sound card device to VM ---
                    --- Only reverse mydude.exe ---
                       --- Enjoy it my dudes ---%
```

## Solution

å¾ dll å¯ä»¥çŸ¥é“æ˜¯ç”¨ SDL æå‡ºä¾†çš„éŠæˆ²ï¼Œæ‰“é–‹å€‹äº”åˆ†é˜å¤§æ¦‚å°±èƒ½æŠ“åˆ°è¦å‰‡ï¼Œåªè¦æœ‰ M é€™å€‹ç®±å­å°±å¿…é ˆå¾ç®±å­çš„ä¸‹é¢é€šéï¼Œå¦å‰‡å°±ä¸€å®šè¦å¾ä¸Šé¢è·³éå»ï¼š

<Image src="./wednesday00.png" alt="" />

ç¨å¾®çœ‹ä¸€ä¸‹ binary å¯ä»¥ç™¼ç¾é€™å€‹ç¨‹å¼æ˜¯ç”¨ [nim](https://nim-lang.org/) æ’°å¯«çš„ï¼Œä»–çš„ç‰¹è‰²æ˜¯æœƒè¢«ç·¨è­¯æˆç­‰åƒ¹çš„ C æˆ–æ˜¯ C++ ç­‰èªè¨€ï¼Œç¸½ä¹‹ä¸åŒæ–¼ bytecodeï¼Œnim é€ å‡ºä¾†çš„æª”æ¡ˆæ˜¯ç„¡æ³•ç›´æ¥ decompile çš„ï¼Œä¸é function çš„ symbol å€’æ˜¯æ²’æœ‰å…¨éƒ¨éƒ½æ‹”é™¤ï¼Œå¯ä»¥ç²—ç•¥çš„çŒœå¾—å‡ºç›¸é—œåŠŸèƒ½ï¼š

<Image src="./wednesday01.png" alt="" />

é€™è£ç›´æ¥å¾ç¢°æ’åˆ¤å®šä¸‹æ‰‹ï¼Œåœ¨ `onCollide__9byAjE9cSmbSbow3F9cTFQfLg` ä¸­å¯ä»¥ç™¼ç¾è§’è‰²çš„ç¢°æ’åˆ¤å®šä»¥åŠåˆ†æ•¸åˆ¤å®šï¼Œfunction çš„ä¸ŠåŠéƒ¨ï¼ˆä¸åœ¨åœ–ç‰‡ä¸Šï¼‰æ˜¯è§’è‰²ç›´æ¥ç¢°æ’ç®±å­æœ¬é«”çš„æƒ…æ³ï¼Œç„¡è¦–ï¼Œç›´æ¥æŠŠä¸‹åŠæ®µé—œæ–¼ M ç®±å­åˆ¤æ–·çš„ if æ¢ä»¶å¼ï¼ˆæˆªåœ–ä¸­æœ€ä¸Šé¢çš„é‚£æ¢ ifï¼‰ patch æˆä¸€å®šæœƒé€²å…¥åŠ åˆ†çš„ç¨‹å¼ç¢¼ï¼ŒåŒæ™‚å¯ä»¥åœ¨ `update__Arw3f6ryHvqdibU49aaayOg` çš„æœ€ä¸‹é¢çŸ¥é“åˆ†æ•¸åˆ°é” 296 ä¹‹å¾Œå¯ä»¥çœ‹åˆ° flagï¼š

<Image src="./wednesday02.png" alt="" />

patch å®Œä¹‹å¾Œå°±ç„¡è…¦ç©ï¼Œä¸€ç›´è¹²ä¸‹ç›´åˆ°åˆ†æ•¸åˆ° 296 å°±å¥½äº†ï¼Œç›´æ¥ç”¨ cheat engine åšåŠ é€Ÿï¼š

<video width="100%" height="400" src="/files/wednesday.mp4" controls="controls">
The video tag is not supported by your browser.
</video>

# 4 - report

## Description

>Nobody likes analysing infected documents, but it pays the bills. Reverse this macro thrill-ride to discover how to get it to show you the key.

## Solution

çœ‹èµ·ä¾†æ˜¯ office çš„å·¨é›†ç—…æ¯’ï¼Œå°‘æ±è¥¿æ‰€ä»¥ä¸æœƒçœŸçš„åŸ·è¡Œï¼Œç›´æ¥çœ‹å·¨é›†çš„éƒ¨åˆ†ï¼Œå¤§éƒ¨åˆ†çš„æ±è¥¿éƒ½æ˜¯ç°¡å–®çš„ encodeï¼Œé¦–å…ˆæŠŠä¸€äº›ç‰©ä»¶ç”¨åˆ°çš„å­—ä¸²è§£å‡ºä¾†ï¼Œå…¶ä¸­å¯ä»¥çœ‹åˆ°æœ‰äº›å­—ä¸²ä¸¦æ²’æœ‰çœŸçš„è¢«ä½¿ç”¨åˆ°ï¼Œå¯èƒ½éœ€è¦çŒœä¸€ä¸‹è¢«æ‹¿å»åšäº†ä»€éº¼äº‹æƒ…ï¼š

```py string.py =
def rigmarole(a):
    t = ''
    for i in range(0,len(a),4):
        t += chr(int(a[i:i+2],16)-int(a[i+2:i+4],16))
    return t

def folderol():
    onzo = "9655B040B64667238524D15D6201.B95D4E01C55CC562C7557405A532D768C55FA12DD074DC697A06E172992CAF3F8A5C7306B7476B38.C555AC40A7469C234424.853FA85C470699477D3851249A4B9C4E.A855AF40B84695239D24895D2101D05CCA62BE5578055232D568C05F902DDC74D2697406D7724C2CA83FCF5C2606B547A73898246B4BC14E941F9121D464D263B947EB77D36E7F1B8254.853FA85C470699477D3851249A4B9C4E.9A55B240B84692239624.CC55A940B44690238B24CA5D7501CF5C9C62B15561056032C468D15F9C2DE374DD696206B572752C8C3FB25C3806.A8558540924668236724B15D2101AA5CC362C2556A055232AE68B15F7C2DC17489695D06DB729A2C723F8E5C65069747AA389324AE4BB34E921F9421.CB55A240B5469B23.AC559340A94695238D24CD5D75018A5CB062BA557905A932D768D15F982D.D074B6696F06D5729E2CAE3FCF5C7506AD47AC388024C14B7C4E8F1F8F21CB64".split(".")
    for idx, i in enumerate(onzo):
        print(idx,i)
        print(f"onzo[{idx}] = {rigmarole(i)}")

folderol()
# 0 9655B040B64667238524D15D6201
# onzo[0] = AppData
# 1 B95D4E01C55CC562C7557405A532D768C55FA12DD074DC697A06E172992CAF3F8A5C7306B7476B38
# onzo[1] = \Microsoft\stomp.mp3
# 2 C555AC40A7469C234424
# onzo[2] = play
# 3 853FA85C470699477D3851249A4B9C4E
# onzo[3] = FLARE-ON
# 4 A855AF40B84695239D24895D2101D05CCA62BE5578055232D568C05F902DDC74D2697406D7724C2CA83FCF5C2606B547A73898246B4BC14E941F9121D464D263B947EB77D36E7F1B8254
# onzo[4] = Sorry, this machine is not supported.
# 5 853FA85C470699477D3851249A4B9C4E
# onzo[5] = FLARE-ON
# 6 9A55B240B84692239624
# onzo[6] = Error
# 7 CC55A940B44690238B24CA5D7501CF5C9C62B15561056032C468D15F9C2DE374DD696206B572752C8C3FB25C3806
# onzo[7] = winmgmts:\\.\root\CIMV2
# 8 A8558540924668236724B15D2101AA5CC362C2556A055232AE68B15F7C2DC17489695D06DB729A2C723F8E5C65069747AA389324AE4BB34E921F9421
# onzo[8] = SELECT Name FROM Win32_Process
# 9 CB55A240B5469B23
# onzo[9] = vbox
# 10 AC559340A94695238D24CD5D75018A5CB062BA557905A932D768D15F982D
# onzo[10] = WScript.Network
# 11 D074B6696F06D5729E2CAE3FCF5C7506AD47AC388024C14B7C4E8F1F8F21CB64
# onzo[11] = \Microsoft\v.png
```

ç¹¼çºŒå¾€ä¸‹çœ‹å¯ä»¥ç™¼ç¾ï¼Œå·¨é›†æœƒè§£å¯†ä¸€æ®µ data ç„¶å¾Œå„²å­˜ç‚º stomp.mp3ï¼Œå¯«å€‹ python æ¨¡ä»¿ä»–è§£å¯†ï¼Œä½†æˆ‘å€‘å¾—åˆ°çš„éŸ³æª”è½èµ·ä¾†è·Ÿ flag ä¸€é»é—œä¿‚ä¹Ÿæ²’æœ‰ï¼Œä¸éå¯ä»¥æ³¨æ„åˆ°é€™è£¡ä¹Ÿæœ‰éƒ¨åˆ†çš„ data æ˜¯å®Œå…¨æ²’æœ‰è¢«ä½¿ç”¨åˆ°çš„ï¼š

```python decrypt.py =
f = open("./T",'r').read().strip()
key = [0x11,0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0xaa,0xbb,0xcc,0xdd,0xee]

kuffle = bytes([(int(f[i:i+2],16)  ^ key[(i//4)%len(key)]) for i in range(0,168667*4,4)])
with open("stomp.mp3",'wb') as z:
        z.write(kuffle)
```

æ²’æœ‰ç”¨åˆ°çš„æ˜¯ data çš„å¦å¤–ä¸€åŠï¼Œä»¥åŠä¸€äº›å­—ä¸² `\Microsoft\v.png`ï¼Œ`FLARE-ON`ï¼Œå¦‚æœæŠŠ data æŠ½å‡ºä¾†ï¼Œç„¶å¾Œå‡è¨­æª”é ­æ˜¯ PNG çš„æ ¼å¼ï¼Œå°±å¯ä»¥ç™¼ç¾ xor å‡ºä¾†çš„çµæœæ˜¯ `NO-E`ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥çŒœ key å°±æ˜¯ `"FLARE-ON"[::-1]`ï¼Œç›´æ¥å¯«è…³æœ¬è§£ï¼š

```python flag.py =
f = open("./T",'r').read().strip()
key = b'FLARE-ON'[::-1]

kuffle = [int(f[i:i+2],16)  ^ key[((i-2)//4)%len(key)] for i in range(2,len(f),4)]
with open("flag.png",'wb') as z:
    z.write(bytes(kuffle))
```

ç„¶å¾Œå°±æ‹¿åˆ° flag çš„åœ–ç‰‡äº†ï¼š

<Image src="./report.png" alt="" />

# 5 - TKApp

## Description

> Now you can play Flare-On on your watch! As long as you still have an arm left to put a watch on, or emulate the watch's operating system with sophisticated developer tools.

## Solution

ä¸€æ¨£æ˜¯æ»¿ç„¡èŠçš„ä¸€é¡Œï¼Œé¡Œç›®çµ¦çš„æ˜¯ [Galaxy Watch çš„æ‡‰ç”¨ç¨‹å¼](https://developer.samsung.com/galaxy-watch-develop/creating-your-first-app/net-companion/setup-sdk.html)ï¼Œä½†å‹•æ…‹ä¸¦æ²’æœ‰ä»€éº¼æ˜é¡¯çš„å¥½è™•ï¼Œå…ˆç›´æ¥éœæ…‹ç†è§£ä¸€ä¸‹ï¼Œç›´æ¥è§£å£“ç¸® TKApp.tpk å¾Œèµ°èµ°çœ‹çœ‹ï¼Œæ‡‰è©²èƒ½å¤ ç¢ºå®šæ‡‰ç”¨ç¨‹å¼çš„éƒ¨åˆ†æ˜¯ .NET ç¨‹å¼ï¼š

```
ExifLib.Standard.dll:                         PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows
TKApp.dll:                                    PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows
Tizen.Wearable.CircularUI.Forms.Renderer.dll: PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows
Tizen.Wearable.CircularUI.Forms.dll:          PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows
Xamarin.Forms.Core.dll:                       PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows
Xamarin.Forms.Platform.Tizen.dll:             PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows
Xamarin.Forms.Platform.dll:                   PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows
Xamarin.Forms.Xaml.dll:                       PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows
```

ç¸½ä¹‹æ‹¿å€‹ .NET çš„ decompiler çœ‹ä¸€ä¸‹ï¼Œç¨‹å¼æ‹¿ä¸€å †å­—ä¸²ä¾†ç•¶ä½œ AES çš„ keyï¼Œç”¨ä¾†è§£å‡º flagï¼Œæ‰€æœ‰çš„æ±è¥¿éƒ½èƒ½ç›´æ¥æ‰¾åˆ°ï¼Œå»æ‰¾ app descriptionï¼Œåœ–ç‰‡çš„ exif è³‡è¨Šç­‰ç­‰ï¼Œç„¶å¾Œèº«ç‚º cipher çš„ Runtime.dll å‰‡æ˜¯ç›´æ¥èººåœ¨ TPK.dll è£¡é¢ï¼Œç›´æ¥å¯«è§£å¯†

```py decrypt.py =
from Crypto.Cipher import AES
from hashlib import sha256
from base64 import *

IV = b'NoSaltOfTheEarth'
key = b'the kind of challenges we are gonna make here'
cipher = open("Runtime.dll",'rb').read()
decryptor = AES.new(sha256(key).digest(),AES.MODE_CBC,iv=IV)
f = decryptor.decrypt(cipher)
with open("flag.png",'wb') as flag:
    flag.write(b64decode(f))
```

<Image src="./TKApp.png" alt="" />

# 6 - codeit

## Description

> Reverse engineer this little compiled script to figure out what you need to do to make it give you the flag (as a QR code).

## Solution

binary æ˜¯ä¸€å€‹æœƒæŠŠè¼¸å…¥åšæˆ QRcode ä¹‹å¾Œç”¨åœ–ç‰‡å±•ç¤ºå‡ºä¾†ç¨‹å¼ï¼Œçœ‹èµ·ä¾†æ˜¯é€™æ¨£

<Image src="./codeit.png" alt="" />

<Image src="./codeit_QR.png" alt="" />

è§€å¯Ÿä¸€ä¸‹ binary è£¡é¢çš„å­—ä¸²ä¸é›£ç™¼ç¾é€™æ˜¯ä¸€å€‹å¾ AutoIt ç·¨è­¯è€Œä¾†çš„ç¨‹å¼ï¼Œéš¨ä¾¿æ‰¾ä¸€ä¸‹å°±å¯ä»¥æ‰¾åˆ°å·¥å…· èƒ½å¤ åšåˆ° extract byte code è·Ÿ decompile byte codeï¼Œé€™è£¡æˆ‘æ˜¯ç”¨ [AutoIt-Ripper](https://github.com/nazywam/AutoIt-Ripper)

ç¨‹å¼ç¢¼ç®—æ˜¯é‡åº¦æ··æ·†ï¼Œä¸éæœ€å¾Œçš„é‚è¼¯æ˜¯é€™æ¨£çš„ï¼Œä½¿ç”¨ Windows API `GetComputerNameA` å…ˆå–å¾—é›»è…¦åå­—ï¼Œç„¶å¾Œå°å…¶åš SHA-256 ä¹‹å¾Œå¯ä»¥å¾—åˆ°ä¸€å€‹ hashï¼Œä¹‹å¾Œç”¨åœ¨å°å‡ºçœŸçš„ QRcode ä¹‹å‰ï¼Œç¨‹å¼æœƒå…ˆå·å·ç”¨é€™å€‹ hash ç•¶ä½œ AES çš„ key ä¾†è§£å¯†ä¸€å€‹ cipherï¼Œå¦‚æœè§£å‡ºä¾†çš„èµ·é ­æ˜¯ `FLARE` ä¸”åŒæ™‚çµå°¾æ˜¯ `ERALF` æ™‚ï¼Œç¨‹å¼æœƒç›´æ¥æŠŠè§£å‡ºä¾†çš„æ±è¥¿ç•¶ä½œ QRcode ç”¨åœ–ç‰‡å±•ç¤ºå‡ºä¾†ï¼Œå¦å‰‡å°±å±•ç¤ºæœ¬ä¾†çš„è¼¸å…¥æ‰€å°æ‡‰çš„ QRcodeï¼Œä¹Ÿå°±æ˜¯èªªæˆ‘å€‘è¦æ‰¾åˆ°æ­£ç¢ºçš„ ComputerNameã€‚

åœ¨ 227 è¡Œé™„è¿‘å¯ä»¥çœ‹åˆ°ä¸€äº› bitwise çš„æ“ä½œï¼ˆ function æˆ‘é‡å‘½åéäº†ï¼‰ï¼š

```autoit script.au3 =227
FUNC readSpriteBmp ( BYREF $computerName )
    LOCAL $FLQVIZHEZM = InstallFile ( 14 )
    LOCAL $FLFWEZDBYC = createFile ( $FLQVIZHEZM )
    IF $FLFWEZDBYC <> - $FLTGQYKODM THEN
        LOCAL $FLVBURIUYD = _GetFileSize_ ( $FLFWEZDBYC )
        IF $FLVBURIUYD <> - $FLTMXODMFL AND DLLSTRUCTGETSIZE ( $computerName ) < $FLVBURIUYD - 54 THEN
            LOCAL $FLNFUFVECT = DLLSTRUCTCREATE (_Hex2Str_( 'struct;byte[' & '269156' & '];endstruct')
            LOCAL $FLSKUANQBG = ReadFile ( $FLFWEZDBYC , $FLNFUFVECT )
            IF $FLSKUANQBG <> - $FLVUJARIHO THEN
                LOCAL $FLXMDCHRQD = DLLSTRUCTCREATE ( 'struct;byte[54];byte[' & $FLVBURIUYD - 54 & '];endstruct', DLLSTRUCTGETPTR ( $FLNFUFVECT ) )
                LOCAL $FLQGWNZJZC = 1
                LOCAL $FLOCTXPGQH = ''
                FOR $FLTERGXSKH =  1 TO DLLSTRUCTGETSIZE ( $computerName )
                    LOCAL $FLYDTVGPNC = NUMBER ( DLLSTRUCTGETDATA ( $computerName , 1 , $FLTERGXSKH ) )
                    FOR $FLTAJBYKXX = 6 TO 0 STEP -1
                        $FLYDTVGPNC += BITSHIFT ( BITAND ( NUMBER ( DLLSTRUCTGETDATA ( $FLXMDCHRQD , 2 , $FLQGWNZJZC ) ) , 1 ) , -1 * $FLTAJBYKXX )
                        $FLQGWNZJZC += 1
                    NEXT
                    $FLOCTXPGQH &= CHR ( BITSHIFT ( $FLYDTVGPNC ,1) + BITSHIFT ( BITAND ( $FLYDTVGPNC ,1) , -7 ) )
                NEXT
                DLLSTRUCTSETDATA ( $computerName , 1 , $FLOCTXPGQH )
            ENDIF
        ENDIF
        CloseHandle ( $FLFWEZDBYC )
    ENDIF
    DeleteFileA ( $FLQVIZHEZM )
ENDFUNC
```

ä»–åšçš„äº‹æƒ…å°±æ˜¯æŠŠä¸€é–‹å§‹çœ‹åˆ°çš„é‚£å€‹åœ¨æ•²éµç›¤çš„ flare icon çš„æ¯ 7bits çµ„èµ·ä¾†ï¼Œé€™è½èµ·ä¾†å°±æ˜¯ ASCIIï¼Œæ‰€ä»¥å¦‚æœæˆ‘å€‘ç…§åšçš„è©±å°±å¯ä»¥æŠ½å‡ºé€™æ®µå­— `aut01tfan1999` é€™å°±æ˜¯æ­£ç¢ºçš„é›»è…¦åç¨±ï¼Œæœ€å¾Œå°±æ˜¯çœ‹è¦ç›´æ¥æ”¹ ComputerName é‚„æ˜¯ Hook Functionï¼Œæˆ–æ˜¯ç›´æ¥è§£å¯†éƒ½è¡Œã€‚

Flag: `L00ks_L1k3_Y0u_D1dnt_Run_Aut0_Tim3_0n_Th1s_0ne!@flare-on.com`

---

ä¸‹é¢çš„é¡Œç›®å¿˜è¨˜æˆªåœ–...ï¼Œé›–ç„¶éƒ½è¨˜å¾—å¾ˆæ¸…æ¥šï¼Œä½†æ˜¯æ‡¶å¾—å¯«ã„Œï¼Œæˆ‘å°±å¯«å€‹å¤§æ¦‚å°±å¥½äº†ï¼Œåæ­£æœ‰å®˜æ–¹ writeupï¼Œ2ã„2ã„ã€‚

# 7 - re_crowd

æœƒæ‹¿åˆ°ä¸€å€‹ pcap æª”æ¡ˆï¼Œå¯¦éš›ä¸Šæ˜¯æ”»æ“Šè€…åœ¨ç”¨ CVE æ”»æ“Šä¼ºæœå™¨ä¸¦ä¸”å·æª”æ¡ˆï¼Œè£é¢åŒ…å« alphanumeric unicode shellcode æŠŠå®ƒå€’å‡ºä¾†åˆ†æçœ‹æ‡‚å°±å¥½äº†ï¼Œè§£å®Œ RC4 å°±å¯ä»¥å¾—åˆ° flagã€‚

# 8 - Aardvark

é€™æ”¯ç¨‹å¼åˆ©ç”¨ wsl å«èµ·ä¸€å€‹ ELF åŸ·è¡Œæª”ï¼ˆæ”¾åœ¨ PE resource è£é¢ï¼‰ï¼Œä¹‹å¾Œç”¨ UNIX Socket æºé€šä¾†ç© OOXXï¼ˆTic-tac-toeï¼‰ çš„éŠæˆ²ï¼Œç”±æ–¼ Tic-tac-toe åœ¨ç©å®¶éƒ½ä¸‹æœ€ä½³ä½ç½®æ™‚æ˜¯å¿…å®šå¹³æ‰‹çš„éŠæˆ²ï¼Œè§£æ³•å°±æ˜¯æŠŠ ELF è£é¢åˆå§‹åŒ–éŠæˆ²ç›¤é¢çš„åœ°æ–¹æ”¹æˆé å…ˆæ”¾ä¸€å † O é€™æ¨£å°±å¿…å‹äº†ã€‚

# 9 - crackinstaller

crackinstaller æœƒå…ˆå®‰è£ä¸€å€‹æœ‰ç°½ç« ä¸”èƒ½ç¹é SMEP çš„ driver ä¹‹å¾Œé€éé€™å€‹ driver å®‰è£ä¸€å€‹æ²’æœ‰ç°½ç« çš„ driverï¼Œç›®æ¨™æ˜¯è¦åœ¨ç™»éŒ„æª”è£¡é¢å¯«ä¸Šæ­£ç¢ºçš„å¯†ç¢¼ç„¶å¾Œå¯«ä¸€å€‹ COM çš„ Client è·Ÿ crackinstaller å®‰è£çš„ COM åšäº’å‹•ï¼Œæœ€å¾Œå°±å¯ä»¥æ‹¿åˆ° flagã€‚

æ¯”è¼ƒæœ‰è¶£çš„é»æ˜¯ã€Œä¸€å€‹æœ‰ç°½ç« ä¸”èƒ½ç¹é SMEP çš„ driver ã€ï¼Œä¸€é–‹å§‹æˆ‘è§£å®Œé¡Œç›®å¾Œä¸€ç›´è¦ºå¾—è£¡é¢çš„ magic number æ„Ÿè¦ºå¯ä»¥ç›´æ¥æŸ¥åˆ°ï¼Œæä¸å¥½æˆ‘ä¸ç”¨èŠ±é€™éº¼å¤šæ™‚é–“é€†å‘ï¼Œçµæœç™¼ç¾é€™æ±è¥¿æ ¹æœ¬å°±æ˜¯[å¡æ™®ç©ºçš„æ±è¥¿](https://www.unknowncheats.me/forum/1547391-post1.html)ï¼ŒPC ç‰ˆçš„ Street Fighter V çš„ driver è€Œä¸”ä»–å”¯ä¸€çš„åŠŸèƒ½å°±æ˜¯æŠŠ SMEP é—œæ‰ç„¶å¾Œè·³ä¸Š userland åŸ·è¡Œä»»æ„ç¨‹å¼ï¼Œå¤©å•Šå¡æ™®ç©º...

# 10 - break

ç°¡å–®ä¾†èªªå°±æ˜¯åŸ·è¡Œä¸»è¦ç¨‹å¼å¾Œï¼Œä¸»è¦ç¨‹å¼æœƒ fork B ä¾† debug è‡ªå·±ï¼ŒB æœƒ fork C ä¾† debug è‡ªå·±ï¼Œé‚è¼¯éƒ½è¢«å¾€ä¸‹å¤–åŒ…ï¼Œå› ç‚º C å¾ˆç°¡å–®ï¼Œæ‰€ä»¥å¯ä»¥æŠŠé‚£äº›åŠŸèƒ½éƒ½ patch å› Bï¼Œé€™æ¨£å°±å¯ä»¥ç”¨ gdb è·Ÿ B åœ¨åšä»€éº¼äº†ï¼Œå°±é†¬å­ï¼Œå¾Œé¢å°±æƒ³è¾¦æ³•æä¸€æå°±æœƒæœ‰ flag äº†ã€‚

# 11 - rabbithole

éå¸¸æƒ¡åŠ£ï¼Œæ¥µç›¡æˆ‘é€šéˆä¹‹èƒ½æŠŠå…¨éƒ¨çš„æ¨£æœ¬éƒ½çœ‹å®Œäº†ï¼Œä½†å…¶å¯¦ä¸ç”¨çœ‹ 32bit é‚£ä¸€éƒ¨åˆ†çš„ 1x å€‹ payloadï¼Œç¸½ä¹‹è£¡é¢çš„ PE æª”æ¡ˆéƒ½è¢« PX é€™å€‹ç®—æ³•çµ¦åŒ…èµ·ä¾†äº†ï¼Œé¦–å…ˆè¦å…ˆå¯«è…³æœ¬æŠŠä»–å€‘å¥½å¥½è§£é–‹ï¼Œç„¶å¾Œå°±å¯ä»¥çœ‹æ‡‚ dll ä¹‹é–“äº’ç›¸å‘¼å«ï¼Œè¢«åŠ å¯†çš„ flag åœ¨ DiMap é€™å€‹ç™»éŒ„æª”è£¡é¢ï¼Œè§£é–‹å°±æ˜¯äº†ã€‚